{"pages":[{"title":"about-me","text":"ok,this is test text that something for you","link":"/about-me/index.html"}],"posts":[{"title":"PythonæŠ¥é”™æ€»ç»“","text":"PythonæŠ¥é”™æ€»ç»“Non-ASCIIpythonå‡ºç°SyntaxError: Non-ASCII character â€˜\\xe6â€™ in file æ‰“å°æ—¥æœŸ.py on line 1, but no encoding declared; è§£å†³æ–¹æ³•åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ å¦‚ä¸‹ä¸¤è¡Œæ³¨é‡Šç ï¼š #!/usr/bin/python# -*- coding: -*- ä¾‹å¦‚ï¼Œå¯æ·»åŠ # -*- coding: utf-8 -*-","link":"/posts/1d0174bc/"},{"title":"docker-swarm-wordpress","text":"learn docker ğŸ³ğŸ³ docker-swarm-wordpressé€šè¿‡docker + swarm + wordpress å»ºç«‹é›†ç¾¤ å®æˆ˜åœ¨ä¸æŒ‡å®šåŒç½‘ç»œç»„çš„æƒ…å†µä¸‹ï¼Œdockeré»˜è®¤å°†æ‰€æœ‰çš„ipéƒ½å½’ç±»åˆ°åå­—å«åšdocker0çš„bridgeç»„é‡Œé¢ï¼Œä½†æ˜¯è¿™æ ·åœ¨è·¨æœºå™¨çš„å®¹å™¨ä¸­ï¼Œæ„å»ºä¼šååˆ†éº»çƒ¦ï¼Œæ— æ³•é€šè¿‡å®¹å™¨åæ¥è¿›è¡Œipé€šä¿¡å› æ­¤ï¼Œåœ¨åˆ›å»ºçš„è¿‡ç¨‹ä¸­éœ€è¦æŒ‡å®šç½‘ç»œç»„ åˆ›å»ºä¸€ä¸ªoverlayçš„ç½‘ç»œdocker network create -d overlay demo# æŸ¥çœ‹æ˜¯å¦åˆ›å»ºæˆåŠŸ [root@manager55 ~]# docker network lsNETWORK ID NAME DRIVER SCOPEee5b54750620 bridge bridge localmxmjjml84ldx demo overlay swarm6ad358de8e6b docker_gwbridge bridge localf127d4764edd host host localihvz4z5lfwis ingress overlay swarm 8000/tcp[root@manager55 ~]# docker service ps clientID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTSt7xe5omklz28 client.1 busybox:latest work196 Running Running 15 minutes ago å¯ä»¥å‘ç°busyboxçš„å®¹å™¨æ˜¯è¿è¡Œåœ¨work196ä¸Šé¢çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å»busybox ping whoamiè¿™ä¸ªå®¹å™¨åï¼Œ [root@work196 ~]# docker exec bd2b98fdc7f9 ping whoamiPING whoami (10.0.2.2): 56 data bytes64 bytes from 10.0.2.2: seq=0 ttl=64 time=0.077 ms64 bytes from 10.0.2.2: seq=1 ttl=64 time=0.194 ms64 bytes from 10.0.2.2: seq=2 ttl=64 time=0.193 ms # æŸ¥çœ‹whoamiå®¹å™¨çš„ip[root@manager55 ~]# docker ecec dfcd2f4c0396 ip adocker: 'ecec' is not a docker command.See 'docker --help'[root@manager55 ~]# docker exec dfcd2f4c0396 ip a1: lo: mtu 65536 qdisc noqueue state UNKNOWN qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever31: eth1@if32: mtu 1450 qdisc noqueue state UP link/ether 02:42:0a:00:00:08 brd ff:ff:ff:ff:ff:ff inet 10.0.0.8/24 brd 10.0.0.255 scope global eth1 valid_lft forever preferred_lft forever33: eth2@if34: mtu 1500 qdisc noqueue state UP link/ether 02:42:ac:12:00:03 brd ff:ff:ff:ff:ff:ff inet 172.18.0.3/16 brd 172.18.255.255 scope global eth2 valid_lft forever preferred_lft forever35: eth0@if36: mtu 1450 qdisc noqueue state UP link/ether 02:42:0a:00:02:03 brd ff:ff:ff:ff:ff:ff inet 10.0.2.3/24 brd 10.0.2.255 scope global eth0 valid_lft forever preferred_lft forever åœ¨ping whoamiå®¹å™¨æ—¶å€™ï¼Œå¹¶æ²¡æœ‰å…¶pingä»–çš„ä»»ä½•ä¸€ä¸ªipè¯´æ˜åœ¨è¿™ä¹‹ä¸Šåˆåšäº†ä¸€å±‚vipï¼Œç”¨æ¥ç»Ÿä¸€ç®¡ç†æ‰€æœ‰å®¹å™¨åä¸ºwhoamiçš„æœºå™¨ æ‰©å±•whoaminå®¹å™¨ docker service scale whami=4 å†æ¬¡ä½¿ç”¨pingçš„æ—¶å€™ä¼šå‘ç°ï¼ŒåŒæ ·pingçš„æ˜¯è¿™ä¸ªvip æŸ¥çœ‹è™šæ‹Ÿipä¸‹é¢çš„ip [root@work196 ~]# docker exec bd2b98fdc7f9 nslookup tasks.whoamiServer: 127.0.0.11Address: 127.0.0.11:53Non-authoritative answer:Name: tasks.whoamiAddress: 10.0.2.10Name: tasks.whoamiAddress: 10.0.2.3Name: tasks.whoamiAddress: 10.0.2.9Name: tasks.whoamiAddress: 10.0.2.8*** Can't find tasks.whoami: No answer å…¶å®è¿™äº›å†…å®¹å°±æ˜¯vipä¸‹é¢çš„çœŸæ­£çš„IPå› æ­¤service ä¸serviceä¹‹é—´æ˜¯é€šè¿‡vipè¿›è¡Œé€šä¿¡çš„","link":"/posts/1976fb59/"},{"title":"Pythonå¸¸ç”¨æ–¹æ³•1","text":"python å¸¸ç”¨æ–¹æ³•ä¿ç•™å°æ•°ä½¿ç”¨å­—ç¬¦ä¸²æ ¼å¼åŒ– a = 11.234print(\"%.2f\"%a) ä½¿ç”¨roundå†…ç½®å‡½æ•° a = 11.234a = round(a,2)print(a) ä½¿ç”¨decimalæ¨¡å— from decimal import Decimala = 12.345Decimal(a).quantize(Decimal(\"0.00\")) åˆ—è¡¨åˆ—è¡¨åˆå¹¶# ä½¿ç”¨+å·æ“ä½œlist1 = [1,2,3,4,5]list2 = [\"z\",\"xx\",] list3 = list1+list2# ä½¿ç”¨extendlist4.extend(list1)# ä½¿ç”¨åˆ‡ç‰‡list4[len(11):len(11)] = list5 osæ¨¡å—Pythonè·å–æŒ‡å®šæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶åæ¨¡å—os.walkå¯ä»¥éå†æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ os.walk(top, topdown=Ture, Î¿nerrÎ¿r=None, followlinks=False)# return (dirpath dirnames filenames) dirpath: string ä»£è¡¨ç›®å½•çš„è·¯å¾„ dirnames list åŒ…å«äº†å½“å‰dirpathè·¯å¾„ä¸‹æ‰€æœ‰çš„å­ç›®å½•åå­—ï¼ˆä¸åŒ…å«ç›®å½•è·¯å¾„ï¼‰ filenamesï¼šlistï¼ŒåŒ…å«äº†å½“å‰dirpathè·¯å¾„ä¸‹æ‰€æœ‰çš„éç›®å½•å­æ–‡ä»¶çš„åå­—ï¼ˆä¸åŒ…å«ç›®å½•è·¯å¾„ï¼‰ã€‚import os def file_name(file_dir): for root, dirs, files in os.walk(file_dir): print(root) #å½“å‰ç›®å½•è·¯å¾„ print(dirs) #å½“å‰è·¯å¾„ä¸‹æ‰€æœ‰å­ç›®å½• print(files) #å½“å‰è·¯å¾„ä¸‹æ‰€æœ‰éç›®å½•å­æ–‡ä»¶ for file in files: # os.path.splitext # å¯¹æ–‡ä»¶åè¿›è¡Œåˆ‡å‰²æˆæ•°ç»„ if os.path.splitext(file)[1] == \".jpeg\": print(file) else: pass æ¨¡å—os.listdir()å¯ä»¥å¾—åˆ°å½“å‰è·¯å¾„ä¸‹çš„æ–‡ä»¶åï¼Œä¸åŒ…æ‹¬å­ç›®å½•ä¸­çš„æ–‡ä»¶ import os# éå†è·å–æ‰€æœ‰æ–‡ä»¶def listdir(path, list_name): for file in os.listdir(path): file_path = os.path.join(path, file) # os.path.isdir(file) #åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºæ–‡ä»¶å¤¹ if os.path.isdir(file_path): listdir(file_path, list_name) elif os.path.splitext(file_path)[1]=='.jpeg': list_name.append(file_path) åˆ¤æ–­æ–‡ä»¶ç±»å‹os.path.isdir(path) # æ˜¯å¦ä¸ºæ–‡ä»¶å¤¹os.path.isfile(path) # æ˜¯å¦ä¸ºæ–‡ä»¶ æ–‡ä»¶æ“ä½œmodeé€‰é¡¹r è¯»æ¨¡å¼ï¼Œåªèƒ½è¯» æ–‡ä»¶ä¸å­˜åœ¨æŠ¥é”™ï¼Œw å†™æ¨¡å¼ï¼Œåªèƒ½å†™ æ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œä»¥ä¸Šå­˜åœ¨å­˜åœ¨åˆ™æ¸…ç©ºåœ¨æ‰“å¼€ rb äºŒè¿›åˆ¶è¯»æ¨¡å¼ åªèƒ½è¯» æ–‡ä»¶ä¸å­˜åœ¨æŠ¥é”™wb äºŒè¿›åˆ¶å†™æ¨¡å¼ åªèƒ½å†™ æ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œä»¥ä¸Šå­˜åœ¨åˆ™æ¸…ç©ºå†æ‰“å¼€æœ‰äºŒè¿›åˆ¶å†…å®¹ å†™å…¥åˆ™éœ€è¦encode(â€œutf-8â€) rb+ äºŒè¿›åˆ¶è¯»æ¨¡å¼ å¯è¯»å¯å†™ æ–‡ä»¶ä¸å­˜åœ¨æŠ¥é”™wb+ äºŒè¿›åˆ¶å†™æ¨¡å¼ å¯è¯»å¯å†™ æ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œä»¥ä¸Šå­˜åœ¨åˆ™æ¸…ç©ºå†æ‰“å¼€ a è¿½åŠ å†™æ¨¡å¼ï¼Œæ–‡ä»¶å­˜åœ¨åˆ™è¿½åŠ å†™å…¥a+ è¿½åŠ è¯»å†™æ–¹å¼ä»¥ä¸Šå­˜åœ¨åˆ™è¿½åŠ å†™å…¥ é»˜è®¤è¿›å…¥ä¸ºæ–‡ä»¶æœ«å°¾f.seek(0) è®¾ç½®è¯»å†™ä½ç½®ä¸ºå¼€å¤´f.truncate(0) å°†æ–‡ç« å­—èŠ‚é˜¶æ®µä¸º0 æ–‡ä»¶å¤´éƒ¨å†™å¦‚æ–‡ä»¶with open(path, \"r+\") as f: old = f.read() f.seek(0) f.write(data) f.write(old) æˆ–è€… with open(path,\"a\") as f: f.seek(0) old = f.read() # å…¨éƒ¨åˆ é™¤ f.truncate(0) f.write(\"---\") f.write(\"tags: xxx\") f.write(\"---\") f.close() Python-mathåº“å‘ä¸Šå–æ•´ math.ceilå‘ä¸‹å–æ•´ math.floorå››èˆäº”å…¥ round import math#å‘ä¸Šå–æ•´print \"math.ceil---\"print \"math.ceil(2.3) => \", math.ceil(2.3)print \"math.ceil(2.6) => \", math.ceil(2.6) #å‘ä¸‹å–æ•´print \"\\nmath.floor---\"print \"math.floor(2.3) => \", math.floor(2.3)print \"math.floor(2.6) => \", math.floor(2.6) #å››èˆäº”å…¥print \"\\nround---\"print \"round(2.3) => \", round(2.3)print \"round(2.6) => \", round(2.6) #è¿™ä¸‰ä¸ªçš„è¿”å›ç»“æœéƒ½æ˜¯æµ®ç‚¹å‹print \"\\n\\nNOTE:every result is type of float\"print \"math.ceil(2) => \", math.ceil(2)print \"math.floor(2) => \", math.floor(2)print \"round(2) => \", round(2)","link":"/posts/79b81c10/"},{"title":"Cè¯­è¨€åŸºç¡€","text":"Cè¯­è¨€åŸºç¡€å¯¹Cè¯­è¨€åŸºç¡€åªæ˜¯çš„æ¦‚æ‹¬ ç›®æ ‡æ–‡ä»¶ å¯æ‰§è¡Œæ–‡ä»¶ åº“ æºæ–‡ä»¶ æºæ–‡ä»¶æŒ‡çš„æ˜¯æˆ‘ä»¬æ‰€ç¼–å†™çš„æ–‡ä»¶ vi xx.c#include int main(void){ printf(\"hello world\"); return 0;} ä»¥ä¸Šxx.cå°±æ˜¯æˆ‘ä»¬çš„æºæ–‡ä»¶ åœ¨unixä¸­ç¼–è¯‘cè¯­è¨€ cc xx.c ä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ç”Ÿæˆä¸€ä¸ªa.outçš„å¯æ‰§è¡Œæ–‡ä»¶ è¿è¡Œå³å¯ æ•´ä¸ªæµç¨‹å°±æ˜¯ç”¨æˆ·è¾“å…¥ä»£ç ç”Ÿæˆæºç æ–‡ä»¶ é€šè¿‡ccç¼–è¯‘åç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ è¿è¡Œè¾“å‡ºå†…å®¹ccå…¶å®æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œå¯ä»¥ç”¨man cc æŸ¥çœ‹ ä¹Ÿå¯ä»¥ç”¨cc -væŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ åœ¨linuxä¸­ä½¿ç”¨gccç¼–è¯‘cæ–‡ä»¶ gcc xx.c ç¬¬ä¸€ä¸ªcè¯­è¨€ç¨‹åº # include int main(void){ int nums; nums = 1; printf(\"how many dogs do you have?\\n\"); getchar(); return 0;}includeæ˜¯é¢„å¤„ç†å™¨æŒ‡ä»¤ mainæ˜¯ç¬¬ä¸€ä¸ªè¢«è°ƒç”¨çš„å‡½æ•° func aæ˜¯æ„é€ å—stdio.h æ˜¯cç¼–è¯‘å™¨è½¯ä»¶åŒ…çš„æ ‡å‡†éƒ¨åˆ† å˜é‡ç±»å‹æ•´æ•° int int nums=12;int nums;nums = 12; int nums = 12 , ages = 20; å¤§è‡´çš„æ‰§è¡Œè¿‡ç¨‹ä¸º int nums åˆ’åˆ†å‡ºä¸€å—å†…å­˜ç©ºé—´åä¸ºnumsnums = 12 ä¸ºnumsèµ‹å€¼12çš„å˜é‡ é”™è¯¯zsh: command not found: a.outmacä¸‹æ— æ³•æ‰§è¡Œccç¼–è¯‘åçš„æ–‡ä»¶å› ä¸ºæ²¡æœ‰ç¡®å®šå·¥ä½œè·¯å¾„ è¿è¡Œ./a.outå°±å¯ä»¥äº†","link":"/posts/9ec06885/"},{"title":"dockeråŸºç¡€","text":"use docker dockerdockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«è™šæ‹Ÿæœºè™šæ‹Ÿæœºè¿è¡Œå¤šä¸ªéš”ç¦»åº”ç”¨æ—¶ ä»ä¸‹åˆ°ä¸Šæ¥çœ‹: åŸºç¡€è®¾æ–½(Infrastructure)ã€‚å®ƒå¯ä»¥æ˜¯ä½ çš„ä¸ªäººç”µè„‘ï¼Œæ•°æ®ä¸­å¿ƒçš„æœåŠ¡å™¨ï¼Œæˆ–è€…æ˜¯äº‘ä¸»æœºã€‚ ä¸»æ“ä½œç³»ç»Ÿ(Host Operating System)ã€‚ä½ çš„ä¸ªäººç”µè„‘ä¹‹ä¸Šï¼Œè¿è¡Œçš„å¯èƒ½æ˜¯MacOSï¼ŒWindowsæˆ–è€…æŸä¸ªLinuxå‘è¡Œç‰ˆã€‚ è™šæ‹Ÿæœºç®¡ç†ç³»ç»Ÿ(Hypervisor)ã€‚åˆ©ç”¨Hypervisorï¼Œå¯ä»¥åœ¨ä¸»æ“ä½œç³»ç»Ÿä¹‹ä¸Šè¿è¡Œå¤šä¸ªä¸åŒçš„ä»æ“ä½œç³»ç»Ÿã€‚ç±»å‹1çš„Hypervisoræœ‰æ”¯æŒMacOSçš„HyperKitï¼Œæ”¯æŒWindowsçš„Hyper-Vä»¥åŠæ”¯æŒLinuxçš„KVMã€‚ç±»å‹2çš„Hypervisoræœ‰VirtualBoxå’ŒVMWareã€‚ ä»æ“ä½œç³»ç»Ÿ(Guest Operating System)ã€‚å‡è®¾ä½ éœ€è¦è¿è¡Œ3ä¸ªç›¸äº’éš”ç¦»çš„åº”ç”¨ï¼Œåˆ™éœ€è¦ä½¿ç”¨Hypervisorå¯åŠ¨3ä¸ªä»æ“ä½œç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯3ä¸ªè™šæ‹Ÿæœºã€‚è¿™äº›è™šæ‹Ÿæœºéƒ½éå¸¸å¤§ï¼Œä¹Ÿè®¸æœ‰700MBï¼Œè¿™å°±æ„å‘³ç€å®ƒä»¬å°†å ç”¨2.1GBçš„ç£ç›˜ç©ºé—´ã€‚å®ƒä»¬è¿˜ä¼šæ¶ˆè€—å¾ˆå¤šCPUå’Œå†…å­˜ã€‚ å„ç§ä¾èµ–ã€‚æ¯ä¸€ä¸ªä»æ“ä½œç³»ç»Ÿéƒ½éœ€è¦å®‰è£…è®¸å¤šä¾èµ–ã€‚å¦‚æœä½ çš„çš„åº”ç”¨éœ€è¦è¿æ¥PostgreSQLçš„è¯ï¼Œåˆ™éœ€è¦å®‰è£…libpq-devï¼›å¦‚æœä½ ä½¿ç”¨Rubyçš„è¯ï¼Œåº”è¯¥éœ€è¦å®‰è£…gemsï¼›å¦‚æœä½¿ç”¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼Œæ¯”å¦‚Pythonæˆ–è€…Node.jsï¼Œéƒ½ä¼šéœ€è¦å®‰è£…å¯¹åº”çš„ä¾èµ–åº“ã€‚ åº”ç”¨ã€‚å®‰è£…ä¾èµ–ä¹‹åï¼Œå°±å¯ä»¥åœ¨å„ä¸ªä»æ“ä½œç³»ç»Ÿåˆ†åˆ«è¿è¡Œåº”ç”¨äº†ï¼Œè¿™æ ·å„ä¸ªåº”ç”¨å°±æ˜¯ç›¸äº’éš”ç¦»çš„ã€‚ dokcerå®¹å™¨ç›¸æ¯”äºè™šæ‹Ÿæœºæ¥è¯´ dockeræ›´åŠ çš„ç®€æ´ ä»ä¸‹åˆ°ä¸Š åŸºç¡€è®¾æ–½(Infrastructure)ã€‚ ä¸»æ“ä½œç³»ç»Ÿ(Host Operating System)ã€‚æ‰€æœ‰ä¸»æµçš„Linuxå‘è¡Œç‰ˆéƒ½å¯ä»¥è¿è¡ŒDockerã€‚å¯¹äºMacOSå’ŒWindowsï¼Œä¹Ÿæœ‰ä¸€äº›åŠæ³•â€è¿è¡Œâ€Dockerã€‚ Dockerå®ˆæŠ¤è¿›ç¨‹(Docker Daemon)ã€‚Dockerå®ˆæŠ¤è¿›ç¨‹å–ä»£äº†Hypervisorï¼Œå®ƒæ˜¯è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šçš„åå°è¿›ç¨‹ï¼Œè´Ÿè´£ç®¡ç†Dockerå®¹å™¨ã€‚ å„ç§ä¾èµ–ã€‚å¯¹äºDockerï¼Œåº”ç”¨çš„æ‰€æœ‰ä¾èµ–éƒ½æ‰“åŒ…åœ¨Dockeré•œåƒä¸­ï¼ŒDockerå®¹å™¨æ˜¯åŸºäºDockeré•œåƒåˆ›å»ºçš„ã€‚ åº”ç”¨ã€‚åº”ç”¨çš„æºä»£ç ä¸å®ƒçš„ä¾èµ–éƒ½æ‰“åŒ…åœ¨Dockeré•œåƒä¸­ï¼Œä¸åŒçš„åº”ç”¨éœ€è¦ä¸åŒçš„Dockeré•œåƒã€‚ä¸åŒçš„åº”ç”¨è¿è¡Œåœ¨ä¸åŒçš„Dockerå®¹å™¨ä¸­ï¼Œå®ƒä»¬æ˜¯ç›¸äº’éš”ç¦»çš„ åŒºåˆ«Dockerå®ˆæŠ¤è¿›ç¨‹å¯ä»¥ç›´æ¥ä¸ä¸»æ“ä½œç³»ç»Ÿè¿›è¡Œé€šä¿¡ï¼Œä¸ºå„ä¸ªDockerå®¹å™¨åˆ†é…èµ„æºï¼›å®ƒè¿˜å¯ä»¥å°†å®¹å™¨ä¸ä¸»æ“ä½œç³»ç»Ÿéš”ç¦»ï¼Œå¹¶å°†å„ä¸ªå®¹å™¨äº’ç›¸éš”ç¦»ã€‚è™šæ‹Ÿæœºå¯åŠ¨éœ€è¦æ•°åˆ†é’Ÿï¼Œè€ŒDockerå®¹å™¨å¯ä»¥åœ¨æ•°æ¯«ç§’å†…å¯åŠ¨ã€‚ç”±äºæ²¡æœ‰è‡ƒè‚¿çš„ä»æ“ä½œç³»ç»Ÿï¼ŒDockerå¯ä»¥èŠ‚çœå¤§é‡çš„ç£ç›˜ç©ºé—´ä»¥åŠå…¶ä»–ç³»ç»Ÿèµ„æºã€‚ è¯´äº†è¿™ä¹ˆå¤šDockerçš„ä¼˜åŠ¿ï¼Œå¤§å®¶ä¹Ÿæ²¡æœ‰å¿…è¦å®Œå…¨å¦å®šè™šæ‹ŸæœºæŠ€æœ¯ï¼Œå› ä¸ºä¸¤è€…æœ‰ä¸åŒçš„ä½¿ç”¨åœºæ™¯ã€‚è™šæ‹Ÿæœºæ›´æ“…é•¿äºå½»åº•éš”ç¦»æ•´ä¸ªè¿è¡Œç¯å¢ƒã€‚ä¾‹å¦‚ï¼Œäº‘æœåŠ¡æä¾›å•†é€šå¸¸é‡‡ç”¨è™šæ‹ŸæœºæŠ€æœ¯éš”ç¦»ä¸åŒçš„ç”¨æˆ·ã€‚è€ŒDockeré€šå¸¸ç”¨äºéš”ç¦»ä¸åŒçš„åº”ç”¨ï¼Œä¾‹å¦‚å‰ç«¯ï¼Œåç«¯ä»¥åŠæ•°æ®åº“ã€‚ æ¦‚å¿µ é•œåƒ(Image)é¢å‘dockerå¼•æ“çš„åªè¯»æ¨¡ç‰ˆï¼ŒåŒ…å«äº†æ–‡ä»¶ç³»ç»Ÿ å®¹å™¨(Container)æ²™ç®±ï¼Œåˆ©ç”¨å®¹å™¨æ¥è¿è¡Œå’Œéš”ç¦»åº”ç”¨ï¼Œå®¹å™¨ä¸å®¹å™¨ä¹‹é—´æ˜¯ç›¸äº’éš”ç¦»ã€äº’ä¸å¯è§çš„é•œåƒè‡ªèº«æ˜¯åªè¯»çš„ã€‚å®¹å™¨ä»é•œåƒå¯åŠ¨çš„æ—¶å€™ï¼ŒDockerä¼šåœ¨é•œåƒçš„æœ€ä¸Šå±‚åˆ›å»ºä¸€ä¸ªå¯å†™å±‚ã€‚é•œåƒæœ¬èº«å°†ä¿æŒä¸å˜ã€‚ ä»“åº“(Repository)å­˜æ”¾é•œåƒçš„åœ°æ–¹ï¼Œç±»ä¼¼äºä»£ç ä»“åº“github giteeç­‰ç­‰ å®‰è£…# centos7è€ç‰ˆæœ¬å®‰è£…yum install docker -y # æŸ¥çœ‹ç‰ˆæœ¬docker --versionDocker version 19.03.1, build 74b1e89 å®‰è£…docker-ce ç¤¾åŒºç‰ˆæœ¬docker å…·æœ‰ç¤¾åŒºç‰ˆå’Œä¼ä¸šç‰ˆï¼Œåœ¨ä¼ä¸šç‰ˆä¸­ä¼šæä¾›ä¸€èµ·é¢å¤–çš„æ”¶è´¹æœåŠ¡https://docs.docker.com/install/linux/docker-ce/centos/ # centos7å®‰è£…docker-ce# å¸è½½æ—§ç‰ˆæœ¬dockersudo yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine# è®¾ç½®å­˜å‚¨åº“sudo yum install -y yum-utils \\ device-mapper-persistent-data \\ lvm2# æ·»åŠ ä¸‹è½½æº# å›½å¤–æºsudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo# é˜¿é‡Œæºsudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo# å®‰è£…dockerç¤¾åŒºç‰ˆæœ¬sudo yum install docker-ce docker-ce-cli containerd.io# å¯åŠ¨dockersudo systemctl start docker# æµ‹è¯•docker run hello-world# æŸ¥çœ‹ç‰ˆæœ¬docker version é•œåƒè·å–é•œåƒ# å®‰è£…Ubuntu:latesté•œåƒ[root@CodeSheep ~]# docker pull ubuntuUsing default tag: latestlatest: Pulling from library/ubuntu5c939e3a4d10: Downloading 8.608MB/26.69MBc63719cdbe7a: Download complete19a861ea6baf: Download complete651c9d2d6c4f: Downloadan zhuang # å®‰è£…Ubuntu:14.04é•œåƒdocker pull ubuntu:14.04# ä»ç¤¾åŒºå®‰è£…ubuntué•œåƒdocker pull dl.dockerpool.com:5000/ubuntu æäº¤ä¸€ä¸ªå®¹å™¨ä¸ºæ–°çš„é•œåƒ(ä¸æå€¡)å»ºè®®ä½¿ç”¨dockerfileåˆ›å»ºæ–°çš„é•œåƒ docker commit CONTAINER REPOSITORY:tagroot:~# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES612090a371f6 centos \"/bin/bash\" 5 seconds ago Up 5 seconds frosty_tereshkovaroot:~# docker commit frosty_tereshkova new/centos:v4sha256:2b405e30c679a448d9b913c19c48a4c435447655001abad264fcc3e7b2264312 è¿è¡Œé•œåƒdocker run -t -i ubuntu /bin/bash æŸ¥çœ‹é•œåƒä¿¡æ¯# åˆ—å‡ºæœ¬åœ°ä¸»æœºä¸Šæ‰€æœ‰é•œåƒ# --------------------------root:~# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEdocker.io/ubuntu latest ccc6e87d482b 6 days ago 64.2 MB# REPOSITORY è¡¨ç¤ºé•œåƒçš„ä»“åº“æº# TAG è¡¨ç¤ºé•œåƒçš„æ ‡ç­¾# IMAGE ID è¡¨ç¤ºé•œåƒçš„ID# CREATED é•œåƒçš„åˆ›å»ºæ—¶é—´# SIZE é•œåƒå¤§å°# --------------------------# æ˜¾ç¤ºæ‰€æœ‰é•œåƒçš„ID -a æ˜¾ç¤ºæ‰€æœ‰é•œåƒ -qæ˜¾ç¤ºIDroot:~# docker images -qa41f1d7eba8f3470671670cacccc6e87d482bfce289e99eb9# æ˜¾ç¤ºé•œåƒçš„æ‘˜è¦ä¿¡æ¯root:~# docker images --digests# æ˜¾ç¤ºé•œåƒè¯¦ç»†ä¿¡æ¯root:~# docker images --no-trunc# æ·»åŠ æ–°çš„é•œåƒæ ‡ç­¾root:ï½# docker tag docker.io/ubuntu:latest docker-ubuntu-version:v2root:~# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEdocker-ubuntu-version v2 ccc6e87d482b 6 days ago 64.2 MBdocker.io/ubuntu latest ccc6e87d482b 6 days ago 64.2 MBdocker.io/ubuntu 14.04 6e4f1fe62ff1 4 weeks ago 197 MB# æŸ¥çœ‹é•œåƒç›¸ä¿¡ä¿¡æ¯docker inspect ccc6e87d482b docker imspect ccc REPOSITORYè¡¨ç¤ºé•œåƒæ¥è‡ªäºå“ªä¸ªä»“åº“TAG æ ‡ç­¾ä¿¡æ¯ï¼Œç‰ˆæœ¬ä¿¡æ¯IMAMGE ID é•œåƒçš„IDå·ç ï¼Œå”¯ä¸€CREATED åˆ›å»ºæ—¶é—´SIZE é•œåƒå¤§å° æœå¯»é•œåƒdocker search mysql# --automated=false ä»…æ˜¾ç¤ºè‡ªåŠ¨åˆ›å»ºçš„é•œåƒ# --no-trunc=false è¾“å‡ºä¿¡æ¯ä¸æˆªæ–­æ˜¾ç¤º# -s --starts=0 æŒ‡å®šä»…æ˜¾ç¤ºè¯„ä»·ä¸ºæŒ‡å®šæ˜Ÿçº§ä»¥ä¸Šçš„é•œåƒ åˆ é™¤é•œåƒdocker rmi IMAGE[IMAGE...]# IMAGE...å¯ä»¥æ˜¯æ ‡ç­¾æˆ–è€…ID# docker rmi -f IMAGE[IMAGE...] å¼ºåˆ¶åˆ é™¤# åˆ é™¤å…¨éƒ¨docker rmi -f $(docker images -qa) å½“å‰é•œåƒæœ‰è¢«ä½¿ç”¨äºæŸä¸€ä¸ªå®¹å™¨çš„æ—¶å€™ï¼Œä½¿ç”¨docker rmi IMAGE ä¼šå‡ºç°æŠ¥é”™çš„å†…å®¹,å¯ä»¥è¿›è¡Œå¼ºåˆ¶çš„åˆ é™¤ï¼Œä½†è¿™æ ·çš„åšæ³•å¹¶ä¸å»ºè®®ï¼Œå¯ä»¥å…ˆåˆ é™¤ä¾èµ–äºè¯¥é•œåƒçš„å®¹å™¨ï¼Œç„¶åå†åˆ é™¤è¯¥é•œåƒ å®¹å™¨åˆ›å»ºå®¹å™¨ä¸å¯åŠ¨ä½¿ç”¨createåˆ›å»ºå®¹å™¨åï¼Œå®¹å™¨æ˜¯å¤„äºåœæ­¢çŠ¶æ€çš„ï¼Œå¯ä»¥ä½¿ç”¨startå¼€å¯ # åˆ›å»ºå®¹å™¨docker create -it ubuntu:test # å¼€å¯å®¹å™¨docker start ID# é‡æ–°å¼€å¯å®¹å™¨docker restart ID æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨# docker run [OPTIONS] IMAGE [COMMAND][ARG...]# --name æŒ‡å®šå®¹å™¨åå­—ï¼ŒæœªæŒ‡å®šåˆ™éšæœºç”Ÿæˆ# -t ç»™dockeråˆ†ä¸€ä¸ªä¼ªç»ˆç«¯ # -i æä¾›äº¤äº’æ¨¡å¼ # -d åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨ID# -P éšæœºç«¯å£æ˜ å°„# -p æŒ‡å®šç«¯å£æ˜ å°„ ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£# -e æŒ‡å®šç¯å¢ƒå˜é‡docker run -i -t ubuntu:latest /bin/bash# åŒºåˆ†-p ä¸ -Pçš„åŒºåˆ«docker pull comcat docker run -it -d -p 8080:8080 tomcatdocker run -it -d -P tomcatroot:~# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESd5987c3d0257 tomcat \"catalina.sh run\" 3 seconds ago Up 2 seconds 0.0.0.0:32768->8080/tcp xenodochial_hugleae1370718b31 tomcat \"catalina.sh run\" 36 seconds ago Up 35 seconds 0.0.0.0:8080->8080/tcp upbeat_beaver exitåå®¹å™¨å¤„äºç»ˆæ­¢çŠ¶æ€ å®ˆæŠ¤çŠ¶æ€è¿è¡Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œé€€å‡ºå®¹å™¨åï¼Œå®¹å™¨å¤„äºç»ˆæ­¢çŠ¶æ€ã€‚ä½¿ç”¨-då¯ä»¥åœ¨åå°è¿è¡Œå®¹å™¨ docker run -d ubuntu:latest /bin/bash -c \"while true;do echo helloworld > xx.txt;sleep 1;done\" ç»ˆæ­¢å®¹å™¨ä½¿ç”¨stopç»ˆæ­¢å®¹å™¨çš„æ—¶å€™ï¼Œä¼šå…ˆå‘é€ä¸€ä¸ªSIGTERMä¿¡å·ï¼Œç­‰å¾…10såå‘é€SIGKILLä¿¡å·ç»ˆæ­¢å®¹å™¨kill ä¼šç›´æ¥å‘é€SIGKILLç»ˆæ­¢å®¹å™¨ # ç»ˆæ­¢å®¹å™¨docker stop -t xxx IDdocker stop --time xxx IDdocker kill ID è¿›å…¥å®¹å™¨ attach å‘½ä»¤attachå¯ä»¥è¿›å…¥-då¼€å¯çš„åå°è¿è¡Œä¸­çš„å®¹å™¨,ä½†æ˜¯å¤šä¸ªçª—å£åŒæ—¶attachåˆ°åŒä¸€ä¸ªå®¹å™¨çš„æ—¶å€™ï¼Œæ‰€æœ‰çª—å£ä¼šåŒæ­¥æ˜¾ç¤ºï¼Œå½“æŸä¸ªçª—å£å‘½ä»¤é˜»å¡çš„æ—¶å€™ï¼Œå…¶ä»–çª—å£ä¹Ÿæ— æ³•æ‰§è¡Œæ“ä½œäº†docker attach ID exec å‘½ä»¤é€šå¸¸ä½¿ç”¨è¿™ä¸ªdocker exec -it ID /bin/bash åˆ é™¤å®¹å™¨åˆ é™¤ç»ˆæ­¢çŠ¶æ€ä¸‹çš„å®¹å™¨ docker rm [OPTIONS] CONTAINER [CONTAINER...]# -f --force=false ç»ˆæ­¢å¹¶åˆ é™¤ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨# -l --link=false åˆ é™¤å®¹å™¨çš„è¿æ¥ï¼Œä½†ä¿ç•™å®¹å™¨# -v --volumes=false åˆ é™¤å®¹å™¨æŒ‚è½½çš„æ•°æ®å·# åœæ­¢æ‰€æœ‰å®¹å™¨docker stop $(dokcer ps -q)# åˆ é™¤æ‰€æœ‰å®¹å™¨docker rm $(docker ps -aq) #éœ€è¦å…ˆæš‚åœdocker rm -f $(docker ps -aq) # ä¸éœ€è¦æš‚åœ å¯¼å…¥ä¸å¯¼å‡ºå®¹å™¨# å¯¼å…¥docker export ID > xx.tar# å¯¼å‡ºcat xx.tar | docker import - test/ubuntu:v1 æŸ¥çœ‹å®¹å™¨# æŸ¥çœ‹æ´»è·ƒçš„å®¹å™¨root:~# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES4171c783b51f 470671670cac \"/bin/bash\" 12 days ago Up 2 seconds devtest# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨root:~# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES7945b6135dda ubuntu \"echo 'â€œhello world'\" 5 seconds ago Exited (0) 4 seconds ago silly_kirch# -l æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨# -n æ˜¾ç¤ºæœ€è¿‘nä¸ªåˆ›å»ºçš„å®¹å™¨# æŸ¥çœ‹å®¹å™¨æ—¥å¿—docker logs -f -t --tail IMAGE# æŸ¥çœ‹å®¹å™¨å†…è¿è¡Œè¿›ç¨‹docker top IMAGE# status çŠ¶æ€è¡¨ç¤ºæ˜¯å¦åœ¨åå°è¿è¡Œï¼Œupè¡¨ç¤ºåœ¨åå°è¿è¡Œ Exitedè¡¨ç¤ºç»ˆæ­¢ å¤åˆ¶å®¹å™¨å†…æ–‡ä»¶docker cp IMAGE:file_path now_path å¸®åŠ©å‘½ä»¤# æŸ¥çœ‹ç‰ˆæœ¬docker version# æ˜¾ç¤ºdockerä¿¡æ¯ï¼ŒåŒ…æ‹¬å®¹å™¨æ•°é‡ï¼Œé•œåƒæ•°é‡ç­‰ç­‰[root@CodeSheep ~]# docker infoClient: Debug Mode: falseServer: Containers: 3 Running: 0 Paused: 0 Stopped: 3 Images: 1 Server Version: 19.03.1 Storage Driver: overlay2 Backing Filesystem: extfs Supports d_type: true Native Overlay Diff: true Logging Driver: json-file Cgroup Driver: cgroupfs# æŸ¥çœ‹æ—¥å¿—docker logs CONTAINER é”™è¯¯åˆé›† é”™è¯¯0dockerä¸‹è½½æºå‡ºé”™ base | 3.6 kB 00:00:00 http://download.docker.com/linux/centos/docker-ce.rep/repodata/repomd.xml: [Errno 14] HTTPS Error 404 - Not FoundTrying other mirror.To address this issue please refer to the below wiki article è¿™æ˜¯å› ä¸ºæ·»åŠ æºæ˜¯å›½å¤–æºï¼Œæœ‰æ—¶å€™ç½‘ç»œä¸å¯¹çš„æƒ…å†µä¸‹æ— æ³•å®‰è£…ï¼Œå»ºè®®æ·»åŠ é˜¿é‡Œæº # åˆ é™¤ä»“åº“å†…çš„å›½å¤–æºcd /etc/yum.repos.d/rm -rf docker-ce.repo download.docker.com_linux_centos_docker-ce.rep.repo # æ·»åŠ é˜¿é‡Œæºsudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo é”™è¯¯1æ²¡æœ‰å¼€å¯dockeræœåŠ¡ Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running # æ£€æµ‹root:~# systemctl status docker* docker.service - Docker Application Container Engine Loaded: loaded (/usr/lib/systemd/system/docker.service; disabled; vendor preset: disabled) Active: inactive (dead) Docs: http://docs.docker.com# å¼€å¯æœåŠ¡systemctl start docker é”™è¯¯2ä½¿ç”¨å½“å‰é•œåƒçš„å®¹å™¨æ­£åœ¨è¿è¡Œ root:~# docker rmi ccc6e87d482Error response from daemon: conflict: unable to delete ccc6e87d482b (must be forced) - image is referenced in multiple repositories# å¼ºåˆ¶åˆ é™¤docker rmi -f ccc6e87d482# ä¸å»ºè®®å¼ºåˆ¶åˆ é™¤ï¼Œåº”å½“å…ˆåˆ é™¤æ‰€æœ‰ä¾èµ–äºè¯¥é•œåƒçš„å®¹å™¨ï¼Œå†åˆ é™¤é•œåƒ","link":"/posts/3ee8c444/"},{"title":"docker-k8s","text":"learn docker ğŸ³ğŸ•¸ï¸ docker-k8så®‰è£…k8såŠå…¶ç®¡ç†å·¥å…·ä¸€äº›éœ€è¦å‡†å¤‡çš„ç¯å¢ƒ å…³é—­é˜²ç«å¢™systemctl stop firewalldsystemctl disable firewalld ç¦ç”¨selinuxsetenforce 0sed -i 's/SELINUX=permissive/SELINUX=disabled/' /etc/sysconfig/selinux å…³é—­swapswapoff -aecho \"vm.swappiness = 0\">> /etc/sysctl.conf å®‰è£…k8s cat","link":"/posts/7cebdf57/"},{"title":"dockerå®¹å™¨æ•°æ®å·","text":"learn docker æ•°æ®ç®¡ç†æ•°æ®å·æ˜¯ä¸€ä¸ªå¯æä¾›ä½¿ç”¨çš„ç‰¹æ®Šç›®å½•ï¼Œä»–ç»•è¿‡æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥æä¾›å¾ˆå¤šæœ‰ç”¨çš„å†…å®¹ æ•°æ®å·å¯ä»¥åœ¨å®¹å™¨ä¹‹é—´å…±äº«å’Œé‡å¤ä½¿ç”¨ å¯¹æ•°æ®å·çš„ä¿®æ”¹ä¼šç«‹é©¬ç”Ÿæ•ˆ å¯¹æ•°æ®å·çš„æ›´æ–°ï¼Œä¸ä¼šå½±å“é•œåƒ å·ä¼šä¸€ç›´å­˜åœ¨ ç›´åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨ åˆ›å»ºæ•°æ®å·# æŸ¥çœ‹æ•°æ®å·root:~# docker volume lsDRIVER VOLUME NAMElocal 1c4c829dcedf5c071d6a14dea5cf9a40e5459a6d81d2a009ecef6c392156121clocal 2a8601766a8ec82c39132bc64c2c99546053cb4104bd94507f215b888e60464dlocal 3fad677be0bbe16df041895a36b7ce088a57f6c75fcab163664522ddc405100dlocal 3ff453f8da89ad256ee7971df11bc3297443b894584cec147c8637ce838a274b# æŸ¥çœ‹volumesè¯¦ç»†ä¿¡æ¯docker volume inspect 1c4c829dcedf5c071d6a14dea5cf9a40e5459a6d81d2a009ecef6c392156121c# åˆ›å»ºæ•°æ®å·è¿æ¥docker run -it -v /å®¿ä¸»æœºç»å¯¹ç›®å½•:/å®¹å™¨å†…ç›®å½• é•œåƒå# è¿è¡Œæ—¶ï¼ŒæŒ‚è½½å·# æ— è®ºå“ªä¸€æ–¹ä¿®æ”¹æ–‡ä»¶ï¼Œæ•°æ®å·éƒ½ä¼šåŒæ­¥åˆ°å¦ä¸€ç«¯# --privileged å…³é—­selinuxdocker run -it -d -v /tmp/data/:/tmp/ --name test1 --privileged=true centos# å®šä¹‰æƒé™doker run -it -v /å®¿ä¸»æœºç»å¯¹ç›®å½•:/å®¹å™¨å†…ç›®å½•:æƒé™ é•œåƒå# åªè¯» ro - read-onlydocker run -it -d -v /tmp/data/:/tmp/:ro --name test1 --privileged=true centos æŸ¥çœ‹æ˜¯å¦æŒ‚è½½æˆåŠŸdocker inspect test1 inspectä¼šæŒ‰ç…§jsonçš„å½¢å¼è¾“å‡ºé…ç½®ï¼Œå…¶ä¸­mountè¡¨æ˜äº†æ•°æ®å·çš„æŒ‚è½½æƒ…å†µRW:trueè¡¨ç¤ºå¯è¯»å†™ å®¹å™¨é—´æ•°æ®å…±äº«ä¼ é€’ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥ç›´åˆ°å®¹å™¨ä¸æœ¬æœºä¹‹é—´çš„ä¼ é€’æˆ‘ä»¬æ˜¯æœ‰çš„æ˜¯-v æˆ–è€…dockerfileä¸­çš„VOLUMEè¿›è¡ŒæŒ‚è½½åœ¨å®¹å™¨ä¸å®¹å™¨ä¹‹é—´ï¼Œä½¿ç”¨çš„æ˜¯â€“volumes-fromæ¥è¿›è¡Œæ–‡ä»¶ä¹‹é—´çš„æŒ‚è½½,å¹¶ä¸”åªè¦å®¹å™¨å­˜åœ¨ï¼Œå®¹å™¨æ•°é‡ä¸Šçš„å‡å°‘å’Œå¢åŠ éƒ½ä¸ä¼šä½¿å¾—æŒ‚è½½æ–‡ä»¶çš„æ¶ˆå¤± docker -it --name doc2 --volumes-from doc1 hzj/centos2 æŠ¥é”™ é—®é¢˜1ls: cannot open directory â€˜tmp/â€˜: Permission deniedæ— æ³•è®¿é—®ç›®å½•ï¼Œæƒé™æ‹’ç»ã€‚è¯¥é—®é¢˜é€šå¸¸åœ¨centos7ä¸‹å‡ºç°ã€‚æˆ–è€…ä¸€ä¸ªå®¹å™¨å¯åŠ¨æˆåŠŸåï¼Œé‡Œé¢çš„æœåŠ¡æ— æ³•æˆåŠŸè®¿é—®ï¼Œè¿™æ˜¯å› ä¸ºcentos7ä¸­çš„å®‰å…¨æ¨¡å—selinuxæŠŠæƒé™ç¦æ‰äº†ï¼Œä¸€èˆ¬çš„è§£å†³æ–¹æ¡ˆæœ‰ä»¥ä¸‹ä¸¤ç§ï¼š ä¸´æ—¶å…³é—­selinuxç›´æ¥åœ¨centosæœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ã€‚æ‰§è¡Œå®Œæˆä»¥åå»ºè®®é‡æ–°docker runã€‚setenforce 0 ç»™å®¹å™¨åŠ æƒé™åœ¨docker runæ—¶ç»™è¯¥å®¹å™¨åŠ æƒé™ï¼ŒåŠ ä¸Šä»¥ä¸‹å‚æ•°å³å¯# --privileged=truedocker run -it -d -v /tmp/data/:/tmp/ --name test1 --privileged=true centos é—®é¢˜2ä¸ºå•¥æ²¡æœ‰è¿™ä¸ªå‘½ä»¤root@8d3aece482eb tmp]# getenforcebash: getenforce: command not found[root@8d3aece482eb tmp]#[root@8d3aece482eb tmp]#[root@8d3aece482eb tmp]# setenforcebash: setenforce: command not found[root@8d3aece482eb tmp]# å› ä¸ºè¿™æ˜¯æœ€ç²¾ç®€çš„centos,åˆ é™¤äº†æ‰€æœ‰è·Ÿå†…æ ¸æ— å…³çš„ä¸œè¥¿","link":"/posts/5f4d14d2/"},{"title":"dockerå®¹å™¨çš„èµ„æºé™åˆ¶","text":"learn docker ğŸ³ dockerå®¹å™¨çš„èµ„æºé™åˆ¶åœ¨è™šæ‹Ÿæœºä¸­æˆ‘ä»¬å¯ä»¥å¯¹æ‰€åˆ›å»ºçš„æœºå™¨åœ¨èµ„æºä¸Šè¿›è¡Œé™åˆ¶ï¼Œæ¯”å¦‚å†…å­˜ç­‰ç­‰åŒæ ·çš„ï¼Œåœ¨dockerä¸­ä¹Ÿèƒ½å¯¹å®¹å™¨è¿›è¡Œèµ„æºä¸Šçš„é…ç½® # åˆ†é…400Mçš„å†…å­˜ç»™å®¹å™¨ æŒ‡å®šç»™memoryçš„è¯æ˜¯200M ä½†å…¶å®swapä¹Ÿä¼šå¾—åˆ°200M å› æ­¤æ˜¯400Mdocker run --memory=200M new/ubuntu-stress ä½¿ç”¨stressè¿›è¡Œå‹åŠ›æµ‹è¯•# dockerfileFROM ubuntuRUN apt-get update && apt-get install stress -yENTRYPOINT [\"/usr/bin/stress\"]# ENTRYPOINT [\"/bin/bash\",\"-c\",\"stress\"]CMD [] å…ˆåˆ†é…ç»™ä»–400M ç„¶åä½¿ç”¨stressåšå‹åŠ›æµ‹è¯•ï¼Œstress ä¼šå¼€å¯è¿›ç¨‹ï¼Œè¿›ç¨‹é»˜è®¤ä¸º256M ç„¶åä¸æ–­çš„å¼€å¯ä¸æ–­çš„é‡Šæ”¾ # -m å¼€ä¸€ä¸ªè¿›ç¨‹ --verbos è¯¦ç»†ä¿¡æ¯ é»˜è®¤å¼€å¯256M --vm-bytes æŒ‡å®šå¼€å¯å¤šå°‘å¤§å°çš„å†…å­˜è¿›ç¨‹docker run --memory=200M new/ubuntu-stress -m 1 --verbos # è¶…èŒƒå›´è¿è¡Œroot:~# docker run --memory=200M new/ubuntu-stress -m 1 --verbose --vm-bytes 500Mstress: info: [1] dispatching hogs: 0 cpu, 0 io, 1 vm, 0 hddstress: dbug: [1] using backoff sleep of 3000usstress: dbug: [1] --> hogvm worker 1 [6] forkedstress: dbug: [6] allocating 524288000 bytes ...stress: dbug: [6] touching bytes in strides of 4096 bytes ...stress: FAIL: [1] (415)","link":"/posts/8aa524f6/"},{"title":"dockeré•œåƒåˆ†å±‚åŸç†","text":"learn docker ğŸ˜Š dockeré•œåƒåˆ†æˆåŸç†baseé•œåƒbase é•œåƒæœ‰ä¸¤å±‚å«ä¹‰ï¼š ä¸ä¾èµ–å…¶ä»–é•œåƒï¼Œä» scratch æ„å»ºã€‚ å…¶ä»–é•œåƒå¯ä»¥ä¹‹ä¸ºåŸºç¡€è¿›è¡Œæ‰©å±•ã€‚å¦‚centosé•œåƒ åŸç†è§£æäº†è§£å‡ ä¸ªæ¦‚å¿µ è”åˆæ–‡ä»¶ç³»ç»Ÿ(Union File System):æ˜¯ä¸€ç§æŠŠå…¶å®ƒæ–‡ä»¶ç³»ç»Ÿè”åˆåˆ°ä¸€ä¸ªè”åˆæŒ‚è½½ç‚¹çš„æ–‡ä»¶ç³»ç»ŸæœåŠ¡ï¼Œå®ƒä½¿ç”¨ branch æŠŠä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶å’Œç›®å½•â€é€æ˜åœ°â€è¦†ç›–ï¼Œå½¢æˆä¸€ä¸ªå•ä¸€ä¸€è‡´çš„æ–‡ä»¶ç³»ç»Ÿã€‚è¿™äº› branch æˆ–è€…æ˜¯ read-only çš„ï¼Œæˆ–è€…æ˜¯ read-write çš„ï¼Œæ‰€ä»¥å½“å¯¹è¿™ä¸ªè™šæ‹Ÿåçš„è”åˆæ–‡ä»¶ç³»ç»Ÿè¿›è¡Œå†™æ“ä½œçš„æ—¶å€™ï¼Œç³»ç»Ÿæ˜¯çœŸæ­£å†™åˆ°äº†ä¸€ä¸ªæ–°çš„æ–‡ä»¶ä¸­ã€‚çœ‹èµ·æ¥è¿™ä¸ªè™šæ‹Ÿåçš„è”åˆæ–‡ä»¶ç³»ç»Ÿæ˜¯å¯ä»¥å¯¹ä»»ä½•æ–‡ä»¶è¿›è¡Œæ“ä½œçš„ï¼Œä½†æ˜¯å…¶å®å®ƒå¹¶æ²¡æœ‰æ”¹å˜åŸæ¥çš„æ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸º Union File System ç”¨åˆ°äº†ä¸€ä¸ªé‡è¦çš„èµ„æºç®¡ç†æŠ€æœ¯ï¼šå†™æ—¶å¤åˆ¶ã€‚ å†™æ—¶å¤åˆ¶(copy-on-writeï¼Œå¸¸è¢«ç®€å†™ä¸º CoW)ï¼Œä¹Ÿå«éšå¼å…±äº«ï¼Œæ˜¯ä¸€ç§æé«˜èµ„æºä½¿ç”¨æ•ˆç‡çš„èµ„æºç®¡ç†æŠ€æœ¯ã€‚å®ƒçš„æ€æƒ³æ˜¯ï¼šå¦‚æœä¸€ä¸ªèµ„æºæ˜¯é‡å¤çš„ï¼Œåœ¨æ²¡æœ‰å¯¹èµ„æºåšå‡ºä¿®æ”¹å‰ï¼Œå¹¶ä¸éœ€è¦ç«‹å³å¤åˆ¶å‡ºä¸€ä¸ªæ–°çš„èµ„æºå®ä¾‹ï¼Œè¿™ä¸ªèµ„æºè¢«ä¸åŒçš„æ‰€æœ‰è€…å…±äº«ä½¿ç”¨ã€‚å½“ä»»ä½•ä¸€ä¸ªæ‰€æœ‰è€…è¦å¯¹è¯¥èµ„æºåšå‡ºä¿®æ”¹æ—¶ï¼Œå¤åˆ¶å‡ºä¸€ä¸ªæ–°çš„èµ„æºå®ä¾‹ç»™è¯¥æ‰€æœ‰è€…è¿›è¡Œä¿®æ”¹ï¼Œä¿®æ”¹åçš„èµ„æºæˆä¸ºå…¶æ‰€æœ‰è€…çš„ç§æœ‰èµ„æºã€‚é€šè¿‡è¿™ç§èµ„æºå…±äº«çš„æ–¹å¼ï¼Œå¯ä»¥æ˜¾è‘—åœ°å‡å°‘å¤åˆ¶ç›¸åŒèµ„æºå¸¦æ¥çš„æ¶ˆè€—ï¼Œä½†æ˜¯è¿™æ ·åšä¹Ÿä¼šåœ¨è¿›è¡Œèµ„æºçš„ä¿®æ”¹æ—¶å¢åŠ ä¸€éƒ¨åˆ†å¼€é”€ã€‚ AUFSæ–‡ä»¶ç³»ç»Ÿå®ä¾‹https://www.cnblogs.com/sparkdev/p/11237347.html dockeré•œåƒç»„æˆåœ¨dockerçš„imageä¸­,ä»–å…¶å®æ˜¯ç”±ä¸€å±‚ä¸€å±‚çš„åŸºç¡€æ–‡ä»¶ç³»ç»Ÿæ‰€å åŠ èµ·æ¥çš„ï¼Œè”åˆæ–‡ä»¶ç³»ç»Ÿ(UnionFS)ä»–å¯ä»¥å°†å‡ å±‚ç›®å½•æŒ‚è½½åˆ°ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ,docker é€šè¿‡è¿™äº›æ–‡ä»¶å†åŠ ä¸Šå®¿ä¸»æœºçš„å†…æ ¸æä¾›äº†ä¸€ä¸ª linux çš„è™šæ‹Ÿç¯å¢ƒã€‚æ¯ä¸€å±‚æ–‡ä»¶ç³»ç»Ÿæˆ‘ä»¬å«åšä¸€å±‚ layerï¼Œè”åˆæ–‡ä»¶ç³»ç»Ÿå¯ä»¥å¯¹æ¯ä¸€å±‚æ–‡ä»¶ç³»ç»Ÿè®¾ç½®ä¸‰ç§æƒé™ï¼Œåªè¯»ï¼ˆreadonlyï¼‰ã€è¯»å†™ï¼ˆreadwriteï¼‰å’Œå†™å‡ºï¼ˆwhiteout-ableï¼‰ ä½†æ˜¯åœ¨dockerçš„é•œåƒä¸­çš„æ¯ä¸€å±‚çš„åŸºç¡€æ–‡ä»¶ç³»ç»Ÿéƒ½æ˜¯åªè¯»çš„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä»–ä»¬å«åšbase æœ€åŸºç¡€çš„ã€‚æ„å»ºé•œåƒçš„æ—¶å€™ï¼Œä»ä¸€ä¸ªæœ€åŸºæœ¬çš„æ“ä½œç³»ç»Ÿå¼€å§‹ï¼Œæ¯ä¸ªæ„å»ºçš„æ“ä½œéƒ½ç›¸å½“äºåšä¸€å±‚çš„ä¿®æ”¹ï¼Œå¢åŠ äº†ä¸€å±‚æ–‡ä»¶ç³»ç»Ÿã€‚ä¸€å±‚å±‚å¾€ä¸Šå åŠ ï¼Œä¸Šå±‚çš„ä¿®æ”¹ä¼šè¦†ç›–åº•å±‚è¯¥ä½ç½®çš„å¯è§æ€§ï¼Œè¿™ä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼Œå°±åƒä¸Šå±‚æŠŠåº•å±‚é®ä½äº†ä¸€æ ·ã€‚å½“ä½ ä½¿ç”¨çš„æ—¶å€™ï¼Œä½ åªä¼šçœ‹åˆ°ä¸€ä¸ªå®Œå…¨çš„æ•´ä½“ï¼Œä½ ä¸çŸ¥é“é‡Œé¢æœ‰å‡ å±‚ï¼Œä¹Ÿä¸æ¸…æ¥šæ¯ä¸€å±‚æ‰€åšçš„ä¿®æ”¹æ˜¯ä»€ä¹ˆã€‚ç»“æ„ç±»ä¼¼è¿™æ ·ï¼š å½“æˆ‘ä»¬åœ¨ä»å®˜æ–¹æ‹‰å»é•œåƒçš„æ—¶å€™ï¼Œä»–çš„æ“ä½œä¹Ÿä¼šå®ç°è¿™ä¸€æ­¥å åŠ çš„è¿‡ç¨‹ï¼Œè®°ä½ åƒæˆ‘ä»¬å¹³æ—¶ä½¿ç”¨çš„ubuntu centos nginxè¿™æ ·çš„dockeré•œåƒéƒ½ä¸æ˜¯æœ€åŸå§‹çš„é•œåƒï¼Œä»–ä»¬ä¹Ÿéƒ½æ˜¯ä¸€å±‚ä¸€å±‚çš„æ–‡ä»¶ç³»ç»Ÿbaseå åŠ èµ·æ¥çš„,æ¯”å¦‚æ‹‰å»ubuntué•œåƒä»–ä¸€å…±ä¼šæ‹‰å»å››å±‚æ–‡ä»¶ç³»ç»Ÿæ¥å®Œæˆæ•´ä¸ªubuntué•œåƒçš„æ­å»ºï¼Œæœ€åç”Ÿæˆä¸€ä¸ªubuntuçš„é•œåƒï¼Œå› æ­¤åœ¨å¤–éƒ¨çœ‹æ¥ä»–æ˜¯å•ç‹¬çš„é•œåƒæ–‡ä»¶ï¼Œä½†å…¶å®ä»–æ˜¯ç”±å¤šä¸ªåŸºç¡€çš„æ–‡ä»¶ç³»ç»Ÿé€šè¿‡è”åˆæ–‡ä»¶ç³»ç»Ÿå åŠ äº§ç”Ÿçš„ã€‚ dockeré•œåƒåŠ è½½ bootfs åœ¨linuxçš„å¼€æœºè¿‡ç¨‹ä¸­ä¼šç”¨åˆ°bootfs,ä¸»è¦åŒ…å«bootloader å’Œ kernelï¼Œbootloader ä¸»è¦ç”¨äºå¼•å¯¼åŠ è½½ kernelï¼Œå½“ kernel è¢«åŠ è½½åˆ°å†…å­˜ä¸­åkernelåï¼Œbootfså°±ä¼šè¢«umountæ‰ã€‚ rootfs rootfs (root file system) åŒ…å«çš„å°±æ˜¯å…¸å‹ Linux ç³»ç»Ÿä¸­çš„/devï¼Œ/procï¼Œ/binï¼Œ/etc ç­‰æ ‡å‡†ç›®å½•å’Œæ–‡ä»¶,ä¸åŒçš„linuxå‘è¡Œç‰ˆæœ¬ï¼Œrootfsæ–‡ä»¶ç³»ç»Ÿå¯èƒ½ä¸é€š æ§åˆ¶è¯»å†™æƒé™,ä¼ ç»Ÿçš„ Linux åŠ è½½ bootfs æ—¶ä¼šå…ˆå°† rootfs è®¾ä¸º read-onlyï¼Œç„¶ååœ¨ç³»ç»Ÿè‡ªæ£€ä¹‹åå°† rootfs ä» read-only æ”¹ä¸º read-writeï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨ rootfs ä¸Šè¿›è¡Œè¯»å†™æ“ä½œäº†ã€‚ä½† Docker åœ¨ bootfs è‡ªæ£€å®Œæ¯•ä¹‹åå¹¶ä¸ä¼šæŠŠ rootfs çš„ read-only æ”¹ä¸º read-writeï¼Œè€Œæ˜¯åˆ©ç”¨ union mountï¼ˆUnionFS çš„ä¸€ç§æŒ‚è½½æœºåˆ¶ï¼‰å°† image ä¸­çš„å…¶ä»–çš„ layer åŠ è½½åˆ°ä¹‹å‰çš„ read-only çš„ rootfså±‚ä¹‹ä¸Šï¼Œæ¯ä¸€å±‚ layer éƒ½æ˜¯ rootfs çš„ç»“æ„ï¼Œå¹¶ä¸”æ˜¯read-only çš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•ä¿®æ”¹ä¸€ä¸ªå·²æœ‰é•œåƒé‡Œé¢çš„ layer çš„ï¼åªæœ‰å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Œä¹Ÿå°±æ˜¯å°† Docker é•œåƒè¿›è¡Œå®ä¾‹åŒ–ï¼Œç³»ç»Ÿä¼šåˆ†é…ä¸€å±‚ç©ºçš„ read-write çš„ rootfs ï¼Œç”¨äºä¿å­˜æˆ‘ä»¬åšçš„ä¿®æ”¹ã€‚ é•œåƒå¤§å°çš„é—®é¢˜ä¸ºä»€ä¹ˆtomcaté•œåƒå¤§å°å¤§äºcentosé•œåƒå¤§å°?å¯ä»¥é€šè¿‡ä¸Šé¢dockeré•œåƒçš„ç»„æˆã€åŠ è½½ä¸¤æ–¹é¢æ¥è§£é‡ŠåŒæ ·ä»¥kernelä½œä¸ºæœ€åº•å±‚æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨centosé•œåƒä¸­ï¼Œä¸Šå±‚åªæ”¾äº†ä¸€ä¸ªcentosçš„rootfsï¼Œè€Œtomcatéœ€è¦å†™å…¥å¤šå±‚baseæ–‡ä»¶ç³»ç»Ÿï¼Œæ¯”å¦‚jdk8 tomcat ç­‰ç­‰ï¼Œå› æ­¤tomcatçš„é•œåƒå¤§å°å¤§äºcentosçš„é•œåƒå¤§å° é•œåƒåˆ†å±‚çš„å¥½å¤„å…±äº«èµ„æºæœ‰å¤šä¸ªé•œåƒéƒ½ä»ç›¸åŒçš„baseé•œåƒæ„å»ºè€Œæ¥ï¼Œé‚£ä¹ˆå®¿ä¸»æœºåªéœ€åœ¨ç£ç›˜ä¸Šä¿å­˜ä¸€ä»½baseé•œåƒï¼ŒåŒæ—¶å†…å­˜ä¸­ä¹Ÿåªéœ€åŠ è½½ä¸€ä»½baseé•œåƒï¼Œå°±å¯ä»¥ä¸ºæ‰€æœ‰å®¹å™¨æœåŠ¡äº†ï¼Œé¥¿è€Œä¸”é•œåƒçš„æ¯ä¸€å±‚éƒ½å¯ä»¥è¢«å…±äº« åˆ›å»ºé•œåƒ åŸºäºå·²æœ‰é•œåƒçš„å®¹å™¨åˆ›å»º# æäº¤ä¸€ä¸ªå®¹å™¨æˆä¸ºä¸€ä¸ªæ–°çš„é•œåƒdocker commit [OPTIONS] CONTAINER [RSPOSITORY[:TAG]]# -a; --author=\"\" ä½œè€…ä¿¡æ¯# -m; --message=\"\" æäº¤ä¿¡æ¯# -p; --pause=true æäº¤æ—¶æš‚åœå®¹å™¨è¿è¡Œ åˆ›å»ºæµç¨‹# pull ä¸€ä¸ªæ–°çš„image docker pull ubuntu# æ”¹å˜ubuntu ä½¿å…¶ä¸åŸæ¥imageä¸åŒdocker run -it ccc6e87d482b /bin/bashecho \"update file \" > testexit# è¿”å›å‰è®°ä½å½“å‰å®¹å™¨çš„åå­—ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸»æœºå# æäº¤å½“å‰å®¹å™¨ä¸ºæ–°çš„é•œåƒæ–‡ä»¶docker commit -m \"update - add a file in ubuntu \" -a \"hzj\" dc758c368fda test# æŸ¥çœ‹å½“å‰é•œåƒåˆ—è¡¨root:~# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEtest latest 41f1d7eba8f3 10 seconds ago 64.2 MBdocker.io/ubuntu latest ccc6e87d482b 6 days ago 64.2 MB åŸºäºæœ¬åœ°æ¨¡ç‰ˆå¯¼å…¥# ä¸‹è½½æ¨¡ç‰ˆå‹ç¼©åŒ…wget xx# æ ¹æ®å‹ç¼©åŒ…å¯¼å…¥æˆé•œåƒcat ubuntu-14.04.tar.gz | docker import - ubuntu:14.04 # ä¿å­˜é•œåƒåˆ°æœ¬åœ°æ–‡ä»¶docker save -o ubuntu_latest.tar ubuntu:latest# è½½å…¥é•œåƒdocker load --input ubuntu_latest.tardocker load < ubuntu_latest.tar åŸºäºDockerfileåˆ›å»º å¦‚ä½•åˆ›å»ºä¸€ä¸ªhello-worldçš„dockeré•œåƒ åˆ›å»ºä¸€ä¸ªè¾“å‡ºhello worldçš„cæ–‡ä»¶#includeint main(){ printf(\"hello world\\n\");} ç¼–è¯‘cæ–‡ä»¶gcc -static hello.c -o hello ç¼–å†™dockerfileFROM scratchADD hello /CMD ['/hello'] æ–°å»ºhelloworldé•œåƒdocker -f /tmp/dockerfile -t helloworld .","link":"/posts/685470da/"},{"title":"dockeræ­å»ºwordpress","text":"learn docker ğŸ³ dockeræ­å»ºwordpress å®‰è£…mysqlã€wordpressé•œåƒdocker pull mysqldocker pyll wordpress åˆ›å»ºmysqléœ€è¦åšä¸€äº›åˆå§‹åŒ–çš„é…ç½®ï¼Œå»ºè®®åœ¨dockerhubä¸ŠæŸ¥çœ‹https://hub.docker.com/_/mysqldocker run -it -d --name mysql \\-v db_data:/var/lib/mysql \\-e MYSQL_ROOT_PASSWORD=root \\-e MYSQL_DATABASE=wordpress \\mysql:8.0 åˆ›å»ºwordpresséœ€è¦è¿æ¥æ•°æ®åº“ä¸æš´éœ²ç«¯å£è½¬æ¢docker run -d -e WORDPRESS_DB_HOST=mysql:3306 \\--name wordpress \\--link mysql \\-e WORDPRESS_DB_USER=root \\-e WORDPRESS_DB_PASSWD=root \\-p 8888:80 \\wordpress æœªæˆåŠŸï¼Œä¸€ç›´æé†’æ•°æ®åº“é”™è¯¯ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ? æ˜¯å› ä¸ºmysqlæ²¡æœ‰åŠ â€“default-auth=mysql_native_passwordè¿™ä¸ªå˜› ä½¿ç”¨docker-composeæ­å»ºwordpressversion: \"3\"services: db: image: mysql:8.0 command: - --default_authentication_plugin=mysql_native_password - --character-set-server=utf8mb4 - --collation-server=utf8mb4_unicode_ci volumes: - db_data:/var/lib/mysql restart: always environment: MYSQL_ROOT_PASSWORD: somewordpress MYSQL_DATABASE: wordpress MYSQL_USER: wordpress MYSQL_PASSWORD: wordpress wordpress: depends_on: - db image: wordpress:latest ports: - \"8000:80\" restart: always environment: WORDPRESS_DB_HOST: db:3306 WORDPRESS_DB_USER: wordpress WORDPRESS_DB_PASSWORD: wordpressvolumes: db_data:","link":"/posts/a8b92e4/"},{"title":"dockerç½‘ç»œ","text":"learn docker ğŸ³ dockerç½‘ç»œdockerç½‘ç»œçš„å‡ ç§æ¨¡å¼ ç½‘è·¯åœ°å€è½¬æ¢NATå†…ç½‘è½¬å¤–ç½‘ linuxçš„ç½‘ç»œå‘½åç©ºé—´namesapceroot:~# sudo ip a | tail -68: docker0: mtu 1500 qdisc noqueue state DOWN group default link/ether 02:42:4f:aa:73:10 brd ff:ff:ff:ff:ff:ff inet 172.17.0.1/16 scope global docker0","link":"/posts/20783356/"},{"title":"docker-compose","text":"learn docker ğŸ³ docker-compose docker-composeæ˜¯ä¸€ä¸ªå·¥å…· é€šè¿‡ymlæ–‡ä»¶å®šä¹‰å¤šå®¹å™¨çš„dockeråº”ç”¨ é€šè¿‡ä¸€æ¡å‘½ä»¤å°±å¯ä»¥æ ¹æ®ymlæ–‡ä»¶çš„å®šä¹‰å»åˆ›å»ºæˆ–è€…ç®¡ç†å¤šä¸ªå®¹å™¨ ä¸‰å¤§æ¦‚å¿µ servicesä¸€ä¸ªserviceä»£è¡¨äº†ä¸€ä¸ªcontainer è¿™ä¸ªcontainerå¯ä»¥ä»dockerhubçš„imageåˆ›å»ºï¼Œæˆ–è€…ä»æœ¬åœ°çš„dockerfile buildå‡ºæ¥çš„imageåˆ›å»º# composeéƒ¨åˆ†services: db: images: mysql:8.0 volumes: - \"db-data:/var/lib/mysql\" networks: - back-tier# ç±»ä¼¼äºCOMMANDå‘½ä»¤docker run -d --network back-tier -v db-data:/var/lib/mysql mysql:8.0# composeéƒ¨åˆ†services: worker: build: ./worker links: - db - redis network: - back-tier networks volumes docker-composeå®‰è£…https://docs.docker.com/compose/install/ sudo curl -L \"https://github.com/docker/compose/releases/download/1.25.3/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose sudo chmod +x /usr/local/bin/docker-composesudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose# æŸ¥çœ‹ç‰ˆæœ¬docker-compose --version ä½¿ç”¨docker-composeæ­å»ºwordpressversion: \"3\"services: db: image: mysql:8.0 command: - --default_authentication_plugin=mysql_native_password - --character-set-server=utf8mb4 - --collation-server=utf8mb4_unicode_ci volumes: - db_data:/var/lib/mysql restart: always environment: MYSQL_ROOT_PASSWORD: somewordpress MYSQL_DATABASE: wordpress MYSQL_USER: wordpress MYSQL_PASSWORD: wordpress wordpress: depends_on: - db image: wordpress:latest ports: - \"8000:80\" restart: always environment: WORDPRESS_DB_HOST: db:3306 WORDPRESS_DB_USER: wordpress WORDPRESS_DB_PASSWORD: wordpressvolumes: db_data: docker-composeå‘½ä»¤# æ ¹æ®docker-compose.ymlæ–‡ä»¶è¿è¡Œdocker-compose -f docker-compose.yml up# åå°è¿è¡Œdocker-compose up -d# æŸ¥çœ‹root:~# docker-compose ps Name Command State Ports------------------------------------------------------------------root_db_1 docker-entrypoint.sh --def ... Exit 0root_wordpress_1 docker-entrypoint.sh apach ... Exit 0# åœæ­¢docker-compose stop# å¼€å¯docker-compose start# åœæ­¢å¹¶åˆ é™¤docker-compose down# æŸ¥çœ‹composeçš„å®¹å™¨docker-compose images# è¿›å…¥composeçš„å®¹å™¨docekr-compose exec IMAGE COMMAND","link":"/posts/f9b84192/"},{"title":"swarmä¸k8sçš„åŒºåˆ«","text":"learn docker ğŸ³ğŸ³ ğŸ³ğŸ•¸ï¸ swarmä¸k8sçš„åŒºåˆ«url:https://cloud.tencent.com/developer/article/1361203","link":"/posts/59fd12f/"},{"title":"docker-DokcerFile","text":"learn docker ğŸ³ DokcerFiledockerfileæ„å»ºä¸‰æ­¥éª¤dockerfile,docker build ,docker run dockerfileyæœ‰å¾ˆå¤šå…·ä½“çš„å®ä¾‹å¯ä»¥åœ¨docker hubä¸Šçœ‹åˆ° ï¼Œæ¯”å¦‚ centoshttps://hub.docker.com/_/centosFROM scratchADD centos-7-x86_64-docker.tar.xz /LABEL org.label-schema.schema-version=\"1.0\" \\ org.label-schema.name=\"CentOS Base Image\" \\ org.label-schema.vendor=\"CentOS\" \\ org.label-schema.license=\"GPLv2\" \\ org.label-schema.build-date=\"20191001\"CMD [\"/bin/bash\"] # åœ¨è¿›å…¥å®¹å™¨åç¬¬ä¸€æ­¥æ‰§è¡Œçš„å‘½ä»¤ tomcaté•œåƒhttps://github.com/docker-library/tomcat/blob/807a2b4f219d70f5ba6f4773d4ee4ee155850b0d/8.5/jdk11/openjdk/Dockerfile dockerfileç¼–å†™è§„åˆ™ æ¯æ¡ä¿ç•™å­—æŒ‡ä»¤éƒ½å¿…é¡»ä¸ºå¤§å†™å­—æ¯ä¸”åé¢è¦è·Ÿè‡³å°‘ä¸€ä¸ªå‚æ•° æŒ‡ä»¤æŒ‰ç…§é¡ºåºä»ä¸Šå€’ä¸‹ï¼Œä¾æ¬¡æ‰§è¡Œ #è¡¨ç¤ºæ³¨é‡Š æ¯æ¡æŒ‡ä»¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒå±‚ï¼Œå¹¶å¯¹é•œåƒè¿›è¡Œæäº¤ dockerfileæ‰§è¡Œé¡ºåº dockerä»åŸºç¡€é•œåƒè¿è¡Œä¸€ä¸ªå®¹å™¨ æ‰§è¡Œä¸€æ¡æŒ‡ä»¤å¹¶å¯¹å®¹å™¨ä½œå‡ºä¿®æ”¹ æ‰§è¡Œç±»ä¼¼docker commitçš„æ“ä½œæäº¤ä¸€ä¸ªæ–°çš„é•œåƒå±‚ dockerå†åŸºäºåˆšæäº¤çš„é•œåƒè¿è¡Œä¸€ä¸ªæ–°å®¹å™¨ æ‰§è¡Œdockerfileä¸­çš„ä¸‹ä¸€è·³æŒ‡ä»¤ç›´åˆ°æ‰€æœ‰æŒ‡ä»¤éƒ½æ‰§è¡Œå®Œæˆ dockerç¼–å†™å…³é”®å­— FROMå£°æ˜åŸºç¡€é•œåƒï¼Œå¦‚centosä¸­å£°æ˜çš„scratch MAINTAINERé•œåƒç»´æŠ¤è€…çš„å§“åå’Œé‚®ç®±åœ°å€ LABELé•œåƒç‰ˆæœ¬ä¿¡æ¯ RUNå®¹å™¨æ„å»ºæ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤ï¼Œå¯ä»¥ç”¨ \\ åˆ†è¡Œ EXPOSEæš´éœ²ç«¯å£ï¼Œæ¯”å¦‚tomcaté•œåƒä¸­çš„dockerfile ä»–exposeäº†ä¸€ä¸ª8080ç«¯å£ï¼Œå½“æˆ‘ä»¬åœ¨ç”¨-PéšæœºæŒ‡å®šç«¯å£çš„æ—¶å€™ï¼Œä»–ä¼šé»˜è®¤æ˜ å°„æˆ‘ä»¬æ‰€æš´éœ²çš„ç«¯å£ï¼Œå¦‚8080 WORKDIRç™»é™†ä¹‹åçš„å·¥ä½œç›®å½• ENVç”¨æ¥æ„å»ºé•œåƒè¿‡ç¨‹ä¸­è®¾ç½®ç¯å¢ƒå˜é‡ ADDæ‹·è´å¹¶è§£å‹åˆ°é•œåƒä¸­ COPYæ‹·è´æ–‡ä»¶åˆ°é•œåƒä¸­ï¼Œå†™æ³•:COPY src destCOPY [\"src\",\"dest\"] VOLUMEå®¹å™¨æ•°æ®å·,ç”¨äºæ•°æ®ä¿å­˜å’ŒæŒä¹…åŒ–å·¥ä½œ,å†™æ³•:VOLUME [\"/data/\",\"/data1/\",] CMDdockerfileä¸­å¯ä»¥æœ‰å¤šä¸ªCMDå‘½ä»¤,ä½†åªæœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆï¼Œä¸”CMDä¼šè¢«docker runä¹‹åçš„CMDæ›¿æ¢æ‰ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨å¯åŠ¨ä¸€ä¸ªé•œåƒçš„æ—¶å€™ä¼šæ‰§è¡Œdocker run -it centos /bin/bashæŒ‡å®šä¸€ä¸ªå®¹å™¨è¦è¿è¡Œæ—¶ï¼Œå¯åŠ¨çš„å‘½ä»¤,å†™æ³•:# shell æ ¼å¼CMD # exec æ ¼å¼CMD [\"å¯æ‰§è¡Œæ–‡ä»¶\",\"å‚æ•°1\",\"å‚æ•°2\"]# å‚æ•°åˆ—è¡¨æ ¼å¼CMN ['å‚æ•°1','å‚æ•°2'] ENTRYPOINTæŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶å€™è¦è¿è¡Œçš„å‘½ä»¤ï¼Œä¸ä¼šè¢«æ›¿æ¢ ONBUILDå½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿çš„Dockerfileæ—¶è¿è¡Œå‘½ä»¤,çˆ¶é•œåƒåœ¨è¢«å­ç»§æ‰¿åï¼Œçˆ¶é•œåƒçš„onbuildè¢«è§¦å‘ ADDå’ŒCOPY ä»¥åŠè¿œç¨‹æ–‡ä»¶çš„æ·»åŠ ADDä¸ä½†å¯ä»¥å¤åˆ¶è¿˜å¯ä»¥è§£å‹ ADD xx.tar.gz /COPY xx /tmp/data1/ æ·»åŠ è¿œç¨‹æ–‡ä»¶/ç›®å½• ä½¿ç”¨RUN curl | RUN wget WORKDIRWORKDIRè¡¨ç¤ºå·¥ä½œç›®å½• WORKDIR /test å¦‚æœæ²¡æœ‰testå·¥ä½œç›®å½•ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»º WORKDIR /testWORKDIR demo1 ä»¥ä¸Šä¼šç”Ÿæˆçš„å·¥ä½œç›®å½•æ˜¯/test/demo1 å°½é‡ä½¿ç”¨ç»å¯¹ç›®å½• CMDä¸ENTRYPOINTåœ¨tomcatçš„å®˜æ–¹é•œåƒåŒ…ä¸­ï¼Œdockerfileé‡Œé¢çš„æœ€åæœ‰è¿™ä¹ˆä¸€å¥CMD CMD [\"catalina.sh\",\"run\"] æ„æ€å°±æ˜¯è¯´åœ¨dokcer runæ²¡æœ‰åŠ CMDçš„æƒ…å†µä¸‹å¯åŠ¨æ—¶ï¼Œä¼šå»è¿è¡ŒCMD [â€œcatalina.shâ€,â€runâ€] è¿™ä¸€ä¸²å†…å®¹ã€‚ 06-Feb-2020 05:29:22.623 INFO [main] org.apache.catalina.startup.Catalina.load Initialization processed in 389 ms06-Feb-2020 05:29:22.639 INFO [main] org.apache.catalina.core.StandardService.startInternal Starting service [Catalina]06-Feb-2020 05:29:22.639 INFO [main] org.apache.catalina.core.StandardEngine.startInternal Starting Servlet Engine: Apache Tomcat/8.5.5006-Feb-2020 05:29:22.647 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [\"http-nio-8080\"]06-Feb-2020 05:29:22.653 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [\"ajp-nio-8009\"]06-Feb-2020 05:29:22.655 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in 32 ms ä½†å¦‚æœæˆ‘ä»¬åœ¨åé¢åŠ äº†å¦‚ /bin/bash root:/tmp# docker run -it -P tomcat /bin/bashroot@2ee3ee482178:/usr/local/tomcat# ä»–å°±ä¸å›å»è¿è¡Œè¿™ä¸ªcatalina.shè¿™ä¸ªç¨‹åº ENTRYPOINTå¯ä»¥å°†å‚æ•°ç´¯åŠ  FROM centosRUN yum install curl -yENTRYPOINT [\"curl\",\"-s\",\"https://ip.cn/\"]docker run -it centos -> [\"curl\",\"-s\",\"https://ip.cn/\"] docker run -it centos -i -> [\"curl\",\"-s\",\"-i\",\"https://ip.cn/\"] ä¸¤ç§é£æ ¼çš„ç¼–å†™æ ¼å¼ ONBUILDä½¿ç”¨ONBUILDå°±æ˜¯åœ¨ç»§æ‰¿çˆ¶å®¹å™¨ä¹‹åï¼Œå¦‚æœå­å®¹å™¨è¿è¡Œäº†ï¼Œå°±ä¼šåœ¨çˆ¶å®¹å™¨ä¸­è¿è¡ŒONBUILDåé¢çš„å‘½ä»¤ FROM centosRUN yum install -y curlENTRYPOINT [\"curl\",\"-s\",\"https://ip.cn/\"] ONBUILD RUN echo \"son is run \" çˆ¶å®¹å™¨ä¸ºm1 å­å®¹å™¨ä¸ºm2,è¿™é‡Œçš„ç»§æ‰¿å°±æ˜¯è¯´ä»¥çˆ¶å®¹å™¨é•œåƒä¸ºåŸºæœ¬æ¨¡ç‰ˆåˆ›å»ºçš„å­é•œåƒåç”Ÿæˆçš„å­å®¹å™¨ ç¼–å†™å®ä¾‹ä¸€ä¸ªæŒ‚è½½æ–‡ä»¶çš„dockerfileFROM centosVOLUME [\"data1/\",\"data2/\"] # è¿™ç§å®šä¹‰æ–¹å¼æ— æ³•åƒå‘½ä»¤ä¸€æ ·æŒ‡å®šæœ¬åœ°çš„æ–‡ä»¶CMD echo \"VOLUME TEST!\"CMD /bin/bash æ ¹æ®ç¼–å†™çš„dockerfileæ„å»ºè‡ªå®šä¹‰é•œåƒ docker build -f /tmp/dockerfile -t hzj/centos . ä½¿ç”¨InspectæŸ¥çœ‹æŒ‚è½½çš„æ–‡ä»¶è·¯å¾„ docker inspect hzj/centos å‡ºç°æŒ‚è½½çš„è·¯å¾„ \"Mounts\": [ { \"Type\": \"volume\", \"Name\": \"2a8601766a8ec82c39132bc64c2c99546053cb4104bd94507f215b888e60464d\", \"Source\": \"/var/lib/docker/volumes/2a8601766a8ec82c39132bc64c2c99546053cb4104bd94507f215b888e60464d/_data\", \"Destination\": \"/data2\", \"Driver\": \"local\", \"Mode\": \"\", \"RW\": true, \"Propagation\": \"\" }, ç”¨dockerfileåˆ›å»ºä¸€ä¸ªcentosé•œåƒåˆå§‹centosé•œåƒåªæœ‰æœ€åŸºæœ¬çš„kernelå†…å®¹ï¼Œå¹¶æ²¡æœ‰å…¶ä»–çš„è½¯ä»¶ï¼Œæ¯”å¦‚vimï¼Œæ¯”å¦‚ifconfigç­‰ã€‚ä½¿ç”¨dockerfileåˆ›å»ºä¸€ä¸ªcentosç³»ç»Ÿ FROM centos # åŸºäºcentosï¼Œç½‘ä¸Šå†™ä¸œè¥¿ å†ç”Ÿæˆé•œåƒ é•œåƒçš„åˆ†å±‚åŸç†MAINTAINER hzj # ä½œè€…ä¿¡æ¯ENV workdir /usr/local # ç”³æ˜ç¯å¢ƒå˜é‡WORKDIR $workdir # è®¾ç½®ç™»é™†åçš„å·¥ä½œç¯å¢ƒRUN yum -y install vimRUN yum -y install net-toolsEXPOSE 80 # æš´éœ²ç«¯å£CMD echo $workdirCMD echo \"success\"CMD /bin/bash docker build -f dockerfile -t hzj/centos:v3 . dockerå¼€å¯mysqlé•œåƒdocker pull mysqldocker run -p 12345:3306 --name mysql \\-v /conf/mysql/conf:/etc/mysql/conf.d \\-v /conf/mysql/logs:/logs \\ -v /conf/mysql/data:/var/lib/mysql \\-e MYSQL_ROOT_PASSWD=123456 \\ #åˆå§‹åŒ–å¯†ç -d mysql:5.6 dockerå¼€å¯redisé•œåƒdocker pull redisdocker run -p 6379:6379 \\-v /hzj/myredis/data:/data \\-v /hzj/myredis/conf/redis.conf:/usr/local/etc/redis/redis.conf \\ -d redis:3.2 redis-server /usr/local/etc/redis/redis.conf \\--appendonly yes dockerå®‰è£…stresså‹åŠ›æµ‹è¯•è½¯ä»¶FROM ubuntuRUN apt-get update && apt-get install stress -yENTRYPOINT [\"/usr/bin/stress\"]# ENTRYPOINT [\"/bin/bash\",\"-c\",\"stress\"]CMD [] ç”Ÿæˆé•œåƒ dokcer build -f dockerfile -t new/ubuntu-stress . åˆ©ç”¨é•œåƒè¿è¡Œå®¹å™¨ # ä¸åŠ å‚æ•° /usr/bin/stressroot:~# docker run -it new/ubuntu-stress'stress' imposes certain types of compute stress on your systemUsage: stress [OPTION [ARG]] ... -?, --help show this help statement --version show version statement -v, --verbose be verbose -q, --quiet be quiet -n, --dry-run show what would have been done -t, --timeout N timeout after N seconds --backoff N wait factor of N microseconds before work starts -c, --cpu N spawn N workers spinning on sqrt() -i, --io N spawn N workers spinning on sync() -m, --vm N spawn N workers spinning on malloc()/free() --vm-bytes B malloc B bytes per vm worker (default is 256MB) --vm-stride B touch a byte every B bytes (default is 4096) --vm-hang N sleep N secs before free (default none, 0 is inf) --vm-keep redirty memory instead of freeing and reallocating -d, --hdd N spawn N workers spinning on write()/unlink() --hdd-bytes B write B bytes per hdd worker (default is 1GB)Example: stress --cpu 8 --io 4 --vm 2 --vm-bytes 128M --timeout 10s# åŠ å‚æ•° /usr/bin/stress -m 1root:~# docker run -it new/ubuntu-stress -m 1stress: info: [1] dispatching hogs: 0 cpu, 0 io, 1 vm, 0 hdd^Cstress: FAIL: [1] (415)","link":"/posts/8d3c2c27/"},{"title":"k8så¸¸è§é”™è¯¯","text":"learn docker ğŸ³ğŸ•¸ï¸ ï¸ k8så¸¸è§é”™è¯¯ç”±äºk8sçš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä¼šå‡ºç°å¾ˆå¤šçš„é—®é¢˜ï¼Œé¢„è®¡ç¯‡å¹…ä¼šå¾ˆå¤§ï¼Œåœ¨è¿™é‡Œåšä¸€ä¸ªè®°å½• k8sé”™è¯¯åˆå§‹åŒ–ç¯å¢ƒè¿‡ç¨‹ä¸­nodeå­èŠ‚ç‚¹å‡ºç°å·²åŠ å…¥masteré›†ç¾¤çš„æƒ…å†µW0210 13:47:24.391420 9455 join.go:346] [preflight] WARNING: JoinControlPane.controlPlane settings will be ignored when control-plane flag is not set.[preflight] Running pre-flight checks [WARNING IsDockerSystemdCheck]: detected \"cgroupfs\" as the Docker cgroup driver. The recommended driver is \"systemd\". Please follow the guide at https://kubernetes.io/docs/setup/cri/ [WARNING Hostname]: hostname \"work233\" could not be reached [WARNING Hostname]: hostname \"work233\": lookup work233 on 114.114.114.114:53: no such hosterror execution phase preflight: [preflight] Some fatal errors occurred: [ERROR DirAvailable--etc-kubernetes-manifests]: /etc/kubernetes/manifests is not empty [ERROR FileAvailable--etc-kubernetes-kubelet.conf]: /etc/kubernetes/kubelet.conf already exists[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`To see the stack trace of this error execute with --v=5 or higher è§£å†³æ–¹æ³•é‡ç½®k8s kubeadm reset å¦å¤– WARNINGä¸å¤§å½±å“ï¼Œå¯ä»¥é€‰æ‹©ä¸ä¿®æ”¹ï¼ŒERRORçš„é”™è¯¯ä¼šç›´æ¥å¯¼è‡´æ— æ³•åˆå§‹åŒ–ç¯å¢ƒ dockeré”™è¯¯dockerå®‰è£…è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repoFile \"/bin/yum-config-manager\", line 133except yum.Errors.RepoError, e: è§£å†³åŠæ³•,pythonç¯å¢ƒé—®é¢˜ sudo vim /bin/yum-config-manager#!/usr/bin/python -tt æ”¹æˆ #!/usr/bin/python2 -tt","link":"/posts/6e725c12/"},{"title":"dockerè§†é¢‘","text":"learn docker ğŸ³ https://gitlab-demo.com/xiaoquwl/dokcer-k8s-devops","link":"/posts/d99f9929/"},{"title":"ansibleæ€»ç»“","text":"ç™»é™†h3cäº¤æ¢æœºh3cäº¤æ¢æœºçš„æ¨¡å—æ”¯æŒåº¦æä½ï¼Œç½‘ä¸Šå¤§å¤šéƒ½æ˜¯æ€ç§‘äº¤æ¢æœºçš„æ¨¡å—ï¼Œå¾ˆå¤šè¦ç”¨åˆ°H3cçš„éƒ½æ˜¯è‡ªå·±å†™çš„ï¼Œæ„Ÿè§‰å¾ˆå‘ é—®é¢˜:ç°åœ¨åˆä¸€ä¸ªé—®é¢˜å°±æ˜¯å‘½ä»¤è¡Œä½¿ç”¨rawæ¨¡å—å¯ä»¥ç™»é™†äº¤æ¢æœºï¼Œå¹¶ä¸”è¾“å‡ºæ‰§æŒ‡ä»¤ è¿”å›ç»“æœï¼Œä½†æ˜¯åœ¨ansible-playbookä¸­ä¸è¡Œ echo \"10.0.5.124\" >> ./xxansible -i xx all -m raw -a 'system-view ;dis arp ;' å¦‚ä¸Šæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¦‚ä¸‹çš„playbookåˆ™ä¸è¡Œ echo first.yml < EOF","link":"/posts/20d6cad/"},{"title":"docker-swarm","text":"learn docker ğŸ³ğŸ³ docker-swarm å‡†å¤‡æœºå™¨ ä¸‰å°centos7 IPåˆ†åˆ«ä¸º10.0.5.233 10.0.5.196 10.0.6.55å…¶ä¸­ä¸€å°ä½œä¸ºmanagerç®¡ç†æœºï¼Œå…¶ä»–ä½œä¸ºworkéšä»æœº # å£°æ˜ç®¡ç†æœº[root@dev ~]# docker swarm init --advertise-addr=10.0.6.55Swarm initialized: current node (yi6s9lbwc402zvv8384wiras7) is now a manager.To add a worker to this swarm, run the following command: docker swarm join --token SWMTKN-1-4tnasb86t2w9bppugns4v8f9vjuf635kkhfkt341lnd18sqf4c-9m7jfe2u493h3wpr24z7audiy 10.0.6.55:2377To add a manager to this swarm, run 'docker swarm join-token manager' and follow the instructions. ä¼šç»™å‡ºä¸€æ®µä¿¡æ¯ï¼Œå…¶ä¸­nodeèŠ‚ç‚¹çš„tokenå€¼ï¼Œä»¥åŠå£°æ˜nodeèŠ‚ç‚¹çš„æ–¹æ³• # å£°æ˜nodeæœº[root@196 hzj]# docker swarm join --token SWMTKN-1-4tnasb86t2w9bppugns4v8f9vjuf635kkhfkt341lnd18sqf4c-9m7jfe2u493h3wpr24z7audiy 10.0.6.55:2377This node joined a swarm as a worker.[root:~]# docker swarm join --token SWMTKN-1-4tnasb86t2w9bppugns4v8f9vjuf635kkhfkt341lnd18sqf4c-9m7jfe2u493h3wpr24z7audiy 10.0.6.55:2377This node joined a swarm as a worker. å¯ä»¥åœ¨managerä¸ŠæŸ¥çœ‹nodeèŠ‚ç‚¹ [root@manager55 ~]# docker node lsID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSIONyi6s9lbwc402zvv8384wiras7 * manager55 Ready Active Leader 19.03.5wxq2hk8ozhv1x6fdm7wplra8t work196 Ready Active 19.03.5zq7zgn8o9ozyqipw5rofub6m5 work233 Ready Active 19.03.5 docker-swarmä½¿ç”¨å¯ä»¥æŠŠdocker-swarmå¼€æˆä¸€ä¸ªé›†ç¾¤çš„æ­å»ºï¼Œé¦–å…ˆæ˜¯å»ºç«‹ä¸€ä¸ªserviceçš„é›†ç¾¤ï¼Œåœ¨serviceåˆ›å»ºå¤šä¸ªworkè¿›è¡Œå·¥ä½œ # åˆ›å»ºæœåŠ¡ managerdocker service create --name demo busybox sh -c \"while true;do sleep 3600;done\"# æœåŠ¡æŸ¥çœ‹[root@manager55 ~]# docker service lsID NAME MODE REPLICAS IMAGE PORTSob8p30vdkhnn demo replicated 1/1 busybox:latest# containeræŸ¥çœ‹[root@manager55 ~]# docker service ps demoID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTSrbl6tfetw25m demo.1 busybox:latest manager55 Running Running 3 hours ago æ°´å¹³æ‰©å±•docker-swarmå¯ä»¥æ°´å¹³æ‰©å±•å®¹å™¨ #æ°´å¹³æ‰©å±•5ä¸ª [root@manager55 ~]# docker service scale demo=5demo scaled to 5overall progress: 5 out of 5 tasks1/5: running [==================================================>]2/5: running [==================================================>]3/5: running [==================================================>]4/5: running [==================================================>]5/5: running [==================================================>]verify: Waiting 4 seconds to verify that tasks are stable... å°†5ä¸ªserviceåŒé…ç½®éƒ¨ç½²åˆ°å…¶ä»–æœºå™¨ä¸Šé¢ï¼Œåˆ†é…çš„æ–¹å¼ä¸ºå¹³å‡åˆ†é… [root@manager55 ~]# docker service ps demoID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTSrbl6tfetw25m demo.1 busybox:latest manager55 Running Running 3 hours agouc3tn3coc8q3 demo.2 busybox:latest work233 Running Running about a minute agody1tza747g3w demo.3 busybox:latest work233 Running Running 56 seconds agomqbt0myozide \\_ demo.3 busybox:latest work196 Shutdown Rejected about a minute ago \"No such image: busybox:latestâ€¦\"mtb3x9mabokn \\_ demo.3 busybox:latest work196 Shutdown Rejected about a minute ago \"No such image: busybox:latestâ€¦\"yyq86fjpf0i4 demo.4 busybox:latest manager55 Running Running 50 seconds agomo12k2g7gx1s \\_ demo.4 busybox:latest work196 Shutdown Rejected about a minute ago \"No such image: busybox:latestâ€¦\"cqpsqtvfeo9y \\_ demo.4 busybox:latest work196 Shutdown Rejected about a minute ago \"No such image: busybox:latestâ€¦\"t8z0vqc0kow7 \\_ demo.4 busybox:latest work196 Shutdown Rejected about a minute ago \"No such image: busybox:latestâ€¦\"fojfst6j5pa2 demo.5 busybox:latest manager55 Running Running about a minute ago è¿™é‡Œåœ¨éƒ¨ç½²çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä¸€ä¸ªé”™è¯¯ï¼Œwork196çš„æœºå™¨å› ä¸ºæ²¡æœ‰é…ç½®å¥½DNSï¼Œå¯¼è‡´æ— æ³•ä»ç½‘ä¸Šæ‹‰å»busyboxçš„é•œåƒæ–‡ä»¶ï¼Œäºæ˜¯å‘ç”Ÿäº†è¿™æ ·çš„æƒ…å†µé¦–å…ˆwork196æ”¶åˆ°è¯·æ±‚å»æ‹‰å»busyboxåˆ›å»ºå®¹å™¨ï¼Œä½†æ˜¯æ²¡æœ‰DNSæ‹‰å»ä¸äº†ï¼ŒæŠ¥é”™ã€‚æ ¹æ®è‡ªåŠ¨åˆ†é…çš„è®¾ç½®ï¼Œå°†ä»»åŠ¡è¿½åŠ åˆ†é…ç»™å…¶ä»–workæˆ–è€…manageæœºå™¨éƒ¨ç½² éƒ¨ç½²ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨work233çš„æœºå™¨ä¸ŠæŸ¥çœ‹èµ·æ¥çš„å®¹å™¨ [root@work233]:~# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES837720ea43f8 busybox:latest \"sh -c 'while true;dâ€¦\" 17 minutes ago Up 17 minutes demo.3.dy1tza747g3whbv2zuasgc6s569d08591e255 busybox:latest \"sh -c 'while true;dâ€¦\" 17 minutes ago Up 17 minutes demo.2.uc3tn3coc8q39izu3to58z9or manageræœºå™¨æŸ¥çœ‹workæœºå™¨å·¥ä½œçŠ¶æ€ [root@manager55 ~]# docker service lsID NAME MODE REPLICAS IMAGE PORTSob8p30vdkhnn demo replicated 5/5 busybox:latest å…¶ä¸­REPLICAS 5/5 å‰è€…è¡¨ç¤ºå½“å‰ä¸€å…±è¿è¡Œå¤šå°‘äº†å®¹å™¨ï¼Œåè€…è¡¨ç¤ºä¸€å…±å¤åˆ¶äº†å¤šå°‘äº†å®¹å™¨ å°è¯•å…³é—­work233æœºå™¨ä¸Šçš„ä¸€å°å®¹å™¨ï¼ŒæŸ¥çœ‹å·¥ä½œçŠ¶æ€ [root@work233 ~]:~# docker rm -f 837720ea43f8837720ea43f8 [root@manager55 ~]# docker service lsID NAME MODE REPLICAS IMAGE PORTSob8p30vdkhnn demo replicated 4/5 busybox:latest# some times later[root@manager55 ~]# docker service lsID NAME MODE REPLICAS IMAGE PORTSob8p30vdkhnn demo replicated 5/5 busybox:latest åœ¨manger55ä¸Šé¢å‘ç°è¿è¡Œæœºå™¨å·²ç»è¢«doneäº†ä¸€å°ï¼Œä½†æ˜¯ä¸€æ®µæ—¶é—´å(ä¸ä¹…ï¼Œç›¸å½“äºé‡å¼€ä¸€å°æœºå™¨çš„æ—¶é—´)ä¼šåˆ·æ–°æˆ5/5 å› ä¸ºscaleä¼šæ£€æµ‹å¹¶é‡æ–°éƒ¨ç½²ä¸€å°æ–°çš„ä¸Šå» æ°´å¹³æ‰©å±•åå®¹å™¨çš„ç½‘ç»œé—®é¢˜ä¹‹å‰çš„dockerå®¹å™¨å…¨éƒ¨éƒ½æ˜¯è¿è¡Œåœ¨æœ¬åœ°çš„ï¼Œäºæ˜¯å®¹å™¨ä¸å®¹å™¨ä¹‹é—´æ˜¯å¯ä»¥é€šè¿‡ä½¿ç”¨åå«docker0çš„bridgeè¿›è¡Œäº’ç›¸é€šä¿¡ï¼Œä½†æ˜¯ä½¿ç”¨docker swarmä¹‹åï¼Œå®¹å™¨å·²ç»åˆ†å¸ƒå¼çš„éƒ¨ç½²åœ¨äº†å¤šå°ipçš„æœºå™¨ä¸Šé¢ï¼Œä»–ä»¬çš„ç½‘ç»œæ˜¯å¦äº’ç›¸é€šä¿¡å‘¢ # æŸ¥çœ‹work233 ä¸Šçš„ ip[work233]:~# docker exec 69d08591e255 ip a1: lo: mtu 65536 qdisc noqueue qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever266: eth0@if267: mtu 1500 qdisc noqueue link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0 valid_lft forever preferred_lft forever# æŸ¥çœ‹manager å…¶ä¸­ä¸€ä¸ªå®¹å™¨çš„ip[root@manager55 ~]# docker exec 0c154e8873c7 ip a1: lo: mtu 65536 qdisc noqueue qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever17: eth0@if18: mtu 1500 qdisc noqueue link/ether 02:42:ac:11:00:04 brd ff:ff:ff:ff:ff:ff inet 172.17.0.4/16 brd 172.17.255.255 scope global eth0 valid_lft forever preferred_lft forever# æµ‹è¯•ping[root@manager55 ~]# docker exec 0c154e8873c7 ping 172.17.0.2PING 172.17.0.2 (172.17.0.2): 56 data bytes64 bytes from 172.17.0.2: seq=0 ttl=64 time=0.186 ms# ä½†æ˜¯ping å®¹å™¨åå°±ä¸å¯è¾¾ï¼Œæ²¡æœ‰åšlink[root@manager55 ~]# docker exec 0c154e8873c7 ping 69d08591e255ping: bad address '69d08591e255' Q: å¦‚æœè§£å†³pingå®¹å™¨åä¸å¯è¾¾çš„é—®é¢˜è¿™æ˜¯å› ä¸ºåœ¨serviceå¯åŠ¨å’Œéƒ¨ç½²çš„è¿‡ç¨‹ä¸­æ²¡æœ‰åšlinkï¼Œåœ¨ä¹‹åå¯ä»¥éƒ¨ç½²çš„è¿‡ç¨‹ä¸­æŒ‡å®šè‡ªå·±çš„ç½‘æ¡¥new-bridge,è¾¾åˆ°äº’ç›¸é€šä¿¡çš„æ•ˆæœå…·ä½“å¯ä»¥çœ‹https://blog.noback.top/posts/20783356/#linux%E7%9A%84%E7%BD%91%E7%BB%9C%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4namesapce å…³äºæœåŠ¡æŸ¥çœ‹åªèƒ½åœ¨managerä¸Šè¿›è¡ŒæŸ¥çœ‹ï¼Œä¸èƒ½åœ¨nodeæœºä¸ŠæŸ¥çœ‹ï¼Œä¼šæŠ¥é”™ [root@work196]# docker service lsError response from daemon: This node is not a swarm manager. Worker nodes can't be used to view or modify cluster state. Please run this command on a manager node or promote the current node to a manager.","link":"/posts/8f65/"},{"title":"djangoå†…å®¹æ€»ç»“","text":"djangoå†…å®¹æ€»ç»“åœ¨åå°å¯¹æŸäº›å›ºå®šå­—æ®µè®¾ç½®é¢œè‰²# models.pyfrom django.urls.html import format_htmlclass Person(models.Model): first_name = models.CharField(max_length=50) last_name = models.CharField(max_length=50) color_code = models.CharField(max_length=6) def colored_name(self): return format_html( '{} {}', self.color_code, self.first_name, self.last_name, ) admin.pyclass PersonAdmin(admin.ModelAdmin): list_display = (â€˜first_nameâ€™, â€˜last_nameâ€™, â€˜colored_nameâ€™) DjangoAdmin Djangoè‡ªå¸¦åå°ç®¡ç†æ¨¡æ¿æ˜¯å…¶ä¸€å¤§ç‰¹è‰²ï¼Œä½†ä½œä¸ºåå°ç®¡ç†å¾ˆå¤šåœ°æ–¹éœ€è¦æˆ‘ä»¬å»æ”¹è¿›ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€äº›å…¶ä»–çš„åå°æ¨¡æ¿ æ¨èæ¨¡æ¿1: xadmin xadminåœ¨å‡ å¹´å‰æ˜¯ä¸ºdjangoå®šåˆ¶çš„åå°ç®¡ç†æ¨¡æ¿ï¼Œä½†æ˜¯ä½œè€…å·²ç»åœæ­¢ç»´æŠ¤ï¼Œä½†æ˜¯åœ¨å…¶åˆ†æ”¯ä¸­ä¾æ—§æœ‰éƒ¨åˆ†äººåœ¨ç»´æŠ¤ã€‚ å…·ä½“ä½¿ç”¨è·³è½¬åˆ°æˆ‘çš„æ˜é‡‘https://juejin.im/post/5afd267d51882542714ff756 æ¨èæ¨¡æ¿2ï¼š django simple-ui åœ¨githubä¸Šçš„æ˜Ÿæ•°å¹¶ä¸é«˜ï¼Œä½†æ˜¯æ˜¯åŸºäºé¥¿äº†ä¹ˆelement-uiæ‰€å†™çš„djangoåå°æ¨¡æ¿ï¼Œæˆ‘è¿˜æœªä½¿ç”¨ ä½¿ç”¨æœ¬èº«è‡ªå¸¦çš„adminæ¨¡æ¿ ä½¿ç”¨å…¶ä»–å…¼å®¹å¤šè¯­è¨€çš„åå°æ¨¡æ¿ url :https://my.oschina.net/zhiyonghe/blog/1532030 è‡ªå¸¦çš„Adminæ¨¡æ¿ è¿™é‡Œä»‹ç»ä¸€ä¸‹è‡ªå¸¦çš„adminæ¨¡æ¿ã€‚ adminç•Œé¢æ±‰åŒ–åœ¨setting.pyæ–‡ä»¶ä¸­è®¾ç½®è¯­è¨€ # setting.pyLANGUAGE_CODE = 'zh-hans'IME_ZONE = 'Asia/Shanghai' Modelæ³¨å†Œåœ¨Model.pyä¸­åˆ›å»ºå®Œç±»åï¼Œéœ€è¦åœ¨admin.pyä¸­å®Œæˆæ³¨å†Œï¼Œæ‰èƒ½åœ¨åå°æ¨¡æ¿ä¸­æ˜¾ç¤ºï¼Œæ–¹æ³•æœ‰äºŒ # admin.py# æ–¹æ³•ä¸€from django.contrib import admin from blog.models import Blogclass BlogAdmin(admin.ModelAdmin): list_display=('xx','xx','xx') # è¦æ˜¾ç¤ºçš„å­—æ®µ list_per_page = 50 # æ¯é¡µæœ€å¤šæ˜¾ç¤º50æ¡ ordering = (\"-xxx\") # è®¾ç½®æ’åºï¼Œ-è¡¨ç¤ºé™åºæ’åº list_editable = ['','',''] # è®¾ç½®å¯ç¼–è¾‘å­—æ®µ list_display_links = ('','',) # é»˜è®¤æƒ…å†µä¸‹åªèƒ½ç‚¹å‡»ç¬¬ä¸€ä¸ªå­—æ®µè¿›å…¥ç¼–è¾‘ï¼Œè®¾ç½®å¤šä¸ªå­—æ®µå¯ç‚¹å‡»è¿›å…¥ç¼–è¾‘ list_filter = ('','','') # ç­›é€‰å™¨ search_fields = ('','','',) # æœç´¢å­—æ®µ date_hierarchy = 'go_time' # è¯¦ç»†æ—¶é—´ç­›é€‰admin.site.register(Blog,BlogAdmin)# æ–¹æ³•äºŒfrom djang.contrib import adminfrom blog.models import Blog@admin.register(Blog)class BlogAdmin(admin.ModelAdmin): list_display=('','','') Django for ajaxdjango å‰åå°ä¼ é€’æ¶ˆæ¯å†…å®¹çš„æ–¹æ³•æœ‰å¾ˆå¤šç§,è¿™é‡Œæˆ‘ä»¬æ¥è®²ä¸€ä¸‹ajax for django # è·¯ç”±åœ°å€# é¡¹ç›®è·¯å¾„ä¸‹path('',include('GraphPro.urls'))# åº”ç”¨è·¯å¾„ä¸‹path('echartsdemo/',demoView.as_view(),name=\"demo\"),# è§†å›¾å±‚class demoView(View): def get(self,request): if request.GET.get('name') == 'hzj': return HttpResponse(\"ssdsdsd\") else: print(2) return render(request,'demo.html') def post(self,request): pass# æ¨¡æ¿å±‚ ç‚¹å‡» {{ data }} $(document).ready(function () { var name = $('#name').val(); var data = {\"name\":name}; $(\"#click_func\").click(function () { $.get( //è¯·æ±‚çš„url '{% url 'demoecharts' %}', data, function (ret) { console.log(ret) } ) }) }) è¿›å…¥é¡µé¢ç›´æ¥è¯·æ±‚åå°æ•°æ® $(document).ready(function () { var data = {\"name\":\"hzj\"}; $.get( //è¯·æ±‚çš„url '{% url 'demo' %}', data, function (ret) { console.log(ret) } ) }) å¼‚æ­¥åŠ è½½æ•°æ® $(document).ready(function () { var data = {\"name\":\"hzj\"}; $.get( //è¯·æ±‚çš„url '{% url 'demo' %}', data, ).done(function(ret){ console.log(ret) }) }) ä»‹ç»Mysqlåœ¨Djangoä¸­çš„å¼•ç”¨ç”±äºDjangoåœ¨åˆå§‹åŒ–é¡¹ç›®åï¼Œæ‰€ä½¿ç”¨çš„æ•°æ®åº“æ˜¯sqlite3,ä½†ä¸ºäº†æ‰©å±•ï¼Œæˆ‘ä»¬è¿™é‡Œè®¡åˆ’ä½¿ç”¨Mysql,é…ç½®æ­¥éª¤å¦‚ä¸‹ é…ç½®1.åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…Mysqlæ•°æ®åº“(Centosç‰ˆ)2.åœ¨djangoçš„setting.pyä¸­å¼•ç”¨ é”™è¯¯ç±»å‹æ€»ç»“ç”±äºmysqlä¸djangoåœ¨é…ç½®è¿‡ç¨‹ä¸­ä¼šå­˜åœ¨å¾ˆå¤šçš„é”™è¯¯ï¼Œè¿™é‡Œæ€»ç»“ä¸€ä¸‹ Mysqlåœ¨Centosä¸­æƒé™ä¸è¶³çš„é”™è¯¯ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2) åŸå› æ˜¯/var/lib/mysqlçš„è®¿é—®æƒé™ä¸è¶³ 1.æ”¹å˜æƒé™ chown -R mysql:mysql /var/lib/mysql 2. å¯åŠ¨æœåŠ¡å™¨ /etc/init.d/mysql start (ä¼šè‡ªåŠ¨ç”Ÿæˆmysql.sockæ–‡ä»¶) 3.é‡æ–°å¯åŠ¨mysqlæœåŠ¡ /etc/init.d/mysql start å¯†ç ç±»å‹é”™è¯¯1045, \"Access denied for user 'root'@'122.224.83.xxx åŸå›  å¯†ç é”™è¯¯ï¼Œæ³¨æ„å¯†ç ä¸èƒ½æ˜¯å­—ç¬¦ä¸² GRANT ALL PRIVILEGES ON *.* TO root@'%' IDENTIFIED BY '123456' WITH GRANT OPTION; django setting ä¸­çš„é…ç½®DATABASES = { 'default': { 'ENGINE': 'django.db.backends.mysql', 'NAME': 'itemids', # æ•°æ®åº“åå­— 'USER': 'root', # æ•°æ®åº“ç™»å½•å 'PASSWORD': '12345x', # æ•°æ®åº“å¯†ç  'HOST': '106.14.195.xxx', æ•°æ®åº“IP 'POST': 3306, # ç«¯å£ }} å¼•ç”¨pymysqlç”±äºMySQLdbåªèƒ½ä½¿ç”¨åœ¨Python2ä¸­ï¼Œåœ¨python3ä¸­å·²ç»åœæ­¢äº†ç»´æŠ¤ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¼•ç”¨pymyqlçš„åº“ pipenv install pymysql# åœ¨ä¸setting.pyåŒçº§åˆ«çš„__init__.pyä¸­ä½¿ç”¨import pymysqlpymysql.install_as_MySQLdb() pymysqlç‰ˆæœ¬ä¸ç¬¦åˆæŠ¥é”™å†…å®¹:django.core.exceptions.ImproperlyConfigured: mysqlclient 1.3.3 or newer is required; you have 0.7.11ä¿®æ”¹Pipenv\\Lib\\site-packages\\django\\db\\backends\\mysql\\base.pyæ³¨é‡Šä¸‹é¢å†…å®¹if version < (1, 3, 3): raise ImproperlyConfigured(â€œmysqlclient 1.3.3 or newer is required; you have %sâ€ % Database.version) (åœ¨Centosä¸­ï¼Œpipenv install æ‰€ç”Ÿæˆçš„åŒ… ä¼šåœ¨pipenv shell æ¿€æ´»ç¯å¢ƒçš„æ—¶å€™å‡ºç°) ç”±äºä¸Šé¢æ³¨é‡Šï¼Œè¿˜ä¼šå‡ºç°çš„æŠ¥é”™å†…å®¹ä¸ºFile â€œC:\\Users\\Administrator\\PycharmProjects\\untitled1\\venv\\lib\\site-packages\\django\\db\\backends\\mysql\\operations.pyâ€, line 146, in last_executed_queryå°†operations.pyä¸­çš„decodeæ”¹æˆencode mysqlä¸èƒ½æ’å…¥ä¸­æ–‡æŠ¥é”™å†…å®¹ï¼š django.db.utils.InternalError: (1366, â€œIncorrect string value: â€˜\\xE5\\xAE\\x9A\\xE6\\x97\\xB6â€¦â€™ for column â€˜nameâ€™ at row 1â€)è§£å†³æ–¹æ³•: https://blog.csdn.net/tzh476/article/details/52644271åˆ é™¤ä¹‹å‰çš„åº“ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“ï¼Œä½¿ç”¨utf8mb64 ä¹‹å‰é»˜è®¤åˆ›å»ºçš„éƒ½æ˜¯latin1 mysql é•¿åº¦çš„é—®é¢˜django.db.utils.InternalError: (1071, â€˜Specified key was too long; max key length is 767 bytesâ€™)https://blog.csdn.net/ljfphp/article/details/80406907https://www.orcode.com/question/407126_k280b8.html è§£å†³æ–¹æ³•1: å‡çº§Mysql5.6â€“>>Mysql5.7centos7 ä¸‹ å¯¹mysqlçš„æ“ä½œ https://blog.csdn.net/xufengzhu/article/details/81110982https://blog.51cto.com/lisea/1941616 è§£å†³æ–¹æ³•2 : å…ˆä½¿ç”¨utf8æ ¼å¼ â€”-> ä»‹ç»Mysqlåœ¨Djangoä¸­çš„å¼•ç”¨ç”±äºDjangoåœ¨åˆå§‹åŒ–é¡¹ç›®åï¼Œæ‰€ä½¿ç”¨çš„æ•°æ®åº“æ˜¯sqlite3,ä½†ä¸ºäº†æ‰©å±•ï¼Œæˆ‘ä»¬è¿™é‡Œè®¡åˆ’ä½¿ç”¨Mysql,é…ç½®æ­¥éª¤å¦‚ä¸‹ é…ç½®1.åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…Mysqlæ•°æ®åº“(Centosç‰ˆ)2.åœ¨djangoçš„setting.pyä¸­å¼•ç”¨ é”™è¯¯ç±»å‹æ€»ç»“ç”±äºmysqlä¸djangoåœ¨é…ç½®è¿‡ç¨‹ä¸­ä¼šå­˜åœ¨å¾ˆå¤šçš„é”™è¯¯ï¼Œè¿™é‡Œæ€»ç»“ä¸€ä¸‹ Mysqlåœ¨Centosä¸­æƒé™ä¸è¶³çš„é”™è¯¯ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2) åŸå› æ˜¯/var/lib/mysqlçš„è®¿é—®æƒé™ä¸è¶³ 1.æ”¹å˜æƒé™ chown -R mysql:mysql /var/lib/mysql 2. å¯åŠ¨æœåŠ¡å™¨ /etc/init.d/mysql start (ä¼šè‡ªåŠ¨ç”Ÿæˆmysql.sockæ–‡ä»¶) 3.é‡æ–°å¯åŠ¨mysqlæœåŠ¡ /etc/init.d/mysql start å¯†ç ç±»å‹é”™è¯¯1045, \"Access denied for user 'root'@'122.224.83.xxx åŸå›  å¯†ç é”™è¯¯ï¼Œæ³¨æ„å¯†ç ä¸èƒ½æ˜¯å­—ç¬¦ä¸² GRANT ALL PRIVILEGES ON *.* TO root@'%' IDENTIFIED BY '123456' WITH GRANT OPTION; django setting ä¸­çš„é…ç½®DATABASES = { 'default': { 'ENGINE': 'django.db.backends.mysql', 'NAME': 'itemids', # æ•°æ®åº“åå­— 'USER': 'root', # æ•°æ®åº“ç™»å½•å 'PASSWORD': '12345x', # æ•°æ®åº“å¯†ç  'HOST': '106.14.195.xxx', æ•°æ®åº“IP 'POST': 3306, # ç«¯å£ }} å¼•ç”¨pymysqlç”±äºMySQLdbåªèƒ½ä½¿ç”¨åœ¨Python2ä¸­ï¼Œåœ¨python3ä¸­å·²ç»åœæ­¢äº†ç»´æŠ¤ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¼•ç”¨pymyqlçš„åº“ pipenv install pymysql# åœ¨ä¸setting.pyåŒçº§åˆ«çš„__init__.pyä¸­ä½¿ç”¨import pymysqlpymysql.install_as_MySQLdb() pymysqlç‰ˆæœ¬ä¸ç¬¦åˆæŠ¥é”™å†…å®¹:django.core.exceptions.ImproperlyConfigured: mysqlclient 1.3.3 or newer is required; you have 0.7.11ä¿®æ”¹Pipenv\\Lib\\site-packages\\django\\db\\backends\\mysql\\base.pyæ³¨é‡Šä¸‹é¢å†…å®¹if version < (1, 3, 3): raise ImproperlyConfigured(â€œmysqlclient 1.3.3 or newer is required; you have %sâ€ % Database.version) (åœ¨Centosä¸­ï¼Œpipenv install æ‰€ç”Ÿæˆçš„åŒ… ä¼šåœ¨pipenv shell æ¿€æ´»ç¯å¢ƒçš„æ—¶å€™å‡ºç°) ç”±äºä¸Šé¢æ³¨é‡Šï¼Œè¿˜ä¼šå‡ºç°çš„æŠ¥é”™å†…å®¹ä¸ºFile â€œC:\\Users\\Administrator\\PycharmProjects\\untitled1\\venv\\lib\\site-packages\\django\\db\\backends\\mysql\\operations.pyâ€, line 146, in last_executed_queryå°†operations.pyä¸­çš„decodeæ”¹æˆencode mysqlä¸èƒ½æ’å…¥ä¸­æ–‡æŠ¥é”™å†…å®¹ï¼š django.db.utils.InternalError: (1366, â€œIncorrect string value: â€˜\\xE5\\xAE\\x9A\\xE6\\x97\\xB6â€¦â€™ for column â€˜nameâ€™ at row 1â€)è§£å†³æ–¹æ³•: https://blog.csdn.net/tzh476/article/details/52644271åˆ é™¤ä¹‹å‰çš„åº“ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“ï¼Œä½¿ç”¨utf8mb64 ä¹‹å‰é»˜è®¤åˆ›å»ºçš„éƒ½æ˜¯latin1 mysql é•¿åº¦çš„é—®é¢˜django.db.utils.InternalError: (1071, â€˜Specified key was too long; max key length is 767 bytesâ€™)https://blog.csdn.net/ljfphp/article/details/80406907https://www.orcode.com/question/407126_k280b8.html è§£å†³æ–¹æ³•1: å‡çº§Mysql5.6â€“>>Mysql5.7centos7 ä¸‹ å¯¹mysqlçš„æ“ä½œ https://blog.csdn.net/xufengzhu/article/details/81110982https://blog.51cto.com/lisea/1941616 è§£å†³æ–¹æ³•2 : å…ˆä½¿ç”¨utf8æ ¼å¼","link":"/posts/7e91b378/"},{"title":"djangoé”™è¯¯åˆé›†","text":"é”™è¯¯ç±»å‹æ€»ç»“ç”±äºmysqlä¸djangoåœ¨é…ç½®è¿‡ç¨‹ä¸­ä¼šå­˜åœ¨å¾ˆå¤šçš„é”™è¯¯ï¼Œè¿™é‡Œæ€»ç»“ä¸€ä¸‹ Mysqlåœ¨Centosä¸­æƒé™ä¸è¶³çš„é”™è¯¯ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2) åŸå› æ˜¯/var/lib/mysqlçš„è®¿é—®æƒé™ä¸è¶³ 1.æ”¹å˜æƒé™ chown -R mysql:mysql /var/lib/mysql 2. å¯åŠ¨æœåŠ¡å™¨ /etc/init.d/mysql start (ä¼šè‡ªåŠ¨ç”Ÿæˆmysql.sockæ–‡ä»¶) 3.é‡æ–°å¯åŠ¨mysqlæœåŠ¡ /etc/init.d/mysql start å¯†ç ç±»å‹é”™è¯¯1045, \"Access denied for user 'root'@'122.224.83.xxx åŸå›  å¯†ç é”™è¯¯ï¼Œæ³¨æ„å¯†ç ä¸èƒ½æ˜¯å­—ç¬¦ä¸² GRANT ALL PRIVILEGES ON *.* TO root@'%' IDENTIFIED BY '123456' WITH GRANT OPTION; django setting ä¸­çš„é…ç½®DATABASES = { 'default': { 'ENGINE': 'django.db.backends.mysql', 'NAME': 'itemids', # æ•°æ®åº“åå­— 'USER': 'root', # æ•°æ®åº“ç™»å½•å 'PASSWORD': '12345x', # æ•°æ®åº“å¯†ç  'HOST': '106.14.195.xxx', æ•°æ®åº“IP 'POST': 3306, # ç«¯å£ }} å¼•ç”¨pymysqlç”±äºMySQLdbåªèƒ½ä½¿ç”¨åœ¨Python2ä¸­ï¼Œåœ¨python3ä¸­å·²ç»åœæ­¢äº†ç»´æŠ¤ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¼•ç”¨pymyqlçš„åº“ pipenv install pymysql# åœ¨ä¸setting.pyåŒçº§åˆ«çš„__init__.pyä¸­ä½¿ç”¨import pymysqlpymysql.install_as_MySQLdb() pymysqlç‰ˆæœ¬ä¸ç¬¦åˆæŠ¥é”™å†…å®¹:django.core.exceptions.ImproperlyConfigured: mysqlclient 1.3.3 or newer is required; you have 0.7.11ä¿®æ”¹Pipenv\\Lib\\site-packages\\django\\db\\backends\\mysql\\base.pyæ³¨é‡Šä¸‹é¢å†…å®¹if version < (1, 3, 3): raise ImproperlyConfigured(â€œmysqlclient 1.3.3 or newer is required; you have %sâ€ % Database.version) (åœ¨Centosä¸­ï¼Œpipenv install æ‰€ç”Ÿæˆçš„åŒ… ä¼šåœ¨pipenv shell æ¿€æ´»ç¯å¢ƒçš„æ—¶å€™å‡ºç°) ç”±äºä¸Šé¢æ³¨é‡Šï¼Œè¿˜ä¼šå‡ºç°çš„æŠ¥é”™å†…å®¹ä¸ºFile â€œC:\\Users\\Administrator\\PycharmProjects\\untitled1\\venv\\lib\\site-packages\\django\\db\\backends\\mysql\\operations.pyâ€, line 146, in last_executed_queryå°†operations.pyä¸­çš„decodeæ”¹æˆencode mysqlä¸èƒ½æ’å…¥ä¸­æ–‡æŠ¥é”™å†…å®¹ï¼š django.db.utils.InternalError: (1366, â€œIncorrect string value: â€˜\\xE5\\xAE\\x9A\\xE6\\x97\\xB6â€¦â€™ for column â€˜nameâ€™ at row 1â€)è§£å†³æ–¹æ³•: https://blog.csdn.net/tzh476/article/details/52644271åˆ é™¤ä¹‹å‰çš„åº“ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“ï¼Œä½¿ç”¨utf8mb64 ä¹‹å‰é»˜è®¤åˆ›å»ºçš„éƒ½æ˜¯latin1ä¸ä¸€æ ·è¦åˆ é™¤ä¹‹å‰çš„åº“ï¼Œä¿®æ”¹æ•°æ®åº“çš„å±æ€§å³å¯ mysql é•¿åº¦çš„é—®é¢˜django.db.utils.InternalError: (1071, â€˜Specified key was too long; max key length is 767 bytesâ€™)https://blog.csdn.net/ljfphp/article/details/80406907https://www.orcode.com/question/407126_k280b8.html è§£å†³æ–¹æ³•1: å‡çº§Mysql5.6â€“>>Mysql5.7centos7 ä¸‹ å¯¹mysqlçš„æ“ä½œ https://blog.csdn.net/xufengzhu/article/details/81110982https://blog.51cto.com/lisea/1941616 è§£å†³æ–¹æ³•2 : å…ˆä½¿ç”¨utf8æ ¼å¼ django migrateçš„é—®é¢˜å‡ºç°ä¸‹é¢è¿™ä¸ªé—®é¢˜ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ä½ çš„modelè®¾ç½®é”™è¯¯äº†ã€‚æœ‰äº›å­—æ®µç±»å‹éœ€è¦å›ºå®šçš„å±æ€§å¦‚integerFieldå­—æ®µéœ€è¦defaultè¿™ä¸ªé€‰é¡¹ï¼Œæ·»åŠ å®Œä¹‹åå°±Okäº† Please select a fix: 1) Provide a one-off default now (will be set on all existing rows with a null value for this column) 2) Quit, and let me add a default in models.p","link":"/posts/7f55f388/"},{"title":"ansibleåŸºç¡€","text":"ä¸»æœºæ¸…å• inventoryansibleä¸­æ·»åŠ ä¸»æœºæ¸…å•çš„å‡ ç§å½¢å¼ ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­æŒ‡å®šip,-kç™»é™†æ—¶æŒ‡å®šå¯†ç  ansible 192.168.20.1 -m ping -kansible 192.168.20.1,192.168.20.2 -m ping -k åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®š é»˜è®¤æ–‡ä»¶å¤¹/etc/ansible/hosts [name1]192.168.20.1[name2]192.168.20.2ansible name1 -m ping -k # æŒ‡å®šåˆ†ç»„ansible all -m ping -k # æŒ‡å®šæ‰€æœ‰ ç”±äºansibleæ˜¯é€šè¿‡sshè®¿é—®è¢«æ‰§è¡Œç«¯ä¸»æœºçš„ï¼Œå› æ­¤æ²¡æœ‰sshçš„æƒé™æ˜¯æ— æ³•å®Œæˆä»»åŠ¡çš„ï¼Œå³ä½¿è¿™é‡Œçš„å‘½ä»¤æ˜¯pingï¼Œä½†ä¾æ—§è¦èµ°sshçš„æµç¨‹è¿™é‡Œçš„pingå¹¶ä¸æ˜¯linuxä¸‹çš„ping ,è€Œæ˜¯ansibleå·¥å…·ä¸‹é¢çš„pingæ¨¡å— ä¸ä½¿ç”¨é»˜è®¤æ–‡ä»¶ä¸‹ï¼Œè‡ªå®šä¹‰æ–‡ä»¶å¤¹ echo \"192.168.20.1\" >> xxansible -i xx all -m ping -k åœ¨é…ç½®ç»„é‡Œé¢ä¸­ç›´æ¥ç¡®è®¤ç™»é™†ç”¨æˆ· echo \"192.168.20.1 ansible_ssh_user=root ansible_ssh_pass=upyun123\"ansible -i xx all -m ping é…ç½®æ–‡ä»¶ local_tmpæ˜¯æœ¬åœ°çš„æ‰§è¡ŒæŒ‡ä»¤ remote_tmpæ˜¯è¿œç¨‹çš„æ‰§è¡ŒæŒ‡ä»¤å½“ç”¨æˆ·ä½¿ç”¨ansibleæ§åˆ¶è¢«æ§ç«¯æ‰§è¡ŒæŒ‡ä»¤çš„æ—¶å€™ï¼Œä»–ä¼šå…ˆå°†å†…å®¹æ”¾åœ¨local_tmpæ–‡ä»¶ä¸­ï¼Œç„¶åä¸Šä¼ åˆ°è¢«æ§ç«¯å¹¶ç”Ÿæˆremote_tmpä¸Šæ‰§è¡Œã€‚æ‰§è¡Œå®Œæˆä¹‹åä¼šåˆ é™¤è¿™ä¸¤ä¸ªtmpæ–‡ä»¶ library = /usr/share/my_modules/ åº“å­˜æ”¾åœ°å€ forks = 5 é»˜è®¤å¹¶å‘æ•° sudo_user = root é»˜è®¤sudo ç”¨æˆ· ask_sudo_pass = True æ¯æ¬¡æ‰§è¡Œansibleæ˜¯å¦è¯¢é—®sshå¯†ç  ask_pass = True remote_port = 22 host_key_checking = False æ£€æŸ¥å¯¹åº”æœåŠ¡å™¨çš„host_key â€”â€“>å»ºè®®å–æ¶ˆæ³¨é‡Š log_path=/var/log/ansible.log æ—¥å¿—æ–‡ä»¶ å‘½ä»¤ansible-doc è¯´æ˜æ–‡æ¡£ansible-doc [options] [module..]-a æ˜¾ç¤ºæ‰€æœ‰æ¨¡å—çš„æ–‡æ¡£ å‚æ•°å°½é‡æ”¾åœ¨å•å¼•å·é‡Œé¢-l â€“list åˆ—å‡ºå¯ç”¨æ¨¡å—-s â€“snippet xxx æ˜¾ç¤ºxxxæ¨¡å—çš„playbookç‰‡æ®µ roleæ‰©å±•æ¨¡å—ansible-galaxyä¸“é—¨æœ‰ä¸€ä¸ªç½‘ç«™æä¾›ä¸åŒç”¨æˆ·ä¸Šä¼ çš„â€è§’è‰²â€åœ°å€:https://galaxy.ansible.com/ # åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„galaxyansible-galaxy list# å®‰è£…galaxyansible-galaxy install xxx# åˆ é™¤galaxyansible-galaxy remove xxx roleé»˜è®¤å®‰è£…è·¯å¾„ä¸º/etc/ansible/roles/ä¸‹ ansibleåˆ—å‡ºæŒ‡å®šç»„åˆ«çš„hoståˆ—è¡¨ansible appsevr â€“list-hostsåˆ—å‡ºæ‰€æœ‰åˆ—è¡¨çš„hostansible all â€“list-hostsansible all â€“listæ”¯æŒé€šé…ç¬¦åŒ¹é…hostansible *serv â€“listå¤šIPæ‰¹é‡æ‰§è¡Œansible 192.168.0.1,192.168.0.2 -m pingå¤šç»„åˆ«æ‰¹é‡æ‰§è¡Œ(é€»è¾‘æˆ–å…³ç³»,åˆå¹¶ï¼ŒAå’ŒBæ‰€æœ‰)ansible websevr:appsevr -m ping(é€»è¾‘ä¸å…³ç³»,åŒºåˆ†,åœ¨Aä¸­,ä¹Ÿåœ¨Bä¸­)ansible â€œwebsevr:&appsevrâ€ -m ping(é€»è¾‘é,åœ¨Aä¸­ä¸åœ¨Bä¸­,æ­¤å¤„å¿…é¡»è¦ç”¨å•å¼•å·)ansible â€˜websevr:!appsevrâ€™ -m ping ansible [-m module_name] [-a args]â€“version æ˜¾ç¤ºç‰ˆæœ¬-m module æŒ‡å®šæ¨¡æ¿,é»˜è®¤ä¸ºcommand-v è¯¦ç»†è¿‡ç¨‹ -vv -vvvæ›´è¯¦ç»†â€“list â€“list-hosts æ˜¾ç¤ºä¸»æœºåˆ—è¡¨ï¼Œ-k â€“ask-pass æç¤ºè¾“å…¥sshè¿æ¥å¯†ç ï¼Œé»˜è®¤ä¸ºkeyéªŒè¯-K â€“ask-become-pass æç¤ºè¾“å…¥sudoæ—¶çš„å£ä»¤-C â€“check æ£€æŸ¥ï¼Œå¹¶ä¸æ‰§è¡Œ-T â€“timeout=TIMEOUT æ‰§è¡Œå‘½ä»¤çš„è¶…æ—¶æ—¶é—´,é»˜è®¤ä¸º10s-u â€“user=REMOTE_USER æ‰§è¡Œè¿œç¨‹æ‰§è¡Œçš„ç”¨æˆ·-b â€“become ä»£æ›¿æ—§ç‰ˆçš„sudoåˆ‡æ¢ (é»˜è®¤ä¸ºansible.cfgé‡Œé¢è®¾ç½®çš„ç”¨æˆ·,ä¸€èˆ¬ä¸ºroot)-a æŒ‡å®šå‚æ•° ansible -må‘½ä»¤æ¨¡å—commandåœ¨commandä¸­,æˆ‘ä»¬å¯ä»¥åˆ›å»ºæ–‡ä»¶ï¼Œä½†æ˜¯å¯¹äºæ–‡ä»¶çš„æ“ä½œ,æœ‰ä¸€ä¸ªä¸“é—¨çš„fileæ¨¡å— # åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ansible -m command -a 'mkdir \\data'# æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦åˆ›å»ºæˆåŠŸansible -m command -a 'ls -al \\data'# æŸ¥çœ‹commandå¸®åŠ©ansible-doc command shellå¦‚æœ-a åå¸¦çš„å‚æ•°ä¸­å‡ºç° $ < > | ; & ç­‰å­—ç¬¦ï¼Œcommandæ˜¯ä¸æ”¯æŒçš„ï¼Œéœ€è¦ç”¨åˆ°shell æ¨¡å— # è¾“å‡ºä¸»æœºåå­—ansible 192.168.1.3 -m shell -a 'echo $HOSTNAME' ansibleå‘½ä»¤æ‰§è¡Œæµç¨‹1.åŠ è½½è‡ªå·±çš„é…ç½®æ–‡ä»¶ é»˜è®¤ä¸º/etc/ansible/ansible.cfg2.åŠ è½½è‡ªå·±å¯¹åº”çš„æ¨¡å—æ–‡ä»¶,å¦‚command3.é€šè¿‡ansibleå°†æ¨¡å—æˆ–å‘½ä»¤ç”Ÿæˆå¯¹åº”çš„ä¸´æ—¶pyæ–‡ä»¶,å¹¶å°†æ–‡ä»¶ä¼ è¾“è‡³è¿œç¨‹æœåŠ¡å™¨çš„å¯¹åº”æ‰§è¡Œç”¨æˆ·$HOME/.ansible/tmp/ansible-tmp-æ•°å­—/xxx.pyæ–‡ä»¶4.å¢åŠ æ–‡ä»¶çš„æ‰§è¡Œæƒé™5.æ‰§è¡Œå¹¶è¿”å›ç»“æœ6.åˆ é™¤ä¸´æ—¶pyæ–‡ä»¶,sleep 0é€€å‡ºæ‰§è¡ŒçŠ¶æ€:ç»¿è‰² æ‰§è¡ŒæˆåŠŸå¹¶ä¸”ä¸éœ€è¦åšæ”¹å˜çš„æ“ä½œé»„è‰² æ‰§è¡ŒæˆåŠŸä½†æ˜¯å¯¹ç›®æ ‡ä¸»æœºåšäº†ä¿®æ”¹çº¢è‰² æ‰§è¡Œå¤±è´¥(é¢œè‰²å†…å®¹åœ¨/etc/ansible.cfgé‡Œé¢ä¿®æ”¹) ç”Ÿæˆsshssh-keygenå¤åˆ¶sshå¯†é’¥åˆ°å…¶ä»–ä¸»æœºssh-copy-id ä¸»æœºip æ¨¡å—ç”±äºAnsibleçš„æ¨¡å—è¿‡å¤šï¼Œå°†è¿‘æœ‰1378ä¸ªæ¨¡å—æ•°é‡,ä½†æ˜¯æ¯ä¸ªæ¨¡å—çš„ä»‹ç»ä»¥åŠä½¿ç”¨æ–¹æ³•éƒ½å­˜æ”¾åœ¨/usr/bin/ansible-docå½“ä¸­ # æŸ¥çœ‹å½“å‰ansibleæ¨¡å—æ•°é‡ansible-doc -l | wc -l# ansible-docçš„ä½¿ç”¨æ–¹æ³•ansible-doc [options] [module..]-a æ˜¾ç¤ºæ‰€æœ‰æ¨¡å—çš„æ–‡æ¡£ å‚æ•°å°½é‡æ”¾åœ¨å•å¼•å·é‡Œé¢-l --list åˆ—å‡ºå¯ç”¨æ¨¡å—-s --snippet xxx æ˜¾ç¤ºxxxæ¨¡å—çš„playbookç‰‡æ®µ# ä½¿ç”¨-mæŒ‡å®šæ¨¡å—ï¼Œé»˜è®¤ä¸ºcommandansible -m command commandåœ¨commandä¸­,æˆ‘ä»¬å¯ä»¥åˆ›å»ºæ–‡ä»¶ï¼Œä½†æ˜¯å¯¹äºæ–‡ä»¶çš„æ“ä½œ,æœ‰ä¸€ä¸ªä¸“é—¨çš„fileæ¨¡å— # åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ansible -m command -a 'mkdir \\data'# æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦åˆ›å»ºæˆåŠŸansible -m command -a 'ls -al \\data'# æŸ¥çœ‹commandå¸®åŠ©ansible-doc command shellå¦‚æœ-a åå¸¦çš„å‚æ•°ä¸­å‡ºç° $ < > | ; & ç­‰å­—ç¬¦ï¼Œcommandæ˜¯ä¸æ”¯æŒçš„ï¼Œéœ€è¦ç”¨åˆ°shell æ¨¡å— # è¾“å‡ºä¸»æœºåå­—ansible 192.168.1.3 -m shell -a 'echo $HOSTNAME' scriptæ—¢ç„¶ansibleå¯ä»¥å¯¹å¤šå°ä¸»æœºè¿›è¡Œæ‰¹é‡çš„æ“ä½œï¼Œé‚£å¾€å¾€æˆ‘ä»¬ä¼šé‡åˆ°ä¸€ä¸ªåœºæ™¯ï¼Œå³éœ€è¦æˆ‘ä»¬åœ¨å¤šå°ä¸»æœºä¸Šæ‰§è¡Œä¸€ä¸ªè„šæœ¬ï¼Œè¿™ä¸ªåœºæ™¯ä¸‹æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ–¹æ³•:1.å°†è„šæœ¬æ–‡ä»¶å¤åˆ¶åˆ°å¤šå°ä¸»æœºä¸Šå,è°ƒç”¨ansibleä½¿ç”¨2.ä½¿ç”¨scriptæ¨¡å—ï¼Œä»…åœ¨æ§åˆ¶ç«¯å­˜åœ¨è„šæœ¬æ–‡ä»¶å³å¯ # æ–¹æ³•ä¸€,å…ˆå°†æ–‡ä»¶å‘åˆ°å¯¹åº”æ§åˆ¶ç«¯ä¸»æœºansible 192.168.1.3 -m command -a '/root/ansible_test.sh'# æ–¹æ³•äºŒroot@DESKTOP-GT1K5L0:~# ansible 192.168.1.3 -m script -a '/root/ansible_test.sh'192.168.1.3 | SUCCESS => { \"changed\": true, \"rc\": 0, \"stderr\": \"Shared connection to 192.168.1.3 closed\", \"stdout\": \"to do it,ansible\", \"stdout_lines\": [ \"to do it,ansible\" ]} Copyåœ¨ä¸Šé¢æˆ‘ä»¬æåˆ°äº†ä»æ§åˆ¶ç«¯ä¼ è¾“æ–‡ä»¶åˆ°è¢«æ§ç«¯,æ—¢ç„¶æ˜¯æ‰¹é‡çš„æ“ä½œ,é‚£ä¹ˆåœ¨ansibleä¸­åŒæ ·å­˜åœ¨ä¸€ä¸ªcopyçš„æ¨¡å—,å¯ä»¥ç”¨æ¥ä¼ è¾“æ–‡ä»¶åœºæ™¯: å…³é—­å¤šå°ä¸»æœºçš„selinuxæµç¨‹: å¤åˆ¶æ§åˆ¶ç«¯selinuxçš„é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹åå‘é€åˆ°è¢«æ§åˆ¶ç«¯ æ³¨æ„:è¿™é‡Œçš„hoè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªä¸»æœºç¾¤ åœ¨/etc/ansible/hostsä¸­å·²ç»æ·»åŠ äº† # æŸ¥çœ‹æ§åˆ¶ç«¯selinuxçŠ¶æ€getenforce# æŸ¥çœ‹è¢«æ§ç«¯selinuxçŠ¶æ€[root@localhost ~]# ansible ho -m command -a 'getenforce'192.168.1.6 | SUCCESS | rc=0 >>Enforcing192.168.1.7 | SUCCESS | rc=0 >>Enforcing192.168.1.5 | SUCCESS | rc=0 >>Enforcing192.168.1.4 | SUCCESS | rc=0 >>Enforcing# å¤åˆ¶selinuxé…ç½®æ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹é…ç½®cp /etc/selinux/config .SELINUX=disabled# å¤åˆ¶é…ç½®æ–‡ä»¶åˆ°è¢«æ§ç«¯æŒ‡å®šè·¯å¾„,å¹¶åšå¥½å¤‡ä»½ansible ho -m copy -a'src=/root/hzj/config dest=/etc/selinux/config backup=yes'# æŸ¥çœ‹è¢«æ§ç«¯æ˜¯å¦ç”Ÿæˆå¤‡ä»½æ–‡ä»¶ansible ho -m command -a 'ls /etc/selinux/'# é‡å¯ansible ho -m command -a 'reboot'# æŸ¥çœ‹è¢«æ§ç«¯selinuxæ˜¯å¦ä¿®æ”¹å®Œæˆansible ho -m command -a 'getenforce'[root@localhost hzj]# ansible ho -m command -a 'getenforce'192.168.1.7 | SUCCESS | rc=0 >>Disabled192.168.1.4 | SUCCESS | rc=0 >>Disabled192.168.1.5 | SUCCESS | rc=0 >>Disabled192.168.1.6 | SUCCESS | rc=0 >>Disabled fetchansibleæ”¯æŒä»è¢«æ§ç«¯æŠ“å–æ–‡ä»¶åˆ°æ§åˆ¶ç«¯,æŠ“å–åçš„æ ¼å¼ä¸º\\example.com\\destsrcè¡¨ç¤ºæŠ“å–è·¯å¾„destè¡¨ç¤ºå­˜æ”¾è·¯å¾„ # å¤åˆ¶æ‰€æœ‰ä¸»æœºçš„æ—¥å¿—åˆ°æ§åˆ¶ç«¯ansible ho -m fetch -a 'src=/var/log/messages dest=/root/data' ä½†æ˜¯fetchä»…æ”¯æŒå•ä¸ªæ–‡ä»¶çš„æŠ“å–ï¼Œå½“æˆ‘ä»¬æƒ³è¦æŠ“å–å¤šä¸ªæ—¥å¿—æ–‡ä»¶æ—¶ï¼Œå¯ä»¥å…ˆè¿›è¡Œæ‰“åŒ… fileè®¾ç½®æ–‡ä»¶çš„å±æ€§ # åˆ›å»ºæ–‡ä»¶ansible ho -m file -a 'name=/data/f3 state=touch'# åˆ é™¤æ–‡ä»¶ansible ho -m file -a 'name=/data/f3 state=absent'# åˆ›å»ºæ–‡ä»¶å¤¹ansible ho -m file -a 'name=/data/f3 state=directory'# åˆ é™¤æ–‡ä»¶å¤¹ansible ho -m file -a 'name=/data/f3 state=absent'# åˆ›å»ºè½¯è¿æ¥ansible ho -m file -a 'src=/root/test name=/data/fq state=link'# ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœä½ åˆ›å»ºäº†æ–‡ä»¶f3 å½“ä½ åˆ›å»ºæ–‡ä»¶å¤¹f3çš„æ—¶å€™ä¼šå‡ºç°é”™è¯¯ hostnameä¿®æ”¹ä¸»æœºå ansible ho -m hostname -a 'name=node'# é‡å¯åç”Ÿæ•ˆ cron# ç»™æ¯å°ä¸»æœºæ·»åŠ ä»»åŠ¡,nameä¸ºæ³¨é‡Šansible ho -m cron -a 'minute=* weekday=1,3,5,7 job=\"usr/bin/wall message\" name=test'# å–æ¶ˆä»»åŠ¡ansible ho -m cron -a 'disabled=true job=\"usr/bin/wall message\" name=test'# é‡æ–°å¯ç”¨ansible ho -m cron -a 'disabled=no job=\"usr/bin/wall message\" name=test'# åˆ é™¤æŸæ¡ä»»åŠ¡ansible ho -m corn -a 'jon=\"usr/bin/wall message\" state=absent' yum# nameæŒ‡å®šåŒ… stateæŒ‡å®šçŠ¶æ€ansible ho -m yum -a 'name=httpd state=latest' å®‰è£…ansible ho -m yum -a 'name=httpd state=absent' åˆ é™¤ Service# å…³é—­æœåŠ¡ nameæŒ‡å®šæœåŠ¡åç§° stateæŒ‡å®šçŠ¶æ€ansible ho -m service -a 'name=httpd state=stopped'ansible ho -m service -a 'name=httpd state=started'ansible ho -m service -a'name=httpd state=reloaded'ansible ho -m service -a'name=httpd state=restarted' Useransible ho -m user -a 'name=user comment=\"test user\" uid=2048 home=/app/user group=root'ansible ho -m user -a 'name=sysuser system=yes home=/app/syseser1'ansible ho -m user -a 'name=user state=absent remove=yes' åˆ é™¤ç”¨æˆ·ä»¥åŠå®¶ç›®å½•ç­‰æ•°æ® playbookçš„ç¼–å†™éšç€å·¥ä½œçš„å¢åŠ ,å•æ¡ansibleå‘½ä»¤(adhoc)å·²ç»ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚.äºæ˜¯æˆ‘ä»¬å¯ä»¥æŠŠå¤šæ¡ansibleå‘½ä»¤å†™å…¥playbookä¸­,è®©ç³»ç»Ÿæ ¹æ®playbookä¸­çš„é¡ºåºä¾æ¬¡æ‰§è¡Œansibleã€‚æˆ‘ä»¬æŠŠå®ƒå«åšå‰§æœ¬ Playbookçš„ç¼–å†™æ–¹å¼Playbookçš„ç¼–å†™æ ¼å¼é‡‡ç”¨çš„æ˜¯yamlè¯­è¨€url: http://www.ruanyifeng.com/blog/2016/07/yaml.htmlurl2: https://www.jianshu.com/p/97222440cd08urs3: https://yaml.org/ å¤šç§è¯­è¨€å®ç°yaml ç®€å•çš„ä»‹ç»ä¸€ä¸‹yamlè¯­è¨€çš„ä½¿ç”¨ 1. åœ¨å•ä¸€æ¡£æ¡ˆä¸­,å¯ä»¥ç”¨è¿ç»­çš„è¿å­—ç¬¦(---)åŒºåˆ†å¤šä¸ªæ¡£æ¡ˆã€‚å¦å¤–ï¼Œè¿˜æœ‰é€‰æ‹©æ€§çš„è¿ç»­ä¸‰ä¸ªç‚¹å·(...)ç”¨æ¥è¡¨ç¤ºæ¡£æ¡ˆç»“å°¾2. æ¬¡è¡Œå¼€å§‹æ­£å¸¸å†™Playbookçš„å†…å®¹ï¼Œä¸€èˆ¬å»ºè®®å†™æ˜è¯¥playbookçš„åŠŸèƒ½3. ä½¿ç”¨#å·æ³¨é‡Šä»£ç 4. ç¼©è¿›ç»Ÿä¸€ç”¨tab5. ä¸€ä¸ªå®Œæ•´çš„ä»£ç å—åŠŸèƒ½æœ€å°‘çš„å…ƒç´ éœ€è¦åŒ…æ‹¬name:task6. ä¸€ä¸ªnameåªèƒ½åŒ…æ‹¬ä¸€ä¸ªtask7. yamlæ–‡ä»¶æ‰©å±•åé€šå¸¸ä¸ºymlæˆ–è€…yaml playbookä¾‹å­ ---- hosts: webservers vars: http_port: 80 max_clients: 200 remote_user: root tasks: - name: ensure apache is at the latest version yum: pkg=httpd state=latest - name: write the apache config file template: src=/srv/httpd.j2 dest=/etc/httpd.conf notify: - restart apache - name: ensure apache is running service: name=httpd state=started handlers: - name: restart apache service: name=httpd state=restarted playbookæ ¸å¿ƒå…ƒç´  Hosts æ‰§è¡Œçš„è¿œç¨‹ä¸»æœºåˆ—è¡¨ Tasks ä»»åŠ¡é›† Varniables å†…ç½®å˜é‡æˆ–è‡ªå®šä¹‰å˜é‡åœ¨playbookä¸­è°ƒç”¨ Templates æ¨¡æ¿,å¯æ›¿æ¢æ¨¡æ¿æ–‡ä»¶ä¸­çš„å˜é‡å¹¶å®ç°ä¸€äº›ç®€å•é€»è¾‘çš„æ–‡ä»¶ Handlers å’Œ notity ç»“åˆä½¿ç”¨,ç”±ç‰¹å®šæ¡ä»¶è§¦å‘çš„æ“ä½œï¼Œæ»¡è¶³æ¡ä»¶æ–¹æ‰æ‰§è¡Œ,å¦åˆ™ä¸æ‰§è¡Œ tags æ ‡ç­¾ æŒ‡å®šæŸæ¡ä»»åŠ¡æ‰§è¡Œ,ç”¨äºé€‰æ‹©è¿è¡Œplaybookä¸­çš„éƒ¨åˆ†ä»£ç ã€‚ansibleå…·æœ‰å¹‚ç­‰æ€§,å› æ­¤ä¼šè‡ªåŠ¨è·³è¿‡æ²¡æœ‰å˜åŒ–çš„éƒ¨åˆ†ï¼Œå³ä¾¿å¦‚æ­¤ï¼Œæœ‰äº›ä»£ç ä¸ºæµ‹è¯•å…¶ç¡®å®æ²¡æœ‰å‘ç”Ÿå˜åŒ–çš„æ—¶é—´ä¾ç„¶ä¼šå¾ˆé•¿ã€‚å› æ­¤å¯ä»¥ä½¿ç”¨tagsè·³è¿‡ä¸€äº›ä»£ç ç‰‡æ®µã€‚ansible-playbook -t tagsname useradd.yml adhoc å’Œ playbook å¯¹æ¯” # adhoc æ”¹å˜ä¸»æœºåå­—ansible ho -m hostname -a 'name=xxx'# playboot ä¿®æ”¹ä¸»æœºåå­—---- host: ho remote_user: root tasks: - name: hello hostname: name=node å¤šæ¡adhoc å’Œplaybookå¯¹æ¯” # adhoc ansible ho -m file -a 'name=/data/newfile state=touch' # åˆ›å»ºæ–‡ä»¶ansible ho -m user -a 'name=test2 system=yes shell=/sbin/nologin' # åˆ›å»ºç”¨æˆ·ansible ho -m yum -a 'name=httpd' # å®‰è£…httpdansible ho -m copy -a 'src=/var/www/html/index.html dest=/var/www/html' # å¤åˆ¶æ–‡ä»¶ansible ho -m service -a 'name=httpd state=started enabled=yes' # å¯åŠ¨æœåŠ¡# playbook- hosts: ho remote_user: root tasks: - name: create file file: name=/data/newfile state=touch - name: create user file: name=test2 system=yes shell=/sbin/nologin - name: install httpd yum: name=httpd - name: copy file copy: src=/var/www/html/index.html dest=/var/www/html - name: start service service: name=httpd state=started enabled=yes shellè„šæœ¬ä¸playbookå¯¹æ¯” # shellè„šæœ¬#!/bin/bash# å®‰è£…Apacheyum install --quiet -y httpd# å¤åˆ¶é…ç½®æ–‡ä»¶cp /tmp/httpd.conf /etc/httpd/conf/httpd.confcp /tmp/vhosts.conf /etc/httpd/conf.d/# å¯åŠ¨Apache å¹¶è®¾ç½®å¼€æœºå¯åŠ¨systemctl start httpd.servicechkconfig httpd on# playbook---- host: all tasks: - name: \"å®‰è£…Apache\" yum: name=httpd - name: \"å¤åˆ¶é…ç½®æ–‡ä»¶\" copy: src=/tmp/httpd.conf dest=/etc/httpd/conf/ - name: \"å¤åˆ¶æ–‡ä»¶\" copy: src=/tmp/vhosts.conf dest=/etc/httpd/conf.d/ - name: \"å¯åŠ¨Apache,å¹¶è®¾ç½®å¼€æœºå¯åŠ¨\" service: name=httpd state=started enabled=yes æ‰§è¡Œæµç¨‹playçš„ä¸»ä½“éƒ¨åˆ†æ˜¯task list ã€‚ task list ä¸­çš„å„ä»»åŠ¡æŒ‰æ¬¡åºé€ä¸ªåœ¨hostsä¸­æŒ‡å®šçš„æ‰€æœ‰ä¸»æœºä¸Šæ‰§è¡Œï¼Œå³åœ¨æ‰€æœ‰ä¸»æœºä¸Šå®Œæˆç¬¬ä¸€ä¸ªä»»åŠ¡ååœ¨å¼€å§‹ç¬¬äºŒä¸ªï¼Œåœ¨è¿è¡Œè‡ªä¸Šè€Œä¸‹æŸä¸€ä¸ªplaybookæ—¶ï¼Œå¦‚æœä¸­é€”å‘ç”Ÿé”™è¯¯ï¼Œæ‰€æœ‰å·²æ‰§è¡Œä»»åŠ¡éƒ½å°†å›æ»šï¼Œå› æ­¤ï¼Œåœ¨æ›´æ­£playbookåé‡æ–°æ‰§è¡Œä¸€æ¬¡å³å¯ å¿½ç•¥é”™è¯¯ä¿¡æ¯ task:- name: copy file copy: src=/root/file dest=/root/ || /bin/true# æˆ–è€…task:- name: copy file copy: src=/root/file dest=/root/ ignore_erros: True playbookè¿è¡Œæ–¹å¼ansible-playbook [options]--check åªæ£€æµ‹å¯èƒ½ä¼šå‘ç”Ÿçš„æ”¹å˜ï¼Œä½†ä¸çœŸæ­£æ‰§è¡Œæ“ä½œ--list-hosts åˆ—å‡ºè¿è¡Œä»»åŠ¡çš„ä¸»æœº--limit ä¸»æœºåˆ—è¡¨ åªé’ˆå¯¹ä¸»æœºåˆ—è¡¨ä¸­çš„ä¸»æœºæ‰§è¡Œ-v æ˜¾ç¤ºè¿‡ç¨‹ -vv -vvvæ˜¾ç¤ºæ›´è¯¦ç»† Playbookå‰§æœ¬ansible-playbookæ˜¯ansibleä¸­çš„ä¸€ä¸ªå·¥å…·,å­˜æ”¾åœ¨/usr/bin/ansible-playbook å…¶ä»– æ¨¡å—https://www.cnblogs.com/f-ck-need-u/p/7550603.htmlhttps://docs.ansible.com/ansible/2.6/modules/list_of_all_modules.html ansibleæ¨¡å—å¼€å‘https://www.jianshu.com/p/f72b79b0d3f9","link":"/posts/ea06c230/"},{"title":"django ç”¨æˆ·","text":"djangoç”¨æˆ·djangoä¸ºå¼€å‘è€…æä¾›äº†ä¸‰ç§ä¸åŒçš„ç”¨æˆ·å½¢å¼ï¼Œä¸€ç§æ˜¯è‡ªå¸¦çš„ç”¨æˆ·æ¨¡å‹(User),å¦å¤–ä¸¤ç§æ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ç”¨æˆ·æ¨¡å‹ï¼Œåˆ†åˆ«æ˜¯(AbstractUser)(AbstractBaseUser),ä»–ä»¬çš„ç»§æ‰¿å…³ç³»åˆ†åˆ«æ˜¯ User ç»§æ‰¿å­AbstractUser ç»§æ‰¿è‡ªAbstractBaseUser djangoè‡ªå¸¦çš„ç”¨æˆ·æ¨¡å‹ä½¿ç”¨djangoè‡ªå¸¦çš„ç”¨æˆ·æ¨¡å‹(å¿«é€Ÿå®ç°)ï¼Œè¯¥æ¨¡å‹æä¾›äº†ä¸€äº›å¼€å‘è¿‡ç¨‹ä¸­ä¼šç»å¸¸ä½¿ç”¨åˆ°çš„å‚æ•°ï¼Œæ¯”å¦‚ç”¨æˆ·çº§åˆ«ï¼Œåå­—ï¼Œé‚®ç®±ï¼Œå¯†ç ç­‰ç­‰ã€‚æˆ‘ä»¬å¯ä»¥åœ¨$\\color{red}{from django.contrib.auth.models import User}$ä¸­æŸ¥çœ‹Userçš„ä½¿ç”¨ class User(AbstractUser): \"\"\" Users within the Django authentication system are represented by this model. Username and password are required. Other fields are optional. \"\"\" class Meta(AbstractUser.Meta): swappable = 'AUTH_USER_MODEL' è‡ªå®šä¹‰User Modelè‡ªå®šä¹‰Usermodeléœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ$\\color{red}{éœ€è¦åœ¨setting.pyä¸­æ·»åŠ AUTH_USER_MODEL}$ ï¼Œç”±äºdjangoå¯»æ‰¾ç”¨æˆ·çš„æ–¹å¼æ˜¯åœ¨setting.pyä¸­å¯»æ‰¾è¿™ä¸ªæ ‡ç¤ºï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ—¶å€™éœ€è¦æ·»åŠ è¿™ä¸ªå†…å®¹ # pro/setting.pyfrom app.model import .AUTH_USER_MODEL=\"app.modelname\" å…¶ä»–éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œè¯·çœ‹æ–‡ç« åº•éƒ¨æ³¨æ„æ  æ–¹æ³•ä¸€ï¼šæ‰©å±•AbstractUserå¦‚æœä½ è§‰å¾—djangoè‡ªå¸¦çš„ç”¨æˆ·ä¸èƒ½æ»¡è¶³ä½ æ‰€éœ€è¦çš„å­—æ®µï¼Œéœ€è¦é¢å¤–æ·»åŠ å­—æ®µçš„è¯ï¼Œä½ å¯ä»¥ä½¿ç”¨AbstractUser # pro/app/models.pyfrom django.contrib.auth.models import AbstractUserfrom django.db import modelsclass NewUser(AbstractUser): new_field = models.CharField(max_length=100)# pro/setting.pyAUTH_USER_MODEL=\"app.modelname\" æ–¹æ³•äºŒï¼šæ‰©å±•AbstractBaseUserAbstractBaseUserä¸­åªå«æœ‰3ä¸ªfield: password, last_loginå’Œis_active. å¦‚æœä½ å¯¹django user modelé»˜è®¤çš„first_name, last_nameä¸æ»¡æ„, æˆ–è€…åªæƒ³ä¿ç•™é»˜è®¤çš„å¯†ç å‚¨å­˜æ–¹å¼, åˆ™å¯ä»¥é€‰æ‹©è¿™ä¸€æ–¹å¼ è‡ªå®šä¹‰å½¢å¼å¦‚AbstarctUserä¸€æ · ä½¿ç”¨AbstractBaseUseræ—¶ï¼Œè™½ç„¶ä»–æä¾›äº†Useræœ€æ ¸å¿ƒçš„å®ç°ï¼Œæ¯”å¦‚passwordï¼Œä½†æ˜¯æˆ‘ä»¬ä¾æ—§éœ€è¦æ·»åŠ ä¸€äº›å¿…é¡»å®šä¹‰çš„å…³é”®å­—æ®µå’Œæ–¹æ³• USERNAME_FIELDï¼Œç”¨æˆ·åç§°å­—æ®µï¼Œå¿…é¡»è®¾ç½®ï¼Œä¸” uniqe=True class UserProfile(AbstractBaseUser): author = models.CharField(max_length=40,unique=True) USERNAME_FIELD = 'author' REQUIRED_FIELDSï¼Œå½“é€šè¿‡createsuperuserç®¡ç†å‘½ä»¤åˆ›å»ºä¸€ä¸ªç”¨æˆ·æ—¶ï¼Œç”¨äºæç¤ºä¸€ä¸ªå­—æ®µåç§°åˆ—è¡¨,ä¸èƒ½åŒ…å«USERNAME_FIELDä»¥åŠpasswordå­—æ®µ # pro/models.pyclass UserProfile(AbstractBaseUser) date_of_birth = models.DateField() height = models.FloatField() REQUIRED_FIELDS=['date_of_birth','height'] is_active å¿…é¡»å®šä¹‰ã€‚ ä¸€ä¸ªå¸ƒå°”å±æ€§ï¼Œæ ‡è¯†ç”¨æˆ·æ˜¯å¦æ˜¯ â€œactiveâ€ çš„ã€‚AbstractBaseUseré»˜è®¤ä¸º Ture get_full_name()å¿…é¡»å®šä¹‰ã€‚ longæ ¼å¼çš„ç”¨æˆ·æ ‡è¯†ã€‚ get_short_name()å¿…é¡»å®šä¹‰ã€‚ shortæ ¼å¼çš„ç”¨æˆ·æ ‡è¯†ã€‚ å¯ç”¨æ–¹æ³•get_username()è¿”å› USERNAME_FIELD çš„å€¼ã€‚ is_anonymous()ä¸€ç›´è¿”å› Falseã€‚ç”¨æ¥åŒºåˆ† AnonymousUserã€‚ is_authenticated()ä¸€ç›´è¿”å› Tureã€‚ç”¨æ¥å‘Šè¯‰ç”¨æˆ·å·²è¢«è®¤è¯ã€‚ set_password(raw_password)è®¾ç½®å¯†ç ã€‚æŒ‰ç…§ç»™å®šçš„åŸå§‹å­—ç¬¦ä¸²è®¾ç½®ç”¨æˆ·çš„å¯†ç ï¼Œtaking care of the password hashingã€‚ ä¸ä¿å­˜ AbstractBaseUser å¯¹è±¡ã€‚å¦‚æœæ²¡æœ‰ç»™å®šå¯†ç ï¼Œå¯†ç å°±ä¼šè¢«è®¾ç½®æˆä¸ä½¿ç”¨ï¼ŒåŒç”¨set_unusable_password()ã€‚ check_password(raw_password)æ£€æŸ¥å¯†ç æ˜¯å¦æ­£ç¡®ã€‚ ç»™å®šçš„å¯†ç æ­£ç¡®è¿”å› Trueã€‚ set_unusable_password()è®¾ç½®useræ— å¯†ç ã€‚ ä¸åŒäºå¯†ç ä¸ºç©ºï¼Œå¦‚æœä½¿ç”¨ check_password()ï¼Œåˆ™ä¸ä¼šè¿”å›Trueã€‚ä¸ä¿å­˜AbstractBaseUser å¯¹è±¡ã€‚ has_usable_password()å¦‚æœè®¾ç½®äº†set_unusable_password()ï¼Œè¿”å›Falseã€‚ get_session_auth_hash()è¿”å›å¯†ç å­—æ®µçš„HMACã€‚ Used for Session invalidation on password change. âš ï¸æ³¨æ„1.åœ¨åˆ›å»ºä»»ä½•è¿ç§»æˆ–è€…ç¬¬ä¸€æ¬¡è¿è¡Œ manager.py migrate å‰è®¾ç½® AUTH_USER_MODELã€‚è®¾ç½®AUTH_USER_MODELå¯¹ä½ çš„æ•°æ®åº“ç»“æ„æœ‰å¾ˆå¤§çš„å½±å“ã€‚å®ƒæ”¹å˜äº†ä¸€äº›ä¼šä½¿ç”¨åˆ°çš„è¡¨æ ¼ï¼Œå¹¶ä¸”ä¼šå½±å“åˆ°ä¸€äº›å¤–é”®å’Œå¤šå¯¹å¤šå…³ç³»çš„æ„é€ ã€‚åœ¨ä½ æœ‰è¡¨æ ¼è¢«åˆ›å»ºåæ›´æ”¹æ­¤è®¾ç½®æ˜¯ä¸è¢« makemigrations æ”¯æŒçš„ï¼Œå¹¶ä¸”ä¼šå¯¼è‡´ä½ éœ€è¦æ‰‹åŠ¨ä¿®æ”¹æ•°æ®åº“ç»“æ„ï¼Œä»æ—§ç”¨æˆ·è¡¨ä¸­å¯¼å‡ºæ•°æ®ï¼Œå¯èƒ½é‡æ–°åº”ç”¨ä¸€äº›è¿ç§»ã€‚2.ç”±äºDjangoçš„å¯äº¤æ¢æ¨¡å‹çš„åŠ¨æ€ä¾èµ–ç‰¹æ€§çš„å±€é™ï¼Œä½ å¿…é¡»ç¡®ä¿ AUTH_USER_MODEL å¼•ç”¨çš„æ¨¡å‹åœ¨æ‰€å±appä¸­ç¬¬ä¸€ä¸ªè¿ç§»æ–‡ä»¶ä¸­è¢«åˆ›å»ºï¼ˆé€šå¸¸å‘½åä¸º 0001_initialï¼‰ï¼Œå¦åˆ™ä½ ä¼šç¢°åˆ°é”™è¯¯(The easiest way to construct a compliant custom User model is to inherit fromAbstractBaseUser. AbstractBaseUser provides the core implementation of a Usermodel, including hashed passwords and tokenized password resets. You must then provide some key implementation details:) å¼•ç”¨Userå¦‚æœä½ é€‰æ‹©äº†è‡ªå®šä¹‰ç”¨æˆ·ç±»å‹ï¼Œé‚£ä¹ˆå½“ä½ åœ¨view.pyä¸­å°è¯•ä½¿ç”¨å¤–é”®å¼•ç”¨ä»–çš„æ—¶å€™ï¼Œä½ ä¼šå‡ºç°é”™è¯¯ï¼Œä½ åº”è¯¥ä½¿ç”¨$\\color{red}{django.contrib.auth.get_user_modelæ¥å¼•ç”¨æ¨¡å‹} def get_user_model(): \"\"\" Return the User model that is active in this project. \"\"\" try: return django_apps.get_model(settings.AUTH_USER_MODEL, require_ready=False) except ValueError: raise ImproperlyConfigured(\"AUTH_USER_MODEL must be of the form 'app_label.model_name'\") except LookupError: raise ImproperlyConfigured( \"AUTH_USER_MODEL refers to model '%s' that has not been installed\" % settings.AUTH_USER_MODEL åŒæ ·çš„ï¼Œä»–ä¼šæ ¹æ®settingä¸­çš„AUTH_USER_MODELæ¥è¯†åˆ«å½“å‰ç”¨æˆ· from django.contrib.auth import get_user_modelUser = get_user_model æŒ‡å®šç”¨æˆ· # pro/app/models.pyclass UserProfile(models.Model): author = models.ForeignKey(setting.AUTH_USER_MODEL) https://www.cnblogs.com/huchong/p/9804635.html#_label0https://blog.csdn.net/qq_37049050/article/details/79211059","link":"/posts/f736b80/"},{"title":"djangoå­—æ®µæ€»ç»“","text":"djangoå­—æ®µçš„è®¾è®¡https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#module-django.db.models.fieldsormçš„è®¾è®¡æ¨¡å¼åœ¨djangoçš„åº”ç”¨è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€è¦è®¾è®¡modelçš„è®¾è®¡ï¼Œåœ¨modelè®¾è®¡è¿‡ç¨‹ä¸­è¦ä½¿ç”¨å„ç§å„æ ·çš„å…³é”®è¯ï¼Œè¿™äº›å…³é”®è¯ å…³è”åˆ°äº†æ•°æ®åº“ä¸­æ¯æ¡è®°å½•çš„é…ç½® # å¼•ç”¨from django.db import models é€šç”¨å­—æ®µnullå­—æ®µå¦‚æœè®¾ç½®ä¸º Trueï¼Œ å½“è¯¥å­—æ®µä¸ºç©ºæ—¶ï¼ŒDjango ä¼šå°†æ•°æ®åº“ä¸­è¯¥å­—æ®µè®¾ç½®ä¸ºNULLï¼Œé»˜è®¤ä¸º Falseã€‚å³æ•°æ®åº“ç½®ç©º å¦‚æœnull=true blank=true åˆ™æ•°æ®åº“å†…å®¹ä¸ºç©ºç™½å­—ç¬¦ä¸² blankField.blanké»˜è®¤blank = False ,å¦‚æœè®¾ç½®ä¸ºTrueï¼Œåˆ™å…è®¸è¯¥å­—æ®µä¸ºç©ºã€‚ä¸nullä¸åŒçš„æ˜¯,nullå­˜ç²¹ä¸æ•°æ®åº“æœ‰ç›¸å…³ï¼Œè€Œblankä¸éªŒè¯ç›¸å…³ã€‚å¦‚æœblank=true,åˆ™è¡¨å•éªŒè¯å°†å…è®¸è¾“å…¥ç©ºå€¼,å¦‚æœblank=False åˆ™ä¸å…è®¸è¾“å…¥ç©ºå€¼ choicesclass TaskSwitchModel(models.Model): ActionType = models.CharField(choices=[ ('snmp','_(snmp)'), (\"vlan\",\"_vlan\"), (\"sysname\",\"_sysname\"), (\"copyright-info\",\"_copyright-info\"), (\"int-vlan\",\"_int-vlan\"), (\"int\",\"_int\")],max_length=100,default=\"\") test = models.CharField(max_length=1, choices=[('A', ('Author')), ('E', ('Editor'))]), class TaskSwitchModel(model.ModelForm): choices=( ('snmp','_(snmp)'), (\"vlan\",\"_vlan\"), (\"sysname\",\"_sysname\"), (\"copyright-info\",\"_copyright-info\"), (\"int-vlan\",\"_int-vlan\"), (\"int\",\"_int\") ) ActionType = model.CharField(choices=choices,max_length=100,default=\"\") Field.choicesæ¯ä¸ªå…ƒç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯è¦åœ¨æ¨¡å‹ä¸Šè®¾ç½®çš„å®é™…å€¼ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯äººç±»å¯è¯»çš„åç§°. select_choices =[ ('A','A_'), ('B','B_'), ('C','C_'), ('D','D_'),]choiceså­—æ®µè¿­ä»£æ¯ä¸ªå…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯è¦åº”ç”¨äºç»„çš„åç§°ã€‚ç¬¬äºŒä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå¯è¿­ä»£çš„2ä»£å…ƒç»„select2_select1_choices=[ ('A',( ('A_/','A_movie'), ('A_+','A_video'), ('A_-','A_City'), ) ), ('Video', ( ('vhs', 'VHS Tape'), ('dvd', 'DVD'), ) ), ('unknown', 'Unknown'),] db_columnè®¾ç½®æ•°æ®åº“åˆ—çš„åç§° age = models.CharFiled(db_column=â€å¹´é¾„â€) db_indexage = models.CharFiled(db_index=true)å¦‚æœè®¾ç½®ä¸ºTrueï¼Œåˆ™åˆ›å»ºæ•°æ®åº“ç´¢å¼• defaultå¯ä»¥æ˜¯å€¼ä¹Ÿå¯ä»¥æ˜¯å¯è°ƒç”¨çš„å¯¹è±¡ï¼Œæ¯æ¬¡å®ä¾‹åŒ–æ¨¡å‹çš„æ—¶å€™ ä¼šè°ƒç”¨è¿™ä¸ªå¯¹è±¡æˆ–å€¼ # 1def contact_defult(): return {\"email\":\"1097690268@qq.com\"}contact_info = JSONField(\"ContactInfo\", default=contact_default)# 2member_name = CharFiled(default=\"å°æ˜\") editableå¯ç¼–è¾‘å­—æ®µå¦‚æœä¸ºFalseï¼Œåˆ™è¯¥å­—æ®µå°†ä¸ä¼šæ˜¾ç¤ºåœ¨ç®¡ç†å‘˜æˆ–å…¶ä»–ä»»ä½•äººä¸­ ModelFormã€‚åœ¨æ¨¡å‹éªŒè¯æœŸé—´ä¹Ÿå°†è·³è¿‡å®ƒä»¬ã€‚é»˜è®¤å€¼ä¸ºTrueã€‚ uniquename = CharFiled(unique=true)å¦‚ä¸Šåˆ™ä¼šä¿è¯è¯¥å­—æ®µçš„å€¼ä¸ºè¡¨ä¸­å”¯ä¸€ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šå‡ºç°åŒåçš„äººå¦‚æœå­˜åœ¨äº†unique åˆ™ä¸å†éœ€è¦db_index å› ä¸ºuniqueé»˜è®¤å­˜åœ¨ç´¢å¼• primary_keyå¦‚æœè®¾ç½®ä¸ºTrueï¼Œåˆ™åˆå§‹è®¾ç½®ä¸ºè¯¥æ¨¡å‹çš„ä¸»é”®ã€‚å¦‚æœæ‚¨æœªprimary_key=Trueåœ¨æ¨¡å‹ä¸­æŒ‡å®šä»»ä½•å­—æ®µï¼Œåˆ™Djangoä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªAutoFieldæ¥ä¿ç•™ä¸»é”®ï¼Œå› æ­¤primary_key=Trueæš—ç¤ºnull=Falseå’Œ unique=Trueã€‚ä¸€ä¸ªå¯¹è±¡åªå…è®¸ä½¿ç”¨ä¸€ä¸ªä¸»é”®ã€‚ä¸»é”®å­—æ®µæ˜¯åªè¯»çš„ã€‚å¦‚æœæ›´æ”¹ç°æœ‰å¯¹è±¡ä¸Šçš„ä¸»é”®çš„å€¼ç„¶åä¿å­˜ï¼Œåˆ™å°†åœ¨æ—§å¯¹è±¡çš„æ—è¾¹åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚ è‡ªå®šä¹‰çš„å­—æ®µhttps://docs.djangoproject.com/zh-hans/2.2/howto/custom-model-fields/","link":"/posts/65abc8f/"},{"title":"ä»»åŠ¡æµç¨‹-checklist","text":"ä»»åŠ¡æµç¨‹-checklist äº¤æ¢æœºä¸‹æ¶æµç¨‹ é¦–å…ˆçŸ¥é“å“ªäº›æœºå™¨è¦ä¸‹æ¶,çŸ¥é“ä»¥åç™»é™†ä¸Šå»çœ‹ä¸€ä¸‹äº¤æ¢æœºä¸Šä¸‹æ˜¯ä¸æ˜¯æœ‰æœºå™¨è¿˜è¿åœ¨ä¸Šé¢ï¼Œå¯ä»¥è®©æœºæˆ¿å¸®å¿™çœ‹ä¸€ä¸‹ æŸ¥çœ‹æ¥å£çš„æµé‡dis int bri xxxåƒè¿™ç§æ²¡å¤šå°‘æµé‡çš„åŸºæœ¬ä¸Šå°±æ˜¯æ²¡æœ‰æœºå™¨äº† æ‰¾åˆ°æœºæŸœ äº¤æ¢æœºå‹å· å‘ç»™å•†åŠ¡ï¼Œ å•†åŠ¡å‘å·¥å•ç»™æœºæˆ¿ä¸‹æ¶ å®Œäº‹ inventoryä¸Šæ¶æµç¨‹æ‹‰å–é¡¹ç›®git clone https://gitlab.s.upyun.com/infrastructure/inventory.gigit clone https://gitlab.s.upyun.com/infrastructure/inventory.git æŸ¥çœ‹å½“å‰åˆ†æ”¯git branch åˆ‡æ¢åˆ†æ”¯git checkout hzj ä¿®æ”¹å†…å®¹â€¦ ä¸Šä¼ git commit -am â€œupdateâ€git push åˆ°webç«¯åˆ›å»ºåˆå¹¶è¯·æ±‚ æ›´æ–°é¦–å…ˆåˆ‡æ¢åˆ°masterï¼Œæ‹‰å–æœ€æ–°git pullåˆ‡æ¢æ¬¡åˆ†æ”¯ git checkout hzjåˆå¹¶æ›´æ–°åˆ†æ”¯åˆ°hzjåˆ†æ”¯ git merge origin hzj å‘æ¶ˆæ¯ç»™æœ‰masteræƒé™çš„äººï¼Œäº¤ç”±masteræ¥åˆå¹¶","link":"/posts/b3883d25/"},{"title":"æ•°æ®åº“æ€»ç»“","text":"ç™»é™†æ•°æ®åº“ssh 10.0.6.55mysql -uroot -p>123456 mysql åŸºæœ¬æ“ä½œè¯­å¥æ•°æ®åº“è¯­å¥æ“ä½œ åˆ›å»ºä¸€ä¸ªåä¸º tc çš„æ•°æ®åº“ create database tc;æŸ¥çœ‹æœ‰å“ªäº›æ•°æ®åº“ show databases; æŸ¥çœ‹æ•°æ®åº“çš„åˆ›å»ºç»†èŠ‚ show create database tc; åˆ›å»ºä¸€ä¸ªä½¿ç”¨gbkå­—ç¬¦é›†çš„æ•°æ®åº“ create database tc set gck;ä¿®æ”¹å­—ç¬¦é›† alter database tc character set utf8;åˆ é™¤åˆ›å»ºçš„æŸä¸ªæ•°æ®åº“ drop database tc; è¡¨ç»“æ„ use tc; # åˆ‡æ¢æ•°æ®åº“create table employee(_id int,name varchar(100),gender varchar(20),birthday date,entry_day date,salary flot(8,2),resume text); # åˆ›å»ºå‘˜å·¥ä¿¡æ¯è¡¨show tables; # æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨show create table employee; # æŸ¥çœ‹è¡¨çš„åˆ›å»ºå¿ƒç»“alter table employee add image blob; # åœ¨å‘˜å·¥è¡¨ä¸Šæ·»åŠ imageåˆ—alter table employee modify job varchar(60); # ä¿®æ”¹å‘˜å·¥è¡¨ä¸­çš„jobåˆ—ï¼Œä½¿å…¶é•¿åº¦æˆ‘é¥¿60alter table employee drop image; åˆ é™¤imageåˆ—rename table employee to user; è¡¨åå­—ä¿®æ”¹ä¸ºuseralter table user character set gbk; ä¿®æ”¹è¡¨çš„å­—ç¬¦é›†ä¸ºutf-8 æŸ¥çœ‹è¡¨ # åˆ›å»ºä¸€ä¸ªå­¦ç”Ÿè¡¨create table student(id int primary key auto_increment,name varchar(20) unique not null ,chinese float,english float,math float);# å¾€å­¦ç”Ÿè¡¨ä¸­æ·»åŠ ä¸€äº›ä¿¡æ¯insert into student(name,chinese,english,math) values ('wangba',93,22,77)insert into student (name,chinese,english,math) values('lisi',80,90,29);insert into student (name,chinese,english,math) values('wangwu',55,99,98);insert into student (name,chinese,english,math) values('zhaoliu',99,30,57);insert into student (name,chinese,english,math) values('zhouqi',78,22,77);#æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯select * from user# æŸ¥è¯¢å­¦ç”Ÿå‘˜å·¥çš„å§“åå’Œå¯¹åº”çš„è‹±è¯­æˆç»©select name,english from student# è¿‡æ»¤è¡¨ä¸­çš„é‡å¤æ•°æ®select distinct english from student # åœ¨æ‰€æœ‰å­¦ç”Ÿåˆ†æ•°ä¸ŠåŠ 10åˆ†çš„ç‰¹é•¿åˆ† æ•°æ®åº“å¯è§†åŒ– navicatnavicatè¿æ¥è¿œç¨‹æœåŠ¡å™¨çš„å‡ ç§æ–¹å¼ ç›´æ¥è¿æ¥æ•°æ®åº“ Connection Name : hzj #éšä¾¿å†™ ä¸»è¦è®°å½•çš„ä¸Šè¿™æ¡è¿æ¥çš„åˆ«åHost 10.0.6.55 # è¿œç¨‹æœåŠ¡å™¨ipPort 3306 # ç«¯å£User Name root # æ•°æ®åº“è´¦å·Passwd #æ•°æ®åº“å¯†ç  å…ˆç™»é™†ssh ä¹‹ååœ¨è¿æ¥æœ¬åœ°çš„æ•°æ®åº“ å…ˆè¿æ¥ssh Host # è¿œç¨‹Port 22User Name # è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·åAuthentication Method # éªŒè¯æ–¹æ³•Private key # id_rsaPassphrase # éªŒè¯çŸ­å¯† é€‰æ‹©å¯†é’¥åè‡ªåŠ¨ç”Ÿæˆ å†è¿æ¥æ•°æ®åº“ Connection Name : hzj #éšä¾¿å†™ ä¸»è¦è®°å½•çš„ä¸Šè¿™æ¡è¿æ¥çš„åˆ«åHost localhost # è¿œç¨‹æœåŠ¡å™¨ipPort 3306 # ç«¯å£User Name root # æ•°æ®åº“è´¦å·Passwd #æ•°æ®åº“å¯†ç  å‡ºç°çš„é”™è¯¯ 2013 - Lost connection to MySQL server at 'reading initial communication packet', system error: 0 \"Internal error/check (Not system error)\" è§£å†³åŠæ³•https://www.jb51.net/article/51480.htm","link":"/posts/3086330/"},{"title":"gitåŸºç¡€","text":"æµç¨‹å·¥ä½œåŒº(æˆ‘ä»¬å½“å‰çš„æ–‡ä»¶å¤¹)æš‚å­˜åŒº(add æäº¤ä¹‹åæ–‡ä»¶æ‰€å­˜åœ¨çš„ä½ç½®)ä»“åº“(commit ä¹‹åå°†æš‚å­˜åŒºæäº¤åˆ°çš„åœ°æ–¹) é¦–å…ˆæ˜¯initåˆå§‹åŒ–æˆ‘ä»¬çš„å·¥ä½œåŒºï¼Œè¿™æ—¶å€™å½“å‰å­˜åœ¨.gitæ–‡ä»¶çš„å°±æ˜¯æˆ‘ä»¬çš„å·¥ä½œåŒºï¼Œå½“å‰è·¯å¾„ä¸ºæˆ‘ä»¬çš„æ ¹ç›®å½•åœ¨å·¥ä½œåŒºåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶test.txtï¼Œgit add ä¹‹åæ–‡ä»¶ä¸Šä¼ åˆ°æš‚å­˜åŒºï¼Œæˆ‘ä»¬å¯ä»¥ç”¨git status ä¼šè®°å½•å½“å‰æš‚å­˜åŒºçš„æ“ä½œgit diffå¯ä»¥æ¯”è¾ƒå·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„å·®å¼‚ï¼Œå½“ç„¶è¿™é‡Œæ˜¯æ²¡æœ‰ä»»ä½•å·®å¼‚çš„ï¼Œå› ä¸ºä»–ä»¬æ˜¯åŒæ ·çš„ä¸¤ä»½æ–‡ä»¶ä¿®æ”¹test.txt ä¹‹åå†å»git diff ä½ ä¼šå‘ç°ä»–ä»¬ä¹‹é—´å­˜åœ¨ç€å·®å¼‚ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™ä»–ä»¬å·²ç»ä¸æ˜¯åŒæ ·ä¸¤ä»½æ–‡ä»¶äº†å‡å¦‚ä½ å†æ¬¡ ä½¿ç”¨Git add . å†ç”¨git diff æ—¶åˆæ²¡æœ‰å·®å¼‚äº† å®‰è£…# ubuntusudo apt-get install git# centos yum install git -y# mac brew install git å…¨å±€å£°æ˜ç”¨æˆ·git config â€“global user.name â€œyour nameâ€git config â€“global user.email â€œxxx@xxx.comâ€œ å£°æ˜ä»“åº“ å¿…é¡»mkdir testcd testgit init ä¼šç”Ÿæˆä¸€ä¸ª.gitçš„ä»“åº“ç®¡ç†æ–‡ä»¶,å¦‚æœä½ ä½¿ç”¨äº†zshçš„ä¸»é¢˜ï¼Œä½ ä¼šå‘ç°å¤šäº†ä¸€ä¸ªmaster è¿™æ˜¯ä½ å½“å‰çš„åˆ†æ”¯ï¼Œä¹Ÿä»…ä»…åªæœ‰è¿™ä¸ªåˆ†æ”¯ git add . â€”> å°†æ–‡ä»¶æ”¾åˆ°æš‚å­˜åŒºgit commit â€”> å°†æ–‡ä»¶æäº¤åˆ°å½“å‰åˆ†æ”¯ master å£°æ˜ä»“åº“å†…å®¹ ä¸ä¸€å®šæ—¢ç„¶æ˜¯ä½œä¸ºå¼€æºå…±äº«çš„é¡¹ç›®æˆ–è€…è¯´æ˜¯çº¿ä¸Šå¤šå¹³å°äº¤äº’çš„ç§åº“ï¼Œé‚£ä¸€å®šéœ€è¦ä¸€ä¸ªä¸“é—¨è§£é‡Šè¿™ä¸ªä»“åº“æ˜¯åšä»€ä¹ˆçš„æ–‡ä»¶â€”> README.mdgit add README.md æäº¤å¹¶æä¾›ä¿¡æ¯å°†æ–‡ä»¶æäº¤åˆ°ä»“åº“ git commit -m \"your message\" æ·»åŠ æ–‡ä»¶git add xxx.txtgit add . #æ·»åŠ å½“å‰æ–‡ä»¶å¤¹æ‰€æœ‰æ–‡ä»¶ ``` ## æŸ¥çœ‹çŠ¶æ€git status```bash# æ·»åŠ æ–‡ä»¶åçš„çŠ¶æ€ alpaca@hzj î‚° ~/hzj/tu î‚° î‚  master â— î‚° git add README.md alpaca@hzj î‚° ~/hzj/tu î‚° î‚  master âœš î‚° git statusOn branch masterChanges to be committed: (use \"git reset HEAD ...\" to unstage) modified: README.md# æäº¤ commit åçš„çŠ¶æ€ alpaca@hzj î‚° ~/hzj/tu î‚° î‚  master âœš î‚° git commit -m \"update some file\"[master ff070f9] update some file 1 file changed, 2 insertions(+) alpaca@hzj î‚° ~/hzj/tu î‚° î‚  master î‚°# çŠ¶æ€ alpaca@hzj î‚° ~/hzj/tu î‚° î‚  master î‚° git statusOn branch masternothing to commit, working tree clean æŸ¥çœ‹æ—¥å¿—å½“ä½ æ¯ä¸€æ¬¡ä½¿ç”¨commit å°†æ–‡ä»¶æäº¤åˆ°å½“å‰åˆ†æ”¯çš„æ—¶å€™ï¼Œè®°å½•ä¸‹æ¯ä¸€ä¸ªæ­¥éª¤æŸ¥çœ‹ä½¿ç”¨ # æŸ¥çœ‹æ—¥å¿—git logcommit bb3c0e3a1e850af0c70d3ce3a22995eaae177e82 (HEAD -> master)Author: alpaca Date: Thu Nov 21 11:46:24 2019 +0800 updatecommit ff070f92dee18935752e5a98b2310d275e1191b6Author: alpaca Date: Thu Nov 21 11:42:58 2019 +0800 update some filecommit 230660d585a95b90e3c6176ad21664c1b10f746aAuthor: alpaca Date: Thu Nov 21 10:37:04 2019 +0800 update some markdown file# ä»…æŸ¥çœ‹ç‰ˆæœ¬å·git log --pretty=oneline# æŒ‡å®šç‰ˆæœ¬å· å¦‚æœä½ è£…äº†zsh æŒ‰tabå°±ä¼šå‡ºæ¥commit_idgit log commit_id ç”±éšæœºç (ç‰ˆæœ¬å·) + ä½œè€… + æ—¥æœŸ + commit_message ç»„æˆ å›é€€æ“ä½œç‰ˆæœ¬å›é€€ï¼Œé¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ä¸€ä¸ªäº‹æƒ… git log åªä¼šè®°å½•ä¸‹commitçš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¼ åˆ°å½“å‰åˆ†æ”¯çš„è¿‡ç¨‹ï¼Œå› æ­¤å›é€€æ“ä½œä»–å¹¶ä¸ä¼šè®°å½•ï¼Œä½†æ˜¯ä»–ä¼šé‡è½½ä¹‹å‰çš„logçŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯å½“ä½ ä¸€å…±æäº¤äº†3æ¬¡å†…å®¹ï¼Œä½ å›é€€åˆ°äº†ç¬¬ä¸‰æ¬¡æäº¤å‰çš„ç‰ˆæœ¬ã€‚é‚£ä¹ˆä½ çš„ç¬¬ä¸‰æ¬¡æäº¤logå¹¶ä¸ä¼šè¢«è®°å½• # å›é€€addæ“ä½œ checkout -- file æš‚å­˜åŒº --> å·¥ä½œåŒºgit checkout -- file# å›é€€connitæ“ä½œä¸Š ä»“åº“ ---> æš‚å­˜åŒºgit reset --hard commit_id # æŸ¥çœ‹å›é€€æ—¥å¿—git reflog æäº¤è¿œç¨‹ä»“åº“ä¹‹å‰çš„æ“ä½œéƒ½æ˜¯æœ¬åœ°çš„ï¼ŒåŒ…æ‹¬æœ€åä¸€æ­¥git commit ä¹Ÿåªæ˜¯æäº¤åˆ°äº†æœ¬åœ°çš„ä»“åº“ã€‚ä¸ºäº†æ›´å¥½çš„ä¿å­˜å†…å®¹ï¼Œæˆ‘ä»¬å·²ç»å¼•å…¥äº‘ä»“åº“æˆ–è€…è¯´æ‰˜ç®¡æˆ‘ä»¬çš„é¡¹ç›® # æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€git remote add origin https://gitee.com/Alpaca-H/how-to-learn-git.git # æäº¤å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“git push origin master# å»ºè®®ç¬¬ä¸€æ¬¡ä½¿ç”¨push -u# Gitä¸ä½†ä¼šæŠŠæœ¬åœ°çš„masteråˆ†æ”¯å†…å®¹æ¨é€çš„è¿œç¨‹æ–°çš„masteråˆ†æ”¯ï¼Œè¿˜ä¼šæŠŠæœ¬åœ°çš„masteråˆ†æ”¯å’Œè¿œç¨‹çš„masteråˆ†æ”¯å…³è”èµ·æ¥ åœ¨ä»¥åçš„æ¨é€æˆ–è€…æ‹‰å–æ—¶å°±å¯ä»¥ç®€åŒ–å‘½ä»¤ã€‚ ä»è¿œç¨‹ä»“åº“ä¸‹è½½git clone https://gitee.com/Alpaca-H/how-to-learn-git.git ç¬¬ä¸€æ¬¡æäº¤çš„å­˜åœ¨çš„é—®é¢˜ ! [rejected] master -> master (fetch first)error: failed to push some refs to 'https://gitee.com/Alpaca-H/how-to-learn-git.git'hint: Updates were rejected because the remote contains work that you dohint: not have locally. This is usually caused by another repository pushinghint: to the same ref. You may want to first integrate the remote changeshint: (e.g., 'git pull ...') before pushing again.hint: See the 'Note about fast-forwards' in 'git push --help' for details. å¦‚æœä½ æ˜¯åœ¨ ç äº‘ä¸Šåˆ›å»ºçš„é¡¹ç›®ï¼Œå®ƒæœ¬èº«å°±å­˜åœ¨ä¸¤ä¸ªREADMEæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ä»“åº“ä¸­æœ¬èº«å°±å­˜åœ¨æ–‡ä»¶äº†ï¼Œè¿™æ—¶å€™ä½ åˆ æ‰è¿™ä¸¤ä¸ªä¹Ÿæ²¡ç”¨ï¼Œ(githubä¸Šå¥½åƒæ²¡è¿™ä¸ªé—®é¢˜)æˆ‘ä»¬éœ€è¦åŒæ­¥è¿œç¨‹ä»“åº“ï¼Œä¹Ÿå°±æ˜¯æ‹‰å–ä¸‹æ¥å¹¶ç”¨â€“allow-unrelated-histories åˆå¹¶ git pull origin master --allow-unrelated-histories git commit -m \"xxx\" #é‡æ–°æäº¤git push origin master ä»è¿œç¨‹ä»“åº“ä¸‹è½½ â€“ æŒ‡å®šåˆ†æ”¯git clone -b hzj_branch https://gitee.com/Alpaca-H/how-to-learn-git.git åˆ†æ”¯ç®¡ç†# åˆ›å»ºåˆ†æ”¯ git branch hzj# åˆ‡æ¢åˆ†æ”¯git checkout hzj# åˆ›å»ºå¹¶åˆ‡æ¢åˆ†æ”¯git checkout -b hzj# æŸ¥çœ‹å½“å‰åˆ†æ”¯git branch è®°ä½ä¸Šé¢çš„åªæ˜¯åˆ†æ”¯ç®¡ç†ï¼Œä»–åªæ˜¯åœ¨ä½ çš„æœ¬åœ°æœ‰äº†åˆ†æ”¯ï¼Œåœ¨ä½ æ²¡æœ‰pushä¹‹å‰æ‰€æœ‰çš„ä¸€åˆ‡éƒ½æ˜¯æœ¬åœ°æ“ä½œ åˆ†æ”¯ç®¡ç†2# åˆ‡æ¢åˆ°æ–°çš„åˆ†æ”¯ git swicth -c dev# åˆ‡æ¢åˆ°å·²æœ‰åˆ†æ”¯git swicth dev # æ·»åŠ æ–‡ä»¶echo \"æˆ‘æ˜¯hzjåˆ†æ”¯\" > README2.mdgit add README2.mdgit commit -m \"update hzj\"git push -u origin hzj # æäº¤åˆ°hzjçš„åˆ†æ”¯ åˆå¹¶åˆ†æ”¯è¿›å…¥master git merge hzj # åˆå¹¶åœ¨æœ¬åœ°ä»“åº“çš„æ–‡ä»¶ åˆ é™¤åˆ†æ”¯git branch -d hzj åˆ†æ”¯åŒæ­¥ä¸»å¹²# åˆ‡æ¢åˆ°masteråˆ†æ”¯git checkout master # ä¸‹æ‹‰mastergit pull origin master# åˆ‡æ¢åˆ†æ”¯git checkout hzj# åŒæ­¥åˆ†æ”¯git merge master ä¸»å¹²åŒæ­¥åˆ†æ”¯(æ…ç”¨)# åˆ‡æ¢åˆ°ä¸»åˆ†æ”¯git checkout master# åŒæ­¥åˆ†æ”¯git merge hzj# æäº¤git push origin master inventoryæ“ä½œ æ‹‰å–é¡¹ç›®git clone https://gitlab.s.upyun.com/infrastructure/inventory.gigit clone https://gitlab.s.upyun.com/infrastructure/inventory.git æŸ¥çœ‹å½“å‰åˆ†æ”¯git branch åˆ‡æ¢åˆ†æ”¯git checkout hzj ä¿®æ”¹å†…å®¹â€¦ ä¸Šä¼ git commit -am â€œupdateâ€git pushåˆ°webç«¯åˆ›å»ºåˆå¹¶è¯·æ±‚ æ›´æ–°é¦–å…ˆåˆ‡æ¢åˆ°masterï¼Œæ‹‰å–æœ€æ–°git pullåˆ‡æ¢æ¬¡åˆ†æ”¯ git checkout hzjåˆå¹¶æ›´æ–°åˆ†æ”¯åˆ°hzjåˆ†æ”¯ git merge origin hzj å‘æ¶ˆæ¯ç»™æœ‰masteræƒé™çš„äººï¼Œäº¤ç”±masteræ¥åˆå¹¶","link":"/posts/9891ebc8/"},{"title":"1-vue-cliç›®å½•ç»“æ„è¯¦è§£","text":"vue-cliç›®å½•ç»“æ„è¯¦è§£ vue-cliç›®å½•ç»“æ„è¯¦è§£â”œâ”€build // ä¿å­˜ä¸€äº›webpackçš„åˆå§‹åŒ–é…ç½®,é¡¹ç›®æ„å»ºâ”‚ â”œâ”€build.js // ç”Ÿäº§ç¯å¢ƒæ„å»ºâ”‚ â”œâ”€check-version.js // æ£€æŸ¥npmã€nodeç‰ˆæœ¬â”‚ â”œâ”€vue-loader.conf.js // webpack loaderé…ç½®â”‚ â”œâ”€webpack.base.conf.js// webpackåŸºç¡€é…ç½®â”‚ â”œâ”€webpack.dev.conf.js // å¼€å‘ç¯å¢ƒé…ç½®ï¼Œæ„å»ºæœ¬åœ°å¼€å‘æœåŠ¡å™¨â”‚ â”œâ”€webpack.prod.conf.js// ç”Ÿäº§ç¯å¢ƒçš„é…ç½®â”‚â”œâ”€config // configæ–‡ä»¶å¤¹ä¿å­˜ä¸€äº›é¡¹ç›®åˆå§‹åŒ–çš„é…ç½®â”‚ â”œâ”€dev.env.js // å¼€å‘ç¯å¢ƒçš„é…ç½®â”‚ â”œâ”€index.js // é¡¹ç›®ä¸€äº›é…ç½®å˜é‡â”‚ â”œâ”€prod.env.js // ç”Ÿäº§ç¯å¢ƒçš„é…ç½®â”‚â”œâ”€dist // æ‰“åŒ…åçš„é¡¹ç›®â”œâ”€node_modules // ä¾èµ–åŒ…â”‚â”œâ”€src // æºç ç›®å½•â”‚ â”œâ”€assets // é™æ€æ–‡ä»¶ç›®å½•â”‚ â”œâ”€components // ç»„ä»¶æ–‡ä»¶â”‚ â”œâ”€router // è·¯ç”±â”‚ â”œâ”€App.vue // æ˜¯é¡¹ç›®å…¥å£æ–‡ä»¶â”‚ â”œâ”€main.js // æ˜¯é¡¹ç›®çš„æ ¸å¿ƒæ–‡ä»¶ï¼Œå…¥å£â”œâ”€static // é™æ€èµ„æºç›®å½• â”œâ”€.babelrc // Babelçš„é…ç½®æ–‡ä»¶â”œâ”€.editorconfig // ä»£ç è§„èŒƒé…ç½®æ–‡ä»¶â”œâ”€.gitignore // gitå¿½ç•¥é…ç½®æ–‡ä»¶â”œâ”€.postcssrc.js // postcssæ’ä»¶é…ç½®æ–‡ä»¶â”œâ”€index.html // é¡µé¢å…¥å£æ–‡ä»¶â”œâ”€package-lock.json // é¡¹ç›®åŒ…ç®¡æ§æ–‡ä»¶â”œâ”€package.json // é¡¹ç›®é…ç½®â””â”€README.md // é¡¹ç›®è¯´æ˜ä¹¦","link":"/posts/3ffae61b/"},{"title":"element-uiä½¿ç”¨æŒ‡å—","text":"element-uiä½¿ç”¨æŒ‡å— åŸºæœ¬è¡¨å• export default { data() { return { ruleForm: { name: '', region: '', date1: '', date2: '', delivery: false, type: [], resource: '', desc: '' }, rules: { name: [ { required: true, message: 'è¯·è¾“å…¥æ´»åŠ¨åç§°', trigger: 'blur' }, { min: 3, max: 5, message: 'é•¿åº¦åœ¨ 3 åˆ° 5 ä¸ªå­—ç¬¦', trigger: 'blur' } ], region: [ { required: true, message: 'è¯·é€‰æ‹©æ´»åŠ¨åŒºåŸŸ', trigger: 'change' } ], date1: [ { type: 'date', required: true, message: 'è¯·é€‰æ‹©æ—¥æœŸ', trigger: 'change' } ], date2: [ { type: 'date', required: true, message: 'è¯·é€‰æ‹©æ—¶é—´', trigger: 'change' } ], type: [ { type: 'array', required: true, message: 'è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªæ´»åŠ¨æ€§è´¨', trigger: 'change' } ], resource: [ { required: true, message: 'è¯·é€‰æ‹©æ´»åŠ¨èµ„æº', trigger: 'change' } ], desc: [ { required: true, message: 'è¯·å¡«å†™æ´»åŠ¨å½¢å¼', trigger: 'blur' } ] } }; }, methods: { submitForm(formName) { this.$refs[formName].validate((valid) => { if (valid) { alert('submit!'); } else { console.log('error submit!!'); return false; } }); }, resetForm(formName) { this.$refs[formName].resetFields(); } } }","link":"/posts/aefec9df/"},{"title":"nginxåŸºç¡€","text":"learn nginx nginxnginxå®‰è£… ç›´æ¥å®‰è£…yum install nginx # æŸ¥çœ‹ç‰ˆæœ¬nginx -v ç¼–è¯‘å®‰è£…å®‰è£…gccã€makeã€wgetã€g++è¿™äº›è½¯ä»¶ åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç›®å½•ä¸‹è½½å®‰è£…æ‰€éœ€è¦çš„å†…å®¹cd /tmpmkdir gen_nginx ä¸‹è½½å®‰è£…openssl,ä¸»è¦ç”¨äºsslæ¨¡å—åŠ å¯†ï¼Œæ”¯æŒhtps wget https://www.openssl.org/source/openssl-1.0.2s.tar.gz ä¸‹è½½pcreæ¥å®ç°å¯¹åœ°å€é‡å®šå‘ï¼Œåœ°å€é‡å†™åŠŸèƒ½å’ŒlocaltionæŒ‡ä»¤ä»¥åŠæ­£åˆ™è¡¨è¾¾å¼çš„æ”¯æŒwget https://ftp.pcre.org/pub/pcre/pcre-8.43.tar.gz ä¸‹è½½zlib gzipå‹ç¼©æ¨¡å—wget https://zlib.net/zlib-1.2.11.tar.gz ä¸‹è½½nginxwget http://nginx.org/download/nginx-1.17.1.tar.gz è§£å‹æ‰€æœ‰çš„æ–‡ä»¶ls *.tar.gz | xargs -n1 tar xzvf ä½¿ç”¨configureç¼–è¯‘å®‰è£…å…·ä½“çš„ç¼–è¯‘å†…å®¹å¯ä»¥è‡ªå·±å†³å®š./configure \\ --with-openssl=../openssl-1.0.2s \\ --with-pcre=../pcre-8.43 \\ --with-zlib=../zlib-1.2.11 \\ --with-pcre-jit --user=admin \\ --prefix=/home/admin/nginx \\ --with-http_ssl_module \\ --with-http_v2_module ç¼–è¯‘å®‰è£…make && make install åˆ†é…æƒé™sudo chown root nginx sudo chmod u+s nginx æ­£å‘ä»£ç†å±€åŸŸç½‘é€šè¿‡ä»£ç†æœåŠ¡å™¨è®¿é—®Internetä¸Šçš„å†…å®¹ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšæ­£å‘ä»£ç† åå‘ä»£ç†å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”±åå‘ä»£ç†æœåŠ¡å™¨é€‰æ‹©ç›®æ ‡æœåŠ¡å™¨è·å–æ•°æ®åï¼Œåœ¨è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶åå‘ä»£ç†æœåŠ¡å™¨å’Œç›®æ ‡æœåŠ¡å™¨å¯¹å¤–å°±æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæš´éœ²çš„æ˜¯ä»£ç†æœåŠ¡å™¨åœ°å€ï¼Œéšè—äº†çœŸå®æœåŠ¡å™¨IPçš„åœ°å€ è´Ÿè½½å‡è¡¡é€šè¿‡åå‘ä»£ç†æœåŠ¡å™¨ï¼Œå°†å¤šä¸ªè¯·æ±‚å¹³å‡åˆ†é…åˆ°ç›®æ ‡æœåŠ¡å™¨ä¸Š åŠ¨é™åˆ†ç¦»åŠ¨æ€èµ„æºä¸åŠ¨æ€èµ„æºåˆ†å¼€æ”¾ï¼Œç”±åå‘ä»£ç†æœåŠ¡å™¨æ¥æ ¹æ®è¯·æ±‚å†…å®¹ï¼Œå°†è¯·æ±‚è½¬å‘åˆ°æŒ‡å®šç›®æ ‡æœåŠ¡å™¨ nginxå¸¸ç”¨å‘½ä»¤é¦–å…ˆè¦è¿›å…¥åˆ°Nginxçš„ç›®å½•ä¸‹,å¦‚æœæ˜¯ç¼–è¯‘å®‰è£…çš„è¯ï¼Œnginxçš„ç›®å½•åº”è¯¥åœ¨/usr/local/sbin/nginxä¸­ï¼Œå¦‚æœæ˜¯ç›´æ¥å®‰è£…ä¸‹è½½çš„è¯ï¼Œnginxçš„ç›®å½•åº”è¯¥åœ¨/usr/sbin/nginx cd /usr/sbin/nginx# æŸ¥çœ‹Nginxè¿›ç¨‹ps -ef | grep nginx# æŸ¥çœ‹nginxçš„ç‰ˆæœ¬å·./nginx -v# å¼ºåˆ¶å…³é—­Nginx./nginx -s stop# é€€å‡ºnginx./nginx -s quit# å¯åŠ¨nginx./nginx# é‡æ–°åŠ è½½nginx./nginx -s reload nginxé…ç½®æ–‡ä»¶å¦‚æœæ˜¯ç›´æ¥å®‰è£…ï¼Œåˆ™é…ç½®æ–‡ä»¶åœ¨/etc/nginx/nginx.confï¼Œå¦‚æœæ˜¯ç¼–è¯‘å®‰è£…ï¼Œåˆ™é…ç½®æ–‡ä»¶åœ¨/usr/local/nginxä¸­æŸ¥æ‰¾nginxé…ç½®æ–‡ä»¶ find / | grep nginx.conf \bnginxé…ç½®æ–‡ä»¶çš„ç»„æˆä¸»è¦åˆ†æˆ3å¤§å—å†…å®¹ ç¬¬ä¸€éƒ¨åˆ†: å…¨å±€æ¨¡å— user nginx; # ç”¨æˆ· ç”¨æˆ·ç»„ ; ä¸€èˆ¬åªæœ‰ç±»unixç³»ç»Ÿæœ‰,windowsä¸éœ€è¦worker_processes auto; # å·¥ä½œè¿›ç¨‹ï¼Œä¸€èˆ¬é…ç½®ä¸ºcpuæ ¸å¿ƒæ•°çš„2å€ï¼Œå€¼è¶Šå¤§ï¼Œå¯ä»¥æ”¯æŒçš„å¹¶å‘å¤„ç†é‡è¶Šå¤šerror_log /var/log/nginx/error.log; # é”™è¯¯æ—¥å¿—çš„é…ç½®è·¯å¾„pid /run/nginx.pid; # è¿›ç¨‹IDå­˜æ”¾è·¯å¾„include /usr/share/nginx/modules/*.conf; ç¬¬äºŒéƒ¨åˆ†: eventsæ¨¡å—ä¸»è¦å½±å“nginxæœåŠ¡å™¨ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ events { # ä½¿ç”¨epollçš„I/O æ¨¡å‹ï¼›epoll ä½¿ç”¨äºLinuxå†…æ ¸2.6ç‰ˆæœ¬åŠä»¥åçš„ç³»ç»Ÿ use epoll; # æ¯ä¸€ä¸ªå·¥ä½œè¿›ç¨‹çš„æœ€å¤§è¿æ¥æ•°é‡ï¼› ç†è®ºä¸Šè€Œè¨€æ¯ä¸€å°nginxæœåŠ¡å™¨çš„æœ€å¤§è¿æ¥æ•°ä¸ºï¼š worker_processes*worker_connections worker_connections 1024; # è¶…æ—¶æ—¶é—´ keepalive_timeout 60 # å®¢æˆ·ç«¯è¯·æ±‚å¤´éƒ¨çš„ç¼“å†²åŒºå¤§å°ï¼Œå®¢æˆ·ç«¯è¯·æ±‚ä¸€èˆ¬ä¼šå°äºä¸€é¡µï¼› å¯ä»¥æ ¹æ®ä½ çš„ç³»ç»Ÿçš„åˆ†é¡µå¤§å°æ¥è®¾å®šï¼Œ å‘½ä»¤ getconf PAGESIZE å¯ä»¥è·å¾—å½“å‰ç³»ç»Ÿçš„åˆ†é¡µå¤§å°ï¼ˆä¸€èˆ¬4Kï¼‰ client_header_buffer_size 4k; # ä¸ºæ‰“å¼€çš„æ–‡ä»¶æŒ‡å®šç¼“å­˜ï¼Œé»˜è®¤æ˜¯ä¸å¯ç”¨ï¼› maxæŒ‡å®šç¼“å­˜æ•°é‡ï¼Œå»ºè®®å’Œæ‰“å¼€æ–‡ä»¶æ•°ä¸€è‡´ï¼›inactiveæ˜¯æŒ‡ç»è¿‡è¿™ä¸ªæ—¶é—´åè¿˜æ²¡æœ‰è¢«è¯·æ±‚è¿‡åˆ™æ¸…é™¤è¯¥æ–‡ä»¶çš„ç¼“å­˜ã€‚ open_file_cache max=65535 inactive=60s; # å¤šä¹…ä¼šæ£€æŸ¥ä¸€æ¬¡ç¼“å­˜çš„æœ‰æ•ˆä¿¡æ¯ open_file_cache_valid 80s; # å¦‚æœåœ¨æŒ‡å®šçš„å‚æ•°open_file_cacheçš„å±æ€§inactiveè®¾ç½®çš„å€¼ä¹‹å†…ï¼Œæ²¡æœ‰è¢«è®¿é—®è¿™ä¹ˆå¤šæ¬¡ï¼ˆopen_file_cache_min_usesï¼‰ï¼Œåˆ™æ¸…é™¤ç¼“å­˜ # åˆ™è¿™é‡ŒæŒ‡çš„æ˜¯ 60så†…éƒ½æ²¡æœ‰è¢«è®¿é—®è¿‡ä¸€æ¬¡åˆ™æ¸…é™¤ çš„æ„æ€ open_file_cache_min_uses 1;} ç¬¬ä¸‰éƒ¨åˆ†1: httpæ¨¡å—httpå…¨å±€é…ç½®çš„æŒ‡ä»¤åŒ…æ‹¬æ–‡ä»¶å¼•å…¥ã€MIME-TYPEå®šä¹‰ã€æ—¥å¿—è‡ªå®šä¹‰ã€è¿æ¥è¶…æ—¶æ—¶é—´ã€å•é“¾è¯·æ±‚æ•°ä¸Šé™ç­‰ã€‚ http { # æ—¥å¿—å‘é€ # æ—¥å¿—æ ¼å¼ å…¶ä¸­mainæ˜¯æ—¥å¿—æ–‡ä»¶çš„åå­— # -------------------------------------------------------------------------- # # æ—¥å¿—æ ¼å¼è®¾ç½®ï¼š # $remote_addrã€$http_x_forwarded_for å¯ä»¥è·å¾—å®¢æˆ·ç«¯ipåœ°å€ # $remote_user å¯ä»¥è·å¾—å®¢æˆ·ç«¯ç”¨æˆ·å # $time_local è®°å½•è®¿é—®çš„æ—¶åŒºä»¥åŠæ—¶é—´ # $request è¯·æ±‚çš„urlä¸httpåè®® # $status å“åº”çŠ¶æ€æˆåŠŸä¸º200 # $body_bytes_sent å‘é€ç»™å®¢æˆ·ç«¯ä¸»ä½“å†…å®¹å¤§å° # $http_referer è®°å½•ä»å“ªä¸ªé¡µé¢è¿‡æ¥çš„è¯·æ±‚ # $http_user_agent å®¢æˆ·ç«¯æµè§ˆå™¨ä¿¡æ¯ # # æ³¨æ„äº‹é¡¹ï¼š # é€šå¸¸webæœåŠ¡å™¨(æˆ‘ä»¬çš„tomcat)æ”¾åœ¨åå‘ä»£ç†(nginx)çš„åé¢ï¼Œè¿™æ ·å°±ä¸èƒ½è·å–åˆ°å®¢æˆ·çš„IPåœ°å€äº†ï¼Œé€šè¿‡$remote_addæ‹¿åˆ°çš„IPåœ°å€æ˜¯åå‘ä»£ç†æœåŠ¡å™¨çš„iPåœ°å€ã€‚ # åå‘ä»£ç†æœåŠ¡å™¨(nginx)åœ¨è½¬å‘è¯·æ±‚çš„httpå¤´ä¿¡æ¯ä¸­ï¼Œå¯ä»¥å¢åŠ $http_x_forwarded_forä¿¡æ¯ï¼Œè®°å½•åŸæœ‰å®¢æˆ·ç«¯çš„IPåœ°å€å’ŒåŸæ¥å®¢æˆ·ç«¯çš„è¯·æ±‚çš„æœåŠ¡å™¨åœ°å€ã€‚ # -------------------------------------------------------------------------- # log_format main '$remote_addr - $remote_user [$time_local] \"$request\" ' '$status $body_bytes_sent \"$http_referer\" ' '\"$http_user_agent\" \"$http_x_forwarded_for\"'; # æŒ‡å®šæ—¥å¿—æ–‡ä»¶å­˜å‚¨åœ°å€ access_log /var/log/nginx/access.log main; # sendfile æŒ‡å®š nginx æ˜¯å¦è°ƒç”¨sendfile å‡½æ•°ï¼ˆé›¶æ‹·è´ æ–¹å¼ï¼‰æ¥è¾“å‡ºæ–‡ä»¶ï¼› # å¯¹äºä¸€èˆ¬å¸¸è§åº”ç”¨ï¼Œå¿…é¡»è®¾ä¸ºonã€‚ # å¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œIOå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿuptimeã€‚ sendfile on; tcp_nopush on; tcp_nodelay on; keepalive_timeout 65; types_hash_max_size 2048; # è´Ÿè½½å‡è¡¡ START>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> # upstream æŒ‡ä»¤å®šä¹‰çš„èŠ‚ç‚¹å¯ä»¥è¢«proxy_passæŒ‡ä»¤å¼•ç”¨ï¼›äºŒè€…ç»“åˆç”¨æ¥åå‘ä»£ç†+è´Ÿè½½å‡è¡¡é…ç½® # ã€å†…ç½®ç­–ç•¥ã€‘ï¼šè½®è¯¢ã€åŠ æƒè½®è¯¢ã€ip_hashã€æœ€å°‘è¿æ¥ é»˜è®¤ç¼–è¯‘è¿›äº†nginx # ã€æ‰©å±•ç­–ç•¥ã€‘ï¼šfairã€é€šç”¨hashã€ä¸€è‡´æ€§hash é»˜è®¤æ²¡æœ‰ç¼–è¯‘è¿›nginx #-----------------------------------------------------------------------------------------------# # ã€1ã€‘é»˜è®¤æ˜¯è½®è¯¢ï¼›å¦‚æœåç«¯æœåŠ¡å™¨downæ‰ï¼Œèƒ½è‡ªåŠ¨å‰”é™¤ã€‚ # upstream bakend { # server 192.168.75.130:8080; # server 192.168.75.132:8080; # server 192.168.75.134:8080; # } # #ã€2ã€‘æƒé‡è½®è¯¢(åŠ æƒè½®è¯¢)ï¼šè¿™æ ·é…ç½®åï¼Œå¦‚æœæ€»å…±è¯·æ±‚äº†3æ¬¡ï¼Œåˆ™å‰é¢ä¸¤æ¬¡è¯·æ±‚åˆ°130ï¼Œåé¢ä¸€æ¬¡è¯·æ±‚åˆ°132 # upstream bakend { # server 192.168.75.130:8080 weight=2; # server 192.168.75.132:8080 weight=1; # } # #ã€3ã€‘ip_hashï¼šè¿™ç§é…ç½®ä¼šä½¿å¾—æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®è€…çš„ipçš„hashç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥è§£å†³sessionçš„é—®é¢˜ã€‚ # upstream bakend { # ip_hash; # server 192.168.75.130:8080; # server 192.168.75.132:8080; # } # #ã€4ã€‘æœ€å°‘è¿æ¥ï¼šå°†è¯·æ±‚åˆ†é…ç»™è¿æ¥æ•°æœ€å°‘çš„æœåŠ¡å™¨ã€‚Nginxä¼šç»Ÿè®¡å“ªäº›æœåŠ¡å™¨çš„è¿æ¥æ•°æœ€å°‘ã€‚ # upstream bakend { # least_conn; # server 192.168.75.130:8080; # server 192.168.75.132:8080; # } # # #ã€5ã€‘fairç­–ç•¥(éœ€è¦å®‰è£…nginxçš„ç¬¬ä¸‰æ–¹æ¨¡å—fair)ï¼šæŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚ # upstream bakend { # fair; # server 192.168.75.130:8080; # server 192.168.75.132:8080; # } # #ã€6ã€‘url_hashç­–ç•¥ï¼ˆä¹Ÿæ˜¯ç¬¬ä¸‰æ–¹ç­–ç•¥ï¼‰ï¼šæŒ‰è®¿é—®urlçš„hashç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œä½¿æ¯ä¸ªurlå®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨ä¸ºç¼“å­˜æ—¶æ¯”è¾ƒæœ‰æ•ˆã€‚ # åœ¨upstreamä¸­åŠ å…¥hashè¯­å¥ï¼Œserverè¯­å¥ä¸­ä¸èƒ½å†™å…¥weightç­‰å…¶ä»–çš„å‚æ•°ï¼Œhash_methodæŒ‡å®šhashç®—æ³• # upstream bakend { # server 192.168.75.130:8080; # server 192.168.75.132:8080; # hash $request_uri; # hash_method crc32; # } # #ã€7ã€‘å…¶ä»–è®¾ç½®ï¼Œä¸»è¦æ˜¯è®¾å¤‡çš„çŠ¶æ€è®¾ç½® # upstream bakend{ # ip_hash; # server 127.0.0.1:9090 down; # down è¡¨ç¤ºè¯¥æœºå™¨å¤„äºä¸‹çº¿çŠ¶æ€ä¸å¯ç”¨ # server 127.0.0.1:8080 weight=2; # server 127.0.0.1:6060; # # # max_fails é»˜è®¤ä¸º1ï¼› æœ€å¤§è¯·æ±‚å¤±è´¥çš„æ¬¡æ•°ï¼Œç»“åˆfail_timeoutä½¿ç”¨ï¼› # # ä»¥ä¸‹é…ç½®è¡¨ç¤º 192.168.0.100:8080åœ¨å¤„ç†è¯·æ±‚å¤±è´¥3æ¬¡åï¼Œå°†åœ¨15så†…ä¸ä¼šå—åˆ°ä»»ä½•è¯·æ±‚äº† # # fail_timeout é»˜è®¤ä¸º10ç§’ã€‚æŸå°Serverè¾¾åˆ°max_failsæ¬¡å¤±è´¥è¯·æ±‚åï¼Œåœ¨fail_timeoutæœŸé—´å†…ï¼Œnginxä¼šè®¤ä¸ºè¿™å°Serveræš‚æ—¶ä¸å¯ç”¨ï¼Œä¸ä¼šå°†è¯·æ±‚åˆ†é…ç»™å®ƒã€‚ # server 192.168.0.100:8080 weight=2 max_fails=3 fail_timeout=15; # server 192.168.0.101:8080 weight=3; # server 192.168.0.102:8080 weight=1; # # é™åˆ¶åˆ†é…ç»™æŸå°Serverå¤„ç†çš„æœ€å¤§è¿æ¥æ•°é‡ï¼Œè¶…è¿‡è¿™ä¸ªæ•°é‡ï¼Œå°†ä¸ä¼šåˆ†é…æ–°çš„è¿æ¥ç»™å®ƒã€‚é»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºä¸é™åˆ¶ã€‚æ³¨æ„ï¼š1.5.9ä¹‹åçš„ç‰ˆæœ¬æ‰æœ‰è¿™ä¸ªé…ç½® # server 192.168.0.103:8080 max_conns=1000; # server 127.0.0.1:7070 backup; # å¤‡ä»½æœºï¼›å…¶ä»–æœºå™¨éƒ½ä¸å¯ç”¨æ—¶ï¼Œè¿™å°æœºå™¨å°±ä¸Šåœºäº† # server example.com my_dns_resolve; # æŒ‡å®šåŸŸåè§£æå™¨ï¼›my_dns_resolveéœ€è¦åœ¨httpèŠ‚ç‚¹é…ç½®resolverèŠ‚ç‚¹å¦‚ï¼šresolver 10.0.0.1; # } # # # #è´Ÿè½½å‡è¡¡ END","link":"/posts/21215442/"},{"title":"nginxé…ç½®å®ä¾‹","text":"learn nginx nginxé…ç½®å®ä¾‹nginxé…ç½®å®ä¾‹â€“åå‘ä»£ç†1é…ç½®å†…å®¹1å°Nginxä»£ç†æœåŠ¡å™¨(10.0.5.233)ã€ä¸€ä¸ªç½‘é¡µæ•ˆæœ: å®¢æˆ·æœºåœ¨æµè§ˆå™¨ä¸­è¾“å…¥www.123.com ç”±nginxä»£ç†è¿›è¡Œè½¬å‘åˆ°æˆ‘ä»¬è‡ªå·±çš„ç½‘é¡µä¸Š # é¦–å…ˆ åœ¨å®¢æˆ·æœºç«¯åšåŸŸåä¸ipçš„æ˜ å°„echo \"10.0.5.255 www.123.com\" >> /etc/hosts# é…ç½®nginxæ–‡ä»¶ /etc/nginx/nginx.confserver { listen 80; server_name 10.0.5.233; root /usr/share/nginx/html; # Load configuration files for the default server block. include /etc/nginx/default.d/*.conf; location / { root html; proxy_pass http://127.0.0.1:8001; index index.html index.htm; } } # ä¸Šé¢æ˜¯nginxæœåŠ¡å™¨çš„é…ç½®ï¼Œè¡¨ç¤ºçš„æ˜¯ç›‘å¬10.0.5.233:80 å°†æ”¶åˆ°çš„è¯·æ±‚è½¬å‘åˆ° http://127.0.0.1:8001æœ¬åœ°ç«¯å£# å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨è¾“å…¥www.123.com:80 --> 10.0.5.233:80 --> server127.0.0.1:8001 nginxé…ç½®â€“åå‘ä»£ç†2é…ç½®å†…å®¹1å°Nginxä»£ç†æœåŠ¡å™¨(10.0.5.233)ã€2ä¸ªç½‘é¡µæ•ˆæœ: å®¢æˆ·æœºåœ¨æµè§ˆå™¨ä¸­è¾“å…¥www.123.com/web1/ è·³è½¬åˆ°ç¬¬ä¸€ä¸ªwebé¡µé¢ ; è¾“å…¥www.123.com/web2/ è·³è½¬åˆ°ç¬¬äºŒä¸ªwebé¡µé¢ # webé¡µé¢è‡ªè¡Œé…ç½®,åˆ†åˆ«æ˜¯# 127.0.0.1:8080/web1/ -> web1# 127.0.0.1:8081/web2/ -> web2# é…ç½®nginxæ–‡ä»¶ /etc/nginx/nginx.confserver { listen 80; server_name 10.0.5.233; root /usr/share/nginx/html; # Load configuration files for the default server block. include /etc/nginx/default.d/*.conf; # ï½ è¡¨ç¤ºåé¢çš„ä¸ºæ­£åˆ™è¡¨è¾¾å¼ location ~ /web1/ { proxy_pass http://127.0.0.1:8080; } location ~ /web2/ { proxy_pass http://127.0.0.1:8081; } } nginxé…ç½®â€“è´Ÿè½½å‡è¡¡é…ç½®å†…å®¹1å°Nginxä»£ç†æœåŠ¡å™¨(10.0.5.233) 2ä¸ªwebæœåŠ¡å™¨ upstream myserver { server 10.0.5.197:8001; server 10.0.5.198:8001;} server { listen 80; server_name 10.0.5.233; root /usr/share/nginx/html; # Load configuration files for the default server block. include /etc/nginx/default.d/*.conf; # ï½ è¡¨ç¤ºåé¢çš„ä¸ºæ­£åˆ™è¡¨è¾¾å¼ location / { proxy_pass http://myserver; } } ç­–ç•¥ï¼š é»˜è®¤ç­–ç•¥ä¸ºè½®è¯¢æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨downæ‰ï¼Œèƒ½è‡ªåŠ¨å‰”é™¤ æƒé‡ç­–ç•¥weightä»£è¡¨æƒé‡ï¼Œæƒé‡é»˜è®¤ä¸º1ï¼Œæƒé‡è¶Šé«˜è¢«åˆ†é…çš„ç”¨æˆ·è¶Šå¤šupstream myserver { server 10.0.5.197:8001 weight=10; server 10.0.5.198:8001 weight=20;} ip_hashç­–ç•¥æ¯ä¸ªè¯·æ±‚æŒ‰ç…§æŒ‰è®¿é—®ipçš„hashç»“æœåˆ†é…ï¼Œæ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³sessionçš„é—®é¢˜upstream myserver { ip_hash; server 10.0.5.197:8001; server 10.0.5.198:8001;} fairç­–ç•¥ç§‘ä¸¾æœåŠ¡å™¨å“åº”æ—¶é—´æ¥åˆ†é…ï¼Œå“åº”çš„è¶Šå¿«åˆ™ä¼˜å…ˆåˆ†é…upstream myserver { server 10.0.5.197:8001; server 10.0.5.198:8001; fair;} nginxé…ç½®å®ä¾‹â€“åŠ¨é™åˆ†ç¦»åŠ¨æ€è¯·æ±‚ä¸é™æ€è¯·æ±‚åˆ†å¼€ï¼Œç”¨nginxå¤„ç†é™æ€é¡µé¢ï¼Œdjangoå¤„ç†åŠ¨æ€é¡µé¢ é™æ€æ–‡ä»¶æ”¾åœ¨é™æ€èµ„æºç®¡ç†æœåŠ¡å™¨ä¸Šï¼ŒåŠ¨æ€èµ„æºæ”¾åœ¨å¦å¤–çš„æœåŠ¡å™¨ä¸Šï¼Œæœ‰Nginxåšè½¬å‘ é™æ€æ–‡ä»¶å’ŒåŠ¨æ€èµ„æºä¸€èµ·å‘å¸ƒåœ¨åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œç”±nginxåšåˆ†ç¦» server { listen 80; server_name 10.0.5.233; root /usr/share/nginx/html; # Load configuration files for the default server block. include /etc/nginx/default.d/*.conf; location /image/ { root /image/; # é™æ€æ–‡ä»¶è·¯å¾„ index index.html index.htm; } location /data/ { root /data/; # é™æ€æ–‡ä»¶è·¯å¾„ autoindex on; # è‡ªåŠ¨åˆ—å‡ºç›®å½• } } nginxé…ç½®å®ä¾‹â€“é«˜å¯ç”¨é›†ç¾¤keepalived+nginxé…ç½®éœ€æ±‚ï¼šmasteræœºå™¨(main nginx) slaveæœºå™¨(backup nginx) ä¸¤å°webæœåŠ¡å™¨åšè½®è¯¢è´Ÿè½½å‡è¡¡ ã€ ä¸€ä¸ªè™šæ‹ŸIP+4ä¸ªæœºå™¨IP nginxæ´»æ€§æ£€æµ‹è„šæœ¬ #!/bin/bash# æ£€æµ‹nginxè¿›ç¨‹æ•°é‡status=`ps -C nginx --no-header | wc -l`# å¦‚æœæ²¡æœ‰è¿›ç¨‹ï¼Œåˆ™é‡å¯ä¹‹åå†æ¬¡æ£€æµ‹nginxæ•°é‡,å¦‚æœä¾æ—§æ²¡æœ‰åˆ™æ€æ‰æ‰€æœ‰keepalivedçš„è¿›ç¨‹if [ $status -eq 0 ];then /usr/sbin/nginx sleep 2 if [ `ps -C nginx --no-header | wc -l ` -eq 0 ]; then killall keepalived fifi keepalivedé…ç½®,æ ¹æ®ä¸»æœºä¸ä»æœºçš„ä¸é€šï¼Œåªéœ€è¦ä¿®æ”¹å‡ ä¸ªå‚æ•°å³å¯router_id ã€ state ã€interface ã€ virtual_router_id ã€priority # å®‰è£…keepalivedyum install keepalived# ä¿®æ”¹é…ç½®æ–‡ä»¶! Configuration File for keepalivedglobal_defs { notification_email { acassen@firewall.loc failover@firewall.loc sysadmin@firewall.loc } notification_email_from Alexandre.Cassen@firewall.loc smtp_server 192.168.200.1 smtp_connect_timeout 30 router_id nginx_master vrrp_skip_check_adv_addr vrrp_strict vrrp_garp_interval 0 vrrp_gna_interval 0}# nginxæ´»æ€§æ£€æµ‹vrrp_script chk_http_port{ script \"/usr/local/src/nginx_check.sh\" interval 2 # æ£€æµ‹è„šæœ¬æ‰§è¡Œçš„é—´éš” weight 2 # æƒé‡}vrrp_instance VI_1 { state BACKUP # DS-backupæœºå™¨ BACKUP MASTER interface eno1 virtual_router_id 51 priority 10 # ä¼˜å…ˆçº§åˆ« advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 10.0.5.196/20 }} nginxé…ç½® upstream myserver { server 10.0.5.197:8001; server 10.0.5.198:8001;} server { listen 80; server_name 10.0.5.196; root /usr/share/nginx/html; # Load configuration files for the default server block. include /etc/nginx/default.d/*.conf; # ï½ è¡¨ç¤ºåé¢çš„ä¸ºæ­£åˆ™è¡¨è¾¾å¼ location / { proxy_pass http://myserver; } } å½“ç”¨æˆ·è®¿é—®10.0.5.196:80ç«¯å£çš„æ—¶å€™ï¼Œç”±äº196æ˜¯vip æ­¤æ—¶æ­£åœ¨masterä¸»æœºä¸Šé¢ï¼Œå› æ­¤ä»–ä¼šè¯»å–masterä¸»æœºä¸Šé¢çš„nginxé…ç½®æ–‡ä»¶ï¼Œåç»­å› ä¸ºnginxçš„è´Ÿè½½å‡è¡¡(è½®è¯¢çš„é…ç½®)ï¼Œå½“ä½ ä¸æ–­çš„è®¿é—®10.0.5.196æ—¶ï¼Œé¡µé¢ä¼šåœ¨10.0.5.197:8001 ä¸10.0.5.198:8001ç›´æ¥æ¥å›çš„è·³åŠ¨ nginxåŸç†https://www.bilibili.com/video/av68136734?p=17https://www.cnblogs.com/dongye95/p/11096785.html#_label0_0","link":"/posts/12ec35da/"},{"title":"vue-element-admin","text":"vue-element-adminæ¡†æ¶å­¦ä¹ ç›®å½•ç»“æ„ åœ°å€åŸºæœ¬æ¨¡ç‰ˆhttps://github.com/PanJiaChen/vue-admin-templateåŸºæœ¬æ¨¡ç‰ˆ-å±•ç¤ºåœ°å€https://panjiachen.github.io/vue-admin-template/#/dashboardå®ä¾‹é¡¹ç›®https://github.com/PanJiaChen/vue-element-admin/blob/master/README.zh-CN.mdå®ä¾‹é¡¹ç›®-å±•ç¤ºåœ°å€https://panjiachen.github.io/vue-element-admin/#/dashboard","link":"/posts/a1c58685/"},{"title":"swagger-uiä½¿ç”¨","text":"SwaggerUiä½¿ç”¨djangoæ­å»ºswagger-uidjango2.0ä¹‹å‰ä½¿ç”¨django-rest-swaggerdjango2.0ä¹‹åä½¿ç”¨drf-yasgè¿™é‡Œä¸»è¦è®°å½•ä¸€äº›ä½¿ç”¨drf-yasgå®‰è£…çš„è¿‡ç¨‹ Qucik-Start# å®‰è£…yum install drf-yasg# settingè®¾ç½®INSTALLED_APPS = [ ... ' drf_yasg 'ï¼Œ ... ]# urls.pyè®¾ç½®...from rest_framework import permissionsfrom drf_yasg.views import get_schema_viewfrom drf_yasg import openapi...schema_view = get_schema_view( openapi.Info( title=\"Snippets API\", default_version='v1', description=\"Test description\", terms_of_service=\"https://www.google.com/policies/terms/\", contact=openapi.Contact(email=\"contact@snippets.local\"), license=openapi.License(name=\"BSD License\"), ), public=True, permission_classes=(permissions.AllowAny,),)urlpatterns = [ url(r'^swagger(?P\\.json|\\.yaml)$', schema_view.without_ui(cache_timeout=0), name='schema-json'), url(r'^swagger/$', schema_view.with_ui('swagger', cache_timeout=0), name='schema-swagger-ui'), url(r'^redoc/$', schema_view.with_ui('redoc', cache_timeout=0), name='schema-redoc'), ...] ç”Ÿæˆåœ°å€ A JSON view of your API specification at /swagger.json A YAML view of your API specification at /swagger.yaml A swagger-ui view of your API specification at /swagger/ A ReDoc view of your API specification at /redoc/ ç½‘å€å®˜æ–¹ç½‘å€https://swagger.io/tools/swagger-ui/drf-yasg gitbookæ–‡æ¡£https://drf-yasg.readthedocs.io/en/stable/drf-yasg gitbookåœ°å€https://github.com/axnsan12/drf-yasg","link":"/posts/a2d15b23/"},{"title":"vueä¸­çš„å„ç±»æ’ä»¶ä»¥åŠä½¿ç”¨æ–¹æ³•","text":"vueä¸­çš„å„ç±»æ’ä»¶ä»¥åŠä½¿ç”¨æ–¹æ³• vueä¸­çš„å„ç±»æ’ä»¶ä»¥åŠä½¿ç”¨æ–¹æ³•åœ¨vueçš„ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°äº†å¾ˆå¤šæ’ä»¶ï¼Œæœ‰äº›æ’ä»¶åªæ˜¯æä¾›äº†ä¸€éƒ¨åˆ†å¾ˆå°çš„åŠŸèƒ½ï¼Œå æ®ä¸äº†å¤ªå¤§çš„ç¯‡å¹…ï¼Œå› æ­¤æ”¶é›†åˆ°è¿™é‡Œè®°å½•ä¸€ä¸‹ qsæ’ä»¶qsæ’ä»¶æ˜¯ä¸€ä¸ªåœ°å€è§£æå·¥å…·,ä¸»è¦æ˜¯å¯¹äºä¸€ä¸²urlåœ°å€è¿›è¡Œåºåˆ—åŒ– # å®‰è£…npm install qs ä½¿ç”¨import qs from 'qs';# å®šä¹‰å…¨å±€åˆ«åVue.prototype.$qs = qs# ä½¿ç”¨this.$http.post('/bb', this.$qs.stringify({ aa:2, bb:3 }) ) .then(function (response) { console.log(response.data); }) .catch(function (error) { console.log(error); });# åˆ™è¯·æ±‚åœ°å€æ˜¯è¿™æ ·çš„aa=2&&bb=3 vuexæ’ä»¶ä½œä¸ºvueä¸­çš„çŠ¶æ€ç®¡ç†æ’ä»¶ npm install vuex --save ä½¿ç”¨import Vue from 'vue'import Vuex from 'vuex'Vue.use(Vuex) vue-routeæ’ä»¶ä½œä¸ºvueä¸­çš„è·¯ç”±æ’ä»¶ # å®‰è£…npm install vue-router ä½¿ç”¨import Vue from 'vue'import VueRouter from 'vue-router'Vue.use(VueRouter) vue-axiosæ’ä»¶ä½¿ç”¨ é”™è¯¯vue eslint é™åˆ¶æ— æ³•ä½¿ç”¨console.logè°ƒè¯• Failed to compile../src/components/leftroute.vueModule Error (from ./node_modules/eslint-loader/index.js):error: Unexpected console statement (no-console) at src/components/leftroute.vue:31:11: 29 | this.$axios.get('http://localhost:3000/people') 30 | .then(function(response){> 31 | console.log(response); | ^ 32 | }) 33 | .catch(function(error){ 34 | console.log(error);error: Unexpected console statement (no-console) at src/components/leftroute.vue:34:11: 32 | }) 33 | .catch(function(error){> 34 | console.log(error); | ^ 35 | }); 36 | } 37 | }2 errors found. è§£å†³æ–¹æ³• åŠ å…¥ \"no-console\" : [\"false\"] æˆ–è€…æŠŠ node_modules/lib/rules/no-console.js ä¸­çš„trueæ”¹æˆfaslehttps://blog.csdn.net/weixin_42476786/article/details/85132793https://blog.csdn.net/qq_40637612/article/details/8760788 mock.js æ•°æ®æ¨¡æ‹Ÿåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæœ‰å¾ˆå¤šçš„ajaxè¯·æ±‚ï¼Œå‰åç«¯åˆ†ç¦»å¼€å‘ä½ è‚¯å®šé‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œåå°ç»™ä½ çš„æ¥å£æ–‡æ¡£ï¼Œä½ éœ€è¦åœ¨æœ¬åœ°æ¨¡æ‹Ÿæ•°æ®è¿”å›ï¼Œå¯èƒ½ä½ ä¹Ÿç”¨åˆ°è¿‡æˆ‘ä¹‹å‰ç”¨çš„è ¢æ–¹æ³•ï¼Œå°±æ˜¯æ–°å»ºä¸€ä¸ªtest.jsonæ–‡ä»¶ï¼Œæ”¾å…¥æ¥å£æ–‡æ¡£ä¸­å†™çš„è¿”å›ç¤ºä¾‹ï¼Œè¿™ä¹ˆåšæœ‰ä¸ªå¾ˆå¤§çš„é—®é¢˜æ˜¯ä¸å¤Ÿçµæ´»ï¼Œè€Œä¸”è¿˜éœ€è¦åˆ‡æ¢urlï¼Œç°åœ¨å­¦ä¼šä½¿ç”¨mock.jsæ‹¦æˆªajaxè¯·æ±‚ï¼Œæ›´åŠ æ–¹ä¾¿çš„æ„é€ ä½ éœ€è¦çš„å‡æ•°æ®","link":"/posts/d0806758/"},{"title":"linuxå°±è¯¥è¿™ä¹ˆå­¦","text":"Linuxå°±è¯¥è¿™ä¹ˆå­¦yumè½¯ä»¶ä»“åº“ yumç®€åŒ–rpmç®¡ç†è½¯ä»¶éš¾åº¦ï¼Œyumèƒ½å¤Ÿæ ¹æ®ç”¨äºçš„è¦æ±‚åˆ†æå‡ºæ‰€éœ€è½¯ä»¶åŒ…åŠå…¶ç›¸å…³ä¾èµ–ï¼Œè‡ªåŠ¨ä»æœåŠ¡å™¨ä¸Šä¸‹è½½è½¯ä»¶åŒ…å¹¶å®‰è£…åˆ°ç³»ç»Ÿ |-----> å®¢æˆ·æœºyumä»“åº“ ---->| ----> å®¢æˆ·æœº |-----> å®¢æˆ·æœº yumä»“åº“çš„é…ç½®æ–‡ä»¶éƒ½å¿…é¡»è¦ä»¥.repoç»“å°¾å¹¶æ”¾åœ¨/etc/yum.repos.d/ç›®å½•ä¸­ [rhel-media]:yum æºçš„åç§°,å¯è‡ªå®šä¹‰baseurl=file://media/cdrom : æä¾›æ–¹å¼åŒ…æ‹¬ FTP(ftp://..) ã€HTTP(http://) ã€æœ¬åœ°(file://)enabled = 1 : è®¾ç½®æ¬¡å…ƒæ˜¯å¦å¯ç”¨ï¼Œ1 ä¸ºå¯ç”¨ 0 ä¸ºç¦ç”¨gpgcheck = 1 : è®¾ç½®æ­¤æºæ˜¯å¦æ ¡éªŒæ–‡ä»¶ï¼Œ1ä¸ºæ ¡éªŒ 0 ä¸ºä¸æ ¡éªŒgpgkey = file:///media/cdrom/RPM-GPG-KET-redhat-release è‹¥ä¸ºæ ¡éªŒè¯·æŒ‡å®šå…¬é’¥æ–‡ä»¶åœ°å€ YUMä»“åº“ä¸­çš„RPMè½¯ä»¶åŒ…å¯ä»¥ç”±çº¢å¸½å®˜æ–¹å‘å¸ƒï¼Œä¹Ÿå¯ä»¥æ˜¯ç¬¬ä¸‰æ–¹ç»„ç»‡å‘å¸ƒ # å‘½ä»¤yum repolist all # åˆ—å‡ºæ‰€æœ‰ä»“åº“yum list all # åˆ—å‡ºä»“åº“ä¸­æ‰€æœ‰è½¯ä»¶åŒ…# ä»¥ä¸Šåˆ—å‡ºçš„æ˜¯çº¿ä¸Šçš„è¿˜æ˜¯æœ¬åœ°çš„yum info è½¯ä»¶åŒ…åç§° # æŸ¥çœ‹è½¯ä»¶åŒ…ä¿¡æ¯yum install è½¯ä»¶åŒ…åç§° # å®‰è£…è½¯ä»¶åŒ…yum reinstall è½¯ä»¶åŒ…åç§° # é‡æ–°å®‰è£…yum remove è½¯ä»¶åŒ…åç§° # åˆ é™¤è½¯ä»¶åŒ…yum update è½¯ä»¶åŒ…åç§° # å‡çº§yum clean alla # æ¸…æ¥šæ‰€æœ‰ä»“åº“ç¼“å­˜yum check-update # æ£€æŸ¥å¯æ›´æ–°çš„è½¯ä»¶åŒ…yum grouplist # æŸ¥çœ‹ç³»ç»Ÿå·²ç»å®‰è£…çš„è½¯ä»¶åŒ…ç»„yum groupinstall è½¯ä»¶åŒ…ç»„ # å®‰è£…æŒ‡å®šçš„è½¯ä»¶åŒ…ç»„yum groupremove è½¯ä»¶åŒ…ç»„ # ç§»é™¤æŒ‡å®šçš„è½¯ä»¶åŒ…ç»„yum groupinfo è½¯ä»¶åŒ…ç»„ # æŸ¥è¯¢æŒ‡å®šçš„è½¯ä»¶åŒ…ä¿¡æ¯ å¸¸ç”¨æŒ‡ä»¤echo ç”¨äºåœ¨ç»ˆç«¯ä¸Šæ˜¾ç¤ºå­—ç¬¦æˆ–å˜é‡ , æ ¼å¼ä¸º echo [å­—ç¬¦ä¸²|å˜é‡][root@localhost ~]# echo $SHELL/bin/bash[root@localhost ~]# echo namename[root@localhost ~]# echo $HOSTNAMElocalhost.localdomain data å‘½ä»¤ç”¨äºæ˜¾ç¤º/è®¾ç½®ç³»ç»Ÿçš„æ—¶é—´æˆ–æ—¥æœŸ, æ ¼å¼ä¸º: \"data[é€‰é¡¹][+æŒ‡å®šçš„æ ¼å¼]\"%t åˆ¶è¡¨ç¬¦(è¡¨ç¤ºä¸€ä¸ªTABé”®)%H å°æ—¶(00-23)%I å°æ—¶(1-12)%M åˆ†é’Ÿ%S ç§’%X ç›¸å½“äº%H:%M:%S%Z æ˜¾ç¤ºæ—¶åŒº%p æ˜¾ç¤ºæœ¬åœ°AMæˆ–PM%A æ˜ŸæœŸ%a æ˜ŸæœŸ[root@localhost ~]# date +%aWed[root@localhost ~]# date +%AWednesday reboot å‘½ä»¤ç”¨äºé‡å¯ç³»ç»Ÿ(ä»…rootç”¨æˆ·å¯ä»¥ä½¿ç”¨)reboot wget å‘½ä»¤ç”¨äºä¸‹è½½ç½‘ç»œæ–‡ä»¶ï¼Œæ ¼å¼ä¸ºwegt[å‚æ•°] ä¸‹è½½åœ°å€-b åå°ä¸‹è½½æ¨¡å¼-O æŒ‡å®šç›®å½•-t æœ€å¤§å°è¯•æ¬¡æ•°-c æ–­ç‚¹ç»­ä¼  # æ–­ç‚¹ç»­ä¼ å•¥æ„æ€-p ä¸‹è½½é¡µé¢å†…æ‰€æœ‰èµ„æºï¼ŒåŒ…æ‹¬å›¾ç‰‡,è§†é¢‘ç­‰-r é€’å½’ä¸‹è½½ elinks åœ¨ç»ˆç«¯ä¸Šè®¿é—®ç½‘é¡µyum install elinks -yelinks www.baidu.com ifconfig ç”¨äºè·å–ç½‘å¡é…ç½®ä¸ç½‘ç»œçŠ¶æ€ç­‰ä¿¡æ¯: æ ¼å¼ä¸º ifconfig [ç½‘ç»œè®¾å¤‡] [å‚æ•°]# åœ¨Centos7ä¸­ï¼Œåˆå§‹ç³»ç»Ÿå·²ç»ä¸åœ¨å¸¦æœ‰ifconfigå‘½ä»¤,éœ€è¦å®‰è£…yum install net-tools -y [root@localhost ~]# ifconfig eth0: flags=4163 mtu 1500 inet 10.0.5.30 netmask 255.255.240.0 broadcast 10.0.15.255 inet6 fe80::546f:27ff:fe92:5 prefixlen 64 scopeid 0x20 ether 56:6f:27:92:00:05 txqueuelen 1000 (Ethernet) RX packets 2789743 bytes 2021122197 (1.8 GiB) RX errors 0 dropped 40085 overruns 0 frame 0 TX packets 255991 bytes 349383987 (333.1 MiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 uname å‘½ä»¤ç”¨äºæŸ¥çœ‹ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ç­‰ä¿¡æ¯ï¼Œæ ¼å¼ä¸º\"uanme [-a]\"å†…æ ¸åç§°ã€å†…æ ¸å‘è¡Œç‰ˆæœ¬ã€å†…æ ¸ç‰ˆæœ¬ã€èŠ‚ç‚¹åã€ç¡¬ä»¶åç§°ã€ç¡¬ä»¶å¹³å°ã€å¤„ç†å™¨ç±»å‹ã€æ“ä½œç³»ç»Ÿç­‰ä¿¡æ¯[root@localhost ~]# uname -aLinux localhost.localdomain 3.10.0-957.el7.x86_64 #1 SMP Thu Nov 8 23:39:32 UTC 2018 x86_64 x86_64 x86_64 GNU/LinuxæŸ¥çœ‹è¯¦ç»†ç‰ˆæœ¬cat /etc/redhat-release uptime æŸ¥çœ‹ç³»ç»Ÿçš„è´Ÿè½½æƒ…å†µ ç³»ç»Ÿå½“å‰æ—¶é—´ã€ç³»ç»Ÿå·²è¿è¡Œæ—¶é—´ã€å½“å‰åœ¨çº¿ç”¨æˆ·ã€å¹³å‡è´Ÿè½½å‡è¡¡(1,5,15åˆ†é’Ÿ)[root@localhost ~]# uptime 11:02:21 up 23:49, 2 users, load average: 0.00, 0.01, 0.05# æ¯ç§’åˆ·æ–°ä¸€æ¬¡è·å¾—å½“å‰çš„ç³»ç»Ÿè´Ÿè½½å‡è¡¡æƒ…å†µ[root@localhost ~]# watch -n 1 uptime free å‘½ä»¤ç”¨äºæ˜¾ç¤ºå½“å‰ç³»ç»Ÿä¸­å†…å­˜çš„ä½¿ç”¨æƒ…å†µ,æ ¼å¼ä¸º free[-m/-g]ä»¥mæˆ–gæ˜¾ç¤ºå½“å‰ç³»ç»Ÿä¸­å†…å­˜çš„ä½¿ç”¨æƒ…å†µ[root@localhost ~]# free total used free shared buff/cache availableMem: 1995208 132640 813324 6520 1049244 1780360Swap: 2097148 0 2097148[root@localhost ~]# free -m total used free shared buff/cache availableMem: 1948 129 794 6 1024 1738Swap: 2047 0 2047[root@localhost ~]# free -g total used free shared buff/cache availableMem: 1 0 0 0 1 1Swap: 1 0 1 who å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰ç™»å½•ä¸»æœºçš„ç”¨æˆ·æƒ…å†µ,æ ¼å¼ä¸º: who[å‚æ•°][root@localhost ~]# whoroot tty1 2019-08-14 11:25root pts/0 2019-08-15 10:38 (10.0.3.12) lastå‘½ä»¤ç”¨äºæŸ¥çœ‹æ‰€æœ‰ç³»ç»Ÿçš„ç™»å…¥è®°å½•: æ ¼å¼ä¸º last[å‚æ•°][root@localhost ~]# lastroot pts/1 10.0.3.12 Thu Aug 15 10:41 - 10:41 (00:00) root pts/0 10.0.3.12 Thu Aug 15 10:38 still logged in root pts/0 10.0.3.12 Thu Aug 15 10:33 - 10:37 (00:04) root pts/1 10.0.3.12 Wed Aug 14 14:40 - 21:38 (06:57) root pts/0 10.0.3.12 Wed Aug 14 14:11 - 21:38 (07:26) root pts/3 10.0.3.12 Wed Aug 14 11:30 - 21:37 (10:06) root pts/2 10.0.5.175 Wed Aug 14 11:26 - 11:33 (00:06) root tty1 Wed Aug 14 11:25 still logged in root pts/1 10.0.3.12 Wed Aug 14 11:19 - 11:32 (00:12) root pts/0 10.0.3.12 Wed Aug 14 11:15 - 11:32 (00:16) root tty1 Wed Aug 14 11:12 - 11:15 (00:02) reboot system boot 3.10.0-957.el7.x Wed Aug 14 11:12 - 11:12 (23:59) wtmp begins Wed Aug 14 11:12:34 2019 historyå‘½ä»¤ç”¨äºæ˜¾ç¤ºå†å²æ‰§è¡Œè¿‡çš„å‘½ä»¤,æ ¼å¼ä¸ºï¼š history [-c][root@localhost ~]# history # æ¸…é™¤å†å²è®°å½•[root@localhost ~]# history -c# é»˜è®¤å†å²è®°å½•ä¿å­˜1000æ¡ï¼Œä¿®æ”¹æœ€å¤§å€¼vim /etc/profile HISTSIZE = xxx pwdç”¨äºæŸ¥çœ‹å½“å‰çš„å·¥ä½œè·¯å¾„pwd cdç”¨äºåˆ‡æ¢å·¥ä½œè·¯å¾„,æ ¼å¼: cd[ç›®å½•åç§°]cd - åˆ‡æ¢åˆ°ä¸Šä¸€æ¬¡ç›®å½•cd ~ åˆ‡æ¢åˆ°å®¶ç›®å½•cd ~username åˆ‡æ¢åˆ°å…¶ä»–ç”¨æˆ·çš„å®¶ç›®å½•cd .. åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½• cat å‘½ä»¤æŸ¥çœ‹çº¯æ–‡æœ¬æ–‡ä»¶(è¾ƒçŸ­çš„), æ ¼å¼ä¸º:cat[é€‰é¡¹][æ–‡ä»¶]-n æ˜¾ç¤ºè¡Œå·-b æ˜¾ç¤ºè¡Œå·(ä¸åŒ…æ‹¬ç©ºè¡Œ)-A æ˜¾ç¤ºå‡ºä¸å¯è§çš„ç¬¦å· more å‘½ä»¤ç”¨äºæŸ¥çœ‹çº¯æ–‡æœ¬æ–‡ä»¶(è¾ƒé•¿çš„),æ ¼å¼ä¸º more[é€‰é¡¹] æ–‡ä»¶ -æ•°å­— é¢„å…ˆæ˜¾ç¤ºçš„è¡Œæ•°(è¦åœ¨æ–‡ä»¶å‰é¢è¾“å…¥)-d æ˜¾ç¤ºæç¤ºè¯­ä¸æŠ¥é”™ä¿¡æ¯[root@localhost ~]# more -5 test.txt head å‘½ä»¤ç”¨äºæŸ¥çœ‹çº¯æ–‡æœ¬æ–‡æ¡£çš„å‰Nè¡Œï¼Œæ ¼å¼ä¸º head[é€‰é¡¹][æ–‡ä»¶]æŸ¥çœ‹æ–‡æœ¬å‰10è¡Œhead -n 10 æ–‡ä»¶åæ­£å¸¸è¾“å‡ºï¼Œä¸æ˜¾ç¤ºæœ€å10è¡Œhead -n -10 tail å‘½ä»¤ç”¨äºæŸ¥çœ‹çº¯æ–‡æœ¬æ–‡æ¡£çš„åNè¡Œ,æ ¼å¼ä¸º tail [é€‰é¡¹][æ–‡ä»¶]æŸ¥çœ‹æ–‡æœ¬æ–‡ä»¶å20è¡Œtail -n 20 æ–‡ä»¶åä¸æ–­åˆ·æ–°æ–‡ä»¶æœ€åä¸€è¡Œtail -n 1 -f æ–‡ä»¶å odå‘½ä»¤ç”¨äºå¯¹æŸ¥çœ‹ç‰¹æ®Šæ ¼å¼çš„æ–‡ä»¶,æ ¼å¼ä¸º od[é€‰é¡¹][æ–‡ä»¶]-t a é»˜è®¤å­—ç¬¦-t c ASCIIå­—ç¬¦-t o å…«è¿›åˆ¶-t d åè¿›åˆ¶-t x åå…­è¿›åˆ¶-t f æµ®ç‚¹æ•° trå‘½ä»¤ç”¨äºè½¬æ¢æ–‡æœ¬æ–‡ä»¶ä¸­çš„å­—ç¬¦,æ ¼å¼ä¸º tr[åŸå§‹å­—ç¬¦][ç›®æ ‡å­—ç¬¦]å°†å°å†™å­—ç¬¦æ”¹æˆå¤§å†™cat test.txt | tr [a-z][A-Z] wc å‘½ä»¤ç”¨äºç»Ÿè®¡æŒ‡å®šæ–‡æœ¬çš„è¡Œæ•°ã€å­—æ•°ã€å­—èŠ‚æ•°, æ ¼å¼ä¸º wc[å‚æ•°] æ–‡æœ¬-l åªæ˜¾ç¤ºè¡Œæ•°-w åªæ˜¾ç¤ºå•è¯æ•°-c åªæ˜¾ç¤ºå­—èŠ‚æ•°ç»Ÿè®¡å½“å‰ç”¨æˆ·ä¸­çš„ä¸ªæ•°wc -l /etc/passwd cut å‘½ä»¤é€šè¿‡åˆ—æ¥æå–æ–‡æœ¬å­—ç¬¦ cut[å‚æ•°] æ–‡æœ¬-d åˆ†éš”ç¬¦ æŒ‡å®šåˆ†éš”ç¬¦,é»˜è®¤ä¸ºTab-f æŒ‡å®šæ˜¾ç¤ºçš„åˆ—æ•°-c å•ä½æ”¹ä¸ºå­—ç¬¦è·å–å½“å‰ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·çš„åç§°cut -d: -f1 /etc/passwdè·å–rootç”¨æˆ·çš„é»˜è®¤shellè§£é‡Šå™¨grep ^root /etc/passwd | cut -d: -f 7 diff å‘½ä»¤ç”¨äºæ¯”è¾ƒå¤šä¸ªæ–‡æœ¬æ–‡ä»¶çš„å·®å¼‚,æ ¼å¼ä¸ºdiff[å‚æ•°] æ–‡ä»¶-b å¿½ç•¥ç©ºæ ¼å¼•èµ·çš„å·®å¼‚-B å¿½ç•¥ç©ºè¡Œå¼•èµ·çš„å·®å¼‚--brief æˆ–è€… -q ä»…è¿”å›æ˜¯å¦å­˜åœ¨å·®å¼‚ (æ²¡æœ‰å·®å¼‚ï¼Œåˆ™æ— è¿”å›)-c ä½¿ç”¨ä¸Šä¸‹æ–‡è¾“å‡ºæ ¼å¼ touch åˆ›å»ºç©ºç™½æ–‡ä»¶å’Œä¿®æ”¹æ–‡ä»¶æ—¶é—´ ,æ ¼å¼ä¸º touch[é€‰é¡¹][æ–‡ä»¶]å¯¹äºåœ¨linuxä¸­çš„æ–‡ä»¶æœ‰ä¸‰ç§æ—¶é—´: æ›´æ”¹æ—¶é—´(mtime):å†…å®¹ä¿®æ”¹æ—¶é—´(ä¸åŒ…æ‹¬æƒé™) æ›´æ”¹æƒé™(ctime):æ›´æ”¹æƒé™å’Œå±æ€§çš„æ—¶é—´ è¯»å–æ—¶é—´(atime):è¯»å–æ–‡ä»¶å†…å®¹çš„æ—¶é—´","link":"/posts/4d6061df/"},{"title":"vueç»„ä»¶åŸºç¡€","text":"vueç»„ä»¶åŸºç¡€ // ç»„ä»¶.jsvue.component(â€˜xxxâ€™,{ data:function(){ return { count: 0, message: â€œxxxâ€ } }, template: '{{message}}'}) // htmlè°ƒç”¨ç»„ä»¶ //js new Vue({el: â€˜#appâ€™}) ç»„ä»¶å¤ç”¨ vue.component(â€œæ ‡ç­¾åâ€,{ }) dataå¿…é¡»æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œè¿”å›å‚æ•°è¿™ä¸ä¹‹å‰ä¸åŒä¹‹å‰new Vue({ data:{ },}) ä¼ é€’æ•°æ®Vue.component(â€˜blog-postâ€™, { props: [â€˜titleâ€™], template: â€˜vueç»„ä»¶åŸºç¡€â€˜}) ç»„ä»¶ä¸­çš„çˆ¶å­çº§ Document {{text}} //çˆ¶çº§åŠ¨æ€ new Vue({ el:\"#app5\", data:{ text:\"æˆ‘æ˜¯çˆ¶çº§çš„\" } }) //å­çº§æ¨¡ç‰ˆåŠ¨æ€è·³åŠ¨ Vue.component('child',{ props:[\"text\"], template:\"æˆ‘æ˜¯å­çº§ï¼Œè¿™æ˜¯æˆ‘è°ƒç”¨æ¥çš„{{text}}\" }) Vue.component('my-c',{ props:[\"text\"], template:\"{{text}}\" }); new Vue({ el:\"#app4\" }); åœ¨ç»„ä»¶ä¸­è¿”å›æ•°æ®å¯ä»¥ä½¿ç”¨data ä»¥åŠ props ï¼Œä½†æ˜¯è¿™ä¸¤è€…æ˜¯æœ‰åŒºåˆ«çš„ï¼Œdataåªèƒ½è¿”å›å½“å‰ç»„ä»¶çš„å€¼,è€Œpropsèƒ½å¤Ÿè¿”å›çˆ¶ç»„ä»¶çš„å€¼ï¼Œä»¥ä¸Šéƒ½æ˜¯propsè°ƒç”¨çˆ¶ç»„ä»¶çš„ä¾‹å­ï¼Œå…¶ä¸­ç»„ä»¶ä¸­çš„æ¨¡ç‰ˆæ‰€åˆ›å»ºå‡ºæ¥çš„å†…å®¹è¢«ç§°ä¸ºå­ç»„ä»¶ï¼Œåˆ†ä¸ºåŠ¨æ€å’Œé™æ€ä¸¤ç§ Vue.component('blog-post', { props: ['title'], template: '{{ title }}'}) å¦‚ä¸Šä¹Ÿæ˜¯ä¸€ç§é™æ€è°ƒç”¨çš„æ–¹æ³•,blog-postä¸ºçˆ¶ç»„ä»¶ h3ä¸ºå­ç»„ä»¶ new Vue({ el: '#blog-post-demo', data: { posts: [ { id: 1, title: 'My journey with Vue' }, { id: 2, title: 'Blogging with Vue' }, { id: 3, title: 'Why Vue is so fun' } ] }}) å¦‚ä¸Šæ˜¯dataè°ƒç”¨å½“å‰ç»„ä»¶çš„å†…å®¹ ç›‘å¬å­ç»„ä»¶äº‹ä»¶å…¨å±€æ³¨å†ŒVue.component('component-a', { /* ... */ })Vue.component('component-b', { /* ... */ })Vue.component('component-c', { /* ... */ })new Vue({ el: '#app' }) å±€éƒ¨æ³¨å†Œvar ComponentA = { /* ... */ }var ComponentB = { /* ... */ }var ComponentC = { /* ... */ } new Vue({ el: '#app', components: { 'component-a': ComponentA, 'component-b': ComponentB }}) ç»„ä»¶ä¹‹é—´åªèƒ½è¶Šä¸€çº§è®¿é—®ï¼Œä¸èƒ½è·¨å¤šçº§ï¼Œæ¯”å¦‚ä½ æƒ³è¦åœ¨ Bè¿™ä¸ªå­ç»„ä»¶ä¸­è®¿é—®Aè¿™ä¸ªå­ç»„ä»¶ï¼Œåˆ™éœ€è¦ var ComponentA = { /* ... */ }var ComponentB = { components: { 'component-a': ComponentA }, // ...} åœ¨æ¨¡å—ç³»ç»Ÿä¸­å±€éƒ¨æ³¨å†Œå¦‚æœä½ è¿˜åœ¨é˜…è¯»ï¼Œè¯´æ˜ä½ ä½¿ç”¨äº†è¯¸å¦‚ Babel å’Œ webpack çš„æ¨¡å—ç³»ç»Ÿã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ¨èåˆ›å»ºä¸€ä¸ª components ç›®å½•ï¼Œå¹¶å°†æ¯ä¸ªç»„ä»¶æ”¾ç½®åœ¨å…¶å„è‡ªçš„æ–‡ä»¶ä¸­ã€‚ ç„¶åä½ éœ€è¦åœ¨å±€éƒ¨æ³¨å†Œä¹‹å‰å¯¼å…¥æ¯ä¸ªä½ æƒ³ä½¿ç”¨çš„ç»„ä»¶ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªå‡è®¾çš„ ComponentB.js æˆ– ComponentB.vue æ–‡ä»¶ä¸­ï¼š import ComponentA from â€˜./ComponentAâ€™import ComponentC from â€˜./ComponentCâ€™ export default { components: { ComponentA, ComponentC }, // â€¦}ç°åœ¨ ComponentA å’Œ ComponentC éƒ½å¯ä»¥åœ¨ ComponentB çš„æ¨¡æ¿ä¸­ä½¿ç”¨äº†ã€‚","link":"/posts/1fd63f28/"},{"title":"wiresharkç½‘ç»œæŠ“åŒ…å·¥å…·","text":"learn wireshark ğŸŒ wiresharkç½‘ç»œæŠ“åŒ…å·¥å…·ä¸‹è½½åœ°å€https://www.wireshark.org/download.html","link":"/posts/f633fc00/"},{"title":"é¢å¤–çŸ¥è¯†","text":"é¢å¤–çŸ¥è¯†ç›²æ‰“ç»ƒä¹ https://www.typingclub.com/sportal/program-3/116.playhttps://pqrs.org/osx/karabiner/https://vim-adventures.com/ æ€»çº¿https://baike.baidu.com/item/%E6%80%BB%E7%BA%BF ossä¸cdnçš„åŒºåˆ«xxx webapiæ¡†æ¶å“ªä¸ªæ˜¯æœ€å¿«çš„webæ¡†æ¶https://github.com/the-benchmarker/web-frameworks pythoné«˜æ€§èƒ½webæ¡†æ¶https://falconframework.org/","link":"/posts/4904e4f5/"},{"title":"vuejsåŸºç¡€2","text":"vuejsåŸºç¡€2 https://cn.vuejs.orgçº¿ä¸Š:https://jsfiddle.net/chrisvfritz/50wL7mdz/ æ·»åŠ ç¯å¢ƒé€šè¿‡å¼•å…¥çš„æ–¹å¼å¼•å…¥vue id=\"app\" --- > //el:#appv-bind:title = \"message\" --- > //ç»‘å®šæ ‡ç­¾å±æ€§(æŒ‡ä»¤){{message}} ---- > data:{ message:\"hello vue!\"}var app2 = new Vue({}) ---> //ç”³æ˜vueçš„å¯¹è±¡//v-if=true ----> //æ¡ä»¶åˆ¤æ–­//v-if:\"seen\" new Vue({ el:'#app',data:{ seen:true} })//æ¡ä»¶å¾ªç¯ {{ todo.text }} var app4 = new Vue({ el:\"#app-4\", data:{ todo:[ {text:'xxx'}, {text:'xxx'}, {text:'xxx'}, ] }})app4.todo.push({text:'yyy'}) //æ·»åŠ å†…å®¹// v-on:click = \"funcname\" è‡ªå®šä¹‰ç‚¹å‡»æ–¹æ³• {{message}} åè½¬æ¶ˆæ¯var app5 = new Vue({ el:\"#app-5\", data:{ message: 'hello,vue.js!' } methods:{ reverseMessage:function () { this.message = this.message.split('').reveser().join('') } } }})// è¡¨å•åŒå‘ç»‘å®š {{message}} new app6 = new Vue({ el:\"#app6\", data:{ message: \"hello world\" }}) vueçš„ç”Ÿå‘½å‘¨æœŸæ¯ä¸ª Vue å®ä¾‹åœ¨è¢«åˆ›å»ºæ—¶éƒ½è¦ç»è¿‡ä¸€ç³»åˆ—çš„åˆå§‹åŒ–è¿‡ç¨‹â€”â€”ä¾‹å¦‚ï¼Œéœ€è¦è®¾ç½®æ•°æ®ç›‘å¬ã€ç¼–è¯‘æ¨¡æ¿ã€å°†å®ä¾‹æŒ‚è½½åˆ° DOM å¹¶åœ¨æ•°æ®å˜åŒ–æ—¶æ›´æ–° DOMç­‰ï¼Œä½†ä¸ºäº†è®©å¼€å‘è€…èƒ½æ›´å¥½çš„æ§åˆ¶vueçš„æ•´ä¸ªæµç¨‹ï¼Œä»¥åŠåœ¨ç‰¹å®šæ—¶å€™æ·»åŠ ç‰¹å®šåŠŸèƒ½ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¿…é¡»è¦äº†è§£çš„æ˜¯vueçš„ç”Ÿå‘½å‘¨æœŸ å…ˆäº†è§£ä¸€ä¸‹domçš„è§£ææµç¨‹æµè§ˆå™¨æ¸²æŸ“å¼•æ“å·¥ä½œæµç¨‹éƒ½å·®ä¸å¤šï¼Œå¤§è‡´åˆ†ä¸º5æ­¥ï¼Œåˆ›å»ºDOMæ ‘â€”â€”åˆ›å»ºStyleRulesâ€”â€”åˆ›å»ºRenderæ ‘â€”â€”å¸ƒå±€Layoutâ€”â€”ç»˜åˆ¶Painting1.ç”¨HTMLåˆ†æå™¨ï¼Œåˆ†æåˆ†æHTMLå…ƒç´ ï¼Œæ„å»ºä¸€é¢—DOMæ ‘(æ ‡è®°åŒ–å’Œæ ‘æ„å»º)2.ç”¨CSSåˆ†æå™¨ï¼Œåˆ†æCSSæ–‡ä»¶å’Œå…ƒç´ ä¸Šçš„inlineæ ·å¼ï¼Œç”Ÿæˆé¡µé¢çš„æ ·å¼è¡¨ã€‚3.å°†DOMæ ‘å’Œæ ·å¼è¡¨ï¼Œå…³è”èµ·æ¥ï¼Œæ„å»ºä¸€é¢—Renderæ ‘(è¿™ä¸€è¿‡ç¨‹åˆç§°ä¸ºAttachment)ã€‚æ¯ä¸ªDOMèŠ‚ç‚¹éƒ½æœ‰attachæ–¹æ³•ï¼Œæ¥å—æ ·å¼ä¿¡æ¯ï¼Œè¿”å›ä¸€ä¸ªrenderå¯¹è±¡(åˆårenderer)ã€‚è¿™äº›renderå¯¹è±¡æœ€ç»ˆä¼šè¢«æ„å»ºæˆä¸€é¢—Renderæ ‘ã€‚4.æœ‰äº†Renderæ ‘ï¼Œæµè§ˆå™¨å¼€å§‹å¸ƒå±€ï¼Œä¸ºæ¯ä¸ªRenderæ ‘ä¸Šçš„èŠ‚ç‚¹ç¡®å®šä¸€ä¸ªåœ¨æ˜¾ç¤ºå±ä¸Šå‡ºç°çš„ç²¾ç¡®åæ ‡ã€‚5.Renderæ ‘å’ŒèŠ‚ç‚¹æ˜¾ç¤ºåæ ‡éƒ½æœ‰äº†ï¼Œå°±è°ƒç”¨æ¯ä¸ªèŠ‚ç‚¹paintæ–¹æ³•ï¼ŒæŠŠå®ƒä»¬ç»˜åˆ¶å‡ºæ¥ã€‚ DOMæ ‘çš„æ„å»ºæ˜¯æ–‡æ¡£åŠ è½½å®Œæˆå¼€å§‹çš„ï¼Ÿæ„å»ºDOMæ•°æ˜¯ä¸€ä¸ªæ¸è¿›è¿‡ç¨‹ï¼Œä¸ºè¾¾åˆ°æ›´å¥½ç”¨æˆ·ä½“éªŒï¼Œæ¸²æŸ“å¼•æ“ä¼šå°½å¿«å°†å†…å®¹æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚å®ƒä¸å¿…ç­‰åˆ°æ•´ä¸ªHTMLæ–‡æ¡£è§£æå®Œæ¯•ä¹‹åæ‰å¼€å§‹æ„å»ºrenderæ•°å’Œå¸ƒå±€ã€‚ Renderæ ‘æ˜¯DOMæ ‘å’ŒCSSOMæ ‘æ„å»ºå®Œæ¯•æ‰å¼€å§‹æ„å»ºçš„å—ï¼Ÿè¿™ä¸‰ä¸ªè¿‡ç¨‹åœ¨å®é™…è¿›è¡Œçš„æ—¶å€™åˆä¸æ˜¯å®Œå…¨ç‹¬ç«‹ï¼Œè€Œæ˜¯ä¼šæœ‰äº¤å‰ã€‚ä¼šé€ æˆä¸€è¾¹åŠ è½½ï¼Œä¸€éè§£æï¼Œä¸€éæ¸²æŸ“çš„å·¥ä½œç°è±¡ã€‚ JSæ“ä½œçœŸå®DOMçš„ä»£ä»·ï¼ç”¨æˆ‘ä»¬ä¼ ç»Ÿçš„å¼€å‘æ¨¡å¼ï¼ŒåŸç”ŸJSæˆ–JQæ“ä½œDOMæ—¶ï¼Œæµè§ˆå™¨ä¼šä»æ„å»ºDOMæ ‘å¼€å§‹ä»å¤´åˆ°å°¾æ‰§è¡Œä¸€éæµç¨‹ã€‚åœ¨ä¸€æ¬¡æ“ä½œä¸­ï¼Œæˆ‘éœ€è¦æ›´æ–°10ä¸ªDOMèŠ‚ç‚¹ï¼Œæµè§ˆå™¨æ”¶åˆ°ç¬¬ä¸€ä¸ªDOMè¯·æ±‚åå¹¶ä¸çŸ¥é“è¿˜æœ‰9æ¬¡æ›´æ–°æ“ä½œï¼Œå› æ­¤ä¼šé©¬ä¸Šæ‰§è¡Œæµç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œ10æ¬¡ã€‚ä¾‹å¦‚ï¼Œç¬¬ä¸€æ¬¡è®¡ç®—å®Œï¼Œç´§æ¥ç€ä¸‹ä¸€ä¸ªDOMæ›´æ–°è¯·æ±‚ï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„åæ ‡å€¼å°±å˜äº†ï¼Œå‰ä¸€æ¬¡è®¡ç®—ä¸ºæ— ç”¨åŠŸã€‚è®¡ç®—DOMèŠ‚ç‚¹åæ ‡å€¼ç­‰éƒ½æ˜¯ç™½ç™½æµªè´¹çš„æ€§èƒ½ã€‚å³ä½¿è®¡ç®—æœºç¡¬ä»¶ä¸€ç›´åœ¨è¿­ä»£æ›´æ–°ï¼Œæ“ä½œDOMçš„ä»£ä»·ä»æ—§æ˜¯æ˜‚è´µçš„ï¼Œé¢‘ç¹æ“ä½œè¿˜æ˜¯ä¼šå‡ºç°é¡µé¢å¡é¡¿ï¼Œå½±å“ç”¨æˆ·ä½“éªŒã€‚ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹ŸDOMï¼Œå®ƒæœ‰ä»€ä¹ˆå¥½å¤„?Webç•Œé¢ç”±DOMæ ‘(æ ‘çš„æ„æ€æ˜¯æ•°æ®ç»“æ„)æ¥æ„å»ºï¼Œå½“å…¶ä¸­ä¸€éƒ¨åˆ†å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå…¶å®å°±æ˜¯å¯¹åº”æŸä¸ªDOMèŠ‚ç‚¹å‘ç”Ÿäº†å˜åŒ–ï¼Œè™šæ‹ŸDOMå°±æ˜¯ä¸ºäº†è§£å†³æµè§ˆå™¨æ€§èƒ½é—®é¢˜è€Œè¢«è®¾è®¡å‡ºæ¥çš„ã€‚å¦‚å‰ï¼Œè‹¥ä¸€æ¬¡æ“ä½œä¸­æœ‰10æ¬¡æ›´æ–°DOMçš„åŠ¨ä½œï¼Œè™šæ‹ŸDOMä¸ä¼šç«‹å³æ“ä½œDOMï¼Œè€Œæ˜¯å°†è¿™10æ¬¡æ›´æ–°çš„diffå†…å®¹ä¿å­˜åˆ°æœ¬åœ°ä¸€ä¸ªJSå¯¹è±¡ä¸­ï¼Œæœ€ç»ˆå°†è¿™ä¸ªJSå¯¹è±¡ä¸€æ¬¡æ€§attchåˆ°DOMæ ‘ä¸Šï¼Œå†è¿›è¡Œåç»­æ“ä½œï¼Œé¿å…å¤§é‡æ— è°“çš„è®¡ç®—é‡ã€‚æ‰€ä»¥ï¼Œç”¨JSå¯¹è±¡æ¨¡æ‹ŸDOMèŠ‚ç‚¹çš„å¥½å¤„æ˜¯ï¼Œé¡µé¢çš„æ›´æ–°å¯ä»¥å…ˆå…¨éƒ¨åæ˜ åœ¨JSå¯¹è±¡(è™šæ‹ŸDOM)ä¸Šï¼Œæ“ä½œå†…å­˜ä¸­çš„JSå¯¹è±¡çš„é€Ÿåº¦æ˜¾ç„¶è¦æ›´å¿«ï¼Œç­‰æ›´æ–°å®Œæˆåï¼Œå†å°†æœ€ç»ˆçš„JSå¯¹è±¡æ˜ å°„æˆçœŸå®çš„DOMï¼Œäº¤ç”±æµè§ˆå™¨å»ç»˜åˆ¶ã€‚ https://www.jianshu.com/p/af0b398602bc é¦–å…ˆæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ç”Ÿå‘½å‘¨æœŸçš„å‡ ä¸ªé˜¶æ®µ1.beforeCreate2.created 3.beforeMount4.mount 5.beforeUpdate6.update 7.beforeDestroy8.destroyed è¿™ä¸ªç”Ÿå‘½å‘¨æœŸçš„è¿‡ç¨‹åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼Œåˆå§‹åŒ– è¿è¡Œä¸­ é”€æ¯ã€‚ Document {{message}} //vuetest.jsnew Vue({ el:\"#app1\", data:{ message:\"helloworld\" }, beforeCreate() { console.log(\"----------------------------\") console.log(\"xxxæˆ‘æ˜¯beforeCreate\") console.log(this.message+\" ,beforeCreateé˜¶æ®µè¾“å‡ºäº†è¿™æ¡ä¿¡æ¯\") console.log(\"ç»“æŸäº†ï¼Œæˆ‘è¾“å‡ºäº†messageçš„ä¿¡æ¯å—\") }, created() { console.log(\"----------------------------\") console.log(\"æˆ‘æ˜¯create\") console.log(this.message+\" ,createdé˜¶æ®µè¾“å‡ºäº†è¿™æ¡ä¿¡æ¯\") console.log(\"ç»“æŸäº†ï¼Œæˆ‘è¾“å‡ºäº†messageçš„ä¿¡æ¯å—\") }, //åœ¨createdé˜¶æ®µå·²ç»èƒ½å¤Ÿæ‹¿åˆ°å…·ä½“çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ›´æ”¹æ•°æ®ï¼Œä¸”ä¸ä¼šè§¦å‘updateå‡½æ•° //ä½†æ˜¯å¦‚æœæœ‰ä¸¤ä¸ªcreatedå‡½æ•°ï¼Œåˆ™åä¸€ä¸ªé‡å å‰ä¸€ä¸ª created(){ console.log(\"----------------------------\") console.log(\"æˆ‘æ˜¯created2ä»£\") this.message = this.message + \"!!!!!!!\" console.log(this.message) console.log(\"over\") }, //è™šæ‹Ÿdomåˆ›å»ºå®Œæˆ,å·²ç»å­˜åœ¨æ•°æ®ä»¥åŠè¯†åˆ«åˆ°äº†el(å³è™šæ‹Ÿdom) //å¯ä»¥ä¿®æ”¹æ•°æ®ï¼Œä½†æ˜¯å·²ç»æ˜¯æœ€åä¸€æ¬¡æœºä¼šäº†ï¼Œä¸”ä¸ä¼šè§¦å‘updateå‡½æ•° beforeMount() { console.log(\"----------------------------\") console.log(\"æˆ‘æ˜¯beforeMount\") this.message = this.message + \"~~~\" console.log(this.message) console.log(\"over\") }, // è¿™é‡Œå†æ¬¡ä¿®æ”¹æ•°æ®çš„è¯ï¼Œä¼šè§¦å‘updateå‡½æ•° mounted() { console.log(\"--------------------\") console.log(\"Mounted\") //console.log(this.message+\"æˆ‘è§¦å‘äº†updateå‡½æ•°ï¼Œæ‰€æœ‰æ¸²æŸ“çš„å†…å®¹ä¹Ÿå˜äº†\")) console.log(\"over\") }, //å¾ªç¯é˜¶æ®µå¿…é¡»è§¦å‘æ‰èƒ½è¿›å…¥ï¼Œè§¦å‘æ¡ä»¶å¦‚ä¿®æ”¹æ•°æ®ï¼Œä½†æ˜¯åœ¨Createdå’ŒbeforeMountä¸¤ä¸ªé˜¶æ®µ //æ˜¯ä¸ä¼šè§¦å‘beforeupdateè¿™ä¸ªé˜¶æ®µçš„ //ä¸å¯ä»¥æ›´æ”¹æ•°æ®ï¼Œå¦åˆ™æ­»å¾ªç¯ beforeUpdate() { console.log(\"--------------------\") console.log('beforeUpdate:é‡æ–°æ¸²æŸ“ä¹‹å‰è§¦å‘') console.log('ç„¶åvueçš„è™šæ‹Ÿdomæœºåˆ¶ä¼šé‡æ–°æ„å»ºè™šæ‹Ÿdomä¸ä¸Šä¸€æ¬¡çš„è™šæ‹Ÿdomæ ‘åˆ©ç”¨diffç®—æ³•è¿›è¡Œå¯¹æ¯”ä¹‹åé‡æ–°æ¸²æŸ“') }, //è¿™é‡Œä¸èƒ½æ›´æ”¹æ•°æ®ï¼Œå¦åˆ™ä¼šé™·å…¥æ­»å¾ªç¯ updated() { console.log(\"--------------------\") console.log('updated:æ•°æ®å·²ç»æ›´æ”¹å®Œæˆï¼Œdomä¹Ÿé‡æ–°renderå®Œæˆ') }, beforeDestroy() { console.log('beforeDestory:é”€æ¯å‰æ‰§è¡Œï¼ˆ$destroyæ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™å°±ä¼šæ‰§è¡Œï¼‰,ä¸€èˆ¬åœ¨è¿™é‡Œå–„å:æ¸…é™¤è®¡æ—¶å™¨ã€æ¸…é™¤éæŒ‡ä»¤ç»‘å®šçš„äº‹ä»¶ç­‰ç­‰...') }, destroyed() { console.log('destroyed:ç»„ä»¶çš„æ•°æ®ç»‘å®šã€ç›‘å¬...éƒ½å»æ‰äº†,åªå‰©ä¸‹domç©ºå£³ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥å–„å') },}) è¾“å‡ºå†…å®¹ è¿™ä¸ªç”Ÿå‘½å‘¨æœŸçš„å¦‚å›¾1.é¦–å…ˆåˆ›å»ºä¸€ä¸ªvueå®ä¾‹ new Vue() ,è¿™æ—¶å€™ä»–åªæ˜¯ä¸€ä¸ªç©ºçš„å£³å­ï¼Œæ— æ³•è®¿é—®åˆ°æ•°æ®å’ŒçœŸå®çš„domã€‚â€”-> beforeCreateã€‚ åˆ›å»ºå®Œå®ä¾‹ä¹‹åå°±ä¼šæ‰§è¡Œ beforeCreate,åœ¨ beforeCreateä¸­ä¸€èˆ¬ä¸æ‰§è¡Œä»»ä½•çš„æ“ä½œ 2.ä¹‹åæ‰§è¡Œ createdå‡½æ•°ï¼Œè¿™ä¸ªæ—¶å€™å·²ç»åŠ è½½äº†æ•°æ®ï¼Œä½†æ˜¯æ²¡æœ‰åˆ›å»ºè™šæ‹Ÿdom 3.ä¹‹åæ‰§è¡Œ beforeMountå‡½æ•°ï¼Œè¿™ä¸ªæ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿçš„dom ï¼ŒåŒæ—¶ä¹ŸåŠ è½½äº†æ•°æ®ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä¿®æ”¹æ•°æ®ï¼Œè€Œä¸”åœ¨æ­¤ä¹‹å‰ä¿®æ”¹çš„æ•°æ®éƒ½ä¸ä¼šè§¦å‘update 4.ä¹‹åæ‰§è¡Œmountedå‡½æ•°ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœä½ ä¿®æ”¹äº†æ•°æ®åˆ™ä¼šè§¦å‘updateå‡½æ•° 5.updateå‡½æ•°éœ€è¦è¢«è§¦å‘ 6.destroyed é”€æ¯","link":"/posts/6412f439/"},{"title":"å›¾è§£ç®—æ³•","text":"è¿™ä¸ªåšæ–‡å¯èƒ½è·Ÿå›¾è§£ç®—æ³•çš„å†…å®¹è®²çš„ä¸ä¸€æ ·ï¼Œä¸€èˆ¬éƒ½æ˜¯çœ‹äº†ä¹¦ä¹‹åæ¢ä¸€ç§è‡ªå·±è®¤ä¸ºæ›´åŠ å½¢è±¡çš„æ¯”å–»å»ç†è§£å†…å®¹ï¼Œå¦‚æœæƒ³è¦çœ‹å›¾è§£ç®—æ³•çš„å¯ä»¥å»è´­ä¹°æˆ–è€…æŸ¥æ‰¾ä¸€äº›PDFçš„ä¹¦ç±ï¼Œç¬”è®°å¯¹äºç®—æ³•å’Œæ•°æ®ç»“æ„å¹¶ä¸åƒè¯­è¨€é‚£æ ·ï¼Œå¯¹äºç‰ˆæœ¬çš„æ›´è¿­æœ‰ä¸€å®šç¨‹åº¦çš„å½±å“ã€‚å¦å¤–ï¼Œç®—æ³•å›¾è§£è¿™æœ¬ä¹¦ä¸­çš„å®ä¾‹éƒ½æ˜¯ä¾é Pythonç¼–å†™çš„ã€‚ äºŒåˆ†æŸ¥æ‰¾å…¶å®äºŒåˆ†æ³•åœ¨æˆ‘ä»¬ç”Ÿæ´»ä¸­å·²ç»å‡ºç°è¿‡äº†å¾ˆå¤šæ¬¡ï¼Œæ¯”å¦‚ç©ä¸€ä¸ªçŒœä»·æ ¼æ¸¸æˆï¼Œè§„å®šä»·æ ¼åœ¨500-1000ä¹‹å†…ï¼Œå¦‚æœæˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªçš„å»çŒœï¼Œåˆ™éœ€è¦çŒœ1000-500-2æ¬¡ï¼Œä½†æ˜¯ä½¿ç”¨äºŒåˆ†æ³•çŒœæµ‹ä»·æ ¼æ—¶ï¼Œå³æ¯æ¬¡å¯¹åŠçŒœæµ‹ä»·æ ¼ï¼Œé‚£ä¹ˆæ¯æ¬¡éƒ½å¯ä»¥å‡å»ä¸€åŠçš„é”™è¯¯ä»·æ ¼ï¼Œå°±åƒä¸€å¼ ç™½çº¸å¯¹åŠæŠ˜ä¸€æ ·ï¼Œæœ€åçš„åŒºåŸŸåˆ™ä¼šè¶Šæ¥è¶Šå°ã€‚è€Œä½¿ç”¨çš„æ¬¡æ•°åˆ™æ˜¯log2næ­¥ã€‚åŒæ ·çš„ä¾‹å­ä¹Ÿå­˜åœ¨äºå­—å…¸ä¸­ï¼ŒæŸ¥å­—å…¸çš„æ‰‹æ³•åŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨äºŒåˆ†æ³•ã€‚ æ¦‚å¿µ:æœ€å¤šéœ€è¦çŒœæµ‹çš„æ¬¡æ•°ä¸åˆ—è¡¨é•¿åº¦ç›¸åŒï¼Œè¿™è¢«ç§°ä¸ºçº¿æ€§æ—¶é—´ ä¾‹å­1åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªæœ‰åºæ•°ç»„å’Œä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæŒ‡å®šçš„å…ƒç´ å‡ºç°åœ¨æ•°ç»„ä¸­ï¼Œåˆ™è¿”å›å…¶ä½ç½® def filter_number(list,keywords): for i in range(len(list)): if list[i] == keywords: print(i)if __name__ == \"__main__\": list = [1,2,4,5,343,67,86,656] keywords = 343 filter_number(list,keywords) å¦‚ä¸Šæ‰€ç¤ºæ˜¯æ™®é€šçš„éå†æ–¹æ³•ï¼Œéå†5æ¬¡åå¾—åˆ°343è¿™ä¸ªå‚æ•°ã€‚ä½†å¦‚æœåŒ¹é…çš„æ•°å­—æ˜¯656ï¼Œåˆ™éœ€è¦åŒ¹é…7æ¬¡ï¼Œå¦‚æœæ•°ç»„çš„é•¿åº¦æ˜¯1000,åŒ¹é…çš„ç»“æœæ˜¯æœ€åä¸€ä¸ªï¼Œåˆ™éœ€è¦åŒ¹é…1000æ¬¡ï¼Œè¿™æ ·å°±å¢åŠ äº†è´Ÿæ‹… # äºŒåˆ†æŸ¥æ‰¾åŒ¹é…def filter_number(list,keywords): first = 0 end = len(list) - 1 while first","link":"/posts/90ec9eea/"},{"title":"vimå¿«æ·é”®","text":"vimå¿«æ·é”®VIM æ˜¯ Linux ç³»ç»Ÿä¸Šä¸€æ¬¾æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå®ƒæ˜¯æ“ä½œ Linux çš„ä¸€æ¬¾åˆ©å™¨ã€‚å½“å‰æœ‰å¾ˆå¤šä¼˜ç§€çš„ IDE éƒ½æ”¯æŒå®‰è£… VIM æ’ä»¶ï¼ŒåŸå› å°±æ˜¯ä½¿ç”¨å®ƒä¾¿æ·ï¼Œé«˜æ•ˆï¼Œå¾ˆçˆ½ï¼ä¸»è¦è®°å½•äº† VIM çš„ä¸€äº›å¸¸ç”¨ä½¿ç”¨æŠ€å·§ï¼Œæ–¹ä¾¿éšæ—¶æŸ¥é˜…å­¦ä¹  ã€‚ å¿«æ·é”®# è·³è½¬åˆ°è¡Œé¦– esc->0 -> shift+i # è·³è½¬åˆ°è¡Œå°¾ esc->shift+a ç¼–è¾‘ æ¸…ç©ºå½“å‰è¡Œï¼Œå¹¶è¿›å…¥ç¼–è¾‘æ¨¡å¼ cc æ¸…ç©ºå½“å‰å•è¯ï¼Œå¹¶è¿›å…¥ç¼–è¾‘æ¨¡å¼ cw","link":"/posts/e47927c/"},{"title":"æ·±æ‹·è´ä¸æµ…æ‹·è´","text":"æ•°æ®ç±»å‹æ•°æ®åˆ†ä¸º åŸºæœ¬æ•°æ®ç±»å‹(String, Number, Boolean, Null, Undefinedï¼ŒSymbol) å¯¹è±¡æ•°æ®ç±»å‹ã€‚ åŸºæœ¬æ•°æ®ç±»å‹çš„ç‰¹ç‚¹: ç›´æ¥å­˜å‚¨åœ¨æ ˆ(stack)ä¸­çš„æ•°æ® å¼•ç”¨æ•°æ®ç±»å‹çš„ç‰¹ç‚¹ï¼šå­˜å‚¨çš„æ˜¯è¯¥å¯¹è±¡åœ¨æ ˆä¸­å¼•ç”¨ï¼ŒçœŸå®çš„æ•°æ®å­˜æ”¾åœ¨å †å†…å­˜é‡Œå¼•ç”¨æ•°æ®ç±»å‹åœ¨æ ˆä¸­å­˜å‚¨äº†æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘å †ä¸­è¯¥å®ä½“çš„èµ·å§‹åœ°å€ã€‚å½“è§£é‡Šå™¨å¯»æ‰¾å¼•ç”¨å€¼æ—¶ï¼Œä¼šé¦–å…ˆæ£€ç´¢å…¶åœ¨æ ˆä¸­çš„åœ°å€ï¼Œå–å¾—åœ°å€åä»å †ä¸­è·å¾—å®ä½“ã€‚ [å›¾] æ·±æ‹·è´å’Œæµ…æ‹·è´æ·±æ‹·è´å’Œæµ…æ‹·è´æ˜¯åªé’ˆå¯¹Objectå’ŒArrayè¿™æ ·çš„å¼•ç”¨æ•°æ®ç±»å‹çš„ã€‚æµ…æ‹·è´åªå¤åˆ¶æŒ‡å‘æŸä¸ªå¯¹è±¡çš„æŒ‡é’ˆï¼Œè€Œä¸å¤åˆ¶å¯¹è±¡æœ¬èº«ï¼Œæ–°æ—§å¯¹è±¡è¿˜æ˜¯å…±äº«åŒä¸€å—å†…å­˜ã€‚ä½†æ·±æ‹·è´ä¼šå¦å¤–åˆ›é€ ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„å¯¹è±¡ï¼Œæ–°å¯¹è±¡è·ŸåŸå¯¹è±¡ä¸å…±äº«å†…å­˜ï¼Œä¿®æ”¹æ–°å¯¹è±¡ä¸ä¼šæ”¹åˆ°åŸå¯¹è±¡ã€‚æ˜¯å’ŒLinuxä¸­çš„è½¯ç¡¬é“¾æ¥æœ‰å…³ç³»å— èµ‹å€¼å’Œæµ…æ‹·è´çš„åŒºåˆ« å½“æˆ‘ä»¬æŠŠä¸€ä¸ªå¯¹è±¡èµ‹å€¼ç»™ä¸€ä¸ªæ–°çš„å˜é‡æ—¶ï¼Œèµ‹çš„å…¶å®æ˜¯è¯¥å¯¹è±¡çš„åœ¨æ ˆä¸­çš„åœ°å€ï¼Œè€Œä¸æ˜¯å †ä¸­çš„æ•°æ®ã€‚ä¹Ÿå°±æ˜¯ä¸¤ä¸ªå¯¹è±¡æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå­˜å‚¨ç©ºé—´ï¼Œæ— è®ºå“ªä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜ï¼Œå…¶å®éƒ½æ˜¯æ”¹å˜çš„å­˜å‚¨ç©ºé—´çš„å†…å®¹ï¼Œå› æ­¤ï¼Œä¸¤ä¸ªå¯¹è±¡æ˜¯è”åŠ¨çš„ã€‚ æµ…æ‹·è´æ˜¯æŒ‰ä½æ‹·è´å¯¹è±¡ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æœ‰ç€åŸå§‹å¯¹è±¡å±æ€§å€¼çš„ä¸€ä»½ç²¾ç¡®æ‹·è´ã€‚å¦‚æœå±æ€§æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ‹·è´çš„å°±æ˜¯åŸºæœ¬ç±»å‹çš„å€¼ï¼›å¦‚æœå±æ€§æ˜¯å†…å­˜åœ°å€ï¼ˆå¼•ç”¨ç±»å‹ï¼‰ï¼Œæ‹·è´çš„å°±æ˜¯å†…å­˜åœ°å€ ï¼Œå› æ­¤å¦‚æœå…¶ä¸­ä¸€ä¸ªå¯¹è±¡æ”¹å˜äº†è¿™ä¸ªåœ°å€ï¼Œå°±ä¼šå½±å“åˆ°å¦ä¸€ä¸ªå¯¹è±¡ã€‚å³é»˜è®¤æ‹·è´æ„é€ å‡½æ•°åªæ˜¯å¯¹å¯¹è±¡è¿›è¡Œæµ…æ‹·è´å¤åˆ¶(é€ä¸ªæˆå‘˜ä¾æ¬¡æ‹·è´)ï¼Œå³åªå¤åˆ¶å¯¹è±¡ç©ºé—´è€Œä¸å¤åˆ¶èµ„æºã€‚ æµ…æ‹·è´ä¸æ·±æ‹·è´ https://www.runoob.com/w3cnote/python-understanding-dict-copy-shallow-or-deep.htmlhttps://juejin.im/post/5b5dcf8351882519790c9a2e#heading-7","link":"/posts/23ccefd3/"},{"title":"20200128","text":"å¤šäº‘ï¼Œæ²¡ä¸‹é›¨ï¼Œå¤©æ°”è¿˜å¥½ï¼Œé£è¿˜æ˜¯è›®å†·çš„ã€‚ è‡ªå·±å¥½åƒå·²ç»æ²¡æœ‰å¤šå°‘åŠ›æ°”æ‰“å­—äº†ã€‚ å¤–é¢æ­£æµä¼ è¿™æ–°çš„å† æ€§ç—…æ¯’ï¼Œå®¶å®¶æˆ·æˆ·éƒ½å¾…åœ¨å®¶é‡Œä¸æ•¢å‡ºå»ï¼Œå¥½å¥½äººéƒ½èšé›†åœ¨æ­¦æ±‰æ•‘åŠ©è¿™æ¬¡ç—…æºåœ°ï¼Œè€Œæˆ‘åœ¨æ­å·ï¼Œæ‘å­é‡Œä¹Ÿæ²¡ä»€ä¹ˆå¤ªå¤§çš„åŠ¨é™ï¼Œä¸å¸¦å£ç½©çš„ä¾æ—§ä¸å¸¦ï¼Œæˆ´å£ç½©çš„æŠŠè‡ªå·±è£¹å¾—ä¸¥ä¸¥å®å®ã€‚ æˆ‘ä¹Ÿä¸çŸ¥é“è‡ªå·±æœ‰æ²¡æœ‰å¾—è¿™ä¸ªç—…ï¼Œæ€»ä¹‹æ˜¯æ— åŠ›çš„ ä½çƒ§çš„ å¶å°”å’³å—½çš„ï¼Œä»–ä»¬è¯´è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œä»Šå¤©æƒ³æ˜ç™½å»åŒ»é™¢çœ‹ä¸€ä¸‹ï¼Œæˆ‘èµ°è¿›äº†å‘çƒ­é—¨è¯Šï¼Œä»–ä»¬è¯´ä»–ä»¬åªæ¥å—38åº¦çš„ï¼Œç„¶åæˆ‘è·‘å»äº†æ™®é€šé—¨è¯Šï¼Œä¸€ç•ªé¢ ç°¸ä¹‹ä¸‹ç®—æ˜¯æŒ‚ä¸Šäº†å·ï¼Œç´§æ¥ç€åˆæ˜¯è¦æŠ½è¡€ åˆæ˜¯è¦åšCTçš„ï¼ŒçœŸçš„å¥½æ— è¯­ï¼›è‡ªå·±æœ¬æ¥å°±æ²¡æœ‰æ€ä¹ˆå»è¿‡åŒ»é™¢æ£€æŸ¥ï¼Œä»Šå¤©åšäº†ä¸Šå»ï¼Œè·Ÿæˆ‘è¯´æ²¡æœ‰ä»˜é’±åˆ«åç€ã€‚ã€‚ è›®ç´¯çš„ï¼Œæ²¡æœ‰åŠ›æ°”ï¼Œçš„ç¡®æ˜¯æ²¡æœ‰åŠ›æ°”","link":"/posts/f2caabf2/"},{"title":"extra-net","text":"Supplementary Info é¢å¤–çŸ¥è¯†ç§ç½‘åœ°å€æœ‰ä¸‰ä¸ªç½‘æ®µï¼š10.x.x.x172.16.x.xè‡³172.31.x.x192.168.x.x","link":"/posts/2a24e761/"},{"title":"rustçŒœè°œæ¸¸æˆ","text":"rustçŒœè°œæ¸¸æˆèµ°å®Œäº†hello worldçš„æµç¨‹ä¹‹åï¼Œæ¥åšä¸€ä¸ªçŒœæ•°å­—çš„æ¸¸æˆ rusté¡¹ç›®ç»“æ„ç”Ÿæˆä¸€ä¸ªåŸºæœ¬é¡¹ç›® cargo new guessing_nametree . âœ guessing_game git:(master) âœ— tree ..â”œâ”€â”€ Cargo.tomlâ””â”€â”€ src â””â”€â”€ main.rs Cargo.tomlæ–‡ä»¶âœ guessing_game git:(master) âœ— cat Cargo.toml[package]name = \"guessing_game\"version = \"0.1.0\"authors = [\"alpaca \"]edition = \"2018\"# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html è¿™ä¸ªé‡Œé¢å­˜å‚¨äº†è¯¥é¡¹ç›®çš„ä¿¡æ¯, nameè¡¨ç¤ºé¡¹ç›®åå­— version è¡¨ç¤ºcargo ç‰ˆæœ¬ authors è¡¨ç¤ºä½œè€…ä¿¡æ¯ edition è¡¨ç¤ºå¹´ä»½ main.rsæ–‡ä»¶è¿™ä¸ªæ–‡ä»¶å°±æ˜¯ä½ å†™çš„ç¨‹åº è¿è¡Œè¯¥ç¨‹åºè¿è¡Œè¯¥ç¨‹åºæœ‰ä¸¤ç§æ–¹æ³• ä¸€ç§æ˜¯å…ˆç¼–è¯‘åæ‰§è¡Œ rustc src/main.rs å¦å¤–ä¸€ç§æ˜¯ç›´æ¥ç”¨cargoè¿è¡Œ cargo run âœ guseeing_game git:(master) âœ— tree ..â”œâ”€â”€ Cargo.lockâ”œâ”€â”€ Cargo.tomlâ”œâ”€â”€ srcâ”‚ â””â”€â”€ main.rsâ””â”€â”€ target â””â”€â”€ debug â”œâ”€â”€ build â”œâ”€â”€ deps â”‚ â”œâ”€â”€ guseeing_game-0ed5a31a6f15733b â”‚ â”œâ”€â”€ guseeing_game-0ed5a31a6f15733b.d â”‚ â””â”€â”€ guseeing_game-0ed5a31a6f15733b.dSYM â”‚ â””â”€â”€ Contents â”‚ â”œâ”€â”€ Info.plist â”‚ â””â”€â”€ Resources â”‚ â””â”€â”€ DWARF â”‚ â””â”€â”€ guseeing_game-0ed5a31a6f15733b â”œâ”€â”€ examples â”œâ”€â”€ guseeing_game â”œâ”€â”€ guseeing_game.d â”œâ”€â”€ guseeing_game.dSYM -> deps/guseeing_game-0ed5a31a6f15733b.dSYM â””â”€â”€ incremental â””â”€â”€ guseeing_game-1u6x8rdyd2mj5 â”œâ”€â”€ s-fiv8l6i4ic-1486aks-139msrfhaunjd â”‚ â”œâ”€â”€ 1651w9kfz3huxj9a.o â”‚ â”œâ”€â”€ 24om6g1u5n10ayrw.o â”‚ â”œâ”€â”€ 2hv2ystwqwaqr9uj.o â”‚ â”œâ”€â”€ 3701sophdbnzpjeb.o â”‚ â”œâ”€â”€ 407p5s5dk77zb92h.o â”‚ â”œâ”€â”€ 4eavspy520jyuwpr.o â”‚ â”œâ”€â”€ dep-graph.bin â”‚ â”œâ”€â”€ query-cache.bin â”‚ â””â”€â”€ work-products.bin â””â”€â”€ s-fiv8l6i4ic-1486aks.lock ä½ ä¼šå‘ç°è¿™ä¸¤ç§è¿è¡Œçš„ç»“æœæ‰€åˆ›å»ºçš„æ–‡ä»¶ç»“æ„æ˜¯ä¸åŒçš„ è·å–å±å¹•å†…å®¹å¹¶è¾“å‡ºuse std::io;fn main() { println!(\"Guess the number!\"); println!(\"Please input your guess.\"); let mut guess = String::new(); io::stdin().read_line(&mut guess) .expect(\"Failed to read line\"); println!(\"You guessed: {}\", guess);} åŒ…å«è¯­å¥å’Œè¡¨è¾¾å¼çš„å‡½æ•°ä½“ å‡½æ•°ä½“æœ‰ä¸€ç³»åˆ—çš„è¯­å¥å’Œä¸€ä¸ªå¯é€‰çš„ç»“å°¾çš„è¡¨è¾¾å¼æ„æˆ rustæ˜¯åŸºäºè¡¨è¾¾å¼çš„è¯­è¨€ ç”¨åˆ†å·åŒºåˆ†è¯­å¥å’Œè¡¨è¾¾å¼ è¯­å¥æ˜¯æ‰§è¡Œä¸€äº›æ“ä½œä½†ä¸è¿”å›å€¼çš„æŒ‡ä»¤ è¡¨è¾¾å¼è®¡ç®—å¹¶äº§ç”Ÿä¸€ä¸ªå€¼è¿”å› ç”¨letå…³é”®å­—åˆ›å»ºå˜é‡å¹¶ç»‘å®šä¸€ä¸ªå€¼æ˜¯ä¸€ä¸ªè¯­å¥ æ¯”å¦‚let y = 6; äºæ˜¯å½“æˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹ fn main(){ let x = (let y =6);} let y = 6 æ˜¯ä¸€ä¸ªè¯­å¥å¹¶ä¸ä¼šè¿”å›ä¸€ä¸ªå€¼æ¥ä½¿å¾—xç»‘å®šï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ let y = 6; æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ ï¼Œè¿”å›6 å‡½æ•°è°ƒç”¨æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ {} æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ å…·æœ‰è¿”å›å€¼çš„å‡½æ•° å‡½æ•°å¯ä»¥å‘è°ƒç”¨å®ƒçš„ä»£ç è¿”å›å€¼ã€‚æˆ‘ä»¬å¹¶ä¸å¯¹è¿”å›å€¼å‘½åï¼Œä½†è¦åœ¨ç®­å¤´ï¼ˆ->ï¼‰åå£°æ˜å®ƒçš„ç±»å‹ å‡½æ•°çš„è¿”å›å€¼ç­‰åŒäºå‡½æ•°ä½“æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ ä½¿ç”¨ return å…³é”®å­—å’ŒæŒ‡å®šå€¼ï¼Œå¯ä»å‡½æ•°ä¸­æå‰è¿”å›ï¼›ä½†å¤§éƒ¨åˆ†å‡½æ•°éšå¼çš„è¿”å›æœ€åçš„è¡¨è¾¾å¼ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰è¿”å›å€¼çš„å‡½æ•°çš„ä¾‹å­ï¼š fn five() -> i32{ 5 } fn main(){ let x = five(); println!(\"the value of x is {} \",x )} ä»¥ä¸Šä»£ç ç­‰åŒäºï¼Œ {}æ˜¯è¡¨è¾¾å¼ è¿”å›5ç»™five()å‡½æ•°ï¼Œ let x = five();æ˜¯è¯­å¥ï¼Œä¸è¿”å›å€¼ï¼Œäºæ˜¯let x = 5; fn main(){ let x =5 ;} fn plus_one (x: i32) -> i32{ x + 1} fn main(){ let x = plus_one(5) println!(\"the value of x is :{}\",x);} æ³¨é‡Š rustä¸­æ˜¯ç”¨// è¿›è¡Œæ³¨é‡Š æ§åˆ¶ é€»è¾‘æ“ä½œifè¯­å¥ fn main() { let number = 3; if number < 5 { println!(\"condition was true\"); } else { println!(\"condition was false\"); } if number!=0{ println!(\"nuf mber was something other than zero\") } else if number != 2{ println!(\"the number was something other than two\") } else { println!(\"the number go\") }} åœ¨letä¸­ä½¿ç”¨iffn main(){ let } loopè¯­å¥ fn main() { loop { println!(\"again!\"); }} fn main() { let mut counter = 0; let result = loop { counter += 1; if counter == 10 { break counter * 2; } }; println!(\"The result is {}\", result);} whileæ¡ä»¶å¾ªç¯ fn main() { let mut number = 3; while number != 0 { println!(\"{}!\", number); number = number - 1; } println!(\"LIFTOFF!!!\");} for éå†å¾ªç¯ fn main() { let a = [10, 20, 30, 40, 50]; for element in a.iter() { println!(\"the value is: {}\", element); }} fn main() { // .rev()åè½¬ 1..4 4å–ä¸åˆ° for number in (1..4).rev() { println!(\"{}!\", number); } println!(\"LIFTOFF!!!\");}","link":"/posts/93aa081f/"},{"title":"RuståŸºç¡€","text":"Installurl https://www.rust-lang.org/zh-CN/tools/install curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh while you input enter ï¼Œwill install rust default ä¸Šé¢è¿™æ¡å‘½ä»¤ä¼šå®‰è£…ä¸€äº›å†…å®¹ï¼Œæ¯”å¦‚ cargo rustupå¦‚æœä½ æƒ³è¦ä½¿ç”¨ä»–ä»¬ï¼Œéœ€è¦å°†ä»–ä»¬æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ # æ–¹æ³•1source $HOME/.cargo/env# æ–¹æ³•2export PATH=\"$HOME/.cargo/bin:$PATH\" # å…¶å®envé‡Œé¢å†™çš„å°±æ˜¯æ–¹æ³•2# æŸ¥çœ‹æ˜¯å¦å®‰è£…å®Œæˆrustc --versionrustc 1.39.0 (4560ea788 2019-11-04) updateæ›´æ–°ç‰ˆæœ¬, rustupç”¨æ¥ç®¡ç†rustçš„ç‰ˆæœ¬,rustæ¯6ä¸ªç¤¼æ‹œä¼šè¿›è¡Œä¸€æ¬¡ç‰ˆæœ¬è¿­ä»£ï¼Œä½¿ç”¨rustup updateæ›´æ–°ç‰ˆæœ¬ rustup update cargoå·¥å…·Cargoï¼šRust çš„æ„å»ºå·¥å…·å’ŒåŒ…ç®¡ç†å™¨ cargo build #æ„å»ºé¡¹ç›®cargo run # æ„å»ºå¹¶è¿è¡Œé¡¹ç›®cargo test # æµ‹è¯•é¡¹ç›®cargo doc # ä¸ºé¡¹ç›®æ„å»ºæ–‡æ¡£cargo publish # å°†åº“å‘å¸ƒåˆ°cartes.io cargo new xxproject # åˆ›å»ºxxprojecté¡¹ç›®# cargo å¼€å‘è€…ç¤¾åŒº cargo ä½¿ç”¨cargo new helloworld # åˆ›å»ºä¸€ä¸ªé¡¹ç›®helloworld # ç”Ÿæˆå¦‚ä¸‹æ–‡ä»¶[root@dev rustttt]# tree ..â””â”€â”€ helloworld â”œâ”€â”€ Cargo.toml â””â”€â”€ src â””â”€â”€ main.rs Cargo.tomlä¸­åŒ…å«äº†ç¼–è¯‘ä½ é¡¹ç›®æ—¶æ‰€éœ€è¦çš„å†…å®¹æ¸…å• src/main.rs ä¸­åŒ…å«äº†ä¸»ç¨‹åº ä½¿ç”¨cargo build æ„å»ºé¡¹ç›®,ç¼–è¯‘å®Œæˆä¹‹åï¼Œä¼šåœ¨ç”Ÿæˆä¸€ä¸ªç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ‰§è¡Œä»–ä»¬ [root@dev helloworld]# ./target/debug/helloworldHello, world! ä½¿ç”¨cargo run æ„å»ºé¡¹ç›®å¹¶è¿è¡Œã€‚ [root@dev helloworld]# cargo run Compiling helloworld v0.1.0 (/root/rustttt/helloworld) Finished dev [unoptimized + debuginfo] target(s) in 0.51s Running `target/debug/helloworld`Hello, world! å…·ä½“æ˜¯ä½¿ç”¨æ–‡æ¡£https://doc.rust-lang.org/cargo/guide/index.html ç¼–è¯‘rustæ–‡ä»¶ rustc# ä½¿ç”¨cargo buildåˆ›å»ºhelloworldç›®å½•cargo build helloworldcd helloworld/src/# ç¼–è¯‘æ–‡ä»¶rustc main.rs ./main# è¾“å‡ºå†…å®¹hello wolrd otherä¸ä¸‹è½½ç¯å¢ƒï¼Œç›´æ¥æµ‹è¯•ä»£ç https://play.rust-lang.orgRustå®˜æ–¹æ–‡æ¡£https://www.rust-lang.org/zh-CN/tools/install","link":"/posts/4fbe8671/"},{"title":"Pythonçˆ¬YouTubeè§†é¢‘","text":"youtubeè§†é¢‘çˆ¬è™«ç¼˜ç”±æœ€è¿‘æƒ³å­¦ä¹ nginxï¼Œæ— å¥ˆæ²¡æœ‰å¥½çš„è§†é¢‘ï¼Œç½‘ä¸Šçš„æ•™ç¨‹ä¹Ÿæ˜¯é›¶é›¶æ•£æ•£çš„ï¼Œæ…•è¯¾ç½‘ 51CTO æ·˜å®ä¸Šåˆä¹°ä¸åˆ°å¤ªå¥½çš„æ•™ç¨‹ï¼Œä¸»è¦è¿˜æ˜¯è´µï¼Œä¹°æ¥è¦æ˜¯è®²çš„çƒ‚è¿˜ä¸èƒ½é€€QAQ äºæ˜¯ï¼Œåœ¨YouTobeä¸Šæœç´¢äº†ä¸€ä¸‹nginxçš„æ•™ç¨‹ï¼Œæˆ‘çš„å¤©å“ªï¼æ²¹ç®¡ç®€ç›´å°±æ˜¯ä¸€å—å®åœ°ï¼Œå¥½å¤šä»˜è´¹çš„è§†é¢‘ä¸Šé¢éƒ½èƒ½æ‰¾åˆ°ï¼Œé•¿æœŸæ··è¿¹Bç«™æ‰¾è§†é¢‘çš„æˆ‘ï¼Œå†³å®šèµ¶ç´§ä¸‹ä¸‹æ¥ï¼Œç”Ÿæ€•å¾…ä¼šå°±æ²¡äº†ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•æ‰¹é‡ä¸‹è½½è¿™äº›è§†é¢‘å‘¢ï¼Ÿ å½“ç„¶æ‹‰ï¼Œèƒ½ä¸ç™½å«–è¿˜ä¸æ˜¯ä¸è¦ç™½å«–ï¼Œè¦æ˜¯è®²çš„å¥½ï¼ŒèµåŠ©ä¸€ä¸‹ä¹Ÿå¾ˆé‡è¦ ä½¿ç”¨you-getGithubåœ°å€: https://github.com/soimort/you-getä¸å¾—ä¸è¯´ï¼Œå…‰çœ‹ä»–çš„starï¼Œåˆæ˜¯ä¸€å—å®è—QAQ ç¼–å†™è„šæœ¬æ—¢ç„¶æœ‰äº†ä¸‹è½½å™¨ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä½¿ç”¨è„šæœ¬æ‰¹é‡ä¸‹è½½äº†ã€‚you-getæ˜¯æ ¹æ®æ²¹ç®¡çš„è§†é¢‘ç½‘é¡µåœ°å€å»ä¸‹è½½è§†é¢‘çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è®°å½•è¿™ä¸€ç»„è§†é¢‘åˆ—è¡¨ä¸­çš„urlåœ°å€ã€‚https://www.youtube.com/watch?v=Do1Opl6DbvM&list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzDhttps://www.youtube.com/watch?v=wZAf-aE2KoI&list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzDhttps://www.youtube.com/watch?v=ULcqKLwf6fE&list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzDå¦‚ä¸Šæ˜¯ä¸‰ä¸ªæµ‹è¯•åœ°å€ï¼Œå¾ˆä¸å¹¸çš„æ˜¯ä»–ä»¬ä¹‹é—´å­˜åœ¨è§„å¾‹ï¼Œä½†å”¯ä¸€å‘ç”Ÿå˜åŒ–çš„v=uid å…¶ä¸­çš„idæ˜¯ä¸€ä¸²éšæœºå­—ç¬¦ï¼Œä½†å½“æˆ‘ä»¬ä¸æ–­åˆ·æ–°å½“å‰é¡µé¢æ—¶ä¼šå‘ç°ï¼Œuidå¹¶æ²¡æœ‰æ”¹å˜ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ä»–ä»¬çš„æ•°æ®åº“ä¸­å­˜åœ¨ä¸€ä¸ªkey-valueçš„å€¼ï¼Œæ¯ä¸€ä¸ªè§†é¢‘å¯¹ä¸€ä¸ªéšæœºuid,å¹¶ä¸”å½“è¿™ç›¸å¯¹çš„å…³ç³»ç”Ÿæˆä¹‹åï¼Œéšæœºuidä¸ä¼šå†å‘ç”Ÿæ”¹å˜ã€‚ è·å–uidæ—¢ç„¶ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç”¨çˆ¬è™«æ¥è·å–è¿™äº›uidæŠŠæ³¨æ„ åƒè¿™æ ·çš„é¡µé¢è™½ç„¶åœ¨ä»–çš„å³ä¾§å‡ºç°äº†åˆ—è¡¨ï¼Œä½†è¿™æ ·çš„æƒ…å†µåœ¨å½“æˆ‘ä»¬ä½¿ç”¨çˆ¬è™«+æ­£åˆ™çš„æ—¶ï¼Œä¼šè¢«ä¸‹æ–¹çš„è§†é¢‘è¿æ¥å¹²æ‰°ï¼Œå› æ­¤æœ€å¥½å…ˆè¿›å…¥æ’­æ”¾åˆ—è¡¨åå†çˆ¬å–åƒå½“å‰é¡µé¢è¿™æ ·ï¼Œæˆ‘ä»¬æ‰€è·å–å‡ºæ¥çš„uidå°±ç›¸å¯¹äºå®Œæ•´ä¸€äº› æ•´ç†å¾ªç¯ä¸‹è½½OK,æœ‰äº†uidå†åŠ ä¸Šä¹‹å‰æˆ‘ä»¬å‘ç°çš„ä¸å˜çš„å…ƒç´ ï¼Œé‚£ä¹ˆä¸€æ¡æ¡å®Œæ•´çš„è§†é¢‘é“¾æ¥å°±æœ‰äº† æºç #!/usr/bin/python3from you_get import common as you_getimport sysimport osimport timeimport requestsimport restatic_url = \"https://www.youtube.com{0}list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzD\"file_path = \"D:\\\\video\\youtobe_nginx_mooc\"# file_path = \"F:\\\\video\\youtobe_nginx_mooc\"resp = requests.get(\"https://www.youtube.com/playlist?list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzD\")pattern = \"\\/watch\\?v=[0-9a-zA-Z_-]{11}&\"video_url_lists = re.findall(pattern,resp.text)# å»é‡video_url_lists = list(set(video_url_lists))print(len(video_url_lists))for list in video_url_lists: format_url = static_url.format(list) print(format_url) print(\"start get video from YouTobe\") sys.argv = ['you-get','-o',file_path,format_url] you_get.main() time.sleep(1)print(\"download finished\")# print(type(resp)) ## ç”±äºè¿™æ˜¯è¿”å›çš„ç±»å‹æ˜¯ # ä½†æ˜¯åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œè¦æ±‚æ˜¯ä¸ºstrç±»å‹ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬ä½¿ç”¨pattern = re.findall('index' resp)æ—¶å€™å°±ä¼šæŠ¥é”™# æŠ¥é”™å†…å®¹ä¸ºTypeError: expected string or bytes-like object# ä¿®æ”¹ pattern = re.findall('index=',str(resp))# æˆ–è€…ä½¿ç”¨pattern = re.findall('index=',resp.text)\"\"\"\"https://www.bilibili.com/read/cv4360/https://www.jianshu.com/p/e323cf85bd3d\"\"\"\"\"\"https://www.youtube.com/watch?v=5i9Ce9vzGxE&list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzD&index=1https://www.youtube.com/watch?v=Do1Opl6DbvM&list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzD&index=1https://www.youtube.com/watch?v=R4p7xxd3BTo&list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzD&index=4https://www.youtube.com/watch?v=Do1Opl6DbvM&list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzD&index=1https://www.youtube.com/watch?v=Do1Opl6DbvM&list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzD&index=1/watch?v=Do1Opl6DbvM&list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzD&index=1https://www.youtube.com/watch?v=0JwSFgWUUQE&list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzDhttps://www.youtube.com/watch?v=fvxAQsRy8Kk&list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzD&index=8https://www.youtube.com/watch?v=R4p7xxd3BTo&list=PLAyxoOmo7O7eoz-Wkii_bwtBEbPwCWQzD&index=4\"\"\"","link":"/posts/b3a48f7b/"},{"title":"ruståŸºç¡€2","text":"ruståŸºç¡€å˜é‡å¸¸é‡rusté‡‡ç”¨å¤šç§å˜é‡çš„å®šä¹‰å½¢å¼ï¼ŒåŒæ—¶åœ¨å®šä¹‰çš„åŒæ—¶åŒºåˆ†äº†å˜é‡ä¸å¸¸é‡çš„åŒºåˆ« å®šä¹‰å˜é‡ä½¿ç”¨let xx=xx # é»˜è®¤immutableå®šä¹‰å¯å˜å˜é‡ let mut xx=xx # mut å¯å˜å®šä¹‰å¸¸é‡ const xx: u32 = 10000 # å¸¸é‡å®šä¹‰ åä¸ºxx ç±»å‹ä¸ºint32 å€¼ä¸º10000 å…¶ä¸­å¸¸é‡é»˜è®¤ä¸å˜ fn main() { let x = 5; println!(\"The value of x is:{}\",x); let mut y = 6; println!(\"The mut value of y is:{}\",y); //ä¿®æ”¹ä¸å¯å˜é‡x æŠ¥é”™ //x = 7 //println!(\"i upadte the x value 5 to {}\",x) y = 10; println!(\"i update the y value 6 to {}\",y); //å®šä¹‰å¸¸é‡,ä»–çš„åå­—æ˜¯MAX_POINTS const MAX_POINTS: u32 = 100_000; println!(\"is constants value MAX_POINTS: {}\",MAX_POINTS); //å˜é‡è¿­ä»£ éšè— //å¯¹å˜é‡çš„éšè—ï¼Œä¹Ÿå°±æ˜¯ä¸æ–­çš„å¯¹xè¿›è¡Œéšè— //è™½ç„¶å˜é‡xæ˜¯ä¸å¯å˜çš„immutable ä½†æ˜¯é‡å¤ä½¿ç”¨letå¯ä»¥å¤šæ¬¡è¿›è¡Œéšè—ï¼Œç”Ÿæˆä¹‹åçš„ä»å°±æ˜¯immutable let q = 5; let q = q + 5; let q = q + 10; println!(\"q:{}\",q) // let spaces = \" \"; let spaces_line = spaces.len(); println!(\"spance_lines_number:{}\",spaces_line) // let mut numbers = \" \"; numbers = numbers.len(); println!(\"{}\",numbers)} å¯å˜é‡mut å’Œéšè—shadowingæœ‰ä»€ä¹ˆåŒºåˆ«?mut ä¸éšè—çš„å¦ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œå½“å†æ¬¡ä½¿ç”¨ let æ—¶ï¼Œå®é™…ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ–°å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜å€¼çš„ç±»å‹ï¼Œå¹¶ä¸”å¤ç”¨è¿™ä¸ªåå­—ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ç¨‹åºè¯·æ±‚ç”¨æˆ·è¾“å…¥ç©ºæ ¼å­—ç¬¦æ¥è¯´æ˜å¸Œæœ›åœ¨æ–‡æœ¬ä¹‹é—´æ˜¾ç¤ºå¤šå°‘ä¸ªç©ºæ ¼ï¼Œç„¶è€Œæˆ‘ä»¬çœŸæ­£éœ€è¦çš„æ˜¯å°†è¾“å…¥å­˜å‚¨æˆæ•°å­—ï¼ˆå¤šå°‘ä¸ªç©ºæ ¼ï¼‰ datatypeæ•°æ®ç±»å‹rustæ˜¯é™æ€ç±»å‹è¯­è¨€(statically typed)ä¹Ÿå°±æ˜¯è¯´åœ¨ç¼–è¯‘æ—¶å°±å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚ æ•´å‹ åº¦ æœ‰ç¬¦å· æ— ç¬¦å·8-bit i8 u816-bit i16 u1632-bit i32 u3264-bit i64 u64128-bit i128 u128arch isize usize æœ‰ç¬¦å·å’Œæ— ç¬¦å·ä»£è¡¨æ•°å­—èƒ½å¦ä¸ºè´Ÿå€¼ï¼Œæœ‰ç¬¦å·æ•°ä»¥è¡¥ç å½¢å¼ï¼ˆtwoâ€™s complement representationï¼‰[https://kaisery.github.io/trpl-zh-cn/ch03-02-data-types.html] å­˜å‚¨ã€‚ æµ®ç‚¹å‹å®ƒä»¬æ˜¯å¸¦å°æ•°ç‚¹çš„æ•°å­—ã€‚Rust çš„æµ®ç‚¹æ•°ç±»å‹æ˜¯ f32 å’Œ f64ï¼Œåˆ†åˆ«å  32 ä½å’Œ 64 ä½ã€‚é»˜è®¤ç±»å‹æ˜¯ f64ï¼Œå› ä¸ºåœ¨ç°ä»£ CPU ä¸­ï¼Œå®ƒä¸ f32 é€Ÿåº¦å‡ ä¹ä¸€æ ·ï¼Œä¸è¿‡ç²¾åº¦æ›´é«˜ã€‚ fn main(){ let x = 2.0; //f64 let y: f32 = 3.0; //f32} æ•°å€¼è¿ç®—fn main(){ let sum = 5 + 32; let difference = 95.5 - 4.3; let product = 4 * 30; let quotient = 56.7 / 32.2; let remainder = 43 % 5;} å¸ƒå°”å‹fn main(){ let t = true ; let f: boole = false; // æ˜¾å¼æŒ‡å®šç±»å‹æ³¨è§£} å­—ç¬¦å‹charä½¿ç”¨å•å¼•å· stringä½¿ç”¨åŒå¼•å· fn main() { let c = 'z'; let z = 'â„¤'; let heart_eyed_cat = 'ğŸ˜»';} å…ƒç»„ç±»å‹å…ƒç»„æ˜¯ä¸€ä¸ªå°†å¤šä¸ªå…¶ä»–ç±»å‹çš„å€¼ç»„åˆè¿›ä¸€ä¸ªå¤åˆç±»å‹çš„ä¸»è¦æ–¹å¼ã€‚å…ƒç»„é•¿åº¦å›ºå®šï¼šä¸€æ—¦å£°æ˜ï¼Œå…¶é•¿åº¦ä¸ä¼šå¢å¤§æˆ–ç¼©å°ã€‚ fn main() { let tup: (i32, f64, u8) = (500, 6.4, 1);} fn main() { let tup = (500, 6.4, 1); let (x, y, z) = tup; println!(\"The value of y is: {}\", y);} ä½¿ç”¨è§£æ„æ‹†åˆ†å…ƒç¥–tup å¯¹åº”å…ƒç¥–å€¼ fn main() { let x: (i32, f64, u8) = (500, 6.4, 1); let five_hundred = x.0; let six_point_four = x.1; let one = x.2;} æ•°ç»„ç±»å‹fn main() { # å®šä¹‰æ–¹æ³•1 let a = [1, 2, 3, 4, 5]; # å®šä¹‰æ–¹æ³•2 let a: [i32; 5] = [1, 2, 3, 4, 5]; # å®šä¹‰æ–¹æ³•3 let a = [3;5] # => [3,3,3,3,3]} fn main() { let a = [1, 2, 3, 4, 5]; let first = a[0]; let second = a[1];} å‡½æ•°æ–¹æ³•fn main() { println!(\"Hello, world!\"); another_function();}fn another_function() { println!(\"Another function.\");} # åŠ å‚æ•°fn main() { another_function(5);}fn another_function(x: i32) { println!(\"The value of x is: {}\", x);}# å¤šå‚æ•°fn main() { another_function(5, 6);}fn another_function(x: i32, y: i32) { println!(\"The value of x is: {}\", x); println!(\"The value of y is: {}\", y);}","link":"/posts/bb04cef6/"},{"title":"rustç»“æ„ä½“","text":"å®šä¹‰å®ä¾‹åŒ–ç»“æ„ä½“å®šä¹‰ç»“æ„ä½“ï¼Œéœ€è¦ä½¿ç”¨ struct å…³é”®å­—å¹¶ä¸ºæ•´ä¸ªç»“æ„ä½“æä¾›ä¸€ä¸ªåå­—ã€‚ç»“æ„ä½“çš„åå­—éœ€è¦æè¿°å®ƒæ‰€ç»„åˆçš„æ•°æ®çš„æ„ä¹‰.åœ¨ç»“æ„ä½“ä¸­éœ€è¦æœ‰ç›¸åº”çš„å±æ€§å’Œå±æ€§å¯¹åº”çš„ç±»å‹ fn main() {// åˆ›å»ºå®ä¾‹æ¨¡ç‰ˆstruct User { username: String, email: String, sign_in_count: u64, active: bool,}// å®ä¾‹åŒ–ä¸å¯å˜æ¨¡å‹let user1 = User { email: String::from(\"someone@example.com\"), username: String::from(\"someusername123\"), active: true, sign_in_count: 1,};}// å®ä¾‹åŒ–å¯å˜æ¨¡å‹let mut user2 = User { email: String::from(\"someone@example.com\"), username: String::from(\"someusername123\"), active: true, sign_in_count: 1,};}// è°ƒç”¨ä¸ä¿®æ”¹println!(\"{}\", user2.email)user2.email = String::from(\"other@example.com\") ä½¿ç”¨å‡½æ•°æ¥è¿”å›å¹¶åˆ›å»ºå®ä¾‹åŒ–æ¨¡å‹fn main() { let user = return_struct(String::from(\"xx\"),2); println!(\"{}\",user.name);}struct User { name: String, age: i32, active: bool, sigin_in_count: i32,}fn return_struct(name: String,age: i32 ) -> User { User { //åŒåå­—æ®µ //1. name: name, //2. name, name, age, active: true, sigin_in_count: 1, }} å®ä¾‹æ›´æ–°let user2 = User { email: String::from(\"another@example.com\"), username: String::from(\"anotherusername567\"), ..user1}; å…ƒç»„ç»“æ„ä½“æ²¡æœ‰å­—æ®µå åªæœ‰å­—æ®µç±»å‹ fn main() {struct Color(i32, i32, i32);struct Point(i32, i32, i32);let black = Color(0, 0, 0);let origin = Point(0, 0, 0);} æ–¹æ³•è¯­æ³•æ–¹æ³•è¯­æ³•åŒå‡½æ•°ç±»ä¼¼ï¼Œä½†æ˜¯æ–¹æ³•å®åœ¨ç»“æ„ä½“çš„ä¸Šä¸‹æ–‡ä¸­è¢«å®šä¹‰çš„ï¼Œå¹¶ä¸”ä»–ä»¬çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯selfï¼Œå®ƒä»£è¡¨äº†è°ƒç”¨è¯¥æ–¹æ³•çš„ç»“æ„ä½“å®ä¾‹ æˆ‘ä»¬å°†æŸä¸ªå®ä¾‹èƒ½åšçš„æ‰€æœ‰äº‹æƒ…ä¸€èµ·æ”¾åœ¨impl(implementation)ä¸­ struct Rectangle{ width: u32, height: u32,}// å¿…é¡»åŒåimpl Rectangle{ fn area(&self) -> u32{ self.width * self.height }}fn main() { let rect1 = Rectangle{width: 30,height: 50}; println!( \"the area is {}\",rect1.area() );} å…¶ä¸­selfè¡¨ç¤ºè°ƒç”¨è¯¥æ–¹æ³•çš„ç»“æ„ä½“å®ä¾‹","link":"/posts/a02a083e/"},{"title":"Rustæ¦‚å¿µ-æ‰€æœ‰æƒ","text":"Rustæ¦‚å¿µ-æ‰€æœ‰æƒå˜é‡ç±»å‹å¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸¤ç¯‡æ–‡ç« https://learning-rust.github.io/docs/a6.variable_bindings,constants_and_statics.htmlhttp://wiki.jikexueyuan.com/project/rust/primitive-types.html åœ¨rustä¸­å˜é‡æ¨¡å¼æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤æˆ‘ä»¬å«åšå˜é‡ç»‘å®šï¼Œä¸ºäº†ä½¿ä»–ä»¬å¯å˜ï¼Œä½¿ç”¨mutå…³é”®å­—å³å¯rustæ˜¯ä¸€ç§é™æ€ç±»å‹çš„è¯­è¨€ï¼›å®ƒåœ¨ç¼–è¯‘æ—¶æ£€æŸ¥æ•°æ®ç±»å‹ã€‚å¹¶ä¸éœ€è¦åœ¨å£°æ˜å˜é‡ç»‘å®šæ—¶æŒ‡å®šä¸€ä¸ªå…·ä½“çš„æ•°æ®ç±»å‹ã€‚ç¼–è¯‘å™¨ä¼šæ£€æŸ¥ä½¿ç”¨æƒ…å†µå¹¶ä¸ºå…¶è®¾ç½®æ›´å¥½çš„æ•°æ®ç±»å‹ã€‚ä½†æ˜¯å¯¹äº å¸¸é‡å’Œé™æ€å˜é‡ï¼Œå¿…é¡»æ³¨é‡Štypeã€‚ç±»å‹åœ¨å†’å·ï¼ˆ:)ä¹‹r å˜é‡ç»‘å®š// å˜é‡ç»‘å®šlet a = true;let b: bool = true; // ä»¥ä¸Šå¯ä»¥å£°æ˜å…·ä½“çš„æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥ä¸æŒ‡å®šlet (x,y) = (1,2);let mut z = 5;z = 6;// å¸¸æ•° å¿…é¡»æŒ‡å®šconst N: i32 = 5;// é™æ€å˜é‡static N: i32 = 6; æ‰€æœ‰æƒåœ¨rustä¸­ï¼Œä¸€å…±åˆ†ä¸ºä¸¤ç§æ•°æ®ç±»å‹ åŸºæœ¬æ•°æ®ç±»å‹ï¼š å¦‚ï¼šboolï¼ˆå¸ƒå°”ï¼‰ï¼Œcharï¼ˆå­—ç¬¦ï¼‰,integerï¼ˆæ•´æ•°ï¼‰,floatingï¼ˆæµ®ç‚¹ï¼‰,arraysï¼ˆæ•°ç»„ï¼‰ï¼Œtuples(å…ƒç»„)ï¼Œslice(åˆ‡ç‰‡),å­—ç¬¦ä¸²ï¼ˆstrï¼‰ï¼Œå‡½æ•°æŒ‡é’ˆ(functions) éåŸºæœ¬æ•°æ®ç±»å‹ ä¹Ÿå°±æ˜¯å¼•ç”¨ç±»å‹ åœ¨rustä¸­ï¼Œå¯¹äºæ‰€æœ‰æƒä¸€å…±æœ‰ä¸¤ç§åŠ¨ä½œçŠ¶æ€ ç§»åŠ¨å’Œcopy å¤åˆ¶å½“å°†aèµ‹å€¼ç»™bçš„æ—¶å€™ï¼Œé¦–å…ˆrustä¼šå¯¹åŸæ¥açš„å…ƒæ•°æ®è¿›è¡Œå¤åˆ¶ï¼Œå¹¶å°†å¤åˆ¶çš„æ•°æ®èµ‹å€¼ç»™bï¼Œå¹¶æŠŠaçš„æ‰€æœ‰æƒçŠ¶æ€ è®¾ç½®ä¸ºâ€œå·²å¤åˆ¶ï¼ˆ copied ï¼‰â€çŠ¶æ€ã€‚ ç§»åŠ¨å½“å°†aèµ‹å€¼ç»™bçš„æ—¶å€™ï¼Œrustä¼šæŠŠåŸæ¥å¯¹açš„åŸæ•°æ®çš„æ‰€æœ‰æƒç§»åŠ¨ç»™bï¼Œå¹¶æŠŠaçš„æ‰€æœ‰æƒçŠ¶æ€ è®¾ç½®ä¸ºâ€œå·²ç§»åŠ¨ï¼ˆ moved ï¼‰â€çŠ¶æ€ã€‚let x = 5;let y = x;// åŸºæœ¬æ•°æ®ç±»å‹ åªå‘ç”Ÿäº†copiedlet x = String::from(\"hello world\");let y = x;// å¼•ç”¨æ•°æ®ç±»å‹ï¼Œå‘ç”Ÿäº†moved å¼•ç”¨ç±»å‹åœ¨å­˜å‚¨åˆ°å †ä¸­æ—¶ï¼Œä¼šæŒ‡å®šä¸‰ä¸ªéƒ¨åˆ† åˆ†åˆ«æ—¶æŒ‡é’ˆï¼Œé•¿åº¦å’Œå®¹é‡ï¼Œå¹¶ä¸”æŒ‡é’ˆæŒ‡å‘å †ä¸Šå­˜æ”¾å†…å­˜çš„å†…å­˜åœ°å€é•¿åº¦è¡¨ç¤º String çš„å†…å®¹å½“å‰ä½¿ç”¨äº†å¤šå°‘å­—èŠ‚çš„å†…å­˜ã€‚å®¹é‡æ˜¯ String ä»æ“ä½œç³»ç»Ÿæ€»å…±è·å–äº†å¤šå°‘å­—èŠ‚çš„å†…å­˜ã€‚é•¿åº¦ä¸å®¹é‡çš„åŒºåˆ«æ˜¯å¾ˆé‡è¦çš„ï¼Œ å¤åˆ¶è¡Œä¸ºå¤åˆ¶è¡Œä¸ºä¸­ï¼Œæ‹·è´äº†ä¸€æ•´ä»½å†…å®¹ï¼ŒåŒ…æ‹¬æŒ‡é’ˆé•¿åº¦å’Œå®¹é‡ï¼Œäºæ˜¯ä»–ä»¬å…±ç”¨åŒä¸€ä¸ªå†…å­˜ï¼Œè€Œä¸æ˜¯åˆ†åˆ«æŒ‡å‘ç›¸ç­‰çš„ä¸¤ä¸ªå†…å­˜äºŒæ¬¡é‡Šæ”¾é”™è¯¯å½“å˜é‡ç¦»å¼€ä½œç”¨åŸŸçš„ä½¿ç”¨,Rustè‡ªåŠ¨è°ƒç”¨dropå‡½æ•°å¹¶æ¸…ç†å˜é‡çš„å †å†…å­˜ï¼Œäºæ˜¯å½“å‡ºç°å¤åˆ¶è¡Œä¸ºçš„æ—¶å€™ï¼Œä»–ä»¬æ‰§è¡Œçš„å†…å­˜åœ°å€æ˜¯ç›¸åŒçš„ï¼Œå½“s1ç¦»å¼€åï¼Œs2æ‰§è¡Œçš„å†…å­˜åœ°å€æ— ã€‚å½“s1ç¦»å¼€åï¼Œs2æ‰§è¡Œçš„å†…å­˜åœ°å€æ— ï¼Œè¿™ä¸ªå«åšäºŒæ¬¡é‡Šæ”¾çš„é”™è¯¯ï¼Œä¹Ÿæ˜¯ä¹‹å‰æåˆ°è¿‡çš„å†…å­˜å®‰å…¨æ€§ bug ä¹‹ä¸€ã€‚ä¸¤æ¬¡é‡Šæ”¾ï¼ˆç›¸åŒï¼‰å†…å­˜ä¼šå¯¼è‡´å†…å­˜æ±¡æŸ“ï¼Œå®ƒå¯èƒ½ä¼šå¯¼è‡´æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚ä½†æ˜¯æˆ‘åœ¨ä»£ç ä¸­è¯•äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰æŠ¥é”™ã€‚ã€‚ã€‚ fn main() { let x = 1; let y = x; println!(\"Hello, world!{}\",y); println!(\"{}\",x)} // inputHello, world!11 ç§»åŠ¨è¡Œä¸ºå¦‚æœå°†åŸå˜é‡æŒ‡é’ˆç§»å‘å¦å¤–ä¸€ä¸ªå˜é‡æŒ‡é’ˆï¼ŒåŸå˜é‡æŒ‡é’ˆå¤±æ•ˆã€‚å½“ä½ å†æ¬¡è°ƒç”¨s1å˜é‡æ—¶ï¼Œç”±äºæŒ‡é’ˆçš„å¤±å»ï¼Œæ²¡æœ‰æŒ‡å‘å­˜å‚¨æ•°æ®çš„å†…å­˜åœ°å€ï¼ŒæŠ¥é”™æ— æ•ˆå¼•ç”¨ fn main() { let x = String::from(\"hello\"); // è¿™ä¸ªæ˜¯å¼•ç”¨ç±»å‹ã€‚æ•°æ®åœ¨å †ä¸Šé¢ let y = x; println!(\"Hello, world!{}\",y); println!(\"{}\",x)}// inputerror[E0382]: borrow of moved value: `x` --> src/main.rs:5:19 |2 | let x = String::from(\"hello\"); | - move occurs because `x` has type `std::string::String`, which does not implement the `Copy` trait3 | let y = x; | - value moved here4 | println!(\"Hello, world!{}\",y);5 | println!(\"{}\",x) | ^ value borrowed here after moveerror: aborting due to previous errorFor more information about this error, try `rustc --explain E0382`.error: could not compile `xx`.To learn more, run the command again with --verbose.// æŒ‡é’ˆæŠ¥é”™æŒ‡é’ˆå·²ç»è¢«move å…‹éš†è¡Œä¸ºå¯¹äºåŸºç¡€ç±»å‹æ¥è¯´ï¼Œå˜é‡çš„æ•°æ®äº¤äº’å½¢å¼æ˜¯å¤åˆ¶å¯¹äºå¼•ç”¨ç±»å‹æ¥è¯´ï¼Œå˜é‡çš„æ•°æ®äº¤äº’å½¢å¼æ— æ³•å¤åˆ¶ï¼Œåªèƒ½ç§»åŠ¨ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ°å¤åˆ¶å †ä¸Šçš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨cloneçš„é€šç”¨å‡½æ•° fn main() { let x = String::from(\"hello\"); // è¿™ä¸ªæ˜¯å¼•ç”¨ç±»å‹ã€‚æ•°æ®åœ¨å †ä¸Šé¢ let y = x.clone(); println!(\"Hello, world!{}\",y); println!(\"{}\",x)} å¼•ç”¨å’Œå€Ÿç”¨ä¸å¯å˜å¼•ç”¨è·³è¿‡æ‰€æœ‰æƒï¼Œå¼•ç”¨å¯¹è±¡æ•°æ®ï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°rustä¸­çš„å¼•ç”¨å…³é”®å­—&&å…³é”®å­—ä½œç”¨æ˜¯åˆ›å»ºäº†ä¸€æ¡æŒ‡å‘æŸä¸€å¯¹è±¡çš„å¼•ç”¨ï¼Œå†ç”±å¼•ç”¨å¯¹è±¡æŒ‡å‘æ•°æ®é”™åœ¨å†…å­˜åœ°å€å½“å¼•ç”¨æœ¬èº«&s1ç¦»å¼€ä½œç”¨åŸŸåï¼Œè°ƒç”¨dropå‡½æ•°ï¼ŒæŒ‡å‘s1å¯¹è±¡çš„æŒ‡é’ˆè¢«ä¸¢å¼ƒåŒæ—¶ï¼Œrustçš„å¼•ç”¨æœ¬èº«ä¹Ÿæ˜¯ä¸å¯å˜çš„ï¼Œ fn main() { let s1 = String::from(\"hello\"); let len = calculate_length(&s1); println!(\"The length of '{}' is {}.\", s1, len);}//å‚æ•°ç±»å‹éœ€è¦å¼•ç”¨ç±»å‹fn calculate_length(s: &String) -> usize { s.len()} ä»¥ä¸Š &s1çš„è¿‡ç¨‹ç§°ä¸ºå¼•ç”¨ï¼Œè·å–å› æœé‚£ä¸ªä½œä¸ºå‡½æ•°å‚æ•°ç§°ä¸ºå€Ÿç”¨ å¯å˜å¼•ç”¨å¯å˜å¼•ç”¨åŒä¸å¯å˜ç±»ä¼¼ï¼Œä½†è¦ä¿è¯è¢«å¼•ç”¨ç±»å‹ä¸ºå¯å˜ç±»å‹å¼•ç”¨ä¸ºå¯å˜å‡½æ•°å‚æ•°ä¸ºå¯å˜å¼•ç”¨ fn main() { let mut s = String::from(\"hello\"); change(&mut s);}fn change(some_string: &mut String) { some_string.push_str(\", world\");}``` åœ¨ç‰¹å®šä½œç”¨åŸŸä¸­çš„ç‰¹å®šæ•°æ®æœ‰ä¸”åªæœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨ã€‚è¿™äº›ä»£ç ä¼šå¤±è´¥;ä½†å¯ä»¥æœ‰å¤šä¸ªä¸å¯å˜å¼•ç”¨,å¹¶ä¸”ä¸å¯å˜å¼•ç”¨å’Œå¯å˜å¼•ç”¨ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼Œå¯ä»¥åœ¨å…¶ä¸­ä¸€ä¸ªå°æ—¶åå†è°ƒç”¨è§£å†³```rustlet mst s = String::from(\"hello\"){ let r1 = &mut s;} let r2 = &mut s; slice åˆ‡ç‰‡let s = String::from(\"hello world\") let hello = &s[..5];// let hello = &s[0..5];let world = &s[6..11];// let world = &s[6..len];let helloworld = &s[..];let helloworld = &s[0..len];","link":"/posts/27cd4fcb/"},{"title":"jwt","text":"Introducing drfhow to use it ä½¿ç”¨drf-jwt# å®‰è£…jwtsource /bin/activepip install djangorestframework-jwt # é…ç½®setting.pyREST_FRAMEWORK = { 'DEFAULT_PERMISSION_CLASSES': ( 'rest_framework.permissions.IsAuthenticated', ), 'DEFAULT_AUTHENTICATION_CLASSES': ( 'rest_framework_jwt.authentication.JSONWebTokenAuthentication', 'rest_framework.authentication.SessionAuthentication', 'rest_framework.authentication.BasicAuthentication', ),}# é…ç½®url.pyfrom rest_framework_jwt.views import obtain_jwt_tokenurlpatterns = [ '', # ... url(r'^api-token-auth/', obtain_jwt_token),]# æµ‹è¯•curl -X POST -d \"username=admin&password=password123\" http://localhost:8000/api-token-auth/# è¿”å›jsoncurl -X POST -H \"Content-Type: application/json\" -d '{\"username\":\"admin\",\"password\":\"password123\"}' http://localhost:8000/api-token-auth/# å®šä¹‰éªŒè¯æ–¹å¼curl -H \"Authorization: JWT \" http://localhost:8000/protected-url/ //settings.py# jwt token æœ‰æ•ˆæœŸimport datetimeJWT_AUTH = { # jwt éªŒè¯ç æœ‰æ•ˆæœŸ 'JWT_EXPIRATION_DELTA': datetime.timedelta(days=365), # jwt éªŒè¯å¤´éƒ¨ 'JWT_AUTH_HEADER_PREFIX': 'Bearer',} django-jwt è‡ªå®šä¹‰ç”¨æˆ·è®¤è¯//settings.pyAUTHENTICATION_BACKENDS = ( 'django.contrib.auth.backends.ModelBackend', 'guardian.backends.ObjectPermissionBackend', 'users.views.CustomBackend',)JWT_AUTH = { 'JWT_AUTH_HEADER_PREFIX': 'JWT', 'JWT_EXPIRATION_DELTA': datetime.timedelta(days=7)}//users views.pyfrom django.db.models import Qfrom django.contrib.auth.backends import ModelBackendfrom django.contrib.auth import get_user_modelUser = get_user_model()# Create your views here.class CustomBackend(ModelBackend): \"\"\" è‡ªå®šä¹‰ç”¨æˆ·éªŒè¯ \"\"\" def authenticate(self, request, username=None, password=None, **kwargs): try: user = User.objects.get(Q(username=username) | Q(mobile=username)) if user.check_password(password): return user except Exception as e: return None https://zhuanlan.zhihu.com/p/30524397https://jpadilla.github.io/django-rest-framework-jwt/#security vueä¸­ä½¿ç”¨tokenéªŒè¯https://blog.csdn.net/baiqiangdoudou/article/details/100174505 curl -H \"Authorization: JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNTc0OTMwMjYyLCJlbWFpbCI6IjEwOTc2OTAyNjhAcXEuY29tIn0.cxzZhCOStN_w9OpVcq7rO-bcA_vWA172DtQaNdeGF3A\" http://localhost:8000/switch/ ä¸ºä»€ä¹ˆè¦ç”¨token ä¸å…¶ä»–çš„å·®åˆ«","link":"/posts/8d17cdf0/"},{"title":"drf-filter","text":"Introducing drf-filterhow to use it django-filterhttps://juejin.im/post/5d22e20f6fb9a07efb69a875","link":"/posts/933b28f1/"},{"title":"drf-note","text":"drfå¦‚ä½•ä½¿ç”¨django-rest-framework 1.é¦–å…ˆä¸‹è½½ pip3 install django-rest-framework 2.åº”ç”¨åœ¨settingä¸­æ·»åŠ  INSTALLED_APPS = ( ... 'rest_framework',) 3.åœ¨drfä¸­ä½¿ç”¨ç™»é™†ç™»å‡ºçš„åŠŸèƒ½ urlpatterns = [ ... url(r'^api-auth/', include('rest_framework.urls'))] åºåˆ—åŒ–åˆ›å»ºmodel ä¸ djangoç±»ä¼¼åˆ›å»ºserializer åºåˆ—åŒ–modelæ•°æ®ï¼Œä»¥jsonçš„å½¢å¼å±•ç¤º ï¼ˆserializer modelserialzierï¼‰åˆ›å»ºview ä¸djangoç±»ä¼¼ ä½¿ç”¨httpieæŸ¥çœ‹ pip install httpiehttp http://localhost:8000/snippets/","link":"/posts/437192d0/"},{"title":"drfæ¡†æ¶è§£æ","text":"drfæ¡†æ¶è§£æ1åœ¨drfçš„viewè§†å›¾ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°viewsetè§†å›¾é›†çš„å†…å®¹ã€‚å¼•ç”¨çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ ç›´æ¥å¼•ç”¨ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ModelViewSet æ ¹æ®ä¸åŒçš„éœ€æ±‚æ·»åŠ ä¸åŒçš„mixins # åˆ—å‡ºåˆ—è¡¨class SwitchViewSet(viewsets.GenericViewSet, mixins.ListModelMixin): serializer_class = SwitchSerializer queryset = SwitchModel.objects.all() å…¶ä¸­mixinsæœ‰å¾ˆå¤šç§ ListModelMixin UpdateModelMixin CreateModelMixin RetrieveModelMixin DestroyModelMixinè¿™äº›mixinsæœ¬èº«å°±å·²ç»æä¾›äº†æœ€åŸºç¡€çš„åŠŸèƒ½ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ·»åŠ é™„åŠ çš„éœ€æ±‚ï¼Œå¯ä»¥é‡å†™è¿™äº›æ–¹æ³•mixinsä¸­çš„å†…å®¹ class SwitchViewSet(viewsets.GenericViewSet, mixins.ListModelMixin): # è·å–åºåˆ—åŒ–å·¥å…· serializer_class = SwitchSerializer # è·å–é›†åˆ queryset = SwitchModel.objects.all() ListModelMixinclass ListModelMixin: \"\"\" List a queryset. \"\"\" def list(self, request, *args, **kwargs): queryset = self.filter_queryset(self.get_queryset()) page = self.paginate_queryset(queryset) if page is not None: serializer = self.get_serializer(page, many=True) return self.get_paginated_response(serializer.data) serializer = self.get_serializer(queryset, many=True) return Response(serializer.data) ListModelMixin ä¹Ÿå°±æ˜¯getè¯·æ±‚è¿”å›å½“å‰æ¨¡å‹æ‰€æœ‰åˆ—è¡¨,filter_querysetè¾¾æˆè¿‡æ»¤ get_querysetè·å–é›†åˆç¬¬äºŒæ®µåˆ¤æ–­æ˜¯å¦æœ‰åšåˆ†ç±»åŠŸèƒ½ç¬¬ä¸‰æ®µè¿”å›serializer def filter_queryset(self, queryset): \"\"\" Given a queryset, filter it with whichever filter backend is in use. You are unlikely to want to override this method, although you may need to call it either from a list view, or from a custom `get_object` method if you want to apply the configured filtering backend to the default queryset. \"\"\" for backend in list(self.filter_backends): queryset = backend().filter_queryset(self.request, queryset, self) return queryset","link":"/posts/23293bb2/"},{"title":"drf-model","text":"drf-model drf-modelclass TestViewSet(viewsets.ModelViewSet): serializer_class = TestSerializer queryset = test_Model.objects.all() # create @action(methods=['post'],detail=False) def create_field(self, request, *args, **kwargs): request.data['name'] = \"hzjé»˜è®¤\" serializer = self.get_serializer(data=request.data) serializer.is_valid(raise_exception=True) self.perform_create(serializer) headers = self.get_success_headers(serializer.data) return Response(serializer.data, status=status.HTTP_201_CREATED, headers=headers) # update @action(methods=['patch'], detail=False) def update_field(self, request, *args, **kwargs): request.data[\"text\"] = \"æ›´æ–°dsdsd\" instance = test_Model.objects.get(id=request.data['id']) # instance = self.get_object() ä¼šæŠ¥é”™ # https://docs.djangoproject.com/en/2.2/ref/class-based-views/mixins-single-object/#django.views.generic.detail.SingleObjectMixin.get_object # é»˜è®¤ä½¿ç”¨idæŸ¥æ‰¾ serializer = self.get_serializer(instance,data=request.data,partial=True) serializer.is_valid() serializer.save() return Response(serializer.data,status=status.HTTP_200_OK) # delete @action(methods=['delete'],detail=False) def delete_field(self,request,*args,**kwargs): instance = test_Model.objects.get(id=request.data['id']) if instance: self.perform_destroy(instance) return Response({\"flag\":\"åˆ é™¤æˆåŠŸ\"},status=status.HTTP_200_OK) else: return Response(status=status.HTTP_400_BAD_REQUEST)","link":"/posts/4b10b818/"},{"title":"DRFæ¡†æ¶","text":"rusté£æ ¼Representational State Transfer è¡¨ç°å±‚çŠ¶æ€è½¬åŒ–ï¼ˆ èµ„æºå®šä½åŠèµ„æºæ“ä½œï¼‰è¡¨è±¡å±‚é¢è¯´å°±æ˜¯é€šè¿‡get,post,put,deleteæ–¹å¼æ¥å®ç°å‰åå°é€šä¿¡çš„ä¸€ç§è½»é‡çº§,è·¨å¹³å°,è·¨è¯­è¨€æ¶æ„è®¾è®¡é£æ ¼çš„webæœåŠ¡ httpä¸ä»…ä»…æ˜¯ä¼ è¾“åè®®ï¼Œæ›´æ˜¯ä¸€ç§åº”ç”¨åè®®ã€‚RESTï¼Œå³Representational State Transferçš„ç¼©å†™ã€‚æ„ä¸ºæ˜¯â€è¡¨ç°å±‚çŠ¶æ€è½¬åŒ–â€ã€‚RESTfulè¡¨ç¤ºä¸€ç§é£æ ¼ï¼Œç†è§£RESTå‰éœ€è¦ç†è§£èµ„æºï¼Œä½•è°“èµ„æºï¼Œå¹¿ä¹‰çš„èµ„æºæ˜¯æŒ‡å¯ä»¥æ“ä½œçš„æ‰€æœ‰å¯¹è±¡ã€‚å¯èƒ½æ˜¯ä¸€ä¸ªç³»ç»Ÿèµ„æºï¼Œå¦‚txtã€jgpã€xml â€¦ï¼Œäº¦å¯ä»¥æ˜¯è¯¸å¦‚è‡ªå·±å®šä¹‰çš„è™šæ‹Ÿé›†åˆçš„æŠ½è±¡ï¼Œå¦‚booksã€usrsã€timesã€‚RESTfutlä»£è¡¨ä¸€ç§ç®€æ´ã€æ–¹ä¾¿ã€å¿«æ·ã€é«˜æ•ˆã€é€æ˜çš„æ¶æ„ï¼Œè¿™å–å†³äºä½ æ€æ ·ç»„åˆã€‚å…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š 1ã€è§„èŒƒåŒ–æ¥å£è®¿é—®æ–¹å¼ã€‚è¿™äº›httpæ“ä½œæ–¹æ³•åŒ…æ‹¬GET/POST/PUT/DELETE/OPTIONSç­‰ï¼Œæ¯ä¸ªæ“ä½œæ–¹æ³•éƒ½ä»£è¡¨ä¸€ä¸ªç›¸åŒæ„ä¹‰çš„æ“ä½œï¼Œå®ƒå‘æ‰€æœ‰äººé€æ˜åœ°è¡¨æ˜æ“ä½œæ–¹å¼ã€‚æ¯”å¦‚GETåªèƒ½è¯»å–/æ‹‰æ•°æ®ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ˜¯æ·»åŠ æ•°æ®ï¼Œä½†å»ºè®®ä¸è¦è¿™ä¹ˆåšï¼Œä¸ç„¶è¿™æ ·å°±å¤±å»äº†RESTçš„æ„ä¹‰ã€‚GET è¯»å–POST æ·»åŠ PUT ä¿®æ”¹DELETE åˆ é™¤2ã€èµ„æºæ ‡è¯†å”¯ä¸€ã€‚é€šè¿‡URIè¡¨ç¤ºä¸€ä¸ªèµ„æºåç§°ï¼Œå½¢å¼/resource/patchã€‚å¦‚/usersï¼Œè¡¨ç¤ºç”¨æˆ·çš„ç»„åˆï¼Œæˆ–ç”¨æˆ·ç¾¤ã€‚å½“ç„¶è¿˜å¯ä»¥ç»§ç»­æ ‡è¯†æŸä¸ªå…·ä½“çš„ä¸€ä¸ªç”¨æˆ·ï¼Œ/users/11ï¼Œè¡¨ç¤ºidä¸º11çš„ç”¨æˆ·ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åˆç”¨ä¸€ç»„/usrgroup/11çš„URIä»£è¡¨æ“ä½œç”¨æˆ·ç»„ï¼Œä¸è¿‡ä¸å»ºè®®è¿™ä¹ˆåšï¼Œå› ä¸ºè¿™æ ·ä»å­—é¢ä¸Šé‡å¤äº†/users/11èµ„æºè¡¨ç¤ºçš„å†…å®¹ã€‚ä¸€ä¸ªèµ„æºURIæ€»æ˜¯åŒ…å«ç¬¬ä¸€æ¡å®ç°çš„æ–¹æ³•ï¼šGET /users/11POST /users/11PUT /users/11DELETE /users/11å½“ç„¶ï¼Œä»…æœ‰è¿™äº›è¿˜ä¸è¶³ä»¥åŒ…æ‹¬èµ„æºæ“ä½œçš„æ‰€æœ‰éœ€æ±‚ï¼Œæ‰€ä»¥è¿˜å¯ä»¥åŒ…å«è¯·æ±‚å‚æ•°ï¼Œå¦‚GET /users?type=list&page=1ã€‚3ã€çŠ¶æ€çš„è½¬åŒ–ã€‚è¿™å°±æ˜¯RESTçš„çœŸå®å«ä¹‰ï¼ŒæŒ‡å®ƒå…è®¸èµ„æºURIå…·æœ‰ä¸åŒçš„è¡¨ç°å½¢å¼ã€‚åŒä¸€ä¸ªURIï¼Œæ ¹æ®ä¸åŒè¯·æ±‚æ–¹å¼ï¼Œæ‰§è¡Œçš„åŠ¨ä½œä¸åŒï¼›è¿˜å¯ä»¥æ ¹æ®è¯·æ±‚çš„Header Acceptçš„ä¸åŒè¿”å›ä¸åŒçš„ç»“æœï¼Œå¦‚text/htmlã€text/cssã€text/xmlç­‰ç­‰ã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºbodyä¸åŒã€‚å¦‚æŸ¥è¯¢å¿«é€’ä¸€èˆ¬ï¼Œå¯ä»¥ä¸Šæ¬¡æŸ¥è¯¢ï¼Œç‰©å“è¿˜åœ¨ä»“åº“ï¼Œè€Œè¿‡ä¸€æ®µæ—¶é—´å·²ç»åœ¨è·¯ä¸Šäº†ã€‚å®ƒè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªäº’åŠ¨è¿‡ç¨‹ã€‚4ã€æ‰€æœ‰ä¿¡æ¯éƒ½åŒ…å«åœ¨å½“å‰è¯·æ±‚ä¸­ã€‚è¯·æ±‚çš„æ–¹å¼åŒ…å«åœ¨ Request Headerçš„Methodä¸­ï¼Œè¿˜å¯ä»¥åŒ…å«Acceptã€Accept-Encodingã€Accept-Languageï¼Œä½¿ç”¨Authenticationã€Cookieç­‰ä¿¡æ¯è¡¨æ˜èº«ä»½ã€‚åŒæ ·ï¼ŒæœåŠ¡ç«¯é€šè¿‡å‘é€Content-Lengthã€Content-Typeå“åº”æ‰§è¡Œæƒ…å†µã€‚æœ€é‡è¦çš„æ˜¯ï¼Œéœ€è¦è¿”å›Status Codeé€šçŸ¥æ‰§è¡ŒçŠ¶æ€ï¼Œå¦‚200 201 400 404 500ç­‰http codeã€‚RESTè®¤ä¸ºï¼Œæ‰€æœ‰ä¿¡æ¯éƒ½èƒ½é€šè¿‡è¯·æ±‚ä¸€æ¬¡æ€§å‘é€ï¼Œè€Œä¸å¿…å†é‡‡ç”¨æ–¹å¼ä¿å­˜çŠ¶æ€ï¼Œè¯·æ±‚çš„ä¿¡æ¯æœ¬èº«å·²ç»è¯´æ˜äº†è¯·æ±‚çš„æ„ä¹‰ã€‚5ã€æ— çŠ¶æ€æ€§ã€‚è¿™æ˜¯RESTæœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œè¿™ä¸ªçŠ¶æ€æŒ‡çš„æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯æ— éœ€ä¸ºæ¯æ¬¡ä¿å­˜è¯·æ±‚çŠ¶æ€ï¼Œå®¢æˆ·ç«¯è¯·æ±‚ä¸å¿…è€ƒè™‘å½“å‰çŠ¶æ€ï¼Œä¸å¿…è€ƒè™‘ä¸Šä¸‹æ–‡ã€‚å…·ä½“ä¸Šè¯´ï¼Œå°±æ˜¯ä¸å¿…ä½¿ç”¨sessionç­‰å·¥å…·è·Ÿè¸ªã€ä¿å­˜è¯·æ±‚çš„ç‰¹æ®Šæ€§ã€‚æ¯”å¦‚ï¼Œæ— è®ºæ˜¯è°ï¼Œä»å“ªé‡Œå‘é€ï¼Œå‡ æ—¶å‘é€ï¼Œå¯¹åŒä¸€ä¸ªURIèµ„æºå‘é€è¯·æ±‚çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ã€‚æ®ä¼ ï¼Œè¿™æ ·çš„è®¾è®¡æ˜¯ä¸ºå½“ä¸€å°æœåŠ¡å™¨å®•æœºæ—¶ï¼Œå¦ä¸€å°æœåŠ¡å™¨å¯ä»¥æ— å·®åˆ«åœ°å“åº”å¯¹æ–¹çš„è¯·æ±‚ã€‚å®¢æˆ·ç«¯è¯·æ±‚åªè®¤URIï¼Œè€Œä¸éœ€ç†åå°çš„è®¾è®¡ã€‚å®é™…ä¸Šï¼Œåœ¨å¦‚ä»Šæ‰§è¡Œçš„RESTfulè®¾è®¡å½“ä¸­ï¼Œå®Œå…¨èƒ½æ‰§è¡Œè¿™ä¸ªè¦æ±‚çš„å¾ˆå°‘ï¼Œæœ€å½»åº•çš„äº‘æœåŠ¡ï¼Œå¤§éƒ¨ä»½ä¸ºRESTful-likeçš„é£æ ¼ã€‚6ã€å¯å®ç°è¯·æ±‚ç¼“å­˜ã€‚é€šè¿‡ç¼“å­˜å‡å°‘è¯·æ±‚æ¬¡æ•°ï¼Œåœ¨HTTPå“åº”é‡Œåˆ©ç”¨Cache-Controlã€Expiresã€Last-Modifiedä¸‰ä¸ªå¤´å­—æ®µï¼Œå¯ä»¥è®©æµè§ˆå™¨ç¼“å­˜èµ„æºä¸€æ®µæ—¶é—´ã€‚ drfçš„è§†å›¾é›†ViewSetç±»åªæ˜¯ä¸€ç§ç±»å‹çš„åŸºäºç±»çš„è§†å›¾ï¼Œå³ä¸æä¾›ä»»ä½•æ–¹æ³•çš„å¤„ç†ç¨‹åºï¼Œä¾‹å¦‚.get()æˆ–.post()ï¼Œè€Œæ˜¯æä¾›æ“ä½œï¼Œå¦‚.list()å’Œ.create()ã€‚http://www.sinodocs.cn/api-guide/viewsets.html drfå­—æ®µæ›´æ–°é»˜è®¤åªæœ‰listå’Œcreate å¯¹åº”çš„æ–¹æ³•å°±æ˜¯get å’Œpostpartial = True å±€éƒ¨æ›´æ–° class TestViewSet(viewsets.ModelViewSet): serializer_class = TestSerializer queryset = test_Model.objects.all() @action(methods=['patch'], detail=False) def update_field(self, request, *args, **kwargs): request.data[\"text\"] = \"æ›´æ–°dsdsd\" instance = test_Model.objects.get(id=request.data['id']) # instance = self.get_object() ä¼šæŠ¥é”™ # https://docs.djangoproject.com/en/2.2/ref/class-based-views/mixins-single-object/#django.views.generic.detail.SingleObjectMixin.get_object # é»˜è®¤ä½¿ç”¨idæŸ¥æ‰¾ serializer = self.get_serializer(instance,data=request.data,partial=True) serializer.is_valid() serializer.save() return Response(serializer.data,status=status.HTTP_200_OK) @action(methods=['delete'],detail=False) def delete_field(self,request,*args,**kwargs): instance = test_Model.objects.get(id=request.data['id']) if instance: self.perform_destroy(instance) return Response({\"flag\":\"åˆ é™¤æˆåŠŸ\"},status=status.HTTP_200_OK) else: return Response(status=status.HTTP_400_BAD_REQUEST) åŸºæœ¬çš„è§†å›¾é›†ä½¿ç”¨viewsets.ModelViewSet + DefaultRouterå…¶ä¸­base-nameè¡¨ç¤ºåŸºç¡€url lookupè¡¨ç¤ºæŸ¥è¯¢å‚æ•°(åªæ ¹æ®ä¸»é”®æŸ¥æ‰¾)è·å–å±€éƒ¨åœ°å€ http://localhost:8080/{base-name}/{lookup} drfè·¯ç”±é›†ä¸ºäº†æ›´åŠ ä¾¿æ·çš„å¼€å‘é¡¹ç›®,drfè®¾è®¡äº†è·¯ç”±é›†çš„å†…å®¹ï¼Œå…å»äº†è·¯ç”±é…ç½®ä¸­çš„éº»çƒ¦ï¼Œå½“ç„¶ä»–ä¹ŸåŒæ—¶å…¼å®¹djangoçš„è·¯ç”±è®¾è®¡https://www.django-rest-framework.org/api-guide/routers/ ä½¿ç”¨from rest_framework import routersrouter = DefaultRouter(trailing_slash=False) # æ˜¯å¦ä»¥æ–œæ /ç»“å°¾# å£°æ˜æ³¨å†Œè·¯ç”±# åŒpath('switch/',views.per_switch.as_view()),router.register(prefix='users', viewset=UserViewSet,basename=\"another_name\")router.register('accounts', AccountViewSet)# æ·»åŠ è§„åˆ™ï¼Œdjangoä¸»åŠ¨æ‰«æurlpatternså˜é‡è·å–è·¯ç”±urlpatterns = router.urls ä»¥ä¸Š prefixå®šä¹‰å‰ç¼€ viewsetå®šä¹‰è§†å›¾ basenameå®šä¹‰å‰ç¼€åˆ«å å½¢æˆurlæ ¼å¼(æœ¬åœ°) â€”>http://localhost:8080/user/http://localhost:8000/accounts/ å…¼å®¹ä½¿ç”¨framework rest_framework.routers import DefaultRouterrouter = DefaultRouter()router.register('test',viewset=TestViewSet,base_name=\"test\")urlpatterns = [ path('switch/',views.switch_list.as_view()),]# å˜é‡ç´¯åŠ urlpatterns += router.urls è·¯ç”±é›†urldjangoçš„è·¯ç”±é›†æ˜¯çœŸæ»´å˜æ€ï¼Œå½“ä½ ä½¿ç”¨å¸¦å€¼å‚æ•°å»æŸ¥æ‰¾åˆ—è¡¨ä¸­çš„ç‰¹å®šå†…å®¹æ—¶å€™ï¼Œä»–æ‰€è¡¨ç°çš„urlæ˜¯^users/{pk}/set_password/$æ³¨æ„ pkåœ¨ä¸­é—´ set_passwordæ˜¯ä½ æ–¹æ³•çš„åå­—å¦‚æœä½ éœ€è¦ä¿®æ”¹è¿™äº›å†…å®¹ï¼Œå¯ä»¥åœ¨@actionä¸­æŒ‡å®šurl_path = set_passwordurl_name = change_password class SwitchViewSet(viewsets.GenericViewSet, mixins.ListModelMixin): serializer_class = SwitchSerializer queryset = SwitchModel.objects.all() # get @action(detail=True,url_path=\"xx\") def list_peer(self, request, pk): queryset = SwitchModel.objects.get(name=pk) print(queryset) # page = self.paginate_queryset(queryset) # if page is not None: # serializer = self.get_serializer(page, many=True) # return self.get_paginated_response(serializer.data) serializer = self.get_serializer(queryset) return Response(serializer.data) å¦‚ä¸Šä¸€ä¸ªåˆ—è¡¨æŸ¥è¯¢çš„åœ°å€æ˜¯ http://localhost:8080/{pk}/xx drfè¿‡æ»¤drfé€šç”¨è¿‡æ»¤# setting.py# å…¨å±€è®¾ç½®è¿‡æ»¤å™¨REST_FRAMEWORK = { 'DEFAULT_FILTER_BACKENDS': ['django_filters.rest_framework.DjangoFilterBackend']}# views.py# å•è§†å›¾è®¾ç½®è¿‡æ»¤å™¨ filter_backends = [django_filters.rest_framework.DjangoFilterBackend] https://www.django-rest-framework.org/api-guide/filtering/ drfåˆ†é¡µhttps://www.django-rest-framework.org/api-guide/pagination/ drfè¿‡æ»¤å™¨https://www.django-rest-framework.org/api-guide/serializers/ drfè§£æå™¨ä¸æ¸²æŸ“å™¨è§†å›¾çš„æœ‰æ•ˆè§£æå™¨é›†å§‹ç»ˆå®šä¹‰ä¸ºç±»åˆ—è¡¨ã€‚å½“ request.dataè¢«è®¿é—®æ—¶ï¼ŒRESTæ¡†æ¶å°†æ£€æŸ¥Content-Typeä¼ å…¥è¯·æ±‚ä¸Šçš„æ ‡å¤´ï¼Œå¹¶ç¡®å®šä½¿ç”¨å“ªä¸ªè§£æå™¨æ¥è§£æè¯·æ±‚å†…å®¹ã€‚å¦‚æœæ‚¨æœªè®¾ç½®å†…å®¹ç±»å‹ï¼Œåˆ™å¤§å¤šæ•°å®¢æˆ·ç«¯å°†é»˜è®¤ä½¿ç”¨â€™application/x-www-form-urlencodedâ€™ä¾‹å¦‚ï¼Œå¦‚æœè¦jsonä½¿ç”¨jQueryå’Œ.ajaxï¼ˆï¼‰æ–¹æ³•å‘é€ç¼–ç æ•°æ®ï¼Œåˆ™åº”ç¡®ä¿åŒ…æ‹¬è¯¥contentType: â€˜application/jsonâ€™è®¾ç½®ã€‚ è®¾ç½®è§£æå™¨ä»…å…è®¸jsonçš„å†…å®¹ # setting.py# å…¨å±€è®¾ç½®è§£æREST_FRAMEWORK = { 'DEFAULT_PARSER_CLASSES': [ 'rest_framework.parsers.JSONParser', ]} # å•è§†å›¾è®¾ç½®è§£æclass modelview(): parser_classes = [JSONParser] å…¶ä»–å„ç±»è§£æhttps://www.django-rest-framework.org/api-guide/parsers/ æ¸²æŸ“å™¨æ—¢ç„¶æœ‰æ”¶çš„è§£æå™¨ï¼Œé‚£ä¹Ÿæœ‰å‘å‡ºæ•°æ®çš„æ¸²æŸ“å™¨ï¼ŒRESTæ¡†æ¶åŒ…æ‹¬è®¸å¤šå†…ç½®çš„Rendererç±»ï¼Œä½¿æ‚¨å¯ä»¥è¿”å›å„ç§åª’ä½“ç±»å‹çš„å“åº”ã€‚è¿˜æ”¯æŒå®šä¹‰è‡ªå·±çš„è‡ªå®šä¹‰æ¸²æŸ“å™¨ï¼Œè¿™ä½¿æ‚¨å¯ä»¥çµæ´»åœ°è®¾è®¡è‡ªå·±çš„åª’ä½“ç±»å‹ã€‚ è®¾ç½®æ¸²æŸ“å™¨# setting.py# å…¨å±€è®¾ç½®è§£æREST_FRAMEWORK = { 'DEFAULT_RENDERER_CLASSES': [ 'rest_framework.renderers.JSONRenderer', 'rest_framework.renderers.BrowsableAPIRenderer', ]} # å•è§†å›¾è®¾ç½®è§£æclass modelview() renderer_classes = [JSONRenderer] å…¶ä»–æ¸²æŸ“å™¨https://www.django-rest-framework.org/api-guide/renderers/","link":"/posts/7068483c/"},{"title":"drf-pagination","text":"Introducing drf-paginationhow to use it django-rest-framework åˆ†é¡µdrfä¸€å…±æœ‰ä¸‰ç§åˆ†é¡µçš„æ–¹å¼ PageNumberPaginationæ­¤åˆ†é¡µæ ·å¼åœ¨è¯·æ±‚æŸ¥è¯¢å‚æ•°ä¸­æ¥å—å•ä¸ªæ•°å­—é¡µç ï¼Œäº‹å…ˆè§„å®šå¥½æ¯ä¸€é¡µçš„æ•°é‡,urlä¸­å®šä¹‰åˆ†é¡µçš„æ ‡è¯† ,æ¯ä¸€é¡µæœ€å¤§æ•°é‡ç­‰ç­‰å½¢å¼ https://api.example.org/accounts/?page=3 å…¨å±€è®¾ç½® REST_FRAMEWORK = { 'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.LimitOffsetPagination'} LimitOffsetPaginationè¿™ç§åˆ†é¡µæ ·å¼åæ˜ äº†æŸ¥æ‰¾å¤šä¸ªæ•°æ®åº“è®°å½•æ—¶ä½¿ç”¨çš„è¯­æ³•ã€‚å®¢æˆ·ç«¯åŒæ—¶åŒ…æ‹¬â€œé™åˆ¶â€å’Œâ€œåç§»â€æŸ¥è¯¢å‚æ•°ã€‚è¯¥é™åˆ¶æŒ‡ç¤ºè¦è¿”å›çš„æœ€å¤§é¡¹ç›®æ•°ï¼Œå¹¶ä¸”ä¸page_sizeå…¶ä»–æ ·å¼ç›¸åŒã€‚åç§»é‡è¡¨ç¤ºæŸ¥è¯¢ç›¸å¯¹äºæœªåˆ†é¡µé¡¹çš„å®Œæ•´é›†åˆçš„å¼€å§‹ä½ç½®ã€‚å½¢å¼ https://api.example.org/accounts/?limit=100&offset=300 å…¨å±€è®¾ç½® REST_FRAMEWORK = { 'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination', 'PAGE_SIZE': 100} è‡ªå®šä¹‰è®¾ç½®page_size æŒ‡ç¤ºé¡µé¢å¤§å°çš„æ•°å€¼ã€‚å¦‚æœè®¾ç½®ï¼Œåˆ™æ­¤PAGE_SIZEè®¾ç½®å°†è¦†ç›–è®¾ç½®ã€‚é»˜è®¤å€¼ä¸ºä¸PAGE_SIZEè®¾ç½®é”®ç›¸åŒçš„å€¼ã€‚page_query_param -ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ï¼ŒæŒ‡ç¤ºç”¨äºåˆ†é¡µæ§ä»¶çš„æŸ¥è¯¢å‚æ•°çš„åç§°ã€‚page_size_query_param-å¦‚æœè®¾ç½®ï¼Œåˆ™è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ï¼ŒæŒ‡ç¤ºæŸ¥è¯¢å‚æ•°çš„åç§°ï¼Œè¯¥å‚æ•°å…è®¸å®¢æˆ·ç«¯æ ¹æ®æ¯ä¸ªè¯·æ±‚è®¾ç½®é¡µé¢å¤§å°ã€‚é»˜è®¤ä¸ºNoneï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯å¯èƒ½æ— æ³•æ§åˆ¶è¯·æ±‚çš„é¡µé¢å¤§å°ã€‚max_page_size-å¦‚æœè®¾ç½®ï¼Œè¿™æ˜¯ä¸€ä¸ªæ•°å­—å€¼ï¼Œè¡¨ç¤ºè¯·æ±‚çš„æœ€å¤§å…è®¸é¡µé¢å¤§å°ã€‚åªæœ‰page_size_query_paramåŒæ—¶è®¾ç½®äº†æ­¤å±æ€§ï¼Œè¯¥å±æ€§æ‰æœ‰æ•ˆã€‚last_page_strings-å­—ç¬¦ä¸²å€¼çš„åˆ—è¡¨æˆ–å…ƒç»„ï¼ŒæŒ‡ç¤ºå¯ä¸ä¸€èµ·ä½¿ç”¨page_query_paramä»¥è¯·æ±‚é›†åˆä¸­çš„æœ€åä¸€é¡µçš„å€¼ã€‚é»˜è®¤ä¸º(â€˜lastâ€™,) ## setting.pyREST_FRAMEWORK = { 'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',}# è®¾ç½®åˆ†é¡µæ ·å¼class LargeResultsSetPagination(PageNumberPagination): page_size = 1000 page_size_query_param = 'page_size' max_page_size = 10000# ä½¿ç”¨æ ·å¼---> å±€éƒ¨æ ·å¼class BillingRecordsView(generics.ListAPIView): queryset = Billing.objects.all() serializer_class = BillingRecordsSerializer pagination_class = LargeResultsSetPagination# è¯·æ±‚æ ¼å¼curl http://localhost:8000/switch/?page=1 CursorPaginationå…‰æ ‡åˆ†é¡µ","link":"/posts/10ccc76d/"},{"title":"httpdæœåŠ¡","text":"apache http serverApache HTTP Serverï¼ˆç®€ç§°Apacheï¼‰æ˜¯Apacheè½¯ä»¶åŸºé‡‘ä¼šçš„ä¸€ä¸ªå¼€æ”¾æºç çš„ç½‘é¡µæœåŠ¡å™¨ï¼Œå¯ä»¥åœ¨å¤§å¤šæ•°è®¡ç®—æœºæ“ä½œç³»ç»Ÿä¸­è¿è¡Œï¼Œç”±äºå…¶å¤šå¹³å°å’Œå®‰å…¨æ€§è¢«å¹¿æ³›ä½¿ç”¨ï¼Œæ˜¯æœ€æµè¡Œçš„WebæœåŠ¡å™¨ç«¯è½¯ä»¶ä¹‹ä¸€ã€‚å®ƒå¿«é€Ÿã€å¯é å¹¶ä¸”å¯é€šè¿‡ç®€å•çš„APIæ‰©å±•ï¼Œå°†Perl/Pythonç­‰è§£é‡Šå™¨ç¼–è¯‘åˆ°æœåŠ¡å™¨ä¸­ã€‚ åœ¨Apacheä¸­ï¼Œå…¶é…ç½®æ–‡ä»¶ç›®å½•ä¸ºâ€œ/etc/httpd/conf/httpd.confâ€ï¼Œè¿™é‡Œé¢åŒ…æ‹¬è®¾ç½®ç½‘ç«™èµ„æºçš„å­˜æ”¾ç›®å½•åŠä¸€äº›ç›¸å…³çš„é…ç½®ã€‚ # å®‰è£…httpyum install httpd # å¼€å¯æœåŠ¡systemctl start httpd# æ£€æŸ¥httpdæœåŠ¡çŠ¶æ€systemctl status httpd# æŸ¥çœ‹ç«¯å£çŠ¶æ€ netstat -anutp | grep 80 ç›®å½•ä»‹ç»é…ç½®æ–‡ä»¶ç›®å½•ä¸ºâ€œ/etc/httpd/conf/httpd.confâ€ [root@localhost httpd]# ls -1conf # å­˜æ”¾æœåŠ¡çš„ä¸»é…ç½®æ–‡ä»¶conf.d # å­˜æ”¾apacheçš„ä¸»é¡µä¿¡æ¯conf.modules.dlogsmodulesrun é…ç½®ä¿¡æ¯é…ç½®æ–‡ä»¶ç›®å½•ä¸ºâ€œ/etc/httpd/conf/httpd.confâ€ [root@localhost httpd]# vi /etc/httpd/conf/httpd.confServerRoot \"/etc/httpd\" #apacheé…ç½®æ–‡ä»¶çš„æ ¹ç›®å½•Timeout 60 #è¶…æ—¶æ—¶é—´ï¼Œå³è¿æ¥æœåŠ¡ç«¯åœ¨60ç§’å†…æ²¡æœ‰ä»»ä½•æ“ä½œï¼Œå³è‡ªåŠ¨æ–­å¼€Listen 80 #ç›‘å¬çš„ç«¯å£ServerAdmin root@localhost #è®¾ç½®ç®¡ç†å‘˜ï¼Œe-mail åœ°å€ServerName www.example.com:80 #æœåŠ¡å™¨ä¸»æœºå.DocumentRoot \"/var/www/html\" #ç½‘ç«™é¡µé¢æ ¹ç›®å½•,å­˜æ”¾æ–‡æ¡£çš„åœ°æ–¹ Options Indexes FollowSymLinks #Oç›®å½•æµè§ˆ #Followsymlinks:å¯ä»¥ç”¨è¿æ¥ï¼Œè¦æ˜¯æƒ³è¦ç¦æ­¢æ˜¾ç¤ºæ–‡ä»¶ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åœ¨â€˜indexesâ€™å‰åŠ â€˜-â€™ã€‚ AllowOverride None Order allow,deny #ç›®å½•ä¸è®¿é—®çš„æ§åˆ¶ Allow from all # åˆ«åAlias /icons/ \"/var/www/icons/\" #åˆ«åå’Œåˆ«åç›®å½• Options Indexes MultiViews FollowSymLinks AllowOverride None Order allow,deny Allow from all# é»˜è®¤é¡µé¢ Options Indexes #å½“ä¸€ä¸ªç›®å½•æ²¡æœ‰é»˜è®¤é¦–é¡µæ—¶ï¼Œå…è®¸æ˜¾ç¤ºæ­¤ç›®å½•åˆ—è¡¨ Options FollowSymLinks AllowOverride None--DirectoryIndex index.html index.html.var #æŒ‡å®šé»˜è®¤é¦–é¡µAddDefaultCharset UTF-8 #è®¾ç½®æœåŠ¡å™¨çš„é»˜è®¤ç¼–ç ä¸ºï¼š UTF-8 python3æ„å»ºhttpæœåŠ¡python3 -m http.server ç»´æŠ¤&é”™è¯¯httpæœåŠ¡å·²å¼€å¯ï¼Œä½†æ˜¯æ— æ³•è®¿é—®ç½‘ç«™ åœ¨æœ¬åœ°æŸ¥çœ‹httpdæœåŠ¡curl http://localhost:80 çœ‹ç«¯å£ï¼Œå¦‚æœæ˜¯åœ¨å…¬å¸å†…éƒ¨ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰éƒ¨åˆ†ipç«¯å£è¢«å° æ¯”å¦‚80 8080 88 ç­‰ç­‰å¦‚æœæ˜¯ä»¥ä¸Šæƒ…å†µï¼Œä¿®æ”¹httpd é…ç½®æ–‡ä»¶ä¸­çš„ç›‘å¬ç«¯å£ï¼Œé‡å¯httpæœåŠ¡å³å¯ æ°¸ä¹…å…³é—­selinux ,éœ€è¦é‡å¯vi /etc/selinux/configSELINUX=disabled ä¸´æ—¶å…³é—­setenforce 0 å¯èƒ½ä¼šå‡ºç°çš„æŠ¥é”™ä¿¡æ¯(13)Permission denied: make_sock: could not bind to address [::]:88â€”-> å…³é—­selinuxå³å¯ æ£€æµ‹ç«¯å£æ˜¯å¦è¢«å¼€å¯ä½¿ç”¨telnetç™»é™†çš„æ–¹å¼æµ‹è¯•æœåŠ¡å™¨ç«¯å£æ˜¯å¦å¼€æ”¾ # æœªå¼€æ”¾çŠ¶æ€ä¸‹çš„è¿”å›æƒ…å†µâœ ~ telnet 10.0.5.92 8888Trying 10.0.5.92...telnet: Unable to connect to remote host: Connection refused# å¼€æ”¾çŠ¶æ€ä¸‹çš„è¿”å›æƒ…å†µâœ ~ telnet 10.0.5.91 8888Trying 10.0.5.91...Connected to 10.0.5.91.Escape character is '^]'. å¼€æ”¾ç«¯å£ç«¯å£æœªè¢«å¼€æ”¾â€”â€”â€”> iptables -I INPUT -p tcp â€“dport 8888 -j ACCEPT åœ°å€https://www.linuxidc.com/Linux/2017-05/143468.htm","link":"/posts/4982550/"},{"title":"shellè„šæœ¬","text":"shellè„šæœ¬ç®€å•çš„ä»‹ç»shellè„šæœ¬çš„ä½¿ç”¨ è§„èŒƒshellè„šæœ¬å¯¹ç©ºæ ¼æœ‰ä¸€å®šçš„è§„å®š ç©ºæ ¼çš„ä½¿ç”¨ èµ‹å€¼è¯­å¥ä¸­ç­‰å·=ä¸¤è¾¹ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œè€Œå­—ç¬¦ä¸²æ¯”è¾ƒä¸­ç­‰å·= == ä¸¤è¾¹å¿…é¡»æœ‰ç©ºæ ¼ ä¸­æ‹¬å·[] [[]] å‰åä¸€å®šè¦åŠ ç©ºæ ¼ i=1if [ $a == $b ] ;then æ‹¬å·çš„ä½¿ç”¨å¸¸è§çš„ä¸‰ç§æ‹¬å· (()) [] [[]] () åªèƒ½è¿›è¡Œæ•´æ•°æ¯”è¾ƒï¼Œä¸èƒ½ç”¨äºå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œæ‹¬å·ä¸­å˜é‡å¯ä»¥çœç•¥å‰ç¼€ [] [[]] [] ä¸testç­‰ä»·éƒ½æ˜¯å‘½ä»¤ï¼Œè€Œ[[]]æ˜¯å…³é”®å­—, && || < > ä¸èƒ½å­˜åœ¨äº[] ä¸­ï¼Œåªèƒ½ç²—åœ¨äº[[]]ä¸­ [[[] æ”¯æŒç®—æœ¯æ‰©å±• [] ä¸æ”¯æŒ [[]] æ”¯æŒå­—ç¬¦ä¸²åŒ¹é…ï¼Œ[] ä¸æ”¯æŒif [[ $a != 1 && $a != 2 ]], å¯¹if [ $a != 1 ] && [ $a != 2] å¯¹if [[ 1+2 -eq 3 ]] å¯¹ å­—ç¬¦ä¸²å¯¹æ¯”å¯¹æ¯”å­—ç¬¦ä¸²åªèƒ½ä½¿ç”¨=ã€==ã€ã€!=ã€-zã€-nã€‚å…¶ä¸­ï¼Œ-n è¡¨ç¤ºå­—ç¬¦ä¸²ä¸ä¸ºç©ºï¼Œå³é•¿åº¦å¤§äº0ï¼Œ-z è¡¨ç¤ºå­—ç¬¦ä¸²ä¸ºç©ºï¼Œå³é•¿åº¦ä¸º0 å¯¹æ¯”æ•°å­—ï¼Œåªèƒ½ä½¿ç”¨==ã€=ã€!=ï¼Œæˆ–è€… -eqã€-neã€-gtã€-geã€-ltã€-leã€‚å…¶ä¸­-eqçš„æ„æ€æ˜¯ equalï¼Œ-neæ˜¯ unequalï¼Œ-gtæ˜¯ greater thanï¼Œ-geæ˜¯ greater than or equal toï¼Œ-ltæ˜¯ less thanï¼Œ-leæ˜¯ less than or equal toã€‚ https://blog.csdn.net/HappyRocking/article/details/90476264 è¯­æ³•åˆ¤æ–­ ifif æ¡ä»¶; then command1else command2fi ä¸¾ä¾‹ if [[ $a == $b ]]; then echo \"equal\"fi","link":"/posts/d0a69eae/"},{"title":"linuxè„šæœ¬","text":"å»ºè®®åœ¨sedå‰ä½¿ç”¨sed -n â€˜///pâ€™ æŸ¥çœ‹ç»“æœ linuxè„šæœ¬è®°å½• åˆ é™¤æ–‡æ¡£ä¸­çš„æ‰€æœ‰å¸¦#çš„è¡Œsed -i -r '/^#.*/s:::g' /etc/ntp.conf","link":"/posts/705ac99d/"},{"title":"netstat","text":"netstatå·¥å…·netstatæ˜¯åœ¨å†…æ ¸ä¸­è®¿é—®ç½‘ç»œç›¸å…³ä¿¡æ¯çš„ç¨‹åºã€‚ æä¾›TCPè¿æ¥ã€TCPå’ŒUDPç›‘å¬ã€è¿›ç¨‹å†…å­˜ç®¡ç†çš„çŠ¶æ€ã€‚ ç›‘æ§TCP/IPç½‘ç»œçš„éå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œæ˜¾ç¤ºè·¯ç”±è¡¨ã€å®é™…ç½‘ç»œè¿æ¥ä»¥åŠæ¯ä¸€ä¸ªç½‘ç»œæ¥å£è®¾å¤‡çš„çŠ¶æ€ä¿¡æ¯ã€‚ ä½¿ç”¨netstatå¯ä»¥è®©ç”¨æˆ·çŸ¥é“æœ‰å“ªäº›ç½‘ç»œè¿æ¥æ­£åœ¨è¿ä½œï¼Œä½¿ç”¨æ—¶å¦‚æœä¸å¸¦å‚æ•°ï¼Œnetstatæ˜¾ç¤ºæ´»åŠ¨çš„TCPè¿æ¥ # å®‰è£…yum install net-tools# ä½¿ç”¨netstat é€‰é¡¹ï¼šå¸¸ç”¨å‚æ•°ï¼š-a:æ˜¾ç¤ºæ‰€æœ‰çš„socketï¼ŒåŒ…æ‹¬ç›‘å¬çš„ä»¥åŠæœªç›‘å¬çš„ã€‚-n:ä¸ä½¿ç”¨åŸŸåå’ŒæœåŠ¡åï¼Œè€Œä½¿ç”¨IPå’Œç«¯å£å·ã€‚-l:ä»…åˆ—å‡ºåœ¨listençŠ¶æ€çš„ç½‘ç»œæœåŠ¡ã€‚-p:æ˜¾ç¤ºå»ºç«‹è¿æ¥çš„ç¨‹åºåå’ŒPIDã€‚-e:æ˜¾ç¤ºä»¥å¤ªç½‘ç»Ÿè®¡ã€‚-s:æ˜¾ç¤ºæ¯ä¸ªåè®®çš„ç»Ÿè®¡ã€‚-tï¼šæ˜¾ç¤ºTCPåè®®è¿æ¥æƒ…å†µã€‚-u:æ˜¾ç¤ºUDPåè®®è¿æ¥æƒ…å†µã€‚-c:æ¯éš”ä¸€ä¸ªå›ºå®šæ—¶é—´ï¼Œæ‰§è¡Œnetstatå‘½ä»¤ã€‚-rï¼šæ˜¾ç¤ºæ ¸å¿ƒè·¯ç”±è¡¨ã€‚-i:æ˜¾ç¤ºæ‰€æœ‰çš„ç½‘ç»œæ¥å£ä¿¡æ¯ å¸¸ç”¨æŒ‡ä»¤# æ˜¾ç¤ºå»ºç«‹è¿æ¥çš„ç¨‹åºå PID IP ç«¯å£ä»¥åŠç›‘å¬çŠ¶æ€[root@localhost ~]# netstat -pan | grep 8888tcp6 0 0 :::8888 :::* LISTEN 16711/httpd","link":"/posts/4421/"},{"title":"iptablesã€firewall é˜²ç«å¢™","text":"iptablesã€firewallé˜²ç«å¢™Linuxä¸­æœ‰ä¸¤ç§é˜²ç«å¢™è½¯ä»¶ï¼ŒConterOS7.0ä»¥ä¸Šä½¿ç”¨çš„æ˜¯firewallï¼ŒConterOS7.0ä»¥ä¸‹ä½¿ç”¨çš„æ˜¯iptables firewall# å¼€å¯é˜²ç«å¢™systemctl start firewalld# å…³é—­é˜²ç«å¢™systemctl stop firewalld# æŸ¥çœ‹çŠ¶æ€systemctl status firewalldfirewall-cmd --state# è®¾ç½®å¼€æœºå¯åŠ¨systemctl enable firewalld# ç¦ç”¨å¼€æœºå¯åŠ¨systemctl disabled firewalld# é‡å¯é˜²ç«å¢™firewall-cmd --reload# å¼€æ”¾ç«¯å£firewall-cmd --zone=public --add-port=8080/tcp --permanet# æŸ¥çœ‹å·²ç»å¼€æ”¾çš„ç«¯å£firewall-cmd --list-ports firewall-cmd --list-all# å…³é—­ç«¯å£firewall-cmd --zone=public --remove-port=8080/tcp --permanet\\ https://juejin.im/post/5d538326f265da03ce39cf38 iptables# å®‰è£…iptables yum install iptables# å®‰è£…iptables-servicesyum install iptables-services# å¼€å¯é˜²ç«å¢™systemctl start iptables# å…³é—­é˜²ç«å¢™systemctl stop iptables.services# é˜²ç«å¢™çŠ¶æ€ ã€å¼€æœºå¯åŠ¨ ã€ ç¦ç”¨å¼€æœºå¯åŠ¨ã€status ã€ enable ã€disable# æŸ¥çœ‹filterè¡¨çš„å‡ æ¡é“¾è§„åˆ™(INPUTé“¾å¯ä»¥çœ‹å‡ºå¼€æ”¾äº†å“ªäº›ç«¯å£)ï¼šiptables -L -n# æŸ¥çœ‹è¿æ ‡è§„åˆ™iptables -t nat -L -n # æ¸…é™¤é˜²ç«å¢™æ‰€æœ‰è§„åˆ™iptables -F# ç»™INPUTé“¾æ·»åŠ è§„åˆ™ï¼ˆå¼€æ”¾8080ç«¯å£ï¼‰iptables -I INPUT -p tcp --dport 8080 -j ACCEPT# æŸ¥æ‰¾è§„åˆ™æ‰€åœ¨è¡Œiptables -L INPUT --line-numbers -n# æ ¹æ®è¡Œå·åˆ é™¤è¿‡æ»¤è§„åˆ™(å…³é—­8080)iptables -D INPUT 1 é˜²ç«å¢™é”™è¯¯å¯¼è‡´çš„åŸå›  å¼€é€šhttpdåï¼Œå½“å‰æœºå™¨ä¸‹ä½¿ç”¨curlå¯è®¿é—®ï¼Œä½†å¤–éƒ¨æœºå™¨è®¿é—®ip+ç«¯å£åˆ™æ— æ³•è®¿é—®[root@localhost ~]# curl http://10.0.5.92:8888curl: (7) Failed connect to 10.0.5.92:8888; No route to host curlæŠ¥å¦‚ä¸‹é”™è¯¯ï¼šcurl: (7) Failed connect to 172.16.225.43:7001; No route to host è§£å†³åŠæ³•â€”-> åœ¨è¢«è®¿é—®æœºå™¨ä¸‹å¼€æ”¾8888ç«¯å£â€”-> iptables -l INPUT -p tcp â€“dport 8888 -j ACCEPTt 8888 -j ACCEPT","link":"/posts/60486/"},{"title":"linuxæ–‡æœ¬ç¼–è¾‘ä¸‰å‰‘å®¢","text":"linuxæ–‡æœ¬ç¼–è¾‘ä¸‰å‰‘å®¢ï¼Œawkã€grepã€sedæ˜¯linuxæ“ä½œæ–‡æœ¬çš„ä¸‰å¤§åˆ©å™¨ï¼Œåˆç§°æ–‡æœ¬ä¸‰å‰‘å®¢ï¼Œä¹Ÿæ˜¯å¿…é¡»æŒæ¡çš„linuxå‘½ä»¤ä¹‹ä¸€ã€‚ä¸‰è€…çš„åŠŸèƒ½éƒ½æ˜¯å¤„ç†æ–‡æœ¬ï¼Œä½†ä¾§é‡ç‚¹å„ä¸ç›¸åŒï¼Œå…¶ä¸­å±awkåŠŸèƒ½æœ€å¼ºå¤§ï¼Œä½†ä¹Ÿæœ€å¤æ‚ã€‚grepæ›´é€‚åˆå•çº¯çš„æŸ¥æ‰¾æˆ–åŒ¹é…æ–‡æœ¬ï¼Œsedæ›´é€‚åˆç¼–è¾‘åŒ¹é…åˆ°çš„æ–‡æœ¬ï¼Œawkæ›´é€‚åˆæ ¼å¼åŒ–æ–‡æœ¬ï¼Œå¯¹æ–‡æœ¬è¿›è¡Œè¾ƒå¤æ‚æ ¼å¼å¤„ç† å…³äºâ€ä¸‰å‰‘å®¢â€çš„ç‰¹é•¿ä»€ä¹ˆæ˜¯ä¸‰å‰‘å®¢çš„ç‰¹é•¿= grep æ›´é€‚åˆå•çº¯çš„æŸ¥æ‰¾å’ŒåŒ¹é…æ–‡æœ¬ sed æ›´é€‚åˆç¼–è¾‘åŒ¹é…çš„æ–‡æœ¬ awk æ›´é€‚åˆæ ¼å¼åŒ–æ–‡æœ¬,å¯¹æ–‡æœ¬è¿›è¡Œè¾ƒå¤æ‚æ ¼å¼å¤„ç† linuxæ–‡æœ¬ç¼–è¾‘ä¸‰å‰‘å®¢grepåŸºç¡€grepï¼ˆglobal search regular expression(RE) and print out the lineï¼Œå…¨é¢æœç´¢æ­£åˆ™è¡¨è¾¾å¼å¹¶æŠŠè¡Œæ‰“å°å‡ºæ¥ï¼‰æ˜¯ä¸€ç§å¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·ï¼Œå®ƒèƒ½ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢æ–‡æœ¬ï¼Œå¹¶æŠŠåŒ¹é…çš„è¡Œæ‰“å°å‡ºæ¥ grep (é€‰é¡¹) pattern flie-A é™¤äº†æ˜¾ç¤ºç¬¦åˆåŒ¹é…è¡Œï¼Œä¹Ÿæ˜¾ç¤ºåŒ¹é…è¡Œåçš„nè¡Œ-B é™¤äº†æ˜¾ç¤ºç¬¦åˆåŒ¹é…è¡Œï¼Œä¹Ÿæ˜¾ç¤ºåŒ¹é…è¡Œå‰çš„nè¡Œ-C é™¤äº†æ˜¾ç¤ºç¬¦åˆåŒ¹é…è¡Œï¼Œä¹Ÿæ˜¾ç¤ºåŒ¹é…è¡Œå‰åçš„nè¡Œ ä½†ä¸æ˜¾ç¤ºæ¯ä¸€è¡Œçš„è¡Œæ•°-c ä»…æ˜¾ç¤ºç»Ÿè®¡åŒ¹é…è¡Œæ•°çš„æ€»æ•°-e å®ç°å¤šä¸ªé€‰é¡¹ä»¶çš„é€»è¾‘å…³ç³» or-E æ‰©å±•çš„æ­£åˆ™è¡¨è¾¾å¼-f FILEï¼šä»FILEè·å–åŒ¹é…å‚æ•°æ ¼å¼-i --ignore-case å¿½ç•¥å­—ç¬¦å¤§å°å†™çš„å·®åˆ«-n æ˜¾ç¤ºåŒ¹é…çš„è¡Œå·-o ä»…æ˜¾ç¤ºåŒ¹é…åˆ°çš„å­—ç¬¦ä¸²-v åå‘åŒ¹é…ï¼Œæ˜¾ç¤ºä¸è¢«åŒ¹é…çš„å†…å®¹-w åªæ˜¾ç¤ºå…¨å­—ç¬¦åˆçš„åˆ— éœ€è¦æ³¨æ„çš„åœ°æ–¹ egrep = grep -E é™¤äº† < \\> \\b ä»¥å¤–å…¶ä»–æ­£åˆ™éƒ½å¯ä»¥å»æ‰\\ å¦‚æœæœ‰è¦åŒ¹é…çš„å†…å®¹ä¸­,æœ‰( ; )è¿™ç§çš„è¯æœ€å¥½åŠ â€â€ æ¯”å¦‚ grep â€œ;â€ test.txt æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å†…å®¹.åŒ¹é…å…¨éƒ¨å­—ç¬¦ï¼Œä¸åŒ¹é…ç©ºè¡Œ[]åŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å•ä¸ªå­—ç¬¦[^] å–å[:alnum:] [0-9a-zA-Z][:alpha:] [a-zA-Z][:upper:] æˆ– [A-Z][:lower:] æˆ– [a-z][:blank:] åŒ¹é…ç©ºç™½å­—ç¬¦[:punct:] æ ‡ç‚¹ç¬¦å·åŒ¹é…æ¬¡æ•° *åŒ¹é…ä»»æ„æ¬¡ 0-næ¬¡ ,è´ªå©ªæ¨¡å¼(å°½å¯èƒ½å¤šåŒ¹é…).*åŒ¹é…ä»»æ„æ¬¡ 1-næ¬¡ \\?åŒ¹é… 0-1æ¬¡\\+è‡³å°‘åŒ¹é…1æ¬¡ ä½ç½®ç¡®å®š^ è¡Œé¦–$ è¡Œå°¾^$ ç©ºç™½è¡Œ åˆ’ç»„åŒ¹é…åœ¨æ­£åˆ™è¡¨è¾¾ç¤ºä¸­ä½¿ç”¨ä¹‹å‰åŒ¹é…åˆ°çš„å†…å®¹ï¼Œå³åˆ’ç»„åŒ¹é… # åˆ†ç»„å½¢å¼ \\(\\)# è¯»å–æ–¹å¼ \\1 \\2 \\3 å®ä¾‹ å¤šæ–‡ä»¶æŸ¥æ‰¾grep \"match_pattern\" file1 file2 file3 åé¡¹æŸ¥æ‰¾grep -v \"macth_pattern\" file1 file2 file3 åŒ¹é…é¡¹æ ‡è®°é¢œè‰²grep \"macth_pattern\" file1 --color=auto æ­£åˆ™åŒ¹é…grep -E \"[1-9]+\"æˆ–egrep \"[1-9]+\" åªæ˜¾ç¤ºåŒ¹é…åˆ°çš„å­—ç¬¦ä¸²echo this is a test line. | grep -o -E \"[a-z]+\\.\" ç»Ÿè®¡åŒ¹é…åˆ°çš„å†…å®¹æ•°é‡grep -c \"text\" file1 æ˜¾ç¤ºåŒ¹é…åˆ°çš„è¡Œå·grep -n \"text\" file1 å¤šçº§ç›®å½•ä¸­é€’å½’æœç´¢grep \"text\" . -r -n å¿½ç•¥å¤§å°å†™echo \"hello world\" | grep -i \"HELLO\" awkåŸºç¡€awkæ˜¯ç”±Alfred Aho ã€Peter Weinberger å’Œ Brian Kernighanè¿™ä¸‰ä¸ªäººåˆ›é€ çš„ï¼Œawkç”±è¿™ä¸ªä¸‰ä¸ªäººçš„å§“æ°çš„é¦–ä¸ªå­—æ¯ç»„æˆã€‚awkå…¶å®å¯ä»¥çœ‹æˆæ˜¯ä¸€é—¨ç‹¬ç«‹çš„ç¼–ç¨‹è¯­è¨€ï¼Œä»–æ”¯æŒæ¡ä»¶åˆ¤æ–­ã€æ•°ç»„ã€å¾ªç¯ç­‰åŠŸèƒ½ã€‚awkå…±æœ‰ä¸¤ä¸ªç‰ˆæœ¬(gawkä¸nawkç‰ˆæœ¬),åœ¨linuxä¸­æˆ‘ä»¬æœ€å¸¸ä½¿ç”¨çš„æ˜¯gawk,åŒæ—¶awkã€grepã€sedè¢«ç§°ä¸ºLinuxä¸­çš„ä¸‰å‰‘å®¢ [root@CodeSheep ~]# ll /usr/bin/awk lrwxrwxrwx. 1 root root 4 Feb 15 2019 /usr/bin/awk -> gawk è¯­æ³•awk [options] â€˜{pattern + action}â€™ {filenames}å…¶ä¸­çš„action æˆ‘ä»¬æœ€å¸¸ç”¨çš„å°±æ˜¯printä»¥åŠprinf,å¯¹äºactionæ¥è¯´ï¼Œæ¯æ¬¡ç»è¿‡ä¸€è¡Œï¼Œéƒ½ä¼šå½“å‰è¡Œæ‰§è¡Œä¸€è¾¹actionæ¯”å¦‚ awk '{print \"1\",NR}' /etc/passwd ä½ ä¼šå‘ç°æœ‰å¤šå°‘è¡Œï¼Œä»–å°±è¾“å‡ºäº†å¤šå°‘ä¸ª1 æ¯è¡Œä¸€ä¸ª awkçš„å·¥ä½œæµç¨‹é¦–å…ˆawkå¹¶ä¸æ˜¯åˆ—æ“ä½œï¼Œè€Œæ˜¯è¡Œæ“ä½œï¼ŒåŒæ ·çš„ä»–ä¹Ÿæ˜¯ä¸€è¡Œä¸€è¡Œçš„å¤„ç†çš„ï¼Œå…¶ä¸­$0è¡¨ç¤ºå½“å‰è¡Œï¼Œæ¯”å¦‚åœ¨æ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬è¾“å‡ºå…¨æ–‡æ˜¯ç”¨catæ¥æŸ¥çœ‹çš„ï¼Œé‚£ä¹ˆç”¨awkçš„æ“ä½œæ˜¯è¿™æ ·çš„,å¦å¤–awkçš„æ¥å—æ ‡å‡†è¾“å…¥å’Œæ–‡ä»¶ cat /etc/passwdawk '{print $0}' /etc/passwd# å¦‚ä¸Šçš„å†…å®¹æ˜¯ä¸€æ ·çš„ awkä¸­çš„åˆ†éš”ç¬¦ä¸ºäº†å¤„ç†å¥½æ¯ä¸€è¡Œä¸­çš„æ¯ä¸€ä¸ªå­—æ®µï¼Œawkå¼•å…¥äº†åˆ†éš”ç¬¦çš„æ¦‚å¿µï¼Œåˆ†éš”ç¬¦æœ‰ä¸‰ç§è¡¨ç°çš„å½¢å¼ï¼Œä¸€ç§æ˜¯ä¸è¾“å…¥ä»»ä½•ä¸æŒ‡å®šä»»ä½•ï¼Œåˆ™é»˜è®¤ä¸ºç©ºæ ¼ä¸€ç§æ˜¯è‡ªå®šä¹‰çš„åˆ†éš”ç¬¦ ä½¿ç”¨ -F æŒ‡å®š æ¯”å¦‚ -F:å¦å¤–ä¸€ç§æ˜¯ä½¿ç”¨ å†…ç½®å˜é‡æŒ‡å®š -v FS=â€™#â€™ è‡ªå®šä¹‰åˆ†éš”ç¬¦æ—¢ç„¶é»˜è®¤çš„åˆ†éš”ç¬¦æ˜¯ç©ºæ ¼,é‚£ä¹ˆå½“ç„¶è¿˜æœ‰è‡ªå®šä¹‰çš„åˆ†éš”ç¬¦å’¯ã€‚æˆ‘ä»¬ä½¿ç”¨-Fé€‰é¡¹æ¥æŒ‡å®šæˆ‘ä»¬çš„åˆ†éš”ç¬¦ # ä½¿ç”¨#åˆ†éš”ç¬¦[root@CodeSheep ~]# cat demo3.text 123#123#dsdshj#dlsj#[root@CodeSheep ~]# awk -F# '{print $1}' demo3.text 123[root@CodeSheep ~]# cat demo3.text 123#123#dsdshj#dlsj#[root@CodeSheep ~]# awk -v FS='#' '{print $1}' demo3.text 123 å…¶å®åœ¨awkä¸­ä¸ä»…ä»…æœ‰è¾“å…¥çš„åˆ†å‰²ç¬¦,è¿˜æœ‰è¾“å‡ºçš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¹Ÿä¸ºç©ºæ ¼ [root@CodeSheep ~]# awk -F# '{print $1,$2}' demo3.text 123 123 OFS(output field separator)å¯ä»¥æŒ‡å®šè¾“å‡ºçš„åˆ†éš”ç¬¦,ç”¨æ³•ä¸FSç›¸åŒ [root@CodeSheep ~]# awk -v FS='#' -v OFS='++++' '{print $1,$2}' demo3.text 123++++123 awké‡å®šå‘awk 'BEGIN { print \"Hello, World !!!\" > \"/tmp/message.txt\" }' awkçš„å†…å»ºå˜é‡awkæ”¯æŒå†…å»ºå˜é‡å’Œè‡ªå®šä¹‰å˜é‡ å†…å»ºå˜é‡ $0 å½“å‰è¡Œ $1~$n ç¬¬nä¸ªå­—æ®µ $NF æœ€åä¸€ä¸ªå­—æ®µ NF å½“å‰è¡Œè¢«åˆ†å‰²å­—æ®µæ€»æ•° NR å½“å‰è¡Œè¡Œå· FNR å„æ–‡ä»¶åˆ†åˆ«è®¡æ•°çš„è¡Œå· FS è¾“å…¥åˆ†éš”ç¬¦ OFS è¾“å‡ºåˆ†éš”ç¬¦ RS è¾“å…¥æ¢è¡Œç¬¦ ORS è¾“å‡ºæ¢è¡Œç¬¦ FILENAME å½“å‰æ–‡ä»¶å ARGC å‘½ä»¤è¡Œå‚æ•°çš„ä¸ªæ•° ARGV æ•°ç»„,ä¿å­˜çš„å‘½ä»¤è¡Œæ‰€ç»™å®šçš„å„å‚æ•° # ç»™æ¯ä¸€è¡Œæ·»åŠ è¡Œå·,è¾“å‡ºå½“å‰è¡Œå·ï¼Œä»¥åŠå½“å‰è¡Œçš„å†…å®¹[root@CodeSheep ~]# df | awk '{print NR,$0}'1 Filesystem 1K-blocks Used Available Use% Mounted on2 /dev/vda1 41147472 6848400 32395580 18% /3 devtmpfs 930656 0 930656 0% /dev4 tmpfs 941116 0 941116 0% /dev/shm5 tmpfs 941116 452 940664 1% /run6 tmpfs 941116 0 941116 0% /sys/fs/cgroup7 tmpfs 188224 0 188224 0% /run/user/0# å¤šä¸ªæ–‡ä»¶ä½¿ç”¨NRæ—¶,ä¼šæ ¹æ®çš„æ–‡ä»¶é¡ºåºç´¯åŠ åºå·# FNRåˆ™ä¼šåˆ†å¼€æ ‡åº# ARGV,ARGC[root@CodeSheep ~]# awk 'BEGIN{print ARGV[0],ARGV[1],ARGV[2],ARGC}' demo1.txt demo2.text awk demo1.txt demo2.text 3# å…¶ä¸­ARGVä½œä¸ºæ•°ç»„,ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯awk è‡ªå®šä¹‰å˜é‡åè‡ªå®šä¹‰å˜é‡çš„ä¸¤ç§å½¢å¼,ä¸€ç§æ˜¯åœ¨actionå¤–é¢ ä½¿ç”¨é€‰é¡¹æŒ‡å®šå˜é‡ï¼Œæ¯”å¦‚ -v name=â€hzjâ€å¦å¤–ä¸€ç§åˆ™æ˜¯åœ¨actionå‰çš„patternä¸­å®šä¹‰ï¼Œæ¯”å¦‚ {name=â€hzjâ€; action->print name} [root@CodeSheep ~]# awk -v name=\"hzj\" 'BEGIN{print name}'hzj[root@CodeSheep ~]# awk 'BEGIN{name=\"hzj\";print name}'hzj[root@CodeSheep ~]# name=hzj[root@CodeSheep ~]# awk -v name=$name 'BEGIN{print name}'hzj awk å‚æ•°options-v name=â€xxâ€ -vå¤–éƒ¨å®šä¹‰å˜é‡###s## pattern+actionæŠ›å¼€Pattern æˆ‘ä»¬å…ˆæ¥ä½¿ç”¨{action} # è¾“å‡ºæ–‡æœ¬å†…å®¹[root@CodeSheep ~]# dfFilesystem 1K-blocks Used Available Use% Mounted on/dev/vda1 41147472 6848500 32395480 18% /devtmpfs 930656 0 930656 0% /devtmpfs 941116 0 941116 0% /dev/shmtmpfs 941116 452 940664 1% /runtmpfs 941116 0 941116 0% /sys/fs/cgrouptmpfs 188224 0 188224 0% /run/user/0[root@CodeSheep ~]# df | awk '{print $1}'Filesystem/dev/vda1devtmpfstmpfstmpfstmpfstmpfs awkæ˜¯é€è¡Œå¤„ç†çš„,ä¹Ÿå°±æ˜¯è¯´å½“awkå¤„ç†ä¸€ä¸ªæ–‡æœ¬çš„æ—¶å€™ï¼Œä»–ä¼šä¸€è¡Œä¸€è¡Œçš„å¤„ç†å†…å®¹ã€‚å…¶ä¸­awké»˜è®¤ä»¥ æ¢è¡Œç¬¦ ä¸ºæ ‡è®°è¯†åˆ«æ¯ä¸€è¡Œã€‚å¦å¤–å¯¹äºæ¯ä¸€è¡Œçš„å¤„ç†ä¸­ awkä¼šæŒ‰ç…§ç”¨æˆ·æŒ‡å®šçš„ åˆ†éš”ç¬¦ å»åˆ†éš”å½“å‰è¡Œï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™é»˜è®¤ä½¿ç”¨ç©ºæ ¼ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå½“å‡ºç°å¤šä¸ªç©ºæ ¼çš„æ—¶å€™,awkä¼šè‡ªåŠ¨å°†è¿ç»­çš„ç©ºæ ¼ç†è§£æˆä¸ºä¸€ä¸ªåˆ†éš”ç¬¦ã€‚å…¶ä¸­ æˆ‘ä»¬å°†è¢«awkå¤„ç†åçš„æ¯ä¸€è¡Œéƒ½ä½¿ç”¨äº†ç‰¹å®šçš„å˜é‡æ ‡è®°$0è¡¨ç¤ºå½“å‰å¤„ç†çš„æ•´è¡Œ$1è¡¨ç¤ºç¬¬ä¸€ä¸ªå­—æ®µ$2è¡¨ç¤ºç¬¬äºŒä¸ªå­—æ®µ$NFè¡¨ç¤ºæœ€åä¸€ä¸ªå­—æ®µNFè¡¨ç¤ºå½“å‰è¡Œè¢«åˆ†å‰²åå­—æ®µæ€»æ•°å› æ­¤ å‡è®¾ä¸€è¡Œæ–‡æœ¬è¢«ç©ºæ ¼åˆ†ä¸º8æ®µï¼Œåˆ™$NFè¡¨ç¤º$8 NF=8 åˆ™$7=$(NF-1) # è¾“å‡ºå¤šè¡Œ[root@CodeSheep ~]# df | awk '{print $1 $2 $3}'Filesystem1K-blocksUsed/dev/vda1411474726848536devtmpfs9306560tmpfs9411160tmpfs941116452tmpfs9411160tmpfs1882240[root@CodeSheep ~]# df | awk '{print $1, $2 ,$3}'Filesystem 1K-blocks Used/dev/vda1 41147472 6848536devtmpfs 930656 0tmpfs 941116 0tmpfs 941116 452tmpfs 941116 0tmpfs 188224 0# è‡ªå·±æ·»åŠ å­—æ®µ[root@CodeSheep ~]# df | awk '{print $1 ,\"this print test\"}'Filesystem this print test/dev/vda1 this print testdevtmpfs this print testtmpfs this print testtmpfs this print testtmpfs this print testtmpfs this print test[root@CodeSheep ~]# df | awk '{print \"$1=\"$1 , \"testfield:\"\"this print test\"}'$1=Filesystem testfield:this print test$1=/dev/vda1 testfield:this print test$1=devtmpfs testfield:this print test$1=tmpfs testfield:this print test$1=tmpfs testfield:this print test$1=tmpfs testfield:this print test$1=tmpfs testfield:this print test#çœ‹ä¸Šé¢çš„æ¡ˆä¾‹æˆ‘ä»¬å¯ä»¥å‘ç°,å½“$1è¢«åŒå¼•å·åŒ…è£¹çš„æ—¶å€™ï¼Œä»–å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²,ä¸å†æ˜¯å˜é‡ awkä¸­çš„Patternå…¶å®actionçš„ä¸»è¦æ“ä½œå°±æ˜¯printè¾“å‡º,ç®€å•æ¥ç”¨å°±æ˜¯è¾“å‡ºå†…å®¹ï¼Œæ›´å¤æ‚çš„å°±æ˜¯å¯¹è¾“å‡ºçš„å†…å®¹è¿›è¡Œæ ¼å¼åŒ–çš„æ“ä½œã€‚è€ŒPatternæ‰€å­˜åœ¨çš„ä¸¤ç§æ¨¡å¼,æ„ˆåŠ åŠ å¼ºäº†awkçš„èƒ½åŠ›ã€‚ awkä¸­çš„é€»è¾‘ä¸ºäº†æ›´å¥½çš„æ ¼å¼åŒ–,awkä¸­ä¹Ÿå¸¦æœ‰é€»è¾‘å‚æ•°ï¼Œå…¶ä¸­åŒ…æ‹¬å¼€å§‹BEGINå’Œç»“å°¾END,ä»–ä»¬ä¹‹é—´ç”¨{}åˆ†éš”,æ¯”å¦‚ awk -v test=\"test\" 'BEGIN{print \"1\",NR}{print test}END{print \"input end\" }' /etc/passwd ä½ ä¼šå‘ç°ä»–è¾“å‡ºäº†å¾ˆå¤šä¸ªtestï¼Œé¦–å…ˆbeginè¿›å…¥ï¼Œç„¶åè¾“å‡º1å’Œè¡Œå·0 ç´§æ¥ç€ä¸æ–­çš„è¿›å…¥è¡Œè¾“å‡ºtest åœ¨æœ€åä¸€è¡Œè¾“å…¥æ—¶ æ‰§è¡Œinput end ç‰¹æ®Šæ¨¡å¼ä¸‹çš„BEGINä¸END BEGIN æ¨¡å¼æŒ‡å®šäº†å¤„ç†æ–‡æœ¬ä¹‹å‰éœ€è¦æ‰§è¡Œçš„æ“ä½œ END æ¨¡å¼æŒ‡å®šäº†å¤„ç†å®Œæ‰€æœ‰è¡Œä¹‹åæ‰€éœ€è¦æ‰§è¡Œçš„æ“ä½œ [root@CodeSheep ~]# df | awk 'BEGIN{print \"$1\",\"$2\"}'$1 $2[root@CodeSheep ~]# df | awk 'BEGIN{print \"$1\",\"$2\"} {print $1,$2}'$1 $2Filesystem 1K-blocks/dev/vda1 41147472devtmpfs 930656tmpfs 941116tmpfs 941116tmpfs 941116tmpfs 188224[root@CodeSheep ~]# df | awk 'BEGIN{print \"$1\",\"$2\"} {print $1,$2} END{print \"end for file\"}'$1 $2Filesystem 1K-blocks/dev/vda1 41147472devtmpfs 930656tmpfs 941116tmpfs 941116tmpfs 941116tmpfs 188224end for file åœ¨BEGINçš„æ¨¡å¼ä¸‹ï¼Œé¦–å…ˆawkä¼šæ‰§è¡ŒBEGINä¸­çš„action ä¹‹åæ‰åšå»æ‰§è¡Œå…¶ä»–çš„action,åŒç†,åœ¨æ‰§è¡Œå®Œæ‰€æœ‰çš„actionä¹‹å,awkå›å»æ‰§è¡ŒENDæ¨¡å¼ä¸‹é¢çš„actionã€‚éœ€è¦æ³¨æ„çš„æ˜¯ä¸¤ä¸ªç‰¹æ®Šçš„æ¨¡å¼BEGINä»¥åŠENDéƒ½éœ€è¦å¤§å†™ äºæ˜¯ awkçš„æ ¼å¼åŒ–èƒ½åŠ›è¡¨éœ²æ— ç–‘äº†,æå–å­—æ®µå†åŠ ä¸ŠBEGINä¸ENDçš„ä¸¤ç§ç‰¹æ®Šæ¨¡å¼ï¼Œä¸€å¼ å®Œæ•´çš„è¡¨ä¸å°±å‡ºæ¥äº†å˜› å…³ç³»è¿ç®—ç¬¦ < å°äº x < y=y> å¤§äº x>y~ æ­£åˆ™åŒ¹é… x ~ /æ­£åˆ™/!~ æ­£åˆ™ä¸åŒ¹é… x !~ /æ­£åˆ™/ awkä¸­çš„æ­£åˆ™æ¨¡å¼æ—¢ç„¶ä¸Šé¢çš„å…³ç³»è¿ç®—ç¬¦ä¸­å‡ºç°äº†æ­£åˆ™ï¼Œé‚£æˆ‘ä»¬å°±æ¥è®²ä¸€è®²æ­£åˆ™æ¨¡å¼éœ€è¦æ³¨æ„çš„æ˜¯ å½“ä½¿ç”¨{x,y}è¿™ç§æ¬¡æ•°åŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œéœ€è¦é…åˆâ€“posixé€‰é¡¹æˆ–è€…â€“re-intervalé€‰é¡¹ # åŒ¹é…/etc/passwd ä¸­ä»¥ tsså¼€å¤´çš„è¡Œ[root@CodeSheep ~]# cat /etc/passwd | awk '/tss/{print $0}'tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin# åŒ¹é…/etc/passwd ä¸­ä»¥ /bin/bashç»“å°¾çš„è¡Œ[root@CodeSheep ~]# cat /etc/passwd | awk '/\\/bin\\/bash$/{print $0}'root:x:0:0:root:/root:/bin/bash# åŒ¹é…/etc/passwd ä¸­ä»¥/bin/bashç»“å°¾çš„è¡Œ åˆ°ä»¥ tsså¼€å¤´çš„è¡Œ[root@CodeSheep ~]# cat /etc/passwd | awk '/\\/bin\\/bash$/,/^tss/{print $0}'root:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologinsystemd-network:x:192:192:systemd Network Management:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinpolkitd:x:999:998:User for polkitd:/:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinchrony:x:998:996::/var/lib/chrony:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinnscd:x:28:28:NSCD Daemon:/:/sbin/nologinmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/falsedockerroot:x:997:994:Docker User:/var/lib/docker:/sbin/nologintss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin# åŒ¹é…è¡Œå·å¤§äº2 ä¸”å°äº6çš„è¡Œ[root@CodeSheep ~]# cat /etc/passwd | awk 'NR>2 && NR>> test by geminis' /etc/passwdsed -r '/^root/c\\>>>> test by geminis' /etc/passwd# åˆ é™¤ç©ºæ ¼sed s/[[:space:]]//g file# åˆ é™¤ç©ºæ ¼ sed /^$/d file åœ°å€https://www.cnblogs.com/along21/p/10366886.html#auto_id_15","link":"/posts/ec496181/"},{"title":"linuxå¸¸ç”¨å‘½ä»¤","text":"linuxå¸¸ç”¨å‘½ä»¤è®°å½•ä¸€äº›ç»å¸¸ä½¿ç”¨çš„å‘½ä»¤å’Œå‘½ä»¤ç»„åˆ find (å¸¸ç”¨)findå‘½ä»¤ç”¨æ¥åœ¨æŒ‡å®šç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶ find . # åˆ—å‡ºå½“å‰ç›®å½•åŠå­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹find /home -name \"*.txt\" # åœ¨/homeç›®å½•ä¸‹æŸ¥æ‰¾ä»¥.txtç»“å°¾çš„æ–‡ä»¶åfind /home -iname \"*.txt\"# åœ¨/homeç›®å½•ä¸‹æŸ¥æ‰¾ä»¥.txtç»“å°¾çš„æ–‡ä»¶å ,å¿½ç•¥å¤§å°find . \\( -name \"*.txt\" -o -name \"*.pdf\" \\) # å½“å‰ç›®å½•åŠå­ç›®å½•ä¸‹æŸ¥æ‰¾æ‰€æœ‰ä»¥.txtå’Œ.pdfç»“å°¾çš„æ–‡ä»¶find /home ! -name \"*.txt\" # ä¸æ˜¯.txtç»“å°¾çš„æ–‡ä»¶find . -type # ç±»å‹å‚æ•° ã€f-æ™®é€šæ–‡ä»¶ï¼Œl-ç¬¦å·è¿æ¥ ï¼Œ d-ç›®å½• s-å¥—æ¥å­— ã€‘find . -maxdepth 3 -type f # -maxdepth æŒ‡å®šæ·±åº¦find . -type f -size -10K # æœç´¢å°äº10Kçš„æ–‡ä»¶ +10K å¤§äº find /usr/ -path \"*local\" # åŒ¹é…æ–‡ä»¶è·¯å¾„æˆ–è€…æ–‡ä»¶[root@lvs-web1 ~]# find /usr/ -path \"*local\"/usr/share/doc/postfix-2.10.1/examples/qmail-local/usr/share/aclocal/usr/libexec/postfix/local/usr/local æ›´åŠ å…·ä½“çš„https://man.linuxde.net/find chrootchrootä¸»è¦ç”¨äºä¿®æ”¹ç³»ç»Ÿçš„æ ¹åˆ†åŒºï¼Œlinuxç³»ç»Ÿä¸­å¸¸å¸¸æ˜¯ä»¥/ä¸ºæ ¹ç›®å½•çš„ åŠŸèƒ½: åœ¨å¿˜è®°rootå¯†ç çš„æ—¶å€™ï¼Œè¿›å…¥å•ç”¨æˆ·ä¿®æ”¹å¯†ç  éš”ç¦»ç¯å¢ƒåœ¨ç»è¿‡ chroot ä¹‹åï¼Œåœ¨æ–°æ ¹ä¸‹å°†è®¿é—®ä¸åˆ°æ—§ç³»ç»Ÿçš„æ ¹ç›®å½•ç»“æ„å’Œæ–‡ä»¶ï¼Œè¿™æ ·å°±å¢å¼ºäº†ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚è¿™ä¸ªä¸€èˆ¬æ˜¯åœ¨ç™»å½• (login) å‰ä½¿ç”¨ chrootï¼Œä»¥æ­¤è¾¾åˆ°ç”¨æˆ·ä¸èƒ½è®¿é—®ä¸€äº›ç‰¹å®šçš„æ–‡ä»¶ç³»ç»Ÿè¯»å–çš„æ˜¯æ–°æ ¹ä¸‹çš„ç›®å½•å’Œæ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸åŸç³»ç»Ÿæ ¹ä¸‹æ–‡ä»¶ä¸ç›¸å…³çš„ç›®å½•ç»“æ„ã€‚åœ¨è¿™ä¸ªæ–°çš„ç¯å¢ƒä¸­ï¼Œå¯ä»¥ç”¨æ¥æµ‹è¯•è½¯ä»¶çš„é™æ€ç¼–è¯‘ä»¥åŠä¸€äº›ä¸ç³»ç»Ÿä¸ç›¸å…³çš„ç‹¬ç«‹å¼€å‘ã€‚ æ„å»ºä¸´æ—¶ç³»ç»Ÿlfsç³»ç»Ÿæ„å»ºä¸­ï¼Œä¸ºäº†éš”ç¦»åŸç³»ç»Ÿçš„ç›®å½•ï¼Œä¼šç”¨åˆ°chroot ç”¨chrootæ„å»ºlinuxä¸´æ—¶ç¯å¢ƒ # å¤åˆ¶ä¾èµ–åº“cd /root/xxmkdir /root/xx/bincp -av /bin/bash /root/xx/bin/bashmkdir /root/xx/lib64/# å¤åˆ¶ä¾èµ–åº“æ–‡ä»¶cp -av /lib64/ld-linux-x86-64.so.2 /lib64/ld-2.12.so \\> /lib64/libc.so.6 /lib64/libc-2.12.so /lib64/libdl.so.2 \\> /lib64/libdl-2.12.so /lib64/libtinfo.so.5 \\> /lib64/libtinfo.so.5.7 /mnt/123/lib64 \\> /mnt/123/lib64â€¦â€¦chroot /root/xx https://www.ibm.com/developerworks/cn/linux/l-cn-chroot/index.htmlhttps://www.cnblogs.com/sparkdev/p/8556075.html","link":"/posts/fe4ef317/"},{"title":"blog_back_new/linux/net/è®°å½•","text":"hook é’©å­ ç”¨æˆ·ç©ºé—´ ä¸ å†…æ ¸ç©ºé—´ å†…æ ¸ç©ºé—´é‡Šæ”¾hookç»™ç”¨äºç©ºé—´è°ƒç”¨è°ƒç”¨è¿‡ç¨‹ä½¿ç”¨command lineæ‰§è¡Œ hookä¸åº“æœ‰å·®åˆ« filter æ­£å¸¸é˜²æ­¢nat è½¬å‘mangle æ‰“æ ‡è®° qosé™é€Ÿç­‰ç­‰ ç½‘æ¡¥","link":"/posts/67b35a0f/"},{"title":"linuxæ•…éšœé—®é¢˜åŠè§£å†³æ–¹æ¡ˆ","text":"linuxæ•…éšœé—®é¢˜åŠè§£å†³æ–¹æ¡ˆlinuxç³»ç»Ÿä½¿ç”¨è¿‡ç¨‹ä¸­ ä¼šé‡åˆ°å¾ˆå¤šçš„æ•…éšœå’ŒæŠ¥é”™ï¼Œä¸ä¹‹å¯¹åº”çš„æ˜¯ä¸€äº›å¿«é€Ÿçš„è§£å†³æ–¹æ¡ˆè¿™é‡Œè®°å½•ä¸€ä¸‹ å¿˜è®°rootå¯†ç ï¼Œæ— æ³•ç™»é™†æœåŠ¡å™¨ centos7 è§£å†³æ–¹æ¡ˆ é‡å¯æœåŠ¡å™¨ è¿›å…¥å¯åŠ¨ç•Œé¢åé€‰æ‹©eè¿›å…¥ç¼–è¾‘å¼•å¯¼ ä¿®æ”¹å†…å®¹,åœ¨å°¾éƒ¨æ·»åŠ rd.breaklinux16 /vmlinuz-3.10.0-123.el7.x86_64 root=UUID=449d53d1-84c2-40c0-b05e-d1900591d71b ro rd.lvm.lv=vg_kvm7usb/swap crashkernel=auto vconsole.keymap=us crashkernel=auto vconsole.font=latarcyrheb-sun16 rd.lvm.lv=vg_kvm7usb/root rhgb quiet LANG=en_US.UTF-8 rd.break ctrl+x ä»¥å½“å‰è®¾å®šå¼€æœºå¼€æœºåçš„äº’åŠ¨å¼å‘½ä»¤ç¯å¢ƒï¼Œä¸¦ä¸æ˜¯æ­£å¸¸å¼€æœºçš„ç³»çµ±ï¼Œæ­£å¸¸å¼€æœºç³»çµ±æŒ‚è½½åœ¨ /sysboo ä¸”æŒ‚è½½æˆåªè¯»ï¼Œå¿…é ˆé‡æ–°æŒ‚è½½æˆå¯å†™å…¥ï¼Œæ‰èƒ½ä¿®æ”¹å¯†ç¢¼ é‡æ–°æŒ‚åœ¨ /sysroot å¹¶æ”¹æˆå¯è¯»å¯å†™mount â€“o remount,rw /sysroot chroot å·¥ä½œç›®å½•åˆ°/sysrootchroot /sysroot è®¾å®šæ–°çš„root å¯†ç passwd rootupyun1upyun1 åœ¨æ­¤æƒ…æ³ä¸‹ï¼ŒSELinux ä¸¦æ²’æœ‰å¯åŠ¨ï¼Œå¯¹æ‰€æœ‰æ–‡ä»¶çš„æ›´æ”¹ï¼Œå¯èƒ½ä¼šé€ æˆæ–‡æ¡£çš„context ä¸æ­£ç¡®ï¼Œä¸ºç¡®ä¿å¼€æœºæ—¶é‡æ–°è®¾å®šSELinux contextï¼Œå¿…é ˆåœ¨æ ¹ç›®å½•ä¸‹æ·»åŠ éšè—æ–‡ä»¶.autorelabelã€‚ é¿å¼€selinuxtouch /.autorelabel é‡å¯reboot centos7 è§£å†³æ–¹æ¡ˆäºŒ é‡å¯æœåŠ¡å™¨ æŒ‰eç¼–è¾‘å¼•å¯¼ ä¿®æ”¹re ä¸º rw æ·»åŠ  init=/bin/bash linux16 /vmlinuz-3.10.0-123.el7.x86_64 root=UUID=449d53d1-84c2-40c0-b05e-d1900591d71b rw rd.lvm.lv=vg_kvm7usb/swap crashkernel=auto vconsole.keymap=us crashkernel=auto vconsole.font=latarcyrheb-sun16 rd.lvm.lv=vg_kvm7usb/root rhgb quiet LANG=en_US.UTF-8 init=/bin/bash ctrl+x ä»¥å½“å‰è®¾å®šå¼€æœº é‡ç½®å¯†ç passwd rootupyun1upyun1 é¿å¼€selinuxtouch /.autorelabel é‡å¯exec /sbin/init","link":"/posts/bc3af3e9/"},{"title":"linuxåˆå§‹åŒ–","text":"åˆå§‹åŒ–è„šæœ¬#!/bin/sh# ---> è„šæœ¬åˆå§‹åŒ–export LC_ALL=en_US.utf8 # å…¨å±€è®¾ç½®ä¸ºen_US.utf8,ä¸ºäº†é˜²æ­¢å‡ºç°ä¹±ç echo -e 'nameserver 192.168.147.20\\nnameserver 192.168.21.20\\nnameserver 114.114.114.114' > /etc/resolv.conf# å†™å…¥DNSåˆ°/etc/resolv.conf ä¿è¯èƒ½pingé€šå¤–ç½‘# ---> è®¾ç½®å˜é‡KERNEL=\"kernel-ml\"# è®¾ç½®KERNELå˜é‡ï¼Œä¸€å¼€å§‹ä¸ºæ—  ï¼Œreloadåä¸ºæ— HOST=\"DCK-ZJ-SAD-xxx\"# è®¾ç½®HOSTå˜é‡ZONE=\"Asia/Shanghai\"# è®¾ç½®æ—¶åŒºå˜é‡# ---> ç›´æ¥è®¾ç½®hostnamectl --static set-hostname $HOST# ä¿®æ”¹ä¸»æœºå ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹# echo \"DCK-ZJ-SAD-xxx\" > /etc/hostnametimedatectl set-timezone $ZONE# è®¾ç½®æœ¬åœ°æ—¶é—´timedatectl set-ntp 0# å…³é—­ntpåŒæ­¥timedatectl set-local-rtc 0# è®¾ç½®ç¡¬ä»¶æ—¶é’Ÿä¸ºUTC setenforce 0 # æš‚æ—¶å–æ¶ˆselinux é«˜å®‰å…¨æ¨¡å¼sed -r -i '/^SELINUX=/s^=.*^=disabled^g' /etc/selinux/config# æ°¸ä¹…å–æ¶ˆselinuxsed -r -i '/^[^root]/s:/bin/bash:/sbin/nologin:g' /etc/passwd# -r æ”¯æŒæ­£åˆ™# -i ç›´æ¥ä¿®æ”¹æ–‡ä»¶# åŒ¹é…æ‰€æœ‰ä¸æ˜¯rootå¼€å¤´çš„è¡Œ å°†åé¢çš„/bin/bash ä¿®æ”¹æˆ/sbin/nologin æ”¶å›æ‰€æœ‰é™¤rootç”¨æˆ·ä»¥å¤–çš„ç®¡ç†è€…ç™»é™†æƒé™# /^[^root]/ å–åï¼Œä¸æ˜¯rootçš„è¡Œsed -r -i '/#Port 22/s^.*^Port 65422^g;/^PasswordAuthentication/s^yes^no^g' /etc/ssh/sshd_config#[root@localhost ~]# sed -r -n '/#Port 22/s^.*^Port 65422^p;/^PasswordAuthentication/s^yes^no^p' /etc/ssh/sshd_config#Port 65422#PasswordAuthentication no# å°†ç™»é™†ç«¯å£22 æ”¹æˆ65422# å°†å¯†ç éªŒè¯ä»yesæ”¹æˆno# --------> ??????????????sed -r -i -e '/DefaultLimitCORE/s^.*^DefaultLimitCORE=infinity^g' -e '/DefaultLimitNOFILE/s^.*^DefaultLimitNOFILE=100000^g' -e '/DefaultLimitNPROC/s^.*^DefaultLimitNPROC=100000^g' /etc/systemd/system.conf #[root@localhost ~]# sed -r -n -e '/DefaultLimitCORE/s^.*^DefaultLimitCORE=infinity^p' -e '/DefaultLimitNOFILE/s^.*^DefaultLimitNOFILE=100000^p' -e '/DefaultLimitNPROC/s^.*^DefaultLimitNPROC=100000^p' /etc/systemd/system.conf#DefaultLimitCORE=infinity#DefaultLimitNOFILE=100000#DefaultLimitNPROC=100000# -e å¤šç‚¹ç¼–è¾‘# å¥½åƒä¹Ÿå¯ä»¥å†™æˆ # sed -r -i 'xxxx:g;xxx:g;xx:gâ€˜# /etc/systemd/system.conf æœ‰å•¥ç”¨# ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾ç½®# é€‚å½“æ”¾å¤§ç³»ç»Ÿé‡Œçš„èµ„æºé™åˆ¶é…é¢# è¿˜æ˜¯ä¸æ‡‚ï¼Ÿsed -r -i 's@weekly@daily@g;s@^rotate.*@rotate 7@g;s@^#compress.*@compress@g' /etc/logrotate.conf#root@localhost ~]# sed -r -n 's@weekly@daily@p;s@^rotate.*@rotate 7@p;s@^#compress.*@compress@p ' /etc/logrotate.conf# rotate log files daily#daily#rotate 7#compress#å°†logrotateæ—¥å¿—ç³»ç»Ÿè®¾ç½®ä¸º æ¯å¤©æ‰§è¡Œ ä¿ç•™7å¤©æ—¥å¿— æ—¥å¿—è¿›è¡Œå‹ç¼© ç­‰åŠŸèƒ½å¼€å¯# ----------------> ??????????????????sed -r -i -e '/Compress=/s@.*@Compress=yes@g; /SystemMaxUse=/s@.*@SystemMaxUse=4G@g; ' -e '/SystemMaxFileSize=/s@.*@SystemMaxFileSize=256M@g; /MaxRetentionSec=/s@.*@MaxRetentionSec=2week@g' /etc/systemd/journald.conf#[root@localhost ~]# sed -r -n -e '/Compress=/s@.*@Compress=yes@p; /SystemMaxUse=/s@.*@SystemMaxUse=4G@p; ' -e '/SystemMaxFileSize=/s@.*@SystemMaxFileSize=256M@p; /MaxRetentionSec=/s@.*@MaxRetentionSec=2week@p' /etc/systemd/journald.conf#Compress=yes#SystemMaxUse=4G#SystemMaxFileSize=256M#MaxRetentionSec=2week# /etc/systemd/journald.conf æœ‰å•¥ç”¨localectl set-locale LANG=en_US.utf8# å£°æ˜è¯­è¨€ç¯å¢ƒï¼Œzh_CN.utf8 ä¸­æ–‡è¯·æ¬¾ä¸‹å¯èƒ½ä¼šå‡ºç°å„ç§ä¹±ç cat > /etc/locale.conf LANGexport LC_ALL=zh_CN.utf8 # é‡ç½®export LC_ALL=C linuxæ—¶é’Ÿè®¾ç½® timedatectltimedatectlå‘½ä»¤å¯ä»¥æŸ¥è¯¢å’Œæ›´æ”¹ç³»ç»Ÿæ—¶é’Ÿå’Œè®¾ç½®ï¼Œä½ å¯ä»¥ä½¿ç”¨æ­¤å‘½ä»¤æ¥è®¾ç½®æˆ–æ›´æ”¹å½“å‰çš„æ—¥æœŸï¼Œæ—¶é—´å’Œæ—¶åŒºï¼Œæˆ–å®ç°ä¸è¿œç¨‹NTPæœåŠ¡å™¨çš„è‡ªåŠ¨ç³»ç»Ÿæ—¶é’ŸåŒæ­¥ã€‚ # æŸ¥çœ‹ç³»ç»Ÿå½“å‰æ—¶é—´å’Œæ—¥æœŸroot:~# timedatectl status Local time: Wed 2020-01-15 19:42:13 CST Universal time: Wed 2020-01-15 11:42:13 UTC RTC time: Wed 2020-01-15 11:41:51 Time zone: Asia/Shanghai (CST, +0800) NTP enabled: n/aNTP synchronized: no RTC in local TZ: no DST active: n/a# æŸ¥çœ‹Timeroot:~# timedatectl | grep Time --color Time zone: Asia/Shanghai (CST, +0800)# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æ—¶åŒºtimedatectl list-timezones# è®¾ç½®æ—¶åŒºtimedatectl set-timezone \"Asia/Shanghai\"# åè°ƒä¸–ç•Œæ—¶timedatectl set-timezone UTC# è®¾ç½®æ—¶é—´timedatectl set-time 15:38:30# è®¾ç½®ç¡¬ä»¶æ—¶é’Ÿä¸ºæœ¬åœ°æ—¶é—´timedatectl set-local-rtc 1# è®¾ç½®ç¡¬ä»¶æ—¶é’Ÿä¸ºä¸–ç•Œæ—¶(UTC)timedatectl set-local-rtc 0# æŸ¥çœ‹ç¡¬ä»¶æ—¶é’Ÿtimedatectl | grep local --color å°†Linuxæ—¶é’ŸåŒæ­¥åˆ°è¿œç¨‹NTPæœåŠ¡å™¨NTPå³Network Time Protocolï¼ˆç½‘ç»œæ—¶é—´åè®®) # è‡ªå·±å½“NTPæœåŠ¡å™¨timedatectl set-ntp true# ç¦ç”¨timedatectl set-ntp false linux ç½‘ç»œæ—¶é—´åè®®(Network Time Protocol) NTPNTPæœåŠ¡å™¨ç”¨æ¥åŒæ­¥æ—¶é—´ ï¼Œæ­å»ºä¸€å°æœ¬åœ°çš„NTPæœåŠ¡å™¨ # å®‰è£…yum install -y ntp# å¯åŠ¨ntpæœåŠ¡systemctl start ntpd# è®¾ç½®å¼€æœºå¯åŠ¨systemctl enable ntpd# æŸ¥çœ‹åŒæ­¥æƒ…å†µ/usr/sbin/ntpq -p ntpé…ç½®# æŸ¥çœ‹å®‰è£…ntpå·¥å…·ä¼šäº§ç”Ÿå“ªäº›æ–‡ä»¶ root:~# rpm -ql ntp/etc/dhcp/dhclient.d /etc/dhcp/dhclient.d/ntp.sh/etc/ntp.conf # ntpé…ç½®æ–‡ä»¶/etc/ntp/crypto...# é…ç½®æ–‡ä»¶å†…å®¹driftfile /var/lib/ntp/drift #ç³»ç»Ÿæ—¶é—´ä¸BIOSæ—¶é—´çš„åå·®è®°å½•restrict default nomodify notrap nopeer noquery # æ§åˆ¶ç›¸å…³æƒé™# default æŒ‡å¸¦æ‰€æœ‰ip# ignore ï¼šå…³é—­æ‰€æœ‰çš„ NTP è”æœºæœåŠ¡# nomodifyï¼šå®¢æˆ·ç«¯ä¸èƒ½æ›´æ”¹æœåŠ¡ç«¯çš„æ—¶é—´å‚æ•°ï¼Œä½†æ˜¯å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡æœåŠ¡ç«¯è¿›è¡Œç½‘ç»œæ ¡æ—¶ã€‚# notrust ï¼šå®¢æˆ·ç«¯é™¤éé€šè¿‡è®¤è¯ï¼Œå¦åˆ™è¯¥å®¢æˆ·ç«¯æ¥æºå°†è¢«è§†ä¸ºä¸ä¿¡ä»»å­ç½‘# noquery ï¼šä¸æä¾›å®¢æˆ·ç«¯çš„æ—¶é—´æŸ¥è¯¢ï¼šç”¨æˆ·ç«¯ä¸èƒ½ä½¿ç”¨ntpqï¼Œntpcç­‰å‘½ä»¤æ¥æŸ¥è¯¢ntpæœåŠ¡å™¨# notrap ï¼šä¸æä¾›trapè¿œç«¯ç™»é™†ï¼šæ‹’ç»ä¸ºåŒ¹é…çš„ä¸»æœºæä¾›æ¨¡å¼ 6 æ§åˆ¶æ¶ˆæ¯é™·é˜±æœåŠ¡ã€‚é™·é˜±æœåŠ¡æ˜¯ ntpdq æ§åˆ¶æ¶ˆæ¯åè®®çš„å­ç³»ç»Ÿï¼Œç”¨äºè¿œç¨‹äº‹ä»¶æ—¥å¿—è®°å½•ç¨‹åºã€‚# nopeer ï¼šç”¨äºé˜»æ­¢ä¸»æœºå°è¯•ä¸æœåŠ¡å™¨å¯¹ç­‰ï¼Œå¹¶å…è®¸æ¬ºè¯ˆæ€§æœåŠ¡å™¨æ§åˆ¶æ—¶é’Ÿ# kod ï¼š è®¿é—®è¿è§„æ—¶å‘é€ KoD åŒ…ã€‚# restrict -6 è¡¨ç¤ºIPV6åœ°å€çš„æƒé™è®¾ç½®restrict 127.0.0.1restrict ::1 # ç¡®ä¿localhostï¼ˆè¿™ä¸ªå¸¸ç”¨çš„IPåœ°å€ç”¨æ¥æŒ‡LinuxæœåŠ¡å™¨æœ¬èº«ï¼‰æœ‰è¶³å¤Ÿæƒé™server 192.168.20.1 perfer # è®¾å®šä¸»æœºæ¥æºï¼Œperferå®šä¹‰æœ€ä¼˜å…ˆrestrict 192.168.20.1 nomodify notrap noquery # å…è®¸ä¸Šæœ‰ æ—¶é—´æœåŠ¡å™¨ä¸»åŠ¨ä¿®æ”¹æœ¬æœº#server 0.centos.pool.ntp.org iburst #erver 1.centos.pool.ntp.org iburst#server 2.centos.pool.ntp.org iburst#server 3.centos.pool.ntp.org iburstincludefile /etc/ntp/crypto/pwkeys /etc/ntp/keysdisable monitor# NTPæœåŠ¡éœ€è¦ä½¿ç”¨åˆ°UDPç«¯å£å·123# åˆæ¬¡åŒæ­¥ntpdate -u 192.168.20.1 linuxç§‘å­¦è®¡ç®—å™¨ bcç§‘å­¦è®¡ç®—å™¨ # å®‰è£…yum install bc -y# \bè¿è¡Œè®¡ç®—æœºbc -q # å€ŸåŠ©ç®¡é“echo \"1+2\" | bcret=$(echo \"4+9\" | bc) && echo $ret linuxç½‘ç»œå·¥å…· NetCat# å®‰è£…yum install nc -y# ä½¿ç”¨-l Port # ä½¿ç”¨ç›‘å¬ç«¯å£ï¼Œç­‰å¾…ç«¯å£æ´»åŠ¨-o # æŒ‡å®šæ–‡ä»¶åç§°ï¼ŒæŠŠå¾€æ¥ä¼ è¾“çš„æ•°æ®ä»¥16è¿›åˆ¶å­—ç å€¾å€’æˆè¯¥æ–‡ä»¶ä¿å­˜-p # è®¾ç½®æœ¬åœ°ä¸»æœºä½¿ç”¨çš„é€šä¿¡ç«¯å£ã€‚-r # æŒ‡å®šæœ¬åœ°ä¸è¿œç«¯ä¸»æœºçš„é€šä¿¡ç«¯å£ã€‚-s #è®¾ç½®æœ¬åœ°ä¸»æœºé€å‡ºæ•°æ®åŒ…çš„IPåœ°å€-u #ä½¿ç”¨UDPä¼ è¾“åè®®-v #æ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹-w # è®¾ç½®ç­‰å¾…è¿çº¿çš„æ—¶é—´-z # ä½¿ç”¨0è¾“å…¥/è¾“å‡ºæ¨¡å¼ï¼Œåªåœ¨æ‰«æé€šä¿¡ç«¯å£æ—¶ä½¿ç”¨ ä½¿ç”¨ä¼ æ–‡ä»¶,æ³¨æ„å…³é—­é˜²ç«å¢™æˆ–è€…å…³é—­ç«¯å£ # å‘é€ç«¯ 10.0.5.197nc 10.0.5.233 8888 < xx.py# æ¥æ”¶ç«¯ 10.0.5.233nc -l 8888 > yy.py ç«¯å£æ‰«æ nc -v -w 1 10.0.5.233 -z 20-30 èŠå¤© # ä¸»æœºç«¯nc 10.0.5.233 8888# æ¥æ”¶ç«¯nc -l 8888 /etc/logrotate æ»šåŠ¨æ—¥å¿—Linuxç³»ç»Ÿé»˜è®¤å®‰è£…logrotateå·¥å…·ï¼Œå®ƒé»˜è®¤çš„é…ç½®æ–‡ä»¶åœ¨ï¼š/etc/logrotate.conf/etc/logrotate.d/logrotate.conf æ˜¯ä¸»è¦çš„é…ç½®æ–‡ä»¶ï¼Œlogrotate.d æ˜¯ä¸€ä¸ªç›®å½•ï¼Œè¯¥ç›®å½•é‡Œçš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«ä¸»åŠ¨çš„è¯»å…¥/etc/logrotate.confä¸­æ‰§è¡Œã€‚ æŸ¥çœ‹å®‰è£…ä¼šäº§ç”Ÿå“ªäº›æ–‡ä»¶[root@DCK-ZJ-SAD-035 logrotate.d]# rpm -ql logrotate/etc/cron.daily/logrotate/etc/logrotate.conf # main/etc/logrotate.d # main/etc/rwtab.d/logrotate/usr/sbin/logrotate/usr/share/doc/logrotate-3.8.6/usr/share/doc/logrotate-3.8.6/CHANGES/usr/share/doc/logrotate-3.8.6/COPYING/usr/share/man/man5/logrotate.conf.5.gz/usr/share/man/man8/logrotate.8.gz/var/lib/logrotate/var/lib/logrotate/logrotate.status å®šæ—¶è½®å¾ªæœºåˆ¶Logrotateæ˜¯åŸºäºCRONæ¥è¿è¡Œçš„ï¼Œå…¶è„šæœ¬æ˜¯/etc/cron.daily/logrotateï¼Œæ—¥å¿—è½®è½¬æ˜¯ç³»ç»Ÿè‡ªåŠ¨å®Œæˆçš„ã€‚ logrotateè¿™ä¸ªä»»åŠ¡é»˜è®¤æ”¾åœ¨cronçš„æ¯æ—¥å®šæ—¶ä»»åŠ¡cron.dailyä¸‹é¢ /etc/cron.daily/logrotate/etc/ç›®å½•ä¸‹é¢è¿˜æœ‰cron.weekly/, cron.hourly/, cron.monthly/ çš„ç›®å½•éƒ½æ˜¯å¯ä»¥æ”¾å®šæ—¶ä»»åŠ¡çš„ æ—¥å¿—è½®è¯¢å‘¨æœŸæ ¹æ®æ—¶é—´åˆ†é…æœ‰4ç§dailyã€weekly ã€monthlyã€yearlyé»˜è®¤daily cat /etc/cron.daily/logrotate #!/bin/sh/usr/sbin/logrotate -s /var/lib/logrotate/logrotate.status /etc/logrotate.confEXITVALUE=$?if [ $EXITVALUE != 0 ]; then /usr/bin/logger -t logrotate \"ALERT exited abnormally with [$EXITVALUE]\"fiexit 0 logrotateé…ç½®å…¨å±€é…ç½® /etc/logrotate.confå¯¹åº”ä¸åŒç¨‹åºçš„é…ç½® /etc/logrotate.d/ å…¨å±€é…ç½® # è½®è¯¢æ—¶é—´,å¯ä»¥æ˜¯weekly,monthly,yearlydaily# æ—¥å¿—å¤‡ä»½ä¿å­˜æ—¶é—´ 7å¤©,è¶…è¿‡åˆ™åˆ é™¤rotate 7create # åˆ›å»ºæ–‡ä»¶dateext # æ—¥å¿—æ–‡ä»¶åˆ‡å‰²åæ·»åŠ æ—¥æœŸåç¼€compress # åˆ‡å‰²åå‹ç¼©include /etc/logrotate.d # æŒ‡å‘æ–‡ä»¶å¤¹/var/log/wtmp { monthly create 0664 root utmp minsize 1M rotate 1}/var/log/btmp { missingok monthly create 0600 root utmp rotate 1} éƒ¨åˆ†åº”ç”¨ç¨‹åºé…ç½®ï¼Œä»¥nginxä¸ºä¾‹å­ # é¦–å…ˆéœ€è¦æŒ‡å®šå­˜æ”¾nginxæ—¥å¿—æ–‡ä»¶çš„åœ°å€/usr/local/nginx/logs/access.log {dailyrotate 7missingok # åœ¨æ—¥å¿—è½®å¾ªæœŸé—´ï¼Œä»»ä½•é”™è¯¯å°†è¢«å¿½ç•¥ï¼Œä¾‹å¦‚â€œæ–‡ä»¶æ— æ³•æ‰¾åˆ°â€ä¹‹ç±»çš„é”™dateextcompress# npcompress # å¦‚æœä½ ä¸å¸Œæœ›å¯¹æ—¥å¿—æ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼Œè®¾ç½®è¿™ä¸ªå‚æ•°å³å¯delaycompress # æ€»æ˜¯ä¸compressé€‰é¡¹ä¸€èµ·ç”¨ï¼Œdelaycompressé€‰é¡¹æŒ‡ç¤ºlogrotateä¸è¦å°†æœ€è¿‘çš„å½’æ¡£å‹ç¼©ï¼Œå‹ç¼©å°†åœ¨ä¸‹ä¸€æ¬¡è½®å¾ªå‘¨æœŸè¿›è¡Œnotifempty # å¦‚æœæ—¥å¿—ä¸ºç©ºï¼Œè½®è¯¢ä¸è¿›è¡Œsharedscripts #è¡¨ç¤ºpostrotateè„šæœ¬åœ¨å‹ç¼©äº†æ—¥å¿—ä¹‹ååªæ‰§è¡Œä¸€æ¬¡postrotate [ -e /usr/local/nginx/logs/nginx.pid ] && kill -USR1 `cat /usr/local/nginx/logs/nginx.pid`endscript}# create 644 www root # ä»¥æŒ‡å®šçš„æƒé™åˆ›å»ºå…¨æ–°çš„æ—¥å¿—æ–‡ä»¶ï¼ŒåŒæ—¶logrotateä¹Ÿä¼šé‡å‘½ååŸå§‹æ—¥å¿—æ–‡ä»¶ã€‚# æ‰§è¡Œç¨‹åºlogrotate /etc/logrotate.d/nginx æ‰‹åŠ¨ä½¿ç”¨# å¦‚æœç­‰ä¸åŠcronè‡ªåŠ¨æ‰§è¡Œæ—¥å¿—è½®è½¬ï¼Œæƒ³æ‰‹åŠ¨å¼ºåˆ¶åˆ‡å‰²æ—¥å¿—ï¼Œéœ€è¦åŠ -få‚æ•°/usr/sbin/logrotate -f /etc/logrotate.d/nginx# æ­£å¼æ‰§è¡Œå‰æœ€å¥½é€šè¿‡Debugé€‰é¡¹æ¥éªŒè¯ä¸€ä¸‹ï¼ˆ-då‚æ•°ï¼‰/usr/sbin/logrotate -d -f /etc/logrotate.d/nginx logrotateå‘½ä»¤æ ¼å¼logrotate [OPTION...] -d, --debug ï¼šdebugæ¨¡å¼ï¼Œæµ‹è¯•é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰é”™è¯¯ï¼Œä¸çœŸå®æ‰§è¡Œã€‚-f, --force ï¼šå¼ºåˆ¶è½¬å‚¨æ–‡ä»¶ã€‚-m, --mail=command ï¼šå‹ç¼©æ—¥å¿—åï¼Œå‘é€æ—¥å¿—åˆ°æŒ‡å®šé‚®ç®±ã€‚-s, --state=statefile ï¼šä½¿ç”¨æŒ‡å®šçš„çŠ¶æ€æ–‡ä»¶ã€‚-v, --verbose ï¼šæ˜¾ç¤ºè½¬å‚¨è¿‡ç¨‹ã€‚ é»˜è®¤å°†æ—¥å¿—ä¿å­˜åœ¨/var/lib/logrotate.statusæ–‡ä»¶ä¸­ logrotateåŸç† create copytruncate åœ°å€logrotateå…·ä½“https://wsgzao.github.io/post/logrotate/localeå…·ä½“https://www.cnblogs.com/wn1m/p/10837609.html","link":"/posts/1d7a61af/"},{"title":"linux-mtrå‘½ä»¤","text":"MTRæ˜¯Linuxå¹³å°ä¸Šä¸€æ¬¾éå¸¸å¥½ç”¨çš„ç½‘ç»œè¯Šæ–­å·¥å…·ï¼Œé›†æˆäº†tracerouteã€pingã€nslookupçš„åŠŸèƒ½ï¼Œç”¨äºè¯Šæ–­ç½‘ç»œçŠ¶æ€éå¸¸æœ‰ç”¨ã€‚ä¸‹é¢è¯·çœ‹ç®€å•ä»‹ç»ã€‚ä¸€æ—¦ä½ è¿è¡Œmtr ï¼Œå®ƒå°†æ¢æµ‹æœ¬åœ°ç³»ç»Ÿå’Œä½ æŒ‡å®šçš„è¿œç¨‹ä¸»æœºä¹‹é—´çš„ç½‘ç»œè¿æ¥ã€‚ å®ƒé¦–å…ˆå»ºç«‹ä¸»æœºä¹‹é—´çš„æ¯ä¸ªç½‘ç»œè·³è·ƒç‚¹ï¼ˆç½‘æ¡¥ï¼Œè·¯ç”±å™¨å’Œç½‘å…³ç­‰ï¼‰çš„åœ°å€ï¼Œç„¶åpingæ¯ä¸ªè·³è·ƒç‚¹ï¼ˆå‘é€ä¸€ä¸ªåºåˆ—ICMP ECHOè¯·æ±‚ï¼‰ä»¥ç¡®å®šåˆ°æ¯å°æœºå™¨çš„é“¾è·¯çš„è´¨é‡ã€‚ å®‰è£…yum install mtr -y ä½¿ç”¨æ–¹æ³•mtr ipæˆ–åŸŸå My traceroute [v0.85]PG-VPN (0.0.0.0) Wed Oct 9 18:22:54 2019Resolver: Received error response 2. (server failure)er of fields quit Packets Pings Host Loss% Snt Last Avg Best Wrst StDev 1. 115.231.97.1 0.0% 20 0.8 1.0 0.8 1.3 0.0 2. 10.100.129.24 0.0% 20 0.9 0.9 0.9 1.0 0.0 3. 10.100.128.65 0.0% 20 0.9 1.0 0.9 1.1 0.0 4. 10.100.129.27 0.0% 20 1.3 1.1 1.0 1.3 0.0 5. 124.14.9.238 0.0% 20 4.0 4.1 3.8 4.3 0.0 ç¬¬ä¸€åˆ—(Host) : IPåœ°å€å’ŒåŸŸå æŒ‰né”®å¯ä»¥åˆ‡æ¢IPå’ŒåŸŸåç¬¬äºŒåˆ—(Loss%): ä¸¢åŒ…ç‡ç¬¬ä¸‰åˆ—(Snt): è®¾ç½®æ¯ç§’å‘é€æ•°æ®åŒ…çš„æ•°é‡ï¼Œé»˜è®¤æ˜¯10 å¯ä»¥é€šè¿‡å‚æ•°-cæ¥æŒ‡å®šç¬¬å››åˆ—(Last)ï¼š æœ€è¿‘ä¸€æ¬¡çš„Pingå€¼ç¬¬äº”å…­ä¸ƒåˆ—(AVG BEST WRST) : åˆ†åˆ«ï¼Œæ˜¯Pingçš„å¹³å‡ æœ€å¥½ æœ€å·®å€¼ç¬¬å…«åˆ—(StDev): æ ‡å‡†åå·®ï¼Œè¶Šå¤§è¯´æ˜ç›¸åº”èŠ‚ç‚¹è¶Šä¸ç¨³å®šã€‚ åˆ¤åˆ« åˆ¤æ–­å„åŒºåŸŸæ˜¯å¦å­˜åœ¨å¼‚å¸¸ï¼Œå¹¶æ ¹æ®å„åŒºåŸŸçš„æƒ…å†µåˆ†åˆ«å¤„ç†ã€‚ åŒºåŸŸ Aï¼šå®¢æˆ·ç«¯æœ¬åœ°ç½‘ç»œï¼Œå³æœ¬åœ°å±€åŸŸç½‘å’Œæœ¬åœ°ç½‘ç»œæä¾›å•†ç½‘ç»œã€‚é’ˆå¯¹è¯¥åŒºåŸŸå¼‚å¸¸ï¼Œå®¢æˆ·ç«¯æœ¬åœ°ç½‘ç»œç›¸å…³èŠ‚ç‚¹é—®é¢˜ï¼Œè¯·å¯¹æœ¬åœ°ç½‘ç»œè¿›è¡Œæ’æŸ¥åˆ†æï¼›æœ¬åœ°ç½‘ç»œæä¾›å•†ç½‘ç»œç›¸å…³èŠ‚ç‚¹é—®é¢˜ï¼Œè¯·å‘å½“åœ°è¿è¥å•†åé¦ˆã€‚ åŒºåŸŸ Bï¼šè¿è¥å•†éª¨å¹²ç½‘ç»œã€‚é’ˆå¯¹è¯¥åŒºåŸŸå¼‚å¸¸ï¼Œå¯æ ¹æ®å¼‚å¸¸èŠ‚ç‚¹ IP æŸ¥è¯¢å½’å±è¿è¥å•†ï¼Œç„¶åç›´æ¥æˆ–é€šè¿‡é˜¿é‡Œäº‘å”®åæŠ€æœ¯æ”¯æŒï¼Œå‘ç›¸åº”è¿è¥å•†åé¦ˆé—®é¢˜ã€‚ åŒºåŸŸ Cï¼šç›®æ ‡æœåŠ¡å™¨æœ¬åœ°ç½‘ç»œï¼Œå³ç›®æ ‡ä¸»æœºå½’å±ç½‘ç»œæä¾›å•†ç½‘ç»œã€‚é’ˆå¯¹è¯¥åŒºåŸŸå¼‚å¸¸ï¼Œéœ€è¦å‘ç›®æ ‡ä¸»æœºå½’å±ç½‘ç»œæä¾›å•†åé¦ˆé—®é¢˜ã€‚ æŸ¥çœ‹èŠ‚ç‚¹ä¸¢åŒ…ç‡ï¼Œè‹¥ Loss% ä¸ä¸ºé›¶ï¼Œåˆ™è¯´æ˜è¿™ä¸€è·³ç½‘ç»œå¯èƒ½å­˜åœ¨é—®é¢˜ã€‚ å¯¼è‡´èŠ‚ç‚¹ä¸¢åŒ…çš„åŸå› é€šå¸¸æœ‰ä¸¤ç§ï¼š äººä¸ºé™åˆ¶äº†èŠ‚ç‚¹çš„ ICMP å‘é€é€Ÿç‡ï¼Œå¯¼è‡´ä¸¢åŒ…ã€‚ èŠ‚ç‚¹ç¡®å®å­˜åœ¨å¼‚å¸¸ï¼Œå¯¼è‡´ä¸¢åŒ… å‘½ä»¤-h #æä¾›å¸®åŠ©å‘½ä»¤-v #æ˜¾ç¤ºmtrçš„ç‰ˆæœ¬ä¿¡æ¯-r #å·²æŠ¥å‘Šæ¨¡å¼æ˜¾ç¤º-s #ç”¨æ¥æŒ‡å®špingæ•°æ®åŒ…çš„å¤§å°-i #ä½¿ç”¨è¿™ä¸ªå‚æ•°æ¥è®¾ç½®ICMPè¿”å›ä¹‹é—´çš„è¦æ±‚é»˜è®¤æ˜¯1ç§’-4 #é»˜è®¤IPv4-6 # æŒ‡å®šIPv6-c --report-cycles COUNT # æŒ‡å®šå‘é€å¤šå°‘ä¸ªæ•°æ®åŒ…-r --report # ç»“æœæ˜¾ç¤ºï¼Œå¹¶ä¸åŠ¨æ€æ˜¾ç¤º-n --no-dns #ä¸å¯¹IPåœ°å€åšåŸŸåè§£æ-p --split # å°†æ¯æ¬¡è¿½è¸ªçš„ç»“æœåˆ†åˆ«åˆ—å‡ºæ¥ï¼Œè€Œéå¦‚ --report ç»Ÿè®¡æ•´ä¸ªç»“æœ-a #æ¥è®¾ç½®å‘é€æ•°æ®åŒ…çš„IPåœ°å€ è¿™ä¸ªå¯¹ä¸€ä¸ªä¸»æœºç”±å¤šä¸ªIPåœ°å€æ˜¯æœ‰ç”¨çš„ ä½¿ç”¨mtr -r -c5 google.com > xx.log","link":"/posts/877ac6e6/"},{"title":"linuxæ–‡ä»¶ç³»ç»Ÿ2","text":"linuxæ–‡ä»¶ç³»ç»Ÿ2linuxä¸­æœ‰è®¸å¤šå¸¸ç”¨çš„æ–‡ä»¶ï¼Œå„è‡ªæœ‰å„è‡ªä¸»è¦çš„ä½œç”¨ ï¼Œæ€•å¿˜è®°ï¼Œè¿™é‡Œåšäº›ç¬”è®° /etc/hostsæ–‡ä»¶hosts â€”â€” the static table lookup for host nameï¼ˆä¸»æœºåæŸ¥è¯¢é™æ€è¡¨ï¼‰ã€‚hostsæ–‡ä»¶æ˜¯Linuxç³»ç»Ÿä¸Šä¸€ä¸ªè´Ÿè´£ipåœ°å€ä¸åŸŸåå¿«é€Ÿè§£æçš„æ–‡ä»¶ï¼Œä»¥asciiæ ¼å¼ä¿å­˜åœ¨/etc/ç›®å½•ä¸‹ã€‚hostsæ–‡ä»¶åŒ…å«äº†ipåœ°å€ä¸ä¸»æœºåä¹‹é—´çš„æ˜ å°„ï¼Œè¿˜åŒ…æ‹¬ä¸»æœºçš„åˆ«åã€‚åœ¨æ²¡æœ‰åŸŸåè§£ææœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç½‘ç»œç¨‹åºéƒ½é€šè¿‡æŸ¥è¯¢è¯¥æ–‡ä»¶æ¥è§£æå¯¹åº”äºæŸä¸ªä¸»æœºåçš„ipåœ°å€ï¼Œå¦åˆ™å°±éœ€è¦ä½¿ç”¨dnsæœåŠ¡ç¨‹åºæ¥è§£å†³ã€‚é€šè¿‡å¯ä»¥å°†å¸¸ç”¨çš„åŸŸåå’Œipåœ°å€æ˜ å°„åŠ å…¥åˆ°hostsæ–‡ä»¶ä¸­ï¼Œå®ç°å¿«é€Ÿæ–¹ä¾¿çš„è®¿é—®ã€‚ä¼˜å…ˆçº§ ï¼š dnsç¼“å­˜ > hosts > dnsæœåŠ¡ â€”> é…ç½® 127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4::1 localhost localhost.localdomain localhost6 localhost6.localdomain610.0.5.91 lvs-master10.0.5.93 lvs-slave10.0.5.92 lvs-web1#10.0.5.90 lvs-web210.0.5.90 www.baidu.com# ipåœ°å€ ä¸»æœºå/åŸŸå ä¸»æœºåˆ«å ç›¸å½“äºæœ¬åœ°çš„åŸŸåè§£æï¼Œå½“ä½ ping www.baidu.comçš„æ—¶å€™ï¼Œä¼šé»˜è®¤å»ping 10.0.5.90","link":"/posts/cd527bc1/"},{"title":"linuxå¸¸ç”¨å‘½ä»¤æ•´ç†","text":"learn linux linuxå¸¸ç”¨å‘½ä»¤æ•´ç†æŸ¥çœ‹linuxç‰ˆæœ¬ä¿¡æ¯1.ä½¿ç”¨lsb_release æŸ¥çœ‹ lsb_release -a# å‡ºç°é”™è¯¯ bash: lsb_release: command not found...# å®‰è£…lsb_releaseyum install -y readhat-lsblsb_release -a 2.uname é€‚åˆæ‰€æœ‰çš„linuxå‘è¡Œç‰ˆæœ¬ [root@CodeSheep ~]# unameLinux[root@CodeSheep ~]# uname -r3.10.0-957.5.1.el7.x86_64[root@CodeSheep ~]# uname -aLinux CodeSheep 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux[root@CodeSheep ~]# 3.ä½¿ç”¨redhat-release [root@CodeSheep ~]# cat /etc/redhat-release CentOS Linux release 7.6.1810 (Core) 4.æŸ¥çœ‹Cetnosç‰ˆæœ¬äºredhatå¯¹åº”ç‰ˆæœ¬çš„å‘½ä»¤ [root@CodeSheep ~]# cat /proc/version Linux version 3.10.0-957.5.1.el7.x86_64 (mockbuild@kbuilder.bsys.centos.org) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-36) (GCC) ) #1 SMP Fri Feb 1 14:54:57 UTC 2019 netstatå‘½ä»¤å¯ä»¥å¸®åŠ©æŸ¥æ‰¾æœ¬æœºçš„ç½‘ç»œçŠ¶æ€netstat -pt #å¯ä»¥è¾“å‡ºPIDä»¥åŠç¨‹åºå è¾“å‡ºç»“æœ Active Internet connections (w/o servers)Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program nametcp 0 0 localhostname:16061 192.168.1.1:50060 ESTABLISHED 22000/java æ˜¯æœ¬æœºçš„16061ç«¯å£åœ¨è°ƒ192.168.1.1:50060ä¸Šçš„æœåŠ¡ï¼Œä¸”æœ¬æœº16061ç«¯å£ä¸Šè·‘çš„æ˜¯ä¸€ä¸ªjavaç¨‹åºï¼Œè¿›ç¨‹IDæ˜¯22000 netstat -ant netstat -input lsofå¯ä»¥æŸ¥çœ‹ç³»ç»Ÿæ‰“å¼€çš„æ–‡ä»¶ï¼Œè¿™é‡Œçš„â€œæ–‡ä»¶â€åŒ…æ‹¬/procæ–‡ä»¶ã€ç£ç›˜æ–‡ä»¶ã€ç½‘ç»œIOç­‰lsof /etc/passwd # æŸ¥çœ‹å“ªä¸ªè¿›ç¨‹åœ¨å ç”¨/etc/passwdlsof -c mysql # åˆ—å‡ºæŸä¸ªç¨‹åºæ‰“å¼€çš„æ–‡ä»¶ä¿¡æ¯lsof -u username # åˆ—å‡ºæŸä¸ªç”¨æˆ·æ‰“å¼€çš„æ–‡ä»¶lsof -u ^root # æ’é™¤æŸä¸ªç”¨æˆ·å¤–çš„è¢«æ‰“å¼€çš„æ–‡ä»¶ä¿¡æ¯lsof -p 1 # åˆ—å‡ºæŸä¸ªè¿›ç¨‹å·æ‰“å¼€çš„æ–‡ä»¶lsof -i # åˆ—å‡ºæ‰€æœ‰çš„ç½‘ç»œè¿æ¥lsof -i :22 # åˆ—å‡ºè°åœ¨ä½¿ç”¨22ç«¯å£lsof | grep usbserial #æŸ¥çœ‹usbç«¯å£ä½¿ç”¨æƒ…å†µ pså‘½ä»¤æŸ¥æ‰¾ä¸è¿›ç¨‹ç›¸å…³çš„PIDå·ps a # æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ä»¥åŠç›¸å…³çš„pidps -A # ç°å®æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ps -u root #æ˜¾ç¤ºrootè¿›ç¨‹ç”¨æˆ·ä¿¡æ¯ps -ef # æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ï¼Œè¿å¸¦å‘½ä»¤è¡Œps -aux # æ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶ä»–ä½¿ç”¨è€…çš„è¡Œç¨‹ps c # åˆ—å‡ºç¨‹åºæ˜¾ç¤ºæ¯ä¸ªç¨‹åºçœŸæ­£çš„æŒ‡ä»¤åç§°ï¼Œè€Œä¸åŒ…å«è·¯å¾„ï¼Œå‚æ•°æˆ–å¸¸é©»æœåŠ¡çš„æ ‡ç¤ºps -e # æ˜¾ç¤ºæ¯ä¸€ä¸ªç¨‹åºçš„ç¯å¢ƒå˜é‡ps -ef | grep java | grep -v grep # æ˜¾ç¤ºæ‰€æœ‰aè¿›ç¨‹,å»æ‰å½“å‰çš„grepè¿›ç¨‹kill -9 pid # æ€æ­»è¿›ç¨‹ æŸ¥çœ‹linuxç‰ˆæœ¬ä¿¡æ¯1.ä½¿ç”¨lsb_release æŸ¥çœ‹ lsb_release -a# å‡ºç°é”™è¯¯ bash: lsb_release: command not found...# å®‰è£…lsb_releaseyum install -y readhat-lsblsb_release -a 2.uname é€‚åˆæ‰€æœ‰çš„linuxå‘è¡Œç‰ˆæœ¬ [root@CodeSheep ~]# unameLinux[root@CodeSheep ~]# uname -r3.10.0-957.5.1.el7.x86_64[root@CodeSheep ~]# uname -aLinux CodeSheep 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux[root@CodeSheep ~]# 3.ä½¿ç”¨redhat-release [root@CodeSheep ~]# cat /etc/redhat-release CentOS Linux release 7.6.1810 (Core) 4.æŸ¥çœ‹Cetnosç‰ˆæœ¬äºredhatå¯¹åº”ç‰ˆæœ¬çš„å‘½ä»¤ [root@CodeSheep ~]# cat /proc/version Linux version 3.10.0-957.5.1.el7.x86_64 (mockbuild@kbuilder.bsys.centos.org) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-36) (GCC) ) #1 SMP Fri Feb 1 14:54:57 UTC 2019 netstatå‘½ä»¤å¯ä»¥å¸®åŠ©æŸ¥æ‰¾æœ¬æœºçš„ç½‘ç»œçŠ¶æ€netstat -pt #å¯ä»¥è¾“å‡ºPIDä»¥åŠç¨‹åºå è¾“å‡ºç»“æœ Active Internet connections (w/o servers)Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program nametcp 0 0 localhostname:16061 192.168.1.1:50060 ESTABLISHED 22000/java æ˜¯æœ¬æœºçš„16061ç«¯å£åœ¨è°ƒ192.168.1.1:50060ä¸Šçš„æœåŠ¡ï¼Œä¸”æœ¬æœº16061ç«¯å£ä¸Šè·‘çš„æ˜¯ä¸€ä¸ªjavaç¨‹åºï¼Œè¿›ç¨‹IDæ˜¯22000 netstat -ant netstat -input lsofå¯ä»¥æŸ¥çœ‹ç³»ç»Ÿæ‰“å¼€çš„æ–‡ä»¶ï¼Œè¿™é‡Œçš„â€œæ–‡ä»¶â€åŒ…æ‹¬/procæ–‡ä»¶ã€ç£ç›˜æ–‡ä»¶ã€ç½‘ç»œIOç­‰lsof /etc/passwd # æŸ¥çœ‹å“ªä¸ªè¿›ç¨‹åœ¨å ç”¨/etc/passwdlsof -c mysql # åˆ—å‡ºæŸä¸ªç¨‹åºæ‰“å¼€çš„æ–‡ä»¶ä¿¡æ¯lsof -u username # åˆ—å‡ºæŸä¸ªç”¨æˆ·æ‰“å¼€çš„æ–‡ä»¶lsof -u ^root # æ’é™¤æŸä¸ªç”¨æˆ·å¤–çš„è¢«æ‰“å¼€çš„æ–‡ä»¶ä¿¡æ¯lsof -p 1 # åˆ—å‡ºæŸä¸ªè¿›ç¨‹å·æ‰“å¼€çš„æ–‡ä»¶lsof -i # åˆ—å‡ºæ‰€æœ‰çš„ç½‘ç»œè¿æ¥lsof -i :22 # åˆ—å‡ºè°åœ¨ä½¿ç”¨22ç«¯å£lsof | grep usbserial #æŸ¥çœ‹usbç«¯å£ä½¿ç”¨æƒ…å†µ pså‘½ä»¤æŸ¥æ‰¾ä¸è¿›ç¨‹ç›¸å…³çš„PIDå·ps a # æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ä»¥åŠç›¸å…³çš„pidps -A # ç°å®æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ps -u root #æ˜¾ç¤ºrootè¿›ç¨‹ç”¨æˆ·ä¿¡æ¯ps -ef # æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ï¼Œè¿å¸¦å‘½ä»¤è¡Œps -aux # æ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶ä»–ä½¿ç”¨è€…çš„è¡Œç¨‹ps c # åˆ—å‡ºç¨‹åºæ˜¾ç¤ºæ¯ä¸ªç¨‹åºçœŸæ­£çš„æŒ‡ä»¤åç§°ï¼Œè€Œä¸åŒ…å«è·¯å¾„ï¼Œå‚æ•°æˆ–å¸¸é©»æœåŠ¡çš„æ ‡ç¤ºps -e # æ˜¾ç¤ºæ¯ä¸€ä¸ªç¨‹åºçš„ç¯å¢ƒå˜é‡ps -ef | grep java | grep -v grep # æ˜¾ç¤ºæ‰€æœ‰aè¿›ç¨‹,å»æ‰å½“å‰çš„grepè¿›ç¨‹kill -9 pid # æ€æ­»è¿›ç¨‹ åˆ›å»ºç›®å½•mkdirmkdir (é€‰é¡¹) (å‚æ•°)-m å»ºç«‹ç›®æ ‡çš„åŒæ—¶è®¾ç½®å±æ€§-p å¤šå±‚çº§å»ºç«‹-v æ˜¾ç¤ºå»ºç«‹ä¿¡æ¯ ä½¿ç”¨ [root@test-ceph ~]# mkdir -m 777 -pv kk/kk/kkkmkdir: å·²åˆ›å»ºç›®å½• \"kk\"mkdir: å·²åˆ›å»ºç›®å½• \"kk/kk\"mkdir: å·²åˆ›å»ºç›®å½• \"kk/kk/kkk\" [root@test-ceph alpaca]# mkdir -pv ~/alpaca/tt/{,name/}{n,a,m,e}mkdir: å·²åˆ›å»ºç›®å½• \"/root/alpaca/tt\"mkdir: å·²åˆ›å»ºç›®å½• \"/root/alpaca/tt/n\"mkdir: å·²åˆ›å»ºç›®å½• \"/root/alpaca/tt/a\"mkdir: å·²åˆ›å»ºç›®å½• \"/root/alpaca/tt/m\"mkdir: å·²åˆ›å»ºç›®å½• \"/root/alpaca/tt/e\"mkdir: å·²åˆ›å»ºç›®å½• \"/root/alpaca/tt/name\"mkdir: å·²åˆ›å»ºç›®å½• \"/root/alpaca/tt/name/n\"mkdir: å·²åˆ›å»ºç›®å½• \"/root/alpaca/tt/name/a\"mkdir: å·²åˆ›å»ºç›®å½• \"/root/alpaca/tt/name/m\"mkdir: å·²åˆ›å»ºç›®å½• \"/root/alpaca/tt/name/e\" ä¸‹è½½æ–‡ä»¶å·¥å…·wgetLinuxç³»ç»Ÿä¸­çš„wgetæ˜¯ä¸€ä¸ªä¸‹è½½æ–‡ä»¶çš„å·¥å…·ï¼Œå®ƒç”¨åœ¨å‘½ä»¤è¡Œä¸‹ã€‚å¯¹äºLinuxç”¨æˆ·æ˜¯å¿…ä¸å¯å°‘çš„å·¥å…·ï¼Œæˆ‘ä»¬ç»å¸¸è¦ä¸‹è½½ä¸€äº›è½¯ä»¶æˆ–ä»è¿œç¨‹æœåŠ¡å™¨æ¢å¤å¤‡ä»½åˆ°æœ¬åœ°æœåŠ¡å™¨ã€‚wgetæ”¯æŒHTTPï¼ŒHTTPSå’ŒFTPåè®®ï¼Œå¯ä»¥ä½¿ç”¨HTTPä»£ç†ã€‚æ‰€è°“çš„è‡ªåŠ¨ä¸‹è½½æ˜¯æŒ‡ï¼Œwgetå¯ä»¥åœ¨ç”¨æˆ·é€€å‡ºç³»ç»Ÿçš„ä¹‹ååœ¨åå°æ‰§è¡Œã€‚è¿™æ„å‘³è¿™ä½ å¯ä»¥ç™»å½•ç³»ç»Ÿï¼Œå¯åŠ¨ä¸€ä¸ªwgetä¸‹è½½ä»»åŠ¡ï¼Œç„¶åé€€å‡ºç³»ç»Ÿï¼Œwgetå°†åœ¨åå°æ‰§è¡Œç›´åˆ°ä»»åŠ¡å®Œæˆï¼Œç›¸å¯¹äºå…¶å®ƒå¤§éƒ¨åˆ†æµè§ˆå™¨åœ¨ä¸‹è½½å¤§é‡æ•°æ®æ—¶éœ€è¦ç”¨æˆ·ä¸€ç›´çš„å‚ä¸ï¼Œè¿™çœå»äº†æå¤§çš„éº»çƒ¦ã€‚wget å¯ä»¥è·Ÿè¸ªHTMLé¡µé¢ä¸Šçš„é“¾æ¥ä¾æ¬¡ä¸‹è½½æ¥åˆ›å»ºè¿œç¨‹æœåŠ¡å™¨çš„æœ¬åœ°ç‰ˆæœ¬ï¼Œå®Œå…¨é‡å»ºåŸå§‹ç«™ç‚¹çš„ç›®å½•ç»“æ„ã€‚è¿™åˆå¸¸è¢«ç§°ä½œâ€é€’å½’ä¸‹è½½â€ã€‚åœ¨é€’å½’ä¸‹è½½çš„æ—¶å€™ï¼Œwget éµå¾ªRobot Exclusionæ ‡å‡†(/robots.txt). wgetå¯ä»¥åœ¨ä¸‹è½½çš„åŒæ—¶ï¼Œå°†é“¾æ¥è½¬æ¢æˆæŒ‡å‘æœ¬åœ°æ–‡ä»¶ï¼Œä»¥æ–¹ä¾¿ç¦»çº¿æµè§ˆã€‚wget éå¸¸ç¨³å®šï¼Œå®ƒåœ¨å¸¦å®½å¾ˆçª„çš„æƒ…å†µä¸‹å’Œä¸ç¨³å®šç½‘ç»œä¸­æœ‰å¾ˆå¼ºçš„é€‚åº”æ€§.å¦‚æœæ˜¯ç”±äºç½‘ç»œçš„åŸå› ä¸‹è½½å¤±è´¥ï¼Œwgetä¼šä¸æ–­çš„å°è¯•ï¼Œç›´åˆ°æ•´ä¸ªæ–‡ä»¶ä¸‹è½½å®Œæ¯•ã€‚å¦‚æœæ˜¯æœåŠ¡å™¨æ‰“æ–­ä¸‹è½½è¿‡ç¨‹ï¼Œå®ƒä¼šå†æ¬¡è”åˆ°æœåŠ¡å™¨ä¸Šä»åœæ­¢çš„åœ°æ–¹ç»§ç»­ä¸‹è½½ã€‚è¿™å¯¹ä»é‚£äº›é™å®šäº†é“¾æ¥æ—¶é—´çš„æœåŠ¡å™¨ä¸Šä¸‹è½½å¤§æ–‡ä»¶éå¸¸æœ‰ç”¨ wget (å‚æ•°) (åœ°å€)-V æ˜¾ç¤ºç‰ˆæœ¬-h è¯­æ³•å¸®åŠ©-b å¯åŠ¨åè½¬å…¥åå°æ‰§è¡Œ-o --output-file=file æŠŠä¸‹è½½è®°å½•å†™åˆ°æ–‡ä»¶ä¸­-a è¿½åŠ å†™åˆ°æ–‡ä»¶ä¸­-q é™é»˜è¾“å‡º-i --input-file=file ä¸‹è½½åœ¨fileæ–‡ä»¶ä¸­å‡ºç°è¿‡çš„urls-F æŠŠè¾“å…¥æ–‡ä»¶å½“ä½œhtmlæ ¼å¼æ¥å¯¹å¾…-O ä¸‹è½½å¹¶ä»¥ä¸åŒçš„æ–‡ä»¶åä¿å­˜ ä½¿ç”¨ # ä¸‹è½½ä¸€ä¸ªåŒ…wegt http://downloads.sourceforge.net/project/tcl/Tcl/8.6.3/tcl8.6.3-src.tar.gz# ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶å¹¶é‡å‘½åï¼Œé»˜è®¤ä»¥æœ€åä¸€ä¸ª/åé¢çš„å†…å®¹ä¸ºæ–‡ä»¶åwegt -O test.tar.gz http://downloads.sourceforge.net/project/tcl/Tcl/8.6.3/tcl8.6.3-src.tar.gz # é™é€Ÿä¸‹è½½wget --limit-rate=300k http://downloads.sourceforge.net/project/tcl/Tcl/8.6.3/tcl8.6.3-src.tar.gz# æ–­ç‚¹ç»­ä¼ wget -c http://downloads.sourceforge.net/project/tcl/Tcl/8.6.3/tcl8.6.3-src.tar.gz# åå°è¿è¡Œ , å¹¶ä½¿ç”¨tailè§‚å¯Ÿè¿›åº¦wget -b http://downloads.sourceforge.net/project/tcl/Tcl/8.6.3/tcl8.6.3-src.tar.gztail -f wget-log# æŒ‡å®šä¸‹è½½æ–‡ä»¶å­˜æ”¾åœ°å€wget --directory-prefix/sources http://downloads.sourceforge.net/project/tcl/Tcl/8.6.3/tcl8.6.3-src.tar.gz# ä¼ªè£…ä»£ç†åç§°wget --user-agent=\"Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.16 (KHTML, like Gecko) Chrome/10.0.648.204 Safari/534.16\" http://downloads.sourceforge.net/project/tcl/Tcl/8.6.3/tcl8.6.3-src.tar.gz# æµ‹è¯•ä¸‹è½½wget --spider http://downloads.sourceforge.net/project/tcl/Tcl/8.6.3/tcl8.6.3-src.tar.gz# å¢åŠ é‡è¯•ä¸‹è½½æ¬¡æ•°wget --tries=40 http://downloads.sourceforge.net/project/tcl/Tcl/8.6.3/tcl8.6.3-src.tar.gz# å¤šé“¾æ¥ä¸‹è½½wget -i urllist.txt# è¿‡æ»¤æ ¼å¼ä¸‹è½½wget --reject=gif http://downloads.sourceforge.net/project/tcl/Tcl/8.6.3/tcl8.6.3-src.tar.gz# æŠŠä¸‹è½½ä¿¡æ¯å­˜å…¥æ—¥å¿—æ–‡ä»¶wget -o downloads.log http://downloads.sourceforge.net/project/tcl/Tcl/8.6.3/tcl8.6.3-src.tar.gz# é™åˆ¶ä¸‹è½½æ–‡ä»¶å¤§å°,è¶…è¿‡5må°±é€€å‡ºï¼Œå¯¹å•ä¸ªä¸‹è½½æ— ç”¨ï¼Œéœ€è¦é€’å½’ä¸‹è½½wget -Q5m -i urllist.txt# ä¸‹è½½æŒ‡å®šæ ¼å¼æ–‡ä»¶wget -r -A .pdf http://downloads.sourceforge.net/project/tcl/Tcl/8.6.3/tcl8.6.3-src.tar.gz# ä¸‹è½½ftpä¸Šçš„å†…å®¹wget ftp-urlwget --ftp-user=username --ftp-passwd=passwd xxx.ftp æŸ¥æ‰¾æ–‡ä»¶findç”¨æ¥åœ¨æŒ‡å®šç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶ã€‚ä»»ä½•ä½äºå‚æ•°ä¹‹å‰çš„å­—ç¬¦ä¸²éƒ½å°†è¢«è§†ä¸ºæ¬²æŸ¥æ‰¾çš„ç›®å½•åã€‚å¦‚æœä½¿ç”¨è¯¥å‘½ä»¤æ—¶ï¼Œä¸è®¾ç½®ä»»ä½•å‚æ•°ï¼Œåˆ™findå‘½ä»¤å°†åœ¨å½“å‰ç›®å½•ä¸‹æŸ¥æ‰¾å­ç›®å½•ä¸æ–‡ä»¶ã€‚å¹¶ä¸”å°†æŸ¥æ‰¾åˆ°çš„å­ç›®å½•å’Œæ–‡ä»¶å…¨éƒ¨è¿›è¡Œæ˜¾ç¤º find . # åˆ—å‡ºå½“å‰ç›®å½•ä»¥åŠå­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹find /home -name \"*.txt\" #åˆ—å‡º/homeç›®å½•ä¸‹æ‰€æœ‰.txtç»“å°¾çš„æ–‡ä»¶åfind /home -iname \"*.txt\" #åŒä¸Šï¼Œå¿½ç•¥å¤§å°å†™find /home \\(-name \"*.txt\" -o -name \"*.pdf\"\\) # æ»¡è¶³é€»è¾‘å…³ç³» andfind /home -name \"*.txt\" -o -name \"*.pdf\" # åŒä¸Šfind /usr/ -path \"*local\" # æŸ¥æ‰¾æ–‡ä»¶æˆ–è·¯å¾„find . -regex \".*\\(\\.txt\\|\\.pdf\\)$\" # æ­£åˆ™åŒ¹é…find /home ! -name \"*.txt\" # ! å¦å®šfind . -type å‚æ•°ç±»å‹ f æ™®é€šæ–‡ä»¶ l è½¯é“¾æ¥ d ç›®å½• c å­—ç¬¦è®¾å¤‡ b å¿«è®¾å¤‡ s å¥—æ¥å­—find . -maxdepth 3 -type f # å®šä¹‰ç›®å½•æœ€å¤§æ·±åº¦ 3find . -mindepth 2 -type f # å®šä¹‰ç›®å½•æœ€å°æ·±åº¦ 2find . -type f -atine -7 # æœ€è¿‘7å¤©å†…find . -type f -atime 7 # 7å¤©å‰å½“å¤©è¢«è®¿é—®è¿‡çš„æ–‡ä»¶find . -type f -atime +7 # 7å¤©å‰è¢«è®¿é—®è¿‡çš„æ–‡ä»¶find /var/log -size +1G # æŸ¥æ‰¾å¤§äº1Gçš„æ–‡ä»¶find /data -owner user # æ‰¾åˆ°userç”¨æˆ·çš„æ–‡ä»¶find ./ -iname '_macosx' -depth -exec rm -rf {} \\; # åˆ é™¤è‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶ https://wangchujiang.com/linux-command/c/find.html å¤åˆ¶æ–‡ä»¶ cpcp (é€‰é¡¹) (å‚æ•°) -r å¯ä»¥å¤åˆ¶ç›®å½•-i è¦†ç›–æ–‡ä»¶ä¹‹å‰è¯¢é—®-f å¼ºè¡Œå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•,æ— è®ºæ˜¯å¦å­˜åœ¨-u ä½¿ç”¨è¿™é¡¹å‚æ•°ååªä¼šåœ¨æºæ–‡ä»¶çš„æ›´æ”¹æ—¶é—´è¾ƒç›®æ ‡æ–‡ä»¶æ›´æ–°æ—¶æˆ–æ˜¯åç§°ç›¸äº’å¯¹åº”çš„ç›®æ ‡æ–‡ä»¶å¹¶ä¸å­˜åœ¨æ—¶ï¼Œæ‰å¤åˆ¶æ–‡ä»¶ï¼›-v çœ‹è¯¦ç»†ä¿¡æ¯ æŸ¥çœ‹åŠ¨æ€åº“ä¾èµ–å…³ç³» lddé¦–å…ˆlddå¹¶ä¸æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶çš„å¯æ‰§è¡Œç¨‹åºï¼Œä»–æ˜¯ä¾é™„åœ¨Linuxä¸­çš„ä¸€ä¸ªshellè„šæœ¬ç”¨äºæ‰“å°ç¨‹åºæˆ–è€…åº“æ–‡ä»¶æ‰€ä¾èµ–çš„å…±äº«åº“åˆ—è¡¨æ¯”å¦‚https://www.cnblogs.com/zhangjxblog/p/7776556.htmlhttps://blog.csdn.net/qq_26819733/article/details/50610129 [root@gogogo ~]# ldd /bin/ls linux-vdso.so.1 => (0x00007ffe7cbcc000) libselinux.so.1 => /lib64/libselinux.so.1 (0x00007fedc8e77000) libcap.so.2 => /lib64/libcap.so.2 (0x00007fedc8c72000) libacl.so.1 => /lib64/libacl.so.1 (0x00007fedc8a69000) libc.so.6 => /lib64/libc.so.6 (0x00007fedc869b000) libpcre.so.1 => /lib64/libpcre.so.1 (0x00007fedc8439000) libdl.so.2 => /lib64/libdl.so.2 (0x00007fedc8235000) /lib64/ld-linux-x86-64.so.2 (0x00007fedc909e000) libattr.so.1 => /lib64/libattr.so.1 (0x00007fedc8030000) libpthread.so.0 => /lib64/libpthread.so.0 (0x00007fedc7e14000) æŸ¥çœ‹å¿«æ·è¾“å…¥ aliasalias æˆ–è€… ~/.bash_profile æŸ¥çœ‹å½“å‰ç›®å½•æ–‡ä»¶ ls# è¯­æ³•ls [option] [name] -a æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶æˆ–ç›®å½•-l é™¤æ–‡ä»¶åç§°å¤–ï¼Œäº¦å°†æ–‡ä»¶å‹æ€ã€æƒé™ã€æ‹¥æœ‰è€…ã€æ–‡ä»¶å¤§å°ç­‰èµ„è®¯è¯¦ç»†åˆ—å‡º-r å€’å™æ˜¾ç¤º-t æ—¶é—´é¡ºåºæ’åˆ—-R é€’å½’æ˜¾ç¤º-h ä»¥å¯è¯»å¤§å°æ˜¾ç¤º-i é¢å¤–æ˜¾ç¤ºinodeä¿¡æ¯ # å¸¸ç”¨ls -alls -altr #å€’å™æ—¶é—´ls -lh # åˆ—å‡ºè¯¦ç»†ä¿¡æ¯å¹¶ä»¥å¯è¯»å¤§å°æ˜¾ç¤ºæ–‡ä»¶å¤§å° æŸ¥çœ‹ç›®å½•æˆ–æ–‡ä»¶æ‰€å ç”¨ç£ç›˜å¤§å° du -sh# è¯­æ³•du [option] [name] -h ä»¥äººç±»å¯è¯»çš„æ–¹å¼æ˜¾ç¤º-aï¼šæ˜¾ç¤ºç›®å½•å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°ï¼Œè¿˜è¦æ˜¾ç¤ºå…¶ä¸‹ç›®å½•å’Œæ–‡ä»¶å ç”¨ç£ç›˜ç©ºé—´çš„å¤§å°-sï¼šæ˜¾ç¤ºç›®å½•å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°ï¼Œä¸è¦æ˜¾ç¤ºå…¶ä¸‹å­ç›®å½•å’Œæ–‡ä»¶å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°-cï¼šæ˜¾ç¤ºå‡ ä¸ªç›®å½•æˆ–æ–‡ä»¶å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°ï¼Œè¿˜è¦ç»Ÿè®¡å®ƒä»¬çš„æ€»å’Œâ€“apparent-sizeï¼šæ˜¾ç¤ºç›®å½•æˆ–æ–‡ä»¶è‡ªèº«çš„å¤§å°-l ï¼šç»Ÿè®¡ç¡¬é“¾æ¥å ç”¨ç£ç›˜ç©ºé—´çš„å¤§å°-Lï¼šç»Ÿè®¡ç¬¦å·é“¾æ¥æ‰€æŒ‡å‘çš„æ–‡ä»¶å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å° # å¸¸ç”¨du -sh æŸ¥çœ‹å½“å‰ç›®å½•æ€»å…±å çš„å®¹é‡ã€‚è€Œä¸å•ç‹¬åˆ—å‡ºå„å­é¡¹å ç”¨çš„å®¹é‡ du -lh --max-depth=1 : æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹ä¸€çº§å­æ–‡ä»¶å’Œå­ç›®å½•å ç”¨çš„ç£ç›˜å®¹é‡ã€‚du -sh * | sort -n ç»Ÿè®¡å½“å‰æ–‡ä»¶å¤¹(ç›®å½•)å¤§å°ï¼Œå¹¶æŒ‰æ–‡ä»¶å¤§å°æ’åºdu -sk filename æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶å¤§å° æ–‡ä»¶ä¼ è¾“ scpå‘½ä»¤scp -h # æŸ¥çœ‹å¸®åŠ©scp -v # æ˜¾ç¤ºè¿›åº¦scp -P # é€‰æ‹©ç«¯å£scp -r # ä¼ è¾“ç›®å½• ä»æœ¬åœ°å°†æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡å™¨scpã€æœ¬åœ°æ–‡ä»¶çš„è·¯å¾„ã€‘ã€æœåŠ¡å™¨ç”¨æˆ·åã€‘@ã€æœåŠ¡å™¨åœ°å€ã€‘ï¼šã€æœåŠ¡å™¨ä¸Šå­˜æ”¾æ–‡ä»¶çš„è·¯å¾„ã€‘scp /Users/mac_pc/Desktop/test.png root@192.168.1.1:/root ä»æœ¬åœ°å°†æ–‡ä»¶å¤¹ä¼ è¾“åˆ°æœåŠ¡å™¨scp -rã€æœ¬åœ°æ–‡ä»¶çš„è·¯å¾„ã€‘ã€æœåŠ¡å™¨ç”¨æˆ·åã€‘@ã€æœåŠ¡å™¨åœ°å€ã€‘ï¼šã€æœåŠ¡å™¨ä¸Šå­˜æ”¾æ–‡ä»¶çš„è·¯å¾„ã€‘sup -r /Users/mac_pc/Desktop/test root@192.168.1.1:/root å°†æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ä¼ è¾“åˆ°æœ¬åœ°scp ã€æœåŠ¡å™¨ç”¨æˆ·åã€‘@ã€æœåŠ¡å™¨åœ°å€ã€‘ï¼šã€æœåŠ¡å™¨ä¸Šå­˜æ”¾æ–‡ä»¶çš„è·¯å¾„ã€‘ã€æœ¬åœ°æ–‡ä»¶çš„è·¯å¾„ã€‘scp root@192.168.1.1:/data/wwwroot/default/111.png /Users/mac_pc/Desktop å°†æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¤¹ä¼ è¾“åˆ°æœ¬åœ°scp -r ã€æœåŠ¡å™¨ç”¨æˆ·åã€‘@ã€æœåŠ¡å™¨åœ°å€ã€‘ï¼šã€æœåŠ¡å™¨ä¸Šå­˜æ”¾æ–‡ä»¶çš„è·¯å¾„ã€‘ã€æœ¬åœ°æ–‡ä»¶çš„è·¯å¾„ã€‘sup -r root@192.168.1.1:/data/wwwroot/default/test /Users/mac_pc/Desktop grepä½¿ç”¨# -wç²¾ç¡®åŒ¹é…grep -w '192.168.20.1' test.txt# æˆ–è€…grep '\\' test.txt grep -C1 åªè¾“å‡ºåŒ¹é…ä»¥åŠå…¶ä¸Šä¸‹å„ä¸€è¡Œ echoçš„ä½¿ç”¨# è¾“å‡ºå†…å®¹echo \"test\"# è¾“å‡ºç©ºè¡Œecho echo -e '\\n\\n'# è¾“å‡ºï¼Œä½†ä¸æ¢è¡Œecho -n \"test\" traceroute è·¯ç”±è¿½è¸ª\btracerouteå¯ä»¥è¿½è¸ªç½‘ç»œæ•°æ®åŒ…ï¼Œå¹¶å±•ç°è·¯ç”±é€”å¾„ é€šè¿‡tracerouteæˆ‘ä»¬å¯ä»¥çŸ¥é“ä¿¡æ¯ä»ä½ çš„è®¡ç®—æœºåˆ°äº’è”ç½‘å¦ä¸€ç«¯çš„ä¸»æœºæ˜¯èµ°çš„ä»€ä¹ˆè·¯å¾„ã€‚å½“ç„¶æ¯æ¬¡æ•°æ®åŒ…ç”±æŸä¸€åŒæ ·çš„å‡ºå‘ç‚¹ï¼ˆsourceï¼‰åˆ°è¾¾æŸä¸€åŒæ ·çš„ç›®çš„åœ°(destination)èµ°çš„è·¯å¾„å¯èƒ½ä¼šä¸ä¸€æ ·ï¼Œä½†åŸºæœ¬ä¸Šæ¥è¯´å¤§éƒ¨åˆ†æ—¶å€™æ‰€èµ°çš„è·¯ç”±æ˜¯ç›¸åŒçš„ã€‚linuxç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºtraceroute,åœ¨MS Windowsä¸­ä¸ºtracertã€‚ tracerouteé€šè¿‡å‘é€å°çš„æ•°æ®åŒ…åˆ°ç›®çš„è®¾å¤‡ç›´åˆ°å…¶è¿”å›ï¼Œæ¥æµ‹é‡å…¶éœ€è¦å¤šé•¿æ—¶é—´ã€‚ä¸€æ¡è·¯å¾„ä¸Šçš„æ¯ä¸ªè®¾å¤‡tracerouteè¦æµ‹3æ¬¡ã€‚è¾“å‡ºç»“æœä¸­åŒ…æ‹¬æ¯æ¬¡æµ‹è¯•çš„æ—¶é—´(ms)å’Œè®¾å¤‡çš„åç§°ï¼ˆå¦‚æœ‰çš„è¯ï¼‰åŠå…¶IPåœ°å€ https://tools.ipip.net/traceroute.php ä½¿ç”¨é¦–å…ˆä½ è¦ä¸‹è½½tracerouteyum install traceroute -y traceroute [å‚æ•°] ä¸»æœº å®æˆ˜[root@gogogo ~]# traceroute www.baidu.comtraceroute to www.baidu.com (180.101.49.11), 30 hops max, 60 byte packets 1 10.0.0.130 (10.0.0.130) 1.151 ms 1.582 ms 2.369 ms 2 10.255.106.1 (10.255.106.1) 1.056 ms 1.647 ms 2.266 ms 3 10.128.0.1 (10.128.0.1) 0.441 ms 0.421 ms 0.389 ms 4 115.231.100.65 (115.231.100.65) 2.023 ms 2.055 ms 2.201 ms 5 10.100.128.21 (10.100.128.21) 1.844 ms 1.977 ms 2.696 ms 6 172.31.110.249 (172.31.110.249) 0.632 ms 0.645 ms 0.630 ms 7 172.31.123.53 (172.31.123.53) 0.536 ms 0.685 ms 0.623 ms 8 * * * 9 61.164.31.120 (61.164.31.120) 2.390 ms 220.191.194.116 (220.191.194.116) 3.258 ms 61.164.31.122 (61.164.31.122) 2.264 ms10 220.191.200.201 (220.191.200.201) 6.861 ms 220.191.200.217 (220.191.200.217) 6.413 ms 220.191.200.201 (220.191.200.201) 5.955 ms11 202.97.76.10 (202.97.76.10) 13.005 ms 202.97.75.174 (202.97.75.174) 14.885 ms 202.97.22.6 (202.97.22.6) 19.543 ms12 58.213.95.118 (58.213.95.118) 19.171 ms 58.213.95.2 (58.213.95.2) 14.327 ms 58.213.94.118 (58.213.94.118) 15.157 ms13 * 58.213.95.126 (58.213.95.126) 20.922 ms 58.213.95.134 (58.213.95.134) 16.233 ms14 58.213.96.102 (58.213.96.102) 14.907 ms 58.213.96.94 (58.213.96.94) 15.467 ms 58.213.96.90 (58.213.96.90) 15.166 ms15 * * *16 * * *17 * * *18 * * *19 * * *20 * * *21 * * *22 * * *23 * * *24 * * *25 * * *26 * * *27 * * *28 * * *29 * * *30 * * * æœ€å·¦è¾¹çš„æ˜¯è¡¨ç¤ºæ¯ä¸€æ¡çš„åºå·,ä»1å¼€å§‹ï¼Œæ¯ä¸€ä¸ªåºå·è¡¨ç¤ºä¸€è·³ï¼Œæ¯ä¸€è·³è¡¨ç¤ºä¸€ä¸ªç½‘å…³ç¬¬äºŒä¸ªå­—æ®µè¡¨ç¤ºä¸»æœºåå’Œå¯¹åº”ipåé¢ä¸‰ä¸ªè¡¨ç¤ºå‘é€çš„ä¸‰ä¸ªåŒ…æ‰€è¿”å›çš„æ—¶é—´ä¸€è¡Œ*å· æœ‰å¯èƒ½æ˜¯é˜²ç«å¢™å°æ‰äº†ICMPçš„è¿”å›ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—ä¸åˆ°ä»€ä¹ˆç›¸å…³çš„æ•°æ®åŒ…è¿”å›æ•°æ®ã€‚ # æ·»åŠ æ¯æ¬¡å‘é€çš„æ•°æ®åŒ…ä¸ªæ•° traceroute -q 4 www.baidu.com# ä¸æŸ¥ä¸»æœºåï¼Œä»…æ˜¾ç¤ºipåœ°å€traceroute -n www.baidu.com# è®¾ç½®è·³æ•°æ•°é‡traceroute -m 10 www.baidu.com# å‘é€åˆ°ç›´è¿ä¸»æœºtraceroute -r www.baidu.com å·¥ä½œåŸç†Tracerouteç¨‹åºçš„è®¾è®¡æ˜¯åˆ©ç”¨ICMPåŠIP headerçš„TTLï¼ˆTime To Liveï¼‰æ ä½ï¼ˆfieldï¼‰ã€‚é¦–å…ˆï¼Œtracerouteé€å‡ºä¸€ä¸ªTTLæ˜¯1çš„IP datagramï¼ˆå…¶å®ï¼Œæ¯æ¬¡é€å‡ºçš„ä¸º3ä¸ª40å­—èŠ‚çš„åŒ…ï¼ŒåŒ…æ‹¬æºåœ°å€ï¼Œç›®çš„åœ°å€å’ŒåŒ…å‘å‡ºçš„æ—¶é—´æ ‡ç­¾ï¼‰åˆ°ç›®çš„åœ°ï¼Œå½“è·¯å¾„ä¸Šçš„ç¬¬ä¸€ä¸ªè·¯ç”±å™¨ï¼ˆrouterï¼‰æ”¶åˆ°è¿™ä¸ªdatagramæ—¶ï¼Œå®ƒå°†TTLå‡1ã€‚æ­¤æ—¶ï¼ŒTTLå˜ä¸º0äº†ï¼Œæ‰€ä»¥è¯¥è·¯ç”±å™¨ä¼šå°†æ­¤datagramä¸¢æ‰ï¼Œå¹¶é€å›ä¸€ä¸ªã€ŒICMP time exceededã€æ¶ˆæ¯ï¼ˆåŒ…æ‹¬å‘IPåŒ…çš„æºåœ°å€ï¼ŒIPåŒ…çš„æ‰€æœ‰å†…å®¹åŠè·¯ç”±å™¨çš„IPåœ°å€ï¼‰ï¼Œtraceroute æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯åï¼Œä¾¿çŸ¥é“è¿™ä¸ªè·¯ç”±å™¨å­˜åœ¨äºè¿™ä¸ªè·¯å¾„ä¸Šï¼Œæ¥ç€traceroute å†é€å‡ºå¦ä¸€ä¸ªTTLæ˜¯2 çš„datagramï¼Œå‘ç°ç¬¬2 ä¸ªè·¯ç”±å™¨â€¦â€¦ traceroute æ¯æ¬¡å°†é€å‡ºçš„datagramçš„TTL åŠ 1æ¥å‘ç°å¦ä¸€ä¸ªè·¯ç”±å™¨ï¼Œè¿™ä¸ªé‡å¤çš„åŠ¨ä½œä¸€ç›´æŒç»­åˆ°æŸä¸ªdatagram æŠµè¾¾ç›®çš„åœ°ã€‚å½“datagramåˆ°è¾¾ç›®çš„åœ°åï¼Œè¯¥ä¸»æœºå¹¶ä¸ä¼šé€å›ICMP time exceededæ¶ˆæ¯ï¼Œå› ä¸ºå®ƒå·²æ˜¯ç›®çš„åœ°äº†ï¼Œé‚£ä¹ˆtracerouteå¦‚ä½•å¾—çŸ¥ç›®çš„åœ°åˆ°è¾¾äº†å‘¢ï¼Ÿ Tracerouteåœ¨é€å‡ºUDP datagramsåˆ°ç›®çš„åœ°æ—¶ï¼Œå®ƒæ‰€é€‰æ‹©é€è¾¾çš„port number æ˜¯ä¸€ä¸ªä¸€èˆ¬åº”ç”¨ç¨‹åºéƒ½ä¸ä¼šç”¨çš„å·ç ï¼ˆ30000 ä»¥ä¸Šï¼‰ï¼Œæ‰€ä»¥å½“æ­¤UDP datagram åˆ°è¾¾ç›®çš„åœ°åè¯¥ä¸»æœºä¼šé€å›ä¸€ä¸ªã€ŒICMP port unreachableã€çš„æ¶ˆæ¯ï¼Œè€Œå½“traceroute æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯æ—¶ï¼Œä¾¿çŸ¥é“ç›®çš„åœ°å·²ç»åˆ°è¾¾äº†ã€‚æ‰€ä»¥traceroute åœ¨Serverç«¯ä¹Ÿæ˜¯æ²¡æœ‰æ‰€è°“çš„Daemon ç¨‹å¼ã€‚ Tracerouteæå–å‘ ICMP TTLåˆ°æœŸæ¶ˆæ¯è®¾å¤‡çš„IPåœ°å€å¹¶ä½œåŸŸåè§£æã€‚æ¯æ¬¡ ï¼ŒTracerouteéƒ½æ‰“å°å‡ºä¸€ç³»åˆ—æ•°æ®,åŒ…æ‹¬æ‰€ç»è¿‡çš„è·¯ç”±è®¾å¤‡çš„åŸŸååŠ IPåœ°å€,ä¸‰ä¸ªåŒ…æ¯æ¬¡æ¥å›æ‰€èŠ±æ—¶é—´ã€‚ æ¯æ¬¡å†™åˆ°TTLå€¼è®¿é—®è·¯ç”±ï¼Œæ¯åˆ°è¾¾ä¸€ä¸ªè·¯ç”±ï¼ŒTTLå€¼å‡å°‘1 åˆ°0è¿”å›ï¼Œ é‡æ–°è£…è½½æ¯”ä¸Šæ¬¡+1çš„TTLå€¼è®¿é—®è·¯ç”±ï¼Œå¦‚æ­¤å¾ªç¯ è®°ä½ä»–åªè®°å½•è·¯ç”±, å¦‚æœæ˜¯äºŒå±‚ä¹‹é—´çš„æœºå™¨è®¿é—®æ˜¯ä¸æ˜¯åªæœ‰ä¸€æ¡ï¼Ÿ mtr è·¯ç”±è¿½è¸ªMTRæ˜¯Linuxå¹³å°ä¸Šä¸€æ¬¾éå¸¸å¥½ç”¨çš„ç½‘ç»œè¯Šæ–­å·¥å…·ï¼Œé›†æˆäº†tracerouteã€pingã€nslookupçš„åŠŸèƒ½ï¼Œç”¨äºè¯Šæ–­ç½‘ç»œçŠ¶æ€éå¸¸æœ‰ç”¨ã€‚ä¸‹é¢è¯·çœ‹ç®€å•ä»‹ç»ã€‚ å®‰è£… yum install mtr -y ä½¿ç”¨æ–¹æ³•mtr ipæˆ–åŸŸå My traceroute [v0.85]PG-VPN (0.0.0.0) Wed Oct 9 18:22:54 2019Resolver: Received error response 2. (server failure)er of fields quit Packets Pings Host Loss% Snt Last Avg Best Wrst StDev 1. 115.231.97.1 0.0% 20 0.8 1.0 0.8 1.3 0.0 2. 10.100.129.24 0.0% 20 0.9 0.9 0.9 1.0 0.0 3. 10.100.128.65 0.0% 20 0.9 1.0 0.9 1.1 0.0 4. 10.100.129.27 0.0% 20 1.3 1.1 1.0 1.3 0.0 5. 124.14.9.238 0.0% 20 4.0 4.1 3.8 4.3 0.0 ç¬¬ä¸€åˆ—(Host) : IPåœ°å€å’ŒåŸŸå æŒ‰né”®å¯ä»¥åˆ‡æ¢IPå’ŒåŸŸåç¬¬äºŒåˆ—(Loss%): ä¸¢åŒ…ç‡ç¬¬ä¸‰åˆ—(Snt): è®¾ç½®æ¯ç§’å‘é€æ•°æ®åŒ…çš„æ•°é‡ï¼Œé»˜è®¤æ˜¯10 å¯ä»¥é€šè¿‡å‚æ•°-cæ¥æŒ‡å®šç¬¬å››åˆ—(Last)ï¼š æœ€è¿‘ä¸€æ¬¡çš„Pingå€¼ç¬¬äº”å…­ä¸ƒåˆ—(AVG BEST WRST) : åˆ†åˆ«æ˜¯Pingçš„å¹³å‡ æœ€å¥½ æœ€å·®å€¼ç¬¬å…«åˆ—(StDev): æ ‡å‡†åå·® å…¶ä»–ç”¨æ³•$ mtr -h #æä¾›å¸®åŠ©å‘½ä»¤$ mtr -v #æ˜¾ç¤ºmtrçš„ç‰ˆæœ¬ä¿¡æ¯$ mtr -r #å·²æŠ¥å‘Šæ¨¡å¼æ˜¾ç¤º$ mtr -s #ç”¨æ¥æŒ‡å®špingæ•°æ®åŒ…çš„å¤§å°$ mtr --no-dns #ä¸å¯¹IPåœ°å€åšåŸŸåè§£æ$ mtr -a #æ¥è®¾ç½®å‘é€æ•°æ®åŒ…çš„IPåœ°å€ è¿™ä¸ªå¯¹ä¸€ä¸ªä¸»æœºç”±å¤šä¸ªIPåœ°å€æ˜¯æœ‰ç”¨çš„$ mtr -i #ä½¿ç”¨è¿™ä¸ªå‚æ•°æ¥è®¾ç½®ICMPè¿”å›ä¹‹é—´çš„è¦æ±‚é»˜è®¤æ˜¯1ç§’$ mtr -4 #IPv4$ mtr -6 #IPv6 åŸŸåæŸ¥è¯¢å·¥å…· digå¸¸ç”¨çš„åŸŸåæŸ¥è¯¢å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥æµ‹è¯•åŸŸåç³»ç»Ÿå·¥ä½œæ˜¯å¦æ­£å¸¸ dig (é€‰é¡¹)(å‚æ•°)alpaca@hzj î‚° ~ î‚° dig www.baidu.com; DiG 9.10.6 www.baidu.com;; global options: +cmd;; Got answer:;; ->>HEADER","link":"/posts/f6c82bc1/"},{"title":"linux å¸¸ç”¨å‘½ä»¤2","text":"learn linux dmesgdmesg å‘½ä»¤å¯ä»¥åˆ—å‡ºç³»ç»Ÿå¯åŠ¨æ—¶ç¡¬ä»¶æ£€æµ‹å’Œé©±åŠ¨åŠ è½½çš„æƒ…å†µï¼Œä»¥åŠåç»­ç”±å†…æ ¸ç”Ÿæˆçš„å…¶ä»–ä¿¡æ¯ã€‚ [root@gogogo ~]# dmesg[ 0.000000] Linux version 5.3.0-1.el7.elrepo.x86_64 (mockbuild@Build64R7) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-39) (GCC)) #1 SMP Mon Sep 16 08:44:46 EDT 2019[ 0.000000] Command line: BOOT_IMAGE=/boot/vmlinuz-5.3.0-1.el7.elrepo.x86_64 root=UUID=f13d84b4-c756-4d89-9d5e-6b534397aa14 ro console=tty0 crashkernel=auto console=ttyS0,115200[ 0.000000] Disabled fast string operations[ 0.000000] x86/fpu: Supporting XSAVE feature 0x001: 'x87 floating point registers'[ 0.000000] x86/fpu: Supporting XSAVE feature 0x002: 'SSE registers'[ 0.000000] x86/fpu: Supporting XSAVE feature 0x004: 'AVX registers'[ 0.000000] x86/fpu: xstate_offset[2]: 576, xstate_sizes[2]: 256[ 0.000000] x86/fpu: Enabled xstate features 0x7, context size is 832 bytes, using 'standard' format.[ 0.000000] BIOS-provided physical RAM map:[ 0.000000] BIOS-e820: [mem 0x0000000000000000-0x000000000009bbff] usable[ 0.000000] BIOS-e820: [mem 0x000000000009bc00-0x000000000009ffff] reserved[ 0.000000] BIOS-e820: [mem 0x00000000000f0000-0x00000000000fffff] reserved[ 0.000000] BIOS-e820: [mem 0x0000000000100000-0x000000007fffcfff] usable[ 0.000000] BIOS-e820: [mem 0x000000007fffd000-0x000000007fffffff] reserved[ 0.000000] BIOS-e820: [mem 0x00000000fffbc000-0x00000000ffffffff] reserved[ 0.000000] NX (Execute Disable) protection: active[ 0.000000] SMBIOS 2.4 present.[ 0.000000] DMI: RDO Project OpenStack Nova, BIOS 0.5.1 01/01/2007[ 0.000000] Hypervisor detected: KVM[ 0.000000] kvm-clock: Using msrs 4b564d01 and 4b564d00 å†…æ ¸åŠ è½½å¼€å§‹è®°å½•ï¼Œè®°å½•æ—¶æ‰“å°å‡ºæ¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»–æ¥çœ‹æ˜¯å¦æœ‰è¯†åˆ«åˆ°ä¸€äº›å¤–éƒ¨åŠ å…¥çš„è®¾å¤‡ï¼Œæ¯”å¦‚è¯†åˆ«USB é¼ æ ‡ ä¸²å£ç­‰ç­‰[1206367.860755] usb 2-1.6: FTDI USB Serial Device converter now attached to ttyUSB0 æ¯”å¦‚è¿™ä¸€æ¡å°±æ˜¯è¯†åˆ«åˆ°äº†ä¸€ä¸ªUSBè®¾å¤‡,æ£€æµ‹è®¾å¤‡æ˜¯å¦å¯ç”¨,echo â€œtestâ€ >> /dev/ttyUSB0 å¸¸ç”¨å‘½ä»¤å› ä¸ºdmesgæ˜¯ä»å†…æ ¸åŠ è½½å¼€å§‹åè®°å½•çš„ï¼Œè®°å½•çš„å†…å®¹å¤ªé•¿ï¼Œå¦‚æœæˆ‘ä»¬è¦è¿‡æ»¤ ï¼Œè¿˜è¦åŠ å…¥ç®¡é“å’Œgrepæ¥ç­›é€‰ dmesg | head -20 # åªè¾“å‡ºå‰20è¡Œæ—¥å¿—dmesg | tail -20 # åªè¾“å‡ºå20è¡Œæ—¥å¿—dmesg | grep -i usb # åªç­›é€‰å‡ºæœ‰usbæ—¥å¿—è¡Œçš„ -i å¿½ç•¥å¤§å°å†™dmesg | grep -E -i \"eth|sda\" # åªç­›é€‰åŒ…å«å­—ç¬¦ä¸²â€œethâ€æˆ–â€œsdaâ€çš„æ—¥å¿—è¡Œ lspcilspci å‘½ä»¤å¯ä»¥åˆ—å‡ºç³»ç»Ÿä¸­çš„ PCI æ€»çº¿åŠå…¶è¿æ¥çš„è®¾å¤‡ã€‚è¯¥å‘½ä»¤çš„è¾“å‡ºå¦‚ä¸‹ï¼šä»€ä¹ˆæ˜¯PCIhttps://zh.wikipedia.org/wiki/%E5%A4%96%E8%AE%BE%E7%BB%84%E4%BB%B6%E4%BA%92%E8%BF%9E%E6%A0%87%E5%87%86 [root@gogogo ~]# lspci00:00.0 Host bridge: Intel Corporation 440FX - 82441FX PMC [Natoma] (rev 02)00:01.0 ISA bridge: Intel Corporation 82371SB PIIX3 ISA [Natoma/Triton II]00:01.1 IDE interface: Intel Corporation 82371SB PIIX3 IDE [Natoma/Triton II]00:01.2 USB controller: Intel Corporation 82371SB PIIX3 USB [Natoma/Triton II] (rev 01)00:01.3 Bridge: Intel Corporation 82371AB/EB/MB PIIX4 ACPI (rev 03)00:02.0 VGA compatible controller: Cirrus Logic GD 544600:03.0 Ethernet controller: Red Hat, Inc. Virtio network device00:04.0 SCSI storage controller: Red Hat, Inc. Virtio block device00:05.0 SCSI storage controller: Red Hat, Inc. Virtio block device00:06.0 RAM memory: Red Hat, Inc. Virtio memory balloon è¾“å‡ºä¿¡æ¯ä¸­åŒ…æ‹¬å£°éŸ³ï¼ˆMultimedia audio controllerï¼‰ï¼ŒUSBè®¾å¤‡ï¼ˆUSB controllerï¼‰ï¼Œè§†é¢‘è¾“å‡ºï¼ˆVGA compatible controllerï¼‰ï¼Œæœ‰çº¿ç½‘å¡ï¼ˆEthernet controllerï¼‰å’Œç£ç›˜ï¼ˆSATA controllerï¼‰ç­‰ã€‚å¦‚éœ€è·å–æ›´è¯¦å°½çš„ä¿¡æ¯ï¼Œè¿˜å¯ä»¥åœ¨è¯¥å‘½ä»¤åå¢åŠ ä¸€è‡³å¤šä¸ª -v é€‰é¡¹ï¼ˆå¦‚ -vvvï¼‰ã€‚ lsusbæŸ¥çœ‹usbè®¾å¤‡çš„æƒ…å†µ æ‰¾å‡ºè¿æ¥äº†å¤šå°‘usbè®¾å¤‡ find /dev/bus åˆ—å‡ºæŸå°USBè®¾å¤‡çš„è¯¦ç»†ä¿¡æ¯ lsusb -D /dev/bus/usb/001/002 ä»¥æ ‘å±‚ç»“æ„åˆ—å‡º USB è®¾å¤‡ lsusb -t å¦‚éœ€è·å–æ›´è¯¦å°½çš„ä¿¡æ¯ï¼Œè¿˜å¯ä»¥åœ¨è¯¥å‘½ä»¤åå¢åŠ ä¸€è‡³å¤šä¸ª -v é€‰é¡¹ï¼ˆå¦‚ -vvvï¼‰ lsblklsblk å‘½ä»¤ç”¨äºåˆ—å‡ºæ‰€æœ‰å¯ç”¨å—è®¾å¤‡çš„ä¿¡æ¯ï¼Œè¿˜èƒ½æ˜¾ç¤ºä»–ä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚å—è®¾å¤‡æœ‰ç¡¬ç›˜ï¼Œé—ªå­˜ç›˜ï¼Œcd-ROMç­‰ç­‰ã€‚ [root@test-ceph ~]# lsblkNAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINTsda 8:0 0 447.1G 0 diskâ”œâ”€sda1 8:1 0 200M 0 part /boot/efiâ”œâ”€sda2 8:2 0 1G 0 part /bootâ””â”€sda3 8:3 0 446G 0 part â”œâ”€centos-root 253:0 0 50G 0 lvm / â”œâ”€centos-swap 253:1 0 7.8G 0 lvm [SWAP] â””â”€centos-home 253:2 0 388.1G 0 lvm /homesdb 8:16 0 1.8T 0 diskâ”œâ”€sdb1 8:17 0 8G 0 partâ”œâ”€sdb2 8:18 0 4G 0 partâ”œâ”€sdb3 8:19 0 40G 0 partâ””â”€sdb4 8:20 0 1.8T 0 partsdc 8:32 0 1.8T 0 disksdd 8:48 0 1.8T 0 disksde 8:64 0 1.8T 0 disksdf 8:80 1 7.5G 0 diskâ”œâ”€sdf1 8:81 1 918M 0 partâ””â”€sdf2 8:82 1 8.5M 0 part NAME: å—è®¾å¤‡åMAJ:MIN: ä¸»è¦å’Œæ¬¡è¦è®¾å¤‡å·RM: è®¾å¤‡æ˜¯å¦å±äºå¯ç§»åŠ¨è®¾å¤‡ï¼Œå¦‚sdbçš„RMå€¼ä¸º1 ï¼Œæ˜¯å¯ç§»åŠ¨è®¾å¤‡SIZE: è®¾å¤‡çš„å®¹é‡å¤§å°ä¿¡æ¯RO: è®¾å¤‡æ˜¯å¦ä¸ºåªè¯»TYPE: è®¾å¤‡æ˜¯ç£ç›˜è¿˜æ˜¯ç£ç›˜ä¸Šçš„ä¸€ä¸ªåˆ†åŒºMOUNTPOINT: è®¾å¤‡çš„æŒ‚è½½ç‚¹ sda æ˜¯ç›˜ sda1æ˜¯åŒº lsblk -m # æ˜¾ç¤ºè®¾å¤‡æ‰€æœ‰è€…ç›¸å…³çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„æ‰€å±ç”¨æˆ·ã€æ‰€å±ç»„ä»¥åŠæ–‡ä»¶ç³»ç»ŸæŒ‚è½½çš„æ¨¡å¼[root@gogogo ~]# lsblk -mNAME SIZE OWNER GROUP MODEvdb 40G root disk brw-rw----vda 20G root disk brw-rw----â””â”€vda1 20G root disk brw-rw---- blkidæ˜¾ç¤ºå…³äºå—çš„ä¿¡æ¯ blkid # æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨ä¿¡æ¯ å’Œå”¯ä¸€è¯†åˆ«idblkid /dev/sad1 # ç‰¹æŒ‡blkid -U # è®¾å¤‡blkid -g # æ¸…é™¤ç¼“å­˜ lscpulscpu å‘½ä»¤å¯ä»¥è·å¾— CPU çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚CPUæ¶æ„ï¼ˆå¦‚ i686 æˆ– x86_64ï¼‰ã€è¿ç®—æ¨¡å¼ï¼ˆ32bit æˆ– 64bitï¼‰ã€æ ¸å¿ƒæ•°ã€æ¯é¢—æ ¸å¿ƒçš„çº¿ç¨‹æ•°ã€å‹å·ã€ä¸»é¢‘ç­‰ã€‚ lsmodå¦‚æœä½ æ–°å¢åŠ äº†ç¡¬ä»¶ï¼Œå´ä¸èƒ½è¢«ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«ã€‚å¯èƒ½ä½ éœ€è¦æ‰‹åŠ¨åœ°åŠ è½½å¯¹åº”çš„å†…æ ¸æ¨¡å—ã€‚å†…æ ¸æ¨¡å—å®‰è£…åœ¨ /lib/modules/ çš„å­ç›®å½•ä¸‹ï¼Œè¯¥å­ç›®å½•çš„åå­—å¯¹åº”å†…æ ¸çš„ç‰ˆæœ¬ã€‚å³ /lib/modules/4.10.0-19-generic ç›®å½•ä¸‹åŒ…å«äº† 4.10.0-19-generic å†…æ ¸çš„é©±åŠ¨ç¨‹åº [root@gogogo ~]# lsmodModule Size Used bycrct10dif_pclmul 16384 1crc32_pclmul 16384 0ghash_clmulni_intel 16384 0aesni_intel 372736 0cirrus 16384 0crypto_simd 16384 1 aesni_intelcryptd 24576 2 crypto_simd,ghash_clmulni_intelglue_helper 16384 1 aesni_inteldrm_kms_helper 176128 3 cirrusjoydev 24576 0input_leds 16384 0drm 487424 3 drm_kms_helper,cirrusinput_leds 16384 0drm 487424 3 drm_kms_helper,cirrusvirtio_balloon 24576 0 è·å–å·²åŠ è½½æ¨¡å—çš„ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨modinfoå‘½ä»¤ modinfo drm[root@gogogo ~]# modinfo drmfilename: /lib/modules/5.3.0-1.el7.elrepo.x86_64/kernel/drivers/gpu/drm/drm.kolicense: GPL and additional rightsdescription: DRM shared core routinesauthor: Gareth Hughes, Leif Delgass, JosÃ© Fonseca, Jon Smirllicense: GPL and additional rightsdescription: DRM bridge infrastructureauthor: Ajay Kumar license: GPL and additional rights å¦å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ modprobe å‘½ä»¤åŠ è½½æ¨¡å—ï¼Œrmmod å‘½ä»¤ç§»é™¤æ¨¡å—ã€‚","link":"/posts/3f665668/"},{"title":"ç”µå•†åå°ç®¡ç†ç³»ç»Ÿ(vue)-æ­å»ºåŸºæœ¬ç¯å¢ƒ","text":"elementUIç”µå•†é¡¹ç›®1 åˆ›å»ºåŸºæœ¬ç¯å¢ƒ# å®‰è£…å„ç§å†…å®¹yum install nodejs,vue,vue-cli ä½¿ç”¨vueæ„å»ºé¡¹ç›®# åˆ›å»ºé¡¹ç›®çš„è¿‡ç¨‹å…¶å®æœ‰å¾ˆå¤šç§ï¼Œä¸€èˆ¬å»ºè®®ç”¨uiå¯è§†åŒ–åˆ›å»ºå’Œå‘½ä»¤è¡Œåˆ›å»ºï¼Œè¿™é‡Œç”¨å¯è§†åŒ–åˆ›å»ºæ¥ä¸¾ä¾‹å­vue ui è¿™é‡Œä¼šç»™æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªé¡¹ç›®ç®¡ç†å™¨ï¼Œåœ¨é‡Œé¢æˆ‘ä»¬å¯ä»¥åˆ›å»ºé¡¹ç›®å’Œå¯¼å…¥é¡¹ç›®ç‚¹å‡»åˆ›å»ºé¡¹ç›®,è¾“å…¥å®Œä¿¡æ¯ä»¥åï¼Œé€‰æ‹©æ¨¡ç‰ˆï¼Œç‚¹å‡»å®Œæˆã€‚ é¡¹ç›®è¿è¡Œçš„å‡ ç§æ–¹å¼npm run # ä¼šå‡ºç°è¿è¡Œé¡¹ç›®çš„å‡ ç§æ–¹å¼ï¼ŒåŸºç¡€çš„é…ç½®ä¸­ä¼šå‡ºç°ä¸‹é¢ä¸‰ä¸ª serve vue-cli-service serve build vue-cli-service build lint vue-cli-service lint serveæ˜¯çƒ­æ›´æ–°æœ¬åœ°è¿è¡Œbuildæ˜¯æ‰“åŒ…é¡¹ç›®lintæ˜¯ç¼–ç è§„èŒƒæ£€æŸ¥ é¡¹ç›®éƒ¨ç½² github-pageéƒ¨ç½²å› ä¸ºæˆ‘å·²ç»éƒ¨ç½²äº†åšå®¢ï¼Œæ‰€ä»¥è¿™é‡Œå°±å…ˆä¸ç”¨è¿™ç§éƒ¨ç½²æ–¹å¼äº†url:https://cli.vuejs.org/guide/deployment.html#github-pagesæœ‰ç”¨åˆ°çš„åœ°æ–¹å¯ä»¥çœ‹ä¸€ä¸‹ docker-nginxéƒ¨ç½²è¿™ä¸ªä¹‹åé©¬ä¸Šå°±è¦ç”¨åˆ°äº†ï¼Œdocker+nginxçš„ä½¿ç”¨ã€‚","link":"/posts/f538ba9d/"},{"title":"keepalive+haproxyè´Ÿè½½å‡è¡¡","text":"haproxyè´Ÿè½½å‡è¡¡ # yumå®‰è£…yum install haproxy -y # centos7é»˜è®¤ç‰ˆæœ¬æ˜¯1.5# æŸ¥çœ‹åŒ…ä¿¡æ¯rpm -qi haproxy# æŸ¥çœ‹åŒ…æ‰€åˆ›å»ºçš„ç›®å½•rpm -ql haproxy â€”->ä¸»è¦ç›®å½•ä¸»ç¨‹åºï¼š/usr/sbin/haproxyé…ç½®æ–‡ä»¶ï¼š/etc/haproxy/haproxy.cfgå¯åŠ¨æœåŠ¡ï¼šsystemctl start haproxyåœæ­¢æœåŠ¡ï¼šsystemctl stop haproxyå¼€æœºå¯åŠ¨ï¼šsystemctl enable haproxy â€”->é…ç½®æ–‡ä»¶ç»“æ„ haproxyé…ç½®æ–‡ä»¶å¯åˆ†ä¸ºå…¨å±€é…ç½®ï¼ˆglobalsettingsï¼‰å’Œ ä»£ç†é…ç½®ï¼ˆproxiesï¼‰ï¼Œè€Œä»£ç†æ®µé…ç½®åŒ…å«defaultsã€frontendã€backendã€listenã€‚ global settingsï¼š#å…¨å±€å‚æ•°é…ç½®ï¼Œä¸»è¦ç”¨äºå®šä¹‰haproxyè¿›ç¨‹ç®¡ç†å®‰å…¨åŠæ€§èƒ½ç›¸å…³çš„å‚æ•°defaults < name >ï¼š#é»˜è®¤é…ç½®å‚æ•°ï¼Œä¸‹é¢çš„æ®µç»§æ‰¿è¯¥é…ç½®ï¼Œåç§°æ˜¯å¯é€‰çš„,è¿™é…ç½®é»˜è®¤é…ç½®å‚æ•°å¯ç”±ä¸‹ä¸€ä¸ªâ€defaultsâ€æ‰€é‡æ–°è®¾å®šfrontend < name >ï¼š#å‰ç«¯é…ç½®ï¼Œå®šä¹‰ä¸€ç³»åˆ—ç›‘å¬çš„å¥—æ¥å­—ï¼Œè¿™äº›å¥—æ¥å­—å¯æ¥å—å®¢æˆ·ç«¯è¯·æ±‚å¹¶ä¸ä¹‹å»ºç«‹è¿æ¥ï¼Œå¯ä»¥ç›‘å¬å¤šä¸ªç«¯å£ã€‚backend < name >ï¼š#åç«¯é…ç½®ï¼Œå®šä¹‰åå°æœåŠ¡å™¨ï¼Œå‰ç«¯ä»£ç†æœåŠ¡å™¨å°†ä¼šæŠŠå®¢æˆ·ç«¯çš„è¯·æ±‚è°ƒåº¦è‡³è¿™äº›æœåŠ¡å™¨ï¼Œç±»ä¼¼nginxä¸­çš„upstreamlisten < name >ï¼š#å®šä¹‰ä¸€ç»„å‰ç«¯å’Œåç«¯çš„å®Œæ•´ä»£ç†ï¼Œå¯ç†è§£ä¸ºfrontend+backendï¼Œé€šå¸¸ç”¨äºtcpæµé‡ä»£ç† â€”->é…ç½®å‚æ•°å¯æ”¯æŒçš„æ—¶é—´å•ä½ us : å¾®ç§’. 1 microsecond = 1/1000000 s ms : æ¯«ç§’. 1 millisecond = 1/1000 s s : ç§’ 1s = 1000ms m : åˆ† 1m = 60s = 60000ms h : å°æ—¶ 1h = 60m = 3600s = 3600000ms d : å¤© 1d = 24h = 1440m = 86400s = 86400000ms haproxyé…ç½®æ–‡ä»¶ å…¨å±€é…ç½®å‚æ•°(global) chroot: #ä¿®æ”¹haproxyçš„å·¥ä½œç›®å½•è‡³æŒ‡å®šçš„ç›®å½•ï¼Œå¹¶åœ¨æ”¾å¼ƒæƒé™ä¹‹å‰æ‰§è¡Œchrootï¼ˆï¼‰æ“ä½œï¼Œå¯ä»¥æå‡haproxyçš„å®‰å…¨çº§åˆ«ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ç¡®ä¿æŒ‡å®šçš„ç›®å½•ä¸ºç©ºç›®å½•ä¸”ä»»ä½•ç”¨æˆ·å‡ä¸èƒ½æœ‰å†™æƒé™;daemon: #è®©haproxyä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼å·¥ä½œäºåå°ï¼Œå…¶ç­‰åŒäº\"-D\"é€‰é¡¹çš„åŠŸèƒ½ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä»¥\"-db\"é€‰é¡¹å°†å…¶ç¦ç”¨;gid: #ä»¥æŒ‡å®šçš„GIDè¿è¡Œhaproxyï¼Œå»ºè®®ä½¿ç”¨ä¸“ç”¨äºè¿è¡Œhaproxyçš„GIDï¼Œä»¥é¿å…å› æƒé™å¸¦æ¥çš„é£é™©;group: #åŒgidï¼Œä¸è¿‡è¿™é‡Œä¸ºæŒ‡å®šçš„ç»„å;uid: #å·²æŒ‡å®šçš„UIDèº«ä»½è¿è¡Œhaproxyè¿›ç¨‹;user: #åŒuidï¼Œä½†è¿™é‡Œä½¿ç”¨çš„ä¸ºç”¨æˆ·å;log: #å®šä¹‰å…¨å±€çš„syslogæœåŠ¡å™¨ï¼Œæœ€å¤šå¯ä»¥å®šä¹‰ä¸¤ä¸ª;nbproc: #æŒ‡å®šå¯åŠ¨çš„haproxyè¿›ç¨‹ä¸ªæ•°ï¼Œåªèƒ½ç”¨äºå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼çš„haproxyï¼›é»˜è®¤ä¸ºæ­¢å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œé‰´äºè°ƒè¯•å›°éš¾ç­‰å¤šæ–¹é¢çš„åŸå› ï¼Œä¸€èˆ¬åªåœ¨ä½†è¿›ç¨‹ä»…èƒ½æ‰“å¼€å°‘æ•°æ–‡ä»¶æè¿°ç¬¦çš„åœºä¸­æ‰ä½¿ç”¨å¤šè¿›ç¨‹æ¨¡å¼;pidfile: #pidæ–‡ä»¶çš„å­˜æ”¾ä½ç½®;ulimit-n: #è®¾å®šæ¯ä¸ªè¿›ç¨‹æ‰€èƒ½å¤Ÿæ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦ï¼Œé»˜è®¤æƒ…å†µä¸‹å…¶ä¼šè‡ªåŠ¨è¿›è¡Œè®¡ç®—ï¼Œå› æ­¤ä¸å»ºè®®ä¿®æ”¹æ­¤é€‰é¡¹;node: #å®šä¹‰å½“å‰èŠ‚ç‚¹çš„åç§°ï¼Œç”¨äºHAåœºæ™¯ä¸­å¤šhaproxyè¿›ç¨‹å…±äº«åŒä¸€ä¸ªIPåœ°å€æ—¶;description: #å½“å‰å®ä¾‹çš„æè¿°ä¿¡æ¯;maxconn: #è®¾å®šæ¯ä¸ªhaproxyè¿›ç¨‹æ‰€æ¥å—çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°ï¼Œå…¶ç­‰åŒäºå‘½ä»¤è¡Œé€‰é¡¹\"-n\"ï¼Œ\"ulimit-n\"è‡ªåŠ¨è®¡ç®—çš„ç»“æœæ­£å¼å‚ç…§ä»å‚æ•°è®¾å®šçš„;maxpipes: #haproxyä½¿ç”¨pipeå®ŒæˆåŸºäºå†…æ ¸çš„tcpæŠ¥æ–‡é‡ç»„ï¼Œæ­¤é€‰é¡¹ç”¨äºè®¾å®šæ¯è¿›ç¨‹æ‰€å…è®¸ä½¿ç”¨çš„æœ€å¤§pipeä¸ªæ•°ï¼Œæ¯ä¸ªpipeä¼šæ‰“å¼€ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå› æ­¤ï¼Œ\"ulimit -n\"è‡ªåŠ¨è®¡ç®—çš„ç»“æœä¼šæ ¹æ®éœ€è¦è°ƒå¤§æ­¤å€¼ï¼Œé»˜è®¤ä¸ºmaxcoon/4;noepoll: #åœ¨linuxç³»ç»Ÿä¸Šç¦ç”¨epollæœºåˆ¶;nokqueue: #åœ¨BSEç³»ç»Ÿä¸Šç¦ç”¨kqueueæœºåˆ¶;nopoll: #ç¦ç”¨pollæœºåˆ¶;nosepoll: #åœ¨linuxç³»ç»Ÿä¸Šç¦ç”¨å¯å‘å¼epollæœºåˆ¶;nosplice: #ç¦æ­¢åœ¨linuxå¥—æ¥å­—ä¸Šä½¿ç”¨tcpé‡ç»„ï¼Œè¿™ä¼šå¯¼è‡´æ›´å¤šçš„recv/sendè°ƒç”¨ï¼Œä¸è¿‡ï¼Œåœ¨linux2.6.25-28ç³»åˆ—çš„å†…æ ¸ä¸Šï¼Œtcpé‡ç»„åŠŸèƒ½æœ‰bugå­˜åœ¨;spread-checks: #åœ¨haprorxyåç«¯æœ‰ç€ä¼—å¤šæœåŠ¡å™¨çš„åœºæ™¯ä¸­ï¼Œåœ¨ç´§ç¼ºæ˜¯æ—¶é—´é—´éš”åç»Ÿä¸€å¯¹ä¸­æœåŠ¡å™¨è¿›è¡Œå¥åº·çŠ¶å†µæ£€æŸ¥å¯èƒ½ä¼šå¸¦æ¥æ„å¤–é—®é¢˜ï¼Œæ­¤é€‰é¡¹ç”¨äºå°†æ£€æŸ¥çš„æ—¶é—´é—´éš”é•¿åº¦ä¸Šå¢åŠ æˆ–å‡å°‘ä¸€å®šçš„éšæœºæ—¶é•¿ï¼Œä¸ºå½“å‰æ£€æŸ¥æ£€æµ‹æ—¶é—´çš„%;maxconnrateï¼š#è®¾ç½®æ¯ä¸ªè¿›ç¨‹æ¯ç§’ç§æ‰€èƒ½å»ºç«‹çš„æœ€å¤§è¿æ¥æ•°é‡ï¼Œé€Ÿç‡ï¼Œä¸€ä¸ªè¿æ¥é‡Œå¯ä»¥æœ‰å¤šä¸ªä¼šè¯ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰ä¼šè¯maxsessrateï¼š#è®¾ç½®æ¯ä¸ªè¿›ç¨‹æ¯ç§’ç§æ‰€èƒ½å»ºç«‹çš„æœ€å¤§ä¼šè¯æ•°é‡maxsslconnï¼š#æ¯è¿›ç¨‹æ”¯æŒSSL çš„æœ€å¤§è¿æ¥æ•°é‡tune.bufsize: #è®¾å®šbufferçš„å¤§å°ï¼ŒåŒæ ·çš„å†…å­˜æ¡ä»¶ä¸‹ï¼Œè¾ƒå°çš„å€¼å¯ä»¥è®©haproxyæœ‰èƒ½åŠ›æ¥å—æ›´å¤šçš„å¹¶å‘è¿æ¥ï¼Œè¾ƒå¤§çš„å€¼äº†å¯ä»¥è®©æŸäº›åº”ç”¨ç¨‹åºä½¿ç”¨è¾ƒå¤§çš„cookieä¿¡æ¯ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨é»˜è®¤å€¼;tune.chksize: #è®¾å®šæ£€æŸ¥ç¼“å†²åŒºçš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œæ›´å¤§çš„å€¼æœ‰åŠ©äºåœ¨è¾ƒå¤§çš„é¡µé¢ä¸­å®ŒæˆåŸºäºå­—ç¬¦ä¸²æˆ–æ¨¡å¼çš„æ–‡æœ¬æŸ¥æ‰¾ï¼Œä½†ä¹Ÿä¼šå ç”¨æ›´å¤šçš„ç³»ç»Ÿèµ„æºï¼Œä¸å»ºè®®ä¿®æ”¹;tune.maxaccept: #è®¾å®šhaproxyè¿›ç¨‹å†…æ ¸è°ƒåº¦è¿è¡Œæ—¶ä¸€æ¬¡æ€§å¯ä»¥æ¥å—çš„è¿æ¥çš„ä¸ªæ•°ï¼Œè¾ƒå¤§çš„å€¼å¯ä»¥å¸¦æ¥è¾ƒå¤§çš„ååé‡ã€‚tune.maxpollevents: #è®¾å®šä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨å¯ä»¥å¤„ç†çš„äº‹ä»¶æœ€å¤§æ•°ï¼Œé»˜è®¤å€¼å–å†³äºOS,å…¶è‡³å°äº200æ—¶å¯ä»‹äºå¸¦å®½ï¼Œä½†ä¼šç•¥å¾®å¢å¤§ç½‘ç»œå»¶è¿Ÿï¼Œä½†å¤§äº200æ—¶ä¼šé™ä½å»¶è¿Ÿï¼Œä½†ä¼šç¨ç¨å¢åŠ ç½‘ç»œå¸¦å®½çš„å ç”¨;tune.maxrewrite: #è®¾å®šåœ¨é¦–éƒ¨é‡å†™æˆ–è¿½åŠ è€Œé¢„ç•™çš„ç¼“å­˜ç©ºé—´ï¼Œå»ºè®®ä½¿ç”¨1024å·¦å³çš„å¤§å°ï¼Œåœ¨éœ€è¦æ›´å¤§çš„ç©ºé—´æ—¶ï¼Œhaproxyä¼šè‡ªåŠ¨å¢åŠ å…¶å€¼;tune.rcvbuf.client: #è®¾å®šå†…æ ¸å¥—æ¥å­—ä¸­å®¢æˆ·ç«¯æ¥æ”¶ç¼“å­˜åŒºçš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨é»˜è®¤å€¼;tune.rcvbuf.server: #è®¾å®šå†…æ ¸å¥—æ¥å­—ä¸­æœåŠ¡å™¨æ¥æ”¶ç¼“å­˜åŒºçš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨é»˜è®¤å€¼;tune.sndbuf.client: #è®¾å®šå†…æ ¸å¥—æ¥å­—ä¸­å®¢æˆ·ç«¯å‘é€ç¼“å­˜åŒºçš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨é»˜è®¤å€¼;tune.sndbuf.server: #è®¾å®šå†…æ ¸å¥—æ¥å­—ä¸­æœåŠ¡å™¨ç«¯å‘é€ç¼“å­˜åŒºçš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨é»˜è®¤å€¼;debug: #è°ƒè¯•æ¨¡å¼ï¼Œè¾“å‡ºå¯åŠ¨ä¿¡æ¯åˆ°æ ‡å‡†è¾“å‡º;quiet: #å®‰è£…æ¨¡å¼ï¼Œå¯åŠ¨æ—¶æ— è¾“å‡º; globalé»˜è®¤é…ç½® # å…¨å±€é…ç½®global log 127.0.0.1 local0 # è®¾ç½®æ—¥å¿— log 127.0.0.1 local1 notice maxconn 4000 # æœ€å¤§è¿æ¥æ•° chroot /usr/local/haproxy # å®‰è£…ç›®å½• user haproxy group haproxy daemon # å®ˆæŠ¤è¿›ç¨‹è¿è¡Œ #nbproc 1 # è¿›ç¨‹æ•°é‡ï¼Œåªèƒ½ç”¨äºå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼çš„haproxyï¼›é»˜è®¤å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸€èˆ¬åªåœ¨å•è¿›ç¨‹ä»…èƒ½æ‰“å¼€å°‘æ•°æ–‡ä»¶æè¿°ç¬¦çš„åœºæ™¯ä¸­æ‰ä½¿ç”¨å¤šè¿›ç¨‹æ¨¡å¼ï¼› pidfile /var/run/haproxy.pid # pidæ–‡ä»¶çš„å­˜æ”¾ä½ç½® defaultsé»˜è®¤é…ç½® defaults mode http #é»˜è®¤è´Ÿè½½å‡è¡¡æ¨¡å¼ä¸ºhttp log global #æ—¥å¿—å®šä¹‰ option httplog #å¯ç”¨æ—¥å¿—è®°å½•HTTPè¯·æ±‚ï¼Œé»˜è®¤ä¸è®°å½•http log option dontlognull #ä¸è®°å½•ç©ºæ—¥å¿— option httpclose # æ¯æ¬¡è¯·æ±‚å®Œæ¯•åä¸»åŠ¨å…³é—­httpé€šé“ option forwardfor except 127.0.0.0/8 #æ’å…¥x-forwardæ ‡è®°ï¼Œåå‘ä»£ç†æ—¶å€™å¯ä»¥é€šè¿‡è¯¥å­—æ®µè·å–å®¢æˆ·ç«¯çœŸå®IP balance roundrobin # è´Ÿè½½å‡è¡¡ç®—æ³•,è½®è¯¢ retries 3 # å®šä¹‰è¿æ¥åç«¯æœåŠ¡å™¨çš„å¤±è´¥é‡è¿æ¬¡æ•° timeout http-request 10sï¼š#åœ¨å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ä½†ä¸è¯·æ±‚æ•°æ®æ—¶ï¼Œå…³é—­å®¢æˆ·ç«¯è¿æ¥ timeout queue 1m : #æœåŠ¡å™¨çš„maxconnæ—¶ï¼Œè¿æ¥åœ¨é˜Ÿåˆ—ä¸­ä¿æŒæŒ‚èµ·çŠ¶æ€è€Œè®¾ç½®çš„è¶…æ—¶æ—¶é—´ï¼Œæƒ³å®¢æˆ·ç«¯è¿”å›503é”™è¯¯ timeout connect 10sï¼š #å®šä¹‰haproxyå°†å®¢æˆ·ç«¯è¯·æ±‚è½¬å‘è‡³åç«¯æœåŠ¡å™¨æ‰€ç­‰å¾…çš„è¶…æ—¶æ—¶é•¿ timeout client 1mï¼š#å®¢æˆ·ç«¯éæ´»åŠ¨çŠ¶æ€çš„è¶…æ—¶æ—¶é•¿ timeout server 1mï¼š#å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯å»ºç«‹è¿æ¥åï¼Œç­‰å¾…æœåŠ¡å™¨ç«¯çš„è¶…æ—¶æ—¶é•¿ timeout http-keep-alive 10s: #å®šä¹‰ä¿æŒè¿æ¥çš„è¶…æ—¶æ—¶é•¿ timeout check 10s: #å¥åº·çŠ¶æ€ç›‘æµ‹æ—¶çš„è¶…æ—¶æ—¶é—´ï¼Œè¿‡çŸ­ä¼šè¯¯åˆ¤ï¼Œè¿‡é•¿èµ„æºæ¶ˆè€— maxconn 3000: #æ¯ä¸ªserveræœ€å¤§çš„è¿æ¥æ•° # è¶…æ—¶å‚æ•° timeout http request ï¼š#åœ¨å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ä½†ä¸è¯·æ±‚æ•°æ®æ—¶ï¼Œå…³é—­å®¢æˆ·ç«¯è¿æ¥ timeout queue ï¼š#ç­‰å¾…æœ€å¤§æ—¶é•¿ timeout connectï¼š #å®šä¹‰haproxyå°†å®¢æˆ·ç«¯è¯·æ±‚è½¬å‘è‡³åç«¯æœåŠ¡å™¨æ‰€ç­‰å¾…çš„è¶…æ—¶æ—¶é•¿ timeout clientï¼š#å®¢æˆ·ç«¯éæ´»åŠ¨çŠ¶æ€çš„è¶…æ—¶æ—¶é•¿ timeout serverï¼š#å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯å»ºç«‹è¿æ¥åï¼Œç­‰å¾…æœåŠ¡å™¨ç«¯çš„è¶…æ—¶æ—¶é•¿ï¼Œ timeout http-keep-alive ï¼š#å®šä¹‰ä¿æŒè¿æ¥çš„è¶…æ—¶æ—¶é•¿ timeout checkï¼š#å¥åº·çŠ¶æ€ç›‘æµ‹æ—¶çš„è¶…æ—¶æ—¶é—´ï¼Œè¿‡çŸ­ä¼šè¯¯åˆ¤ï¼Œè¿‡é•¿èµ„æºæ¶ˆè€— listené»˜è®¤é…ç½® # ç›‘å¬é¡µé¢é…ç½®listen admin_stats bind 0.0.0.0:50000 # ç›‘å¬IPå’Œç«¯å£ï¼Œä¸ºäº†å®‰å…¨å¯ä»¥è®¾ç½®æœ¬æœºçš„å±€åŸŸç½‘IPåŠç«¯å£ï¼› mode http option httplog # é‡‡ç”¨httpæ—¥å¿—æ ¼å¼ stats refresh 30s # ç»Ÿè®¡é¡µé¢è‡ªåŠ¨åˆ·æ–°æ—¶é—´ stats enable # å¯ç”¨çŠ¶æ€ç»Ÿè®¡æŠ¥å‘Š stats uri /stats # çŠ¶æ€ç®¡ç†é¡µé¢ï¼Œé€šè¿‡ ip+port/statsæ¥è®¿é—® å¦‚10.0.5.92:9999/stats stats realm \"LOGIN\" # å¯†ç æ¡†ä¸Šæ˜¾ç¤ºçš„æ–‡æœ¬ stats auth admin:psadmin # ç»Ÿè®¡é¡µé¢ç”¨æˆ·åå’Œå¯†ç è®¾ç½® stats hide-version # éšè—ç»Ÿè®¡é¡µé¢ä¸ŠHAProxyçš„ç‰ˆæœ¬ä¿¡æ¯ #errorfile 403 /usr/local/haproxy/examples/errorfiles/ #è®¾ç½®haproxy é”™è¯¯é¡µé¢ stats admin_stats if TRUE #å¦‚æœè®¤è¯é€šè¿‡å°±åšç®¡ç†åŠŸèƒ½ï¼Œå¯ä»¥ç®¡ç†åç«¯çš„æœåŠ¡å™¨ å‰ç«¯é…ç½® frontend http_main bind 0.0.0.0:80 # httpè¯·æ±‚çš„ç«¯å£ï¼Œä¼šè¢«è½¬å‘åˆ°è®¾ç½®çš„ipåŠç«¯å£ # bind :80 # ç›‘å¬æœ¬æœºæ‰€æœ‰ip80ç«¯å£ # bind *:80 # bind 192.168.12.1:8080,10.1.0.12:8090 # è½¬å‘è§„åˆ™ #acl url_yuming path_beg www.yuming.com #use_backend server_yuming if url_yuming # é»˜è®¤è·³è½¬é¡¹ï¼Œå½“ä¸Šé¢éƒ½æ²¡æœ‰åŒ¹é…ä¸Šï¼Œå°±è½¬åˆ°backendçš„http_defaultä¸Šï¼› default_backend http_default # æå‡å¤±è´¥çš„æ—¶å€™çš„ç”¨æˆ·ä½“éªŒ #errorfile 502 /usr/local/haproxy/examples/errorfiles/502.http #errorfile 503 /usr/local/haproxy/examples/errorfiles/503.http #errorfile 504 /usr/local/haproxy/examples/errorfiles/504.http åç«¯é…ç½® backend http_default # é¢å¤–çš„ä¸€äº›è®¾ç½®ï¼ŒæŒ‰éœ€ä½¿ç”¨ option forwardfor option forwardfor header Client-IP option http-server-close option httpclose # è´Ÿè½½å‡è¡¡æ–¹å¼ #source æ ¹æ®è¯·æ±‚æºIP #static-rr æ ¹æ®æƒé‡ #leastconn æœ€å°‘è¿æ¥å…ˆå¤„ç†;åœ¨æœ‰ç€è¾ƒé•¿æ—¶é—´ä¼šè¯çš„åœºæ™¯ä¸­æ¨èä½¿ç”¨æ­¤ç®—æ³•ï¼Œå¦‚LDAPã€SQLç­‰ï¼Œå…¶å¹¶ä¸å¤ªé€‚ç”¨äºè¾ƒçŸ­ä¼šè¯çš„åº”ç”¨å±‚åè®®ï¼Œå¦‚HTTPï¼›æ­¤ç®—æ³•æ˜¯åŠ¨æ€çš„ï¼Œ #uri æ ¹æ®è¯·æ±‚çš„uri #url_param æ ¹æ®è¯·æ±‚çš„urlå‚æ•° #rdp-cookie æ®æ®cookie(name)æ¥é”å®šå¹¶å“ˆå¸Œæ¯ä¸€æ¬¡è¯·æ±‚ #hdr(name) æ ¹æ®HTTPè¯·æ±‚å¤´æ¥é”å®šæ¯ä¸€æ¬¡HTTPè¯·æ±‚ #roundrobin è½®è¯¢æ–¹å¼ balance roundrobin # è´Ÿè½½å‡è¡¡çš„æ–¹å¼,è½®è¯¢æ–¹å¼ # è®¾ç½®å¥åº·æ£€æŸ¥é¡µé¢ #option httpchk GET /index.html #ä¼ é€’å®¢æˆ·ç«¯çœŸå®IP option forwardfor header X-Forwarded-For # éœ€è¦è½¬å‘çš„ipåŠç«¯å£ # inter 2000 å¥åº·æ£€æŸ¥æ—¶é—´é—´éš”2ç§’ # rise 3 æ£€æµ‹å¤šå°‘æ¬¡æ‰è®¤ä¸ºæ˜¯æ­£å¸¸çš„ # fall 3 å¤±è´¥å¤šå°‘æ¬¡æ‰è®¤ä¸ºæ˜¯ä¸å¯ç”¨çš„ # weight 30 æƒé‡ server node1 192.168.1.101:8080 check inter 2000 rise 3 fall 3 weight 30 server node2 192.168.1.101:8081 check inter 2000 rise 3 fall 3 weight 30 å¸¸ç”¨å‚æ•°bind ç”¨äºç›‘å¬ bind []: [,...] [param*] # ä»…åœ¨frontendå’ŒlistenåŒºåŸŸä½¿ç”¨bind 0.0.0.0:80 # httpè¯·æ±‚çš„ç«¯å£ï¼Œä¼šè¢«è½¬å‘åˆ°è®¾ç½®çš„ipåŠç«¯å£ # bind :80 # ç›‘å¬æœ¬æœºæ‰€æœ‰ip80ç«¯å£ # bind *:80 # bind 192.168.12.1:8080,10.1.0.12:8090 å•å°haproxy+ä¸¤å°RSæœåŠ¡å™¨é…ç½®haproxy æœåŠ¡å™¨ 10.0.5.93RS æœåŠ¡å™¨1 10.0.5.90RS æœåŠ¡å™¨2 10.0.5.91 åˆå§‹åŒ–å‡†å¤‡å¦‚æœå¯¹é˜²ç«å¢™æ²¡æœ‰å¤ªå¤§çš„è¦æ±‚ï¼Œå¯ä»¥ç›´æ¥å…³é—­é˜²æŠ¤å¢™ æ‰€æœ‰æœºå™¨éƒ½å…³é—­ # å…³é—­é˜²ç«å¢™systemctl stop firewalldsystemctl status firewalld# å®‰è£…haproxyyum install haproxy -y# é…ç½®vi /etc/haproxy/haproxy.cfg haproxyæœåŠ¡å™¨ DS # åŸºç¡€é…ç½®global log 127.0.0.1 local0 chroot /var/lib/haproxy pidfile /var/run/haproxy.pid maxconn 4000 user haproxy group haproxy daemon stats socket /var/lib/haproxy/statsdefaults mode http log global option httplog option dontlognull option http-server-close option forwardfor except 127.0.0.0/8 option redispatch retries 3 balance roundrobin timeout http-request 10s timeout queue 1m timeout connect 10s timeout client 1m timeout server 1m timeout http-keep-alive 10s timeout check 10s maxconn 3000 # å¼€å¯ç›‘å¬ç«¯å£listen Status # åå­—éšä¾¿ç”¨ bind 10.0.5.93:9999 # ç»‘å®šç›‘å¬ç«¯å£ mode http stats enable stats uri /stats stats realm \"LOGIN\" stats refresh 6s stats auth upyun:upyun123# ç«¯å£è½¬å‘listen web_server # åå­—éšä¾¿ç”¨ mode tcp #é‡‡ç”¨7å±‚æ¨¡å¼ bind *:7777 # è½¬å‘ç«¯å£ è¯·æ±‚7777 -> RS:8888 ä¸Šé¢ å› æ­¤è¿™é‡Œçš„*:7777 å¯åšvip -> keepalive balance roundrobin #è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œè¿™é‡Œæ˜¯è½®æ¢ # è½®è¯¢ç®—æ³• #option httpchk GET /test.test #å¥åº·æ£€æµ‹ # å¥åº·æ£€æµ‹ server web1 10.0.5.91:8888 weight 3 check inter 500 fall 3 server web2 10.0.5.90:8888 weight 2 check inter 500 fall 3 æŸ¥çœ‹haproxy ç›‘å¬ç«¯çŠ¶æ€ä¸æ–­è¯·æ±‚10.0.5.93:7777 ä¼šå‘ç°ipä¼šåœ¨90 ä¸91 ä¹‹é—´ä¸æ–­æ”¹å˜ï¼Œå› ä¸ºæˆ‘ä»¬é‡‡ç”¨äº†è½®è¯¢çš„æœºåˆ¶ï¼Œç›¸åº”çš„å›¾ä¸­web totalä¹Ÿä¼šä¸æ–­å¢åŠ  while 1; do curl http://10.0.5.93:7777/|grep \"< h2 >.*< /h2 >\" ;sleep 1; done over keepalive+haproxyå°±æ˜¯åœ¨ä¸Šé¢çš„å•å°haproxyæœºå™¨ä¸Š æ·»åŠ ä¸€å°haproxyæœºå™¨ï¼ŒåŒæ—¶åˆ©ç”¨keepalivedçš„ç‰¹æ€§ï¼Œä½¿ç”¨vipåœ¨ä¸¤å°haproxyæœºå™¨ä¸Šæ¼‚ç§»ï¼Œæ— è®ºvipæ¼‚ç§»åˆ°å“ªä¸ªåœ°æ–¹ï¼Œéƒ½æœ‰å¯¹åº”çš„haproxyæœºå™¨å»å¯¹ä¸‹é¢çš„ä¸¤å°RSæœºå™¨è¿›è¡Œè´Ÿè½½å‡è¡¡ keepalive æé«˜ haproxyçš„ç¨³å®šæ€§haproxy æé«˜ RSçš„ç¨³å®šæ€§ é…ç½®DS1 keepalive + haproxy 10.0.5.93DS2 keepalive + haproxy 10.0.5.92 RS1 10.0.5.91RS2 10.0.5.90 VIP 10.0.5.96ç›‘æ§ç«¯å£ 10.0.5.96:9999/statsVIPç«¯å£ 10.0.5.96:8888 â€”- > 10.0.5.91:8888 DS1 keepaliveé…ç½® # å£°æ˜ä¸€ä¸‹èº«ä»½å’Œvipå°±é†’äº†! Configuration File for keepalivedglobal_defs { router_id LVS_DEVEL}vrrp_instance VI_1 { state MASTER interface eno1 virtual_router_id 51 priority 1000 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 10.0.5.96/20 }} DS2 keepalivedé…ç½® ! Configuration File for keepalivedglobal_defs { router_id LVS_DEVEL}vrrp_instance VI_1 { state BACKUP interface eno1 virtual_router_id 51 priority 10 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 10.0.5.96/20 }} è¿™æ—¶å€™ä½ å¯ä»¥å…ˆæµ‹è¯•ä¸€ä¸‹keepalivedæ˜¯å¦æˆåŠŸï¼Œä¸¤è¾¹å¼€èµ·æ¥ï¼Œç„¶åå…³æ‰DS-masteræœºå™¨ï¼Œå¦‚æœVIPæ¼‚ç§»åˆ°DS-BACKUPä¸Šé¢åˆ™è¡¨ç¤ºæˆåŠŸ DS1 haproxyé…ç½® ä¸ DS2 haproxyç›¸åŒ global log 127.0.0.1 local0 chroot /var/lib/haproxy pidfile /var/run/haproxy.pid maxconn 4000 user haproxy group haproxy daemon stats socket /var/lib/haproxy/statsdefaults mode http log global option httplog option dontlognull option http-server-close option forwardfor except 127.0.0.0/8 option redispatch retries 3 balance roundrobin timeout http-request 10s timeout queue 1m timeout connect 10s timeout client 1m timeout server 1m timeout http-keep-alive 10s timeout check 10s maxconn 3000# ç›‘å¬ç«¯å£listen Status bind 10.0.5.96:9999 mode http stats enable stats uri /stats stats realm \"LOGIN\" stats refresh 6s stats auth upyun:upyun123# è¿™ä¸ª80ç«¯å£æœ‰ä»€ä¹ˆç”¨listen web_server mode tcp #é‡‡ç”¨7å±‚æ¨¡å¼ bind *:7777 balance roundrobin #è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œè¿™é‡Œæ˜¯è½®æ¢ #option httpchk GET /test.test #å¥åº·æ£€æµ‹ server web1 10.0.5.91:8888 weight 3 check inter 500 fall 3 server web2 10.0.5.90:8888 weight 2 check inter 500 fall 3 RSæœºå™¨å°†VIPå†™å…¥å›æºåœ°å€ ifconfig enp4s0:0 10.0.5.96 broadcast 10.0.5.96 netmask 255.255.240.0 up å¦å¤–ï¼Œå½“æˆ‘åˆ‡æ–­master-keepalivedçš„æ˜¯å¦ï¼Œä¼šæœ‰ä¸€å®šæ—¶é—´çš„å»¶è¿Ÿ","link":"/posts/14c89e63/"},{"title":"ç”µå•†åå°ç®¡ç†ç³»ç»Ÿ(vue)-loginæ¨¡å—","text":"loginæ¨¡å— loginæ¨¡å—ç™»é™†éªŒè¯åŠŸèƒ½element-uiä¸ºæˆ‘ä»¬æä¾›äº†è‰¯å¥½çš„éªŒè¯åŠŸèƒ½æ¨¡å— åœ¨el-formä¸­ç»‘å®šrules ç¼–å†™è§„åˆ™ å¯¹åº”è¾“å…¥æ¡†æŒ‡å®špropä¼ å‡ºä¿¡æ¯ ç™»é™† é‡ç½® export default { data() { return { form: { username: \"admin\", password: \"admin\" }, // å®šä¹‰è§„åˆ™ rules: { username: [ // ç©ºéªŒè¯å’Œæ ¼å¼éªŒè¯ { required: true, message: 'é”™è¯¯', trigger: 'blur' }, { min: 3, max: 5, message: 'é•¿åº¦åœ¨ 3 åˆ° 5 ä¸ªå­—ç¬¦', trigger: 'blur' } ], password: [ { required: true, message: 'é”™è¯¯', trigger: 'blur' }, { min: 3, max: 5, message: 'é•¿åº¦åœ¨3åˆ°5ä¸ªå­—ç¬¦',trigger: 'blur'} ], } }; }};#app { background-color: #2b4b6b; height: 100%;}.login_box { width: 450px; height: 300px; background-color: #fff; border-radius: 3px; position: absolute; left: 50%; right: 50%; top: 50%; transform: translate(-50%, -50%);}.login_form{ position: absolute; bottom: 0; width: 100%; padding: 0 20px; box-sizing: border-box;}.btns { display: flex; justify-content: flex-end;} é‡ç½®è¡¨å• resetFieldsä½¿ç”¨refå£°æ˜å¯¹è±¡åç§°ç»™æ ‡ç­¾æ·»åŠ ref å†™æˆæ–¹æ³•ï¼Œä¼ é€’refnameåˆ°scriptä¸­ é‡ç½® é‡ç½®è¡¨å• methods: { //é‡ç½®formè¡¨æ ¼ resetForms(loginform) { this.$refs[loginform].resetFields(); } è¡¨å•é¢„éªŒè¯ vaildateç»™æ ‡ç­¾æ·»åŠ ref å†™æˆæ–¹æ³•ï¼Œä¼ é€’refnameåˆ°scriptä¸­ ç™»é™† ç™»é™†è¡¨å• methods: { //ç™»é™†formè¡¨æ ¼ login(editForm){ this.$refs[editForm].validate(vaild => { console.log(vaild) }); } æ¶ˆæ¯æç¤ºmessageå±€éƒ¨å¼•ç”¨messageç»„ä»¶ import { Message } from 'element-ui'Vue.prototype.$message = Message æ ‡ç­¾ç»‘å®šå±æ€§ ç™»é™† é‡ç½® scriptä¸­ç¼–å†™é€»è¾‘ this.$message.success(\"ç™»é™†æˆåŠŸ\"); å‰ç«¯è·å–tokenå­˜æ”¾ methods: { //é‡ç½®formè¡¨æ ¼ resetForms(editForm) { //æ ¹æ®refsè·å–å®ä¾‹å¯¹è±¡ï¼Œå¾—åˆ°å¯¹è±¡ä»¥åè°ƒç”¨element-uiæ–¹æ³•é‡ç½®å­—æ®µ this.$refs[editForm].resetFields(); this.$message.success(\"é‡ç½®æˆåŠŸ\"); }, login(editForm) { // è·å–å¯¹è±¡å†…å®¹ï¼Œæ ¹æ®çŠ¶æ€ç éªŒè¯æ˜¯å¦ç™»é™†æˆåŠŸï¼Œå¹¶è¿”å›æ¶ˆæ¯å¼¹çª— this.$refs[editForm].validate(async vaild => { if (!vaild) return; const { data: data, status: status } = await this.$http.post( \"login/\", this.form ); //è¿™é‡Œæœ‰ä¸ªbug ä¸åº”è¯¥æ˜¯ç›´æ¥æ‹¿çš„statusçŠ¶æ€ç æ¥çœ‹ï¼Œè€Œæ˜¯åº”è¯¥åº”è¯¥æ‹¿åˆ°resultè¿”å›æ•°æ®ä¸­çš„statusæ¥çœ‹ï¼Œç”±äºå‰é¢æ¥å£æ²¡æœ‰å†™å¥½ï¼Œæ‰€ä»¥è¿™é‡Œåªèƒ½æ ¹æ®æµè§ˆå™¨è¿”å›çš„statusæ¥çœ‹ if (status != 200) return this.$message.error(\"ç™»é™†å¤±è´¥\"); this.$message.success(\"ç™»é™†æˆåŠŸ\"); window.sessionStorage.setItem(\"token\", data.token); //å­˜æ”¾token this.$router.push(\"/home\"); }); } }}; è·¯ç”±å¯¼èˆªæƒé™è·¯ç”±å¯¼èˆªå®ˆå«æ§åˆ¶è®¿é—®æƒé™å¦‚æœç”¨æˆ·æ²¡æœ‰ç™»é™†ï¼Œä½†æ˜¯ç›´æ¥é€šè¿‡URLè®¿é—®ç‰¹å®šé¡µé¢ï¼Œéœ€è¦é‡æ–°å¯¼èˆªåˆ°ç™»é™†é¡µé¢ åŸæ¥çš„è·¯ç”±å¯¼èˆª const routes = [ { path: '/' , redirect: '/login'}, { path: '/login' ,component: Login }, { path: '/home',component: Home}] ä¿®æ”¹æˆè·¯ç”±å¯¼èˆªå®ˆå«å //router.jsconst routes = [ { path: '/' , redirect: '/login'}, { path: '/login' ,component: Login }, { path: '/home',component: Home}]const router = new VueRouter({ mode: 'history', // base: process.env.BASE_URL, routes})// æŒ‚è½½è·¯ç”±å¯¼èˆªå®ˆå«router.beforeEach((to,form,next) => { // to å°†è¦è®¿é—®çš„è·¯å¾„ // from ä»£è¡¨ä»é‚£ä¸ªè·¯å¾„è·³è½¬è¿‡æ¥ // next æ˜¯ä¸€ä¸ªå‡½æ•°,è¡¨ç¤ºæ”¾è¡Œ // next() æ”¾è¡Œ next('/login') å¼ºåˆ¶è·³è½¬ if (to.path === '/login') return next() //è·å–token const tokenStr = window.sessionStorage.getItem('token') if(!tokenStr) return next('/login') next()})export default router ç™»é™†ä¸æ³¨é”€åŸºäºtokençš„æ–¹å¼å®ç°é€€å‡ºæ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦æœ¬åœ°çš„tokenå³å¯ï¼Œè¿™æ ·ï¼Œåç»­çš„è¯·æ±‚å°±ä¸ä¼šæºå¸¦tokenï¼Œå¿…é¡»é‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„tokenä¹‹åæ‰å¯ä»¥è®¿é—®é¡µé¢ /home é€€å‡º export default { methods:{ Userexit(){ window.sessionStorage.clear(); this.$router.push('/login'); this.$message.success(\"é€€å‡ºæˆåŠŸ\"); } }};","link":"/posts/4dba38f8/"},{"title":"keepalive+lvs å››å±‚è´Ÿè½½å‡è¡¡","text":"å…³é”®è¯LB (Load Balancer è´Ÿè½½å‡è¡¡)HA (High Available é«˜å¯ç”¨)Failover (å¤±è´¥åˆ‡æ¢)Cluster (é›†ç¾¤)LVS (Linux Virtual Server Linux è™šæ‹ŸæœåŠ¡å™¨)DS (Director Server)ï¼ŒæŒ‡çš„æ˜¯å‰ç«¯è´Ÿè½½å‡è¡¡å™¨èŠ‚ç‚¹RS (Real Server)ï¼Œåç«¯çœŸå®çš„å·¥ä½œæœåŠ¡å™¨VIP (Virtual IP)ï¼Œè™šæ‹Ÿçš„ IP åœ°å€ï¼Œå‘å¤–éƒ¨ç›´æ¥é¢å‘ç”¨æˆ·è¯·æ±‚ï¼Œä½œä¸ºç”¨æˆ·è¯·æ±‚çš„ç›®æ ‡çš„ IP åœ°å€DIP (Director IP)ï¼Œä¸»è¦ç”¨äºå’Œå†…éƒ¨ä¸»æœºé€šè®¯çš„ IP åœ°å€RIP (Real Server IP)ï¼Œåç«¯æœåŠ¡å™¨çš„ IP åœ°å€CIP (Client IP)ï¼Œè®¿é—®å®¢æˆ·ç«¯çš„ IP åœ°å€ ä»…ä½¿ç”¨lvså•èŠ‚ç‚¹lvs ã€ vip ä¸¤å°RSæœåŠ¡å™¨ vip: 10.0.5.97/20lvs-director: 10.0.5.92RS1: 10.0.5.90RS2: 10.0.5.91 åœ¨lvsä¸Šè¿›è¡Œæ“ä½œ # å®‰è£…lvsyum install ipvsadm -y # å®‰è£…net-toolsyum install net-tools# åœ¨ç½‘å¡ä¸Šç»‘å®švipifconfig eno1:0 10.0.5.97 broadcast 10.0.5.97 netmask 255.255.240.0 up# æ·»åŠ è·¯ç”±route add -host 10.0.5.97 dev eno1# å¯ç”¨ç³»ç»Ÿçš„åŒ…è½¬å‘åŠŸèƒ½echo \"1\" > /proc/sys/net/ipv4/ip_forward# æ¸…ç©ºç³»ç»Ÿä¹‹å‰æ‰€æœ‰çš„ipvsadmè§„åˆ™ipvsadm --clearipvsadm -C# å¢åŠ è™šæ‹Ÿip (-s rr è¡¨è¿°è½®è¯¢)ipvsadm -A -t 10.0.5.97:8888 -s rr# ipvsadm -D -t 10.0.5.97:8888 # åˆ é™¤è§„åˆ™# æ·»åŠ æœåŠ¡å¯¹è±¡ -gè¡¨ç¤ºå·¥ä½œæ¨¡å¼ä¸ºç›´æ¥è·¯ç”± ç«¯å£å¿…é¡»ä¸€è‡´ipvsadm -a -t 10.0.5.97:8888 -r 10.0.5.91:8888 -gipvsadm -a -t 10.0.5.97:8888 -r 10.0.5.92:8888 -g åœ¨RSæœºä¸Šè¿›è¡Œæ“ä½œ # //RS1# ç»‘å®šVIP ifconfig eno1:0 10.0.5.91 broadcast 10.0.5.91 netmask 255.255.240.0 up# æ·»åŠ è·¯ç”±route add -host 10.0.5.91 dev eno1:0#//RS2 åŒ lvsæ­å»ºæˆåŠŸåæŸ¥çœ‹æ­å»ºçŠ¶æ€ [root@lvs-web1 ~]# ipvsadm -lnIP Virtual Server version 1.2.1 (size=4096)Prot LocalAddress:Port Scheduler Flags -> RemoteAddress:Port Forward Weight ActiveConn InActConnTCP 10.0.5.97:8888 rr -> 10.0.5.90:8888 Route 1 0 0 -> 10.0.5.91:8888 Route 1 0 0 å½“ä½ è®¿é—®VIPåœ°å€çš„æ—¶å€™ï¼ŒVIPä¼šæŒ‡å‘å…¶æ‰€æœåŠ¡çš„ä¸¤ä¸ªçœŸå®IPåœ°å€ åœ¨è½®è¯¢æ¨¡å¼ä¸‹ï¼Œä¸€å®šæ—¶é—´åæŒ‡å‘å¦ä¸€ä¸ªip å•èŠ‚ç‚¹lvså¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼Œéœ€è¦ä½¿ç”¨Keepalive+lvs ä»…ä½¿ç”¨keepaliveä¸ä½¿ç”¨RSæœåŠ¡å™¨ï¼Œä»…ä½¿ç”¨ä¸¤å°DSæœåŠ¡å™¨æµ‹è¯•vipåœ¨ä¸¤å°DSä¹‹é—´ä¿æŒæ´»æ€§çš„è¿‡ç¨‹ç›®çš„â€”-> ä¿è¯vipçš„æ´»æ€§ vip 10.0.5.96DS1: 10.0.5.93DS2: 10.0.5.90 åœ¨DS-Masteræœºå™¨ä¸Šæ“ä½œ # å®‰è£…keepalivedyum install keepalived# ä¿®æ”¹é…ç½®æ–‡ä»¶! Configuration File for keepalivedglobal_defs { //å…¨å±€é…ç½® notification_email { //é€šçŸ¥é‚®ä»¶ï¼Œ å½“keepalivedä¸­masterå’Œbackupèº«ä»½æ”¹å˜çš„æ˜¯å¦ä¼šå‘é€é‚®ä»¶ acassen@firewall.loc failover@firewall.loc sysadmin@firewall.loc } notification_email_from Alexandre.Cassen@firewall.loc smtp_server 192.168.200.1 smtp_connect_timeout 30 router_id LVS_DEVEL_master // é›†ç¾¤åå­— vrrp_skip_check_adv_addr vrrp_strict vrrp_garp_interval 0 vrrp_gna_interval 0}vrrp_instance VI_1 { //vrrpå®ä¾‹ + åå­—(åŒé›†ç¾¤åå­—éœ€è¦ç›¸åŒ) state MASTER // å½“å‰æœºå™¨èº«ä»½ åªèƒ½æœ‰ä¸€ä¸ªmaster interface enp10s0 //å½“å‰ç½‘ç»œæ¥å£ virtual_router_id 51 // è™šæ‹Ÿè·¯ç”±åºå· ä¸»ä»éœ€è¦ç›¸åŒ priority 100 // ä¼˜å…ˆçº§åˆ« ä¸»> ä» advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { //è™šæ‹Ÿip 10.0.5.96/20 }} åœ¨DS-Backupæœºå™¨ä¸Šçš„æ“ä½œ # å®‰è£…keepalivedyum install keepalived# ä¿®æ”¹é…ç½®æ–‡ä»¶! Configuration File for keepalivedglobal_defs { notification_email { acassen@firewall.loc failover@firewall.loc sysadmin@firewall.loc } notification_email_from Alexandre.Cassen@firewall.loc smtp_server 192.168.200.1 smtp_connect_timeout 30 router_id LVS_DEVEL vrrp_skip_check_adv_addr vrrp_strict vrrp_garp_interval 0 vrrp_gna_interval 0}vrrp_instance VI_1 { state BACKUP // DS-backupæœºå™¨ interface eno1 virtual_router_id 51 priority 10 //ä¼˜å…ˆçº§åˆ« advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 10.0.5.96/20 }} ä¸»ä»æœºå™¨å¯åŠ¨keepalivedå å¯ä»¥å‘ç°ç°åœ¨çš„vipæ˜¯åœ¨DS-masterä¸Šçš„ï¼Œä¸ºäº†éªŒè¯masterä¸»æœºå‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œvipä¼šæ¼‚ç§»åˆ°DS-backupçš„ç°è±¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨masterå…³é—­keepalivedä»¥ä¸Šï¼Œå½“masterå‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œbackupæœºå™¨ä¸Šå‡ºç°vipï¼Œä»è€Œä¿è¯vipçš„æ´»æ€§ï¼Œä»¥æ­¤æ¥ä¿è¯lvsçš„ç¨³å®šæ€§ å¦å¤–ï¼Œå½“masteræœºå™¨å†æ¬¡é‡å¯çš„æ—¶å€™ï¼Œvipåˆä¼šé£˜å›åˆ°masterèº«ä¸Š keepalive+lvs ä¸»ä»æ–¹å¼é«˜å¯ç”¨ä¸»ä»æ¨¡å¼éœ€è¦å‡†å¤‡å››å°æœåŠ¡å™¨ï¼Œå‡å¼€å¯httpdæœåŠ¡ é…ç½® vip 10.0.5.96DS1: 10.0.5.90 lvs-masterDS2: 10.0.5.93 lvs-slaveRS1: 10.0.5.91 lvs-web1RS2: 10.0.5.92 lvs-web2 # æµ‹è¯•ping lvs-master é¦–å…ˆä¿è¯ 90 93ä¸¤å°æœºå™¨çš„keepaliveæ­å»ºæˆåŠŸï¼Œé…ç½®å‚è€ƒä¸Šé¢çš„keepalived Keepalivedä¸»å¤‡é…ç½®æ–‡ä»¶åŒºåˆ«ï¼š 01. router_id ä¿¡æ¯ä¸ä¸€è‡´ 02. state çŠ¶æ€æè¿°ä¿¡æ¯ä¸ä¸€è‡´ 03. priority ä¸»å¤‡ç«é€‰ä¼˜å…ˆçº§æ•°å€¼ä¸ä¸€è‡´ masteræœºå™¨ä¸Šé…ç½®lvs vi /etc/keepalived/keepalived.confvirtual_server 10.0.5.96 8888 { //vip delay_loop 3 lb_algo rr // è´Ÿè½½å‡è¡¡æ¨¡å¼ rr--è½®è¯¢ lb_kind DR // è´Ÿè½½å‡è¡¡è¿æ¥å½¢å¼ ç›´è¿è·¯ç”± !persistence_timeout 50 protocol TCP real_server 10.0.5.91 8888 { weight 1 TCP_CHECK { connect_port 8888 //è¿æ¥ç«¯å£ connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } } real_server 10.0.5.92 8888 { weight 1 TCP_CHECK { connect_port 8888 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } }} backupæœºå™¨ä¸Šé…ç½®lvs vi /etc/keepalived/keepalived.confvirtual_server 10.0.5.96 8888 { delay_loop 3 lb_algo rr lb_kind DR !persistence_timeout 50 protocol TCP real_server 10.0.5.91 8888 { weight 1 TCP_CHECK { connect_port 8888 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } } real_server 10.0.5.92 8888 { weight 1 TCP_CHECK { connect_port 8888 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } }} RSæœºå™¨ä¸Šé…ç½®åªè¦æ˜¯ä½œä¸ºlvsæœåŠ¡çš„å¯¹è±¡ï¼Œè¿™äº›æ­¥éª¤éƒ½è¦åšï¼ŒåŒ…æ‹¬åé¢å¦‚æœæˆ‘ä»¬æŠŠds-masteræœºå™¨åœ¨ä½œä¸ºkeepalivedè°ƒåº¦æœºçš„åŒæ—¶ï¼Œä¹Ÿæä¾›webæœåŠ¡çš„æ—¶å€™ï¼Œå°±éœ€è¦åšè¿™äº›æ­¥éª¤ # ç»‘å®šVIPifconfig lo:0 10.0.5.96 netmask 255.255.240.0 broadcast 10.0.5.96 up # æ·»åŠ è·¯ç”±route add -host 10.0.5.96 dev lo:0# æŠ‘åˆ¶arpecho 2 > /proc/sys/net/ipv4/conf/all/arp_announce echo 2 > /proc/sys/net/ipv4/conf/lo/arp_announceecho 1 > /proc/sys/net/ipv4/conf/all/arp_ignoreecho 1 >/proc/sys/net/ipv4/conf/lo/arp_ignore ## æ°¸ä¹…æŠ‘åˆ¶arpvi /etc/sysctl.confnet.ipv4.conf.lo.arp_ignore = 1net.ipv4.conf.lo.arp_announce = 2net.ipv4.conf.all.arp_ignore = 1net.ipv4.conf.all.arp_announce = 2 åŒæ—¶å¯åŠ¨keepalivedï¼ŒæŸ¥çœ‹lvsè¿æ¥çŠ¶æ€ systemctl start keepalivedipvsadm -ln[root@localhost ~]# ipvsadm -lnIP Virtual Server version 1.2.1 (size=4096)Prot LocalAddress:Port Scheduler Flags -> RemoteAddress:Port Forward Weight ActiveConn InActConnTCP 10.0.5.96:8888 rr -> 10.0.5.91:8888 Route 1 0 0 -> 10.0.5.92:8888 Route 1 0 0 while 1; do curl http://10.0.5.96:8888/| grep '< h2 >.* ' ;sleep 1; done å¯ä»¥çœ‹åˆ° åŒä¸»æ–¹å¼äº’ä¸ºä¸»ä»ï¼šä¸»ä»éƒ½åœ¨å·¥ä½œï¼›å…¶ä¸­ä¸€ä¸ªå®•æœºäº†ï¼ŒVIPæ¼‚ç§»åˆ°å¦ä¸€ä¸ªä¸Šï¼Œæä¾›æœåŠ¡ é…ç½® vip1: 10.0.5.96vip2: 10.0.5.97RS1: 10.0.5.91RS2: 10.0.5.92DS1: 10.0.5.90DS2: 10.0.5.93 DS1 é…ç½®: ! Configuration File for keepalivedglobal_defs { router_id LVS_DEVEL_master}vrrp_instance VI_1 { state MASTER interface enp10s0 virtual_router_id 51 priority 100 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 10.0.5.96/20 }}virtual_server 10.0.5.96 8888 { delay_loop 3 lb_algo rr lb_kind DR protocol TCP real_server 10.0.5.91 8888 { weight 1 TCP_CHECK { connect_port 8888 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } } real_server 10.0.5.92 8888 { weight 1 TCP_CHECK { connect_port 8888 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } }}vrrp_instance VI_2 { state BACKUP interface enp10s0 virtual_router_id 52 priority 11 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 10.0.5.97/20 }}virtual_server 10.0.5.97 8888 { delay_loop 3 lb_algo rr lb_kind DR protocol TCP real_server 10.0.5.91 8888 { weight 1 TCP_CHECK { connect_port 8888 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } } real_server 10.0.5.92 8888 { weight 1 TCP_CHECK { connect_port 8888 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } }} DS2é…ç½® ! Configuration File for keepalivedglobal_defs { router_id LVS_DEVEL}vrrp_instance VI_1 { state BACKUP interface eno1 virtual_router_id 51 priority 10 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 10.0.5.96/20 }}virtual_server 10.0.5.96 8888 { delay_loop 3 lb_algo rr lb_kind DR protocol TCP real_server 10.0.5.91 8888 { weight 1 TCP_CHECK { connect_port 8888 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } } real_server 10.0.5.92 8888 { weight 1 TCP_CHECK { connect_port 8888 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } }}vrrp_instance VI_2 { state MASTER interface eno1 virtual_router_id 52 priority 101 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 10.0.5.97/20 }}virtual_server 10.0.5.97 8888 { delay_loop 3 lb_algo rr lb_kind DR protocol TCP real_server 10.0.5.91 8888 { weight 1 TCP_CHECK { connect_port 8888 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } } real_server 10.0.5.92 8888 { weight 1 TCP_CHECK { connect_port 8888 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } }}``` ä¸¤ä¸ªé…ç½®éƒ½å·®ä¸å¤šï¼Œæ— éå°±æ˜¯ä¸¤å°æœºå™¨éƒ½ä½œä¸ºå¯¹æ–¹æœºå™¨çš„Masterå’ŒBackupæœºå™¨ï¼ŒåŒæ—¶æ‹¥æœ‰ä¸¤ä¸ªvipï¼Œæ³¨æ„æƒé‡çš„å¤§å°RSä¸Šçš„é…ç½®```bash#é…ç½®VIPåˆ°æœ¬åœ°å›ç¯ç½‘å¡loä¸Šï¼Œå¹¶åªå¹¿æ’­è‡ªå·±ifconfig lo:0 172.17.100.100 broadcast 172.17.100.100 netmask 255.255.255.255 upifconfig lo:1 172.17.100.101 broadcast 172.17.100.101 netmask 255.255.255.255 up #é…ç½®æœ¬åœ°å›ç¯ç½‘å¡è·¯ç”±route add -host 172.17.100.100 lo:0route add -host 172.17.100.101 lo:1# å…³é—­arpvim /etc/sysctl.confnet.ipv4.conf.lo.arp_ignore = 1net.ipv4.conf.lo.arp_announce = 2net.ipv4.conf.all.arp_ignore = 1net.ipv4.conf.all.arp_announce = 2 æŸ¥çœ‹ç»“æœ å…³é—­å…¶ä¸­ä¸€ä¸ªDSæœºå™¨æ—¶ï¼Œå¦å¤–ä¸€å°DSæœºå™¨ä¸Šå‡ºç°ä¸‰ä¸ªIP ï¼Œè‡ªèº«IP+2ä¸ªVIP https://www.cnblogs.com/f-ck-need-u/p/8492298.html#2-keepalived-lvs- sorry_server å’Œlocal RSå¦‚æœRSéƒ½åœ¨åŒä¸€åˆ»downæ‰äº†çš„è¯ï¼Œå¤–ç•Œå°±æ— æ³•è®¿é—®ç½‘ç«™äº†ã€‚å› ä¸ºvipå·²ç»æ²¡æœ‰äº†RSçš„å»å¤„ï¼Œè¿™é‡Œæä¾›äº†ä¸¤ç§è§£å†³æ–¹æ³• ä½¿ç”¨keepalivedæ¥é…ç½®ä¸€ä¸ªæœåŠ¡é¡µé¢ã€‚ä¾‹å¦‚å‘Šè¯‰å¤–ç•Œå®¢æˆ·ç«¯ç½‘ç«™æ­£åœ¨ç»´æŠ¤çŠ¶æ€.ä½¿ç”¨sorry_server æ¥æŒ‡å‘ æŸä¸€ä¸ªip+ç«¯å£, å› ä¸ºæ˜¯åœ¨æ‰€æœ‰RSéƒ½å®•æœºçš„æƒ…å†µä¸‹sorry serveræä¾›çš„ä¸´æ—¶æœåŠ¡æ‰ç”Ÿæ•ˆï¼Œå› æ­¤é€šå¸¸å°†sorry serveré…ç½®åœ¨virtual_serverä¸­è€Œéreal_serverä¸­ã€‚ éœ€è¦åœ¨masterå’ŒbackupèŠ‚ç‚¹ä¸Šéƒ½é…ç½®sorry_server virtual_server 192.168.100.10 8888 { delay_loop 6 lb_algo wrr lb_kind DR protocol TCP sorry_server 127.0.0.1 8888# ä¹Ÿå¯ä»¥æŒ‡å‘æœ¬åœ°ï¼Œéœ€è¦å¼€å¯httpdæœåŠ¡ å¼€å¯keepalived ç„¶åå°†ä¸¤å°RSçš„æœºå™¨ä¸Šçš„httpdæœåŠ¡å…¨éƒ¨åœæ‰ï¼Œä¼šå‘ç°vipä¼šæ¼‚ç§»åˆ°ä¸¤å°DSä¸­çš„å…¶ä¸­ä¸€å°ä¸Š ä½¿ç”¨local RSå¯¹äºé›†ç¾¤ç³»ç»Ÿä¸å¤§çš„æƒ…å†µä¸‹ï¼ŒDS ä¸€èˆ¬ä¼šæ¯”è¾ƒç©ºé—²ï¼Œè¿™æ ·å°±æ¯”è¾ƒæµªè´¹èµ„æºã€‚è¿™æ—¶é€šå¸¸ä¼šå°†LVS Directorè‡ªèº«ä¹Ÿä½œä¸ºä¸€ä¸ªRSï¼Œä¸€è¾¹æä¾›webæœåŠ¡ï¼Œä¸€è¾¹æä¾›è°ƒåº¦åŠŸèƒ½ï¼Œä¸è¿‡åº”è¯¥å°†å®ƒçš„è°ƒåº¦æƒé‡è®¾ç½®ä½ä¸€ç‚¹ï¼Œä»¥å…å½±å“è´Ÿè½½å‡è¡¡çš„æ€§èƒ½ã€‚è¿™ç§°ä¸ºlocal RSï¼Œlocal RSçš„RIPå¯ä»¥å†™Directorä¸Šçš„ä»»æ„åœ°å€(127.0.0.1éƒ½å¯ä»¥)ã€‚ä¾‹å¦‚ï¼švirtual_server 192.168.100.10 8888 { .... real_server 127.0.0.1 8888 { weight 1 TCP_CHECK { connect_port 8888 connect_timeout 1 nb_get_retry 2 delay_before_retry 1 }}} ä¸¤ä¸ªä¸åº”è¯¥åŒæ—¶é…ç½®ï¼Œå› ä¸ºå¦‚æœlocal RS åäº†ï¼Œsorry serverè‚¯å®šæ— æ³•è°ƒåº¦ è„‘è£‚è§£å†³æ–¹æ³•åœ¨é«˜å¯ç”¨ï¼ˆHAï¼‰ç³»ç»Ÿä¸­ï¼Œå½“è”ç³»2ä¸ªèŠ‚ç‚¹çš„â€œå¿ƒè·³çº¿â€æ–­å¼€æ—¶ï¼Œæœ¬æ¥ä¸ºä¸€æ•´ä½“ã€åŠ¨ä½œåè°ƒçš„HAç³»ç»Ÿï¼Œå°±åˆ†è£‚æˆä¸º2ä¸ªç‹¬ç«‹çš„ä¸ªä½“ã€‚ç”±äºç›¸äº’å¤±å»äº†è”ç³»ï¼Œéƒ½ä»¥ä¸ºæ˜¯å¯¹æ–¹å‡ºäº†æ•…éšœã€‚ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šçš„HAè½¯ä»¶åƒâ€œè£‚è„‘äººâ€ä¸€æ ·ï¼Œäº‰æŠ¢â€œå…±äº«èµ„æºâ€ã€äº‰èµ·â€œåº”ç”¨æœåŠ¡â€ï¼Œå°±ä¼šå‘ç”Ÿä¸¥é‡åæœâ€”â€”æˆ–è€…å…±äº«èµ„æºè¢«ç“œåˆ†ã€2è¾¹â€œæœåŠ¡â€éƒ½èµ·ä¸æ¥äº†ï¼›æˆ–è€…2è¾¹â€œæœåŠ¡â€éƒ½èµ·æ¥äº†ï¼Œä½†åŒæ—¶è¯»å†™â€œå…±äº«å­˜å‚¨â€ï¼Œå¯¼è‡´æ•°æ®æŸåï¼ˆå¸¸è§å¦‚æ•°æ®åº“è½®è¯¢ç€çš„è”æœºæ—¥å¿—å‡ºé”™ï¼‰ã€‚ æ·»åŠ å†—ä½™çš„å¿ƒè·³çº¿ï¼Œä¾‹å¦‚ï¼šåŒçº¿æ¡çº¿ï¼ˆå¿ƒè·³çº¿ä¹ŸHAï¼‰ï¼Œå°½é‡å‡å°‘â€œè£‚è„‘â€å‘ç”Ÿå‡ ç‡ï¼› è®¾ç½®ä»²è£æœºåˆ¶ã€‚ä¾‹å¦‚è®¾ç½®å‚è€ƒIPï¼ˆå¦‚ç½‘å…³IPï¼‰ï¼Œå½“å¿ƒè·³çº¿å®Œå…¨æ–­å¼€æ—¶ï¼Œ2ä¸ªèŠ‚ç‚¹éƒ½å„è‡ªpingä¸€ä¸‹å‚è€ƒIPï¼Œä¸é€šåˆ™è¡¨æ˜æ–­ç‚¹å°±å‡ºåœ¨æœ¬ç«¯ã€‚ä¸ä»…â€œå¿ƒè·³â€ã€è¿˜å…¼å¯¹å¤–â€œæœåŠ¡â€çš„æœ¬ç«¯ç½‘ç»œé“¾è·¯æ–­äº†ï¼Œå³ä½¿å¯åŠ¨ï¼ˆæˆ–ç»§ç»­ï¼‰åº”ç”¨æœåŠ¡ä¹Ÿæ²¡æœ‰ç”¨äº†ï¼Œé‚£å°±ä¸»åŠ¨æ”¾å¼ƒç«äº‰ï¼Œè®©èƒ½å¤Ÿpingé€šå‚è€ƒIPçš„ä¸€ç«¯å»èµ·æœåŠ¡ã€‚æ›´ä¿é™©ä¸€äº›ï¼Œpingä¸é€šå‚è€ƒIPçš„ä¸€æ–¹å¹²è„†å°±è‡ªæˆ‘é‡å¯ï¼Œä»¥å½»åº•é‡Šæ”¾æœ‰å¯èƒ½è¿˜å ç”¨ç€çš„é‚£äº›å…±äº«èµ„æºã€‚ è„‘è£‚åŸå› ï¼š Keepalivedé…ç½®é‡ŒåŒä¸€ VRRPå®ä¾‹å¦‚æœ virtual_router_idä¸¤ç«¯å‚æ•°é…ç½®ä¸ä¸€è‡´ä¹Ÿä¼šå¯¼è‡´è£‚è„‘é—®é¢˜å‘ç”Ÿã€‚ RSä¸Šå¼€å¯äº† iptablesé˜²ç«å¢™é˜»æŒ¡äº†å¿ƒè·³æ¶ˆæ¯ä¼ è¾“ã€‚ é«˜å¯ç”¨æœåŠ¡å™¨ä¸Šå¿ƒè·³ç½‘å¡åœ°å€ç­‰ä¿¡æ¯é…ç½®ä¸æ­£ç¡®ï¼Œå¯¼è‡´å‘é€å¿ƒè·³å¤±è´¥ã€‚ å…¶ä»–æœåŠ¡é…ç½®ä¸å½“ç­‰åŸå› ï¼Œå¦‚å¿ƒè·³æ–¹å¼ä¸åŒï¼Œå¿ƒè·³å¹¿æ’å†²çªã€è½¯ä»¶Bugç­‰ è§£å†³: åšå¥½å¯¹è£‚è„‘çš„ç›‘æ§æŠ¥è­¦ï¼ˆå¦‚é‚®ä»¶åŠæ‰‹æœºçŸ­ä¿¡ç­‰æˆ–å€¼ç­ï¼‰.åœ¨é—®é¢˜å‘ç”Ÿæ—¶äººä¸ºç¬¬ä¸€æ—¶é—´ä»‹å…¥ä»²è£ï¼Œé™ä½æŸå¤±ã€‚ä¾‹å¦‚ï¼Œç™¾åº¦çš„ç›‘æ§æŠ¥è­¦çŸ­å€å°±æœ‰ä¸Šè¡Œå’Œä¸‹è¡Œçš„åŒºåˆ«ã€‚æŠ¥è­¦æ¶ˆæ¯å‘é€åˆ°ç®¡ç†å‘˜æ‰‹æœºä¸Šï¼Œç®¡ç†å‘˜å¯ä»¥é€šè¿‡æ‰‹æœºå›å¤å¯¹åº”æ•°å­—æˆ–ç®€å•çš„å­—ç¬¦ä¸²æ“ä½œè¿”å›ç»™æœåŠ¡å™¨.è®©æœåŠ¡å™¨æ ¹æ®æŒ‡ä»¤è‡ªåŠ¨å¤„ç†ç›¸åº”æ•…éšœï¼Œè¿™æ ·è§£å†³æ•…éšœçš„æ—¶é—´æ›´çŸ­. å¼ºè¡Œå…³é—­ä¸€ä¸ªèŠ‚ç‚¹ä¿è¯ï¼Œé¿å…äº‰å¤º æ£€æµ‹å½“å‰æœåŠ¡å™¨ä¸Šæ˜¯å¦å­˜åœ¨vip è¦èµ‹äºˆæ‰§è¡Œæƒé™ while truedoif [ `ip a show eth0 |grep 10.0.0.3|wc -l` -ne 0 ]then echo \"keepalived is error!\"else echo \"keepalived is OK !\"fidone è‡ªå®šä¹‰å¥åº·çŠ¶æ€æ£€æµ‹keepalivedå¯ä»¥é€šè¿‡è®¾ç½®vrrp_scriptè‡ªå®šä¹‰ # è‡ªå®šä¹‰VRRPå®ä¾‹å¥åº·æ£€æŸ¥è„šæœ¬ keepalivedåªèƒ½åšåˆ°å¯¹è‡ªèº«é—®é¢˜å’Œç½‘ç»œæ•…éšœçš„ç›‘æ§ï¼ŒScriptå¯ä»¥å¢åŠ å…¶ä»–çš„ç›‘æ§æ¥åˆ¤å®šæ˜¯å¦éœ€è¦åˆ‡æ¢ä¸»å¤‡vrrp_script chk_sshd { script \"killall -0 sshd\" # ç¤ºä¾‹ä¸ºæ£€æŸ¥sshdæœåŠ¡æ˜¯å¦è¿è¡Œä¸­ interval 2 # æ£€æŸ¥é—´éš”æ—¶é—´ weight -4 # æ£€æŸ¥å¤±è´¥é™ä½çš„æƒé‡} keepalivedè‡ªåŠ¨é…ç½®# /keepalived.conf! Configuration File for keepalivedglobal_defs {router_id SLB-SAD}vrrp_script chk_upyun { Â¦ Â¦ Â¦ script \"/etc/keepalived/bin/check_vip.sh\" Â¦ Â¦ Â¦ interval 3}vrrp_instance upyun_lb { Â¦ state MASTER Â¦ interface eth3 Â¦ virtual_router_id 20 Â¦ priority 100 Â¦ advert_int 1 Â¦ notify_master /etc/keepalived/bin/change_master.sh Â¦ notify_backup /etc/keepalived/bin/change_backup.sh Â¦ authentication { Â¦ Â¦ Â¦ auth_type PASS Â¦ Â¦ Â¦ auth_pass upyun.com Â¦ } Â¦ track_script { Â¦ Â¦ Â¦ chk_upyun Â¦ } Â¦ virtual_ipaddress { Â¦ Â¦ Â¦ 192.168.147.20 label eth3:9 Â¦ }} include /etc/keepalived/virserver.conf# virserver.confvirtual_server 192.168.147.20 8600 { Â¦ delay_loop 2 Â¦ lb_algo wrr Â¦ lb_kind DR Â¦ protocol UDP Â¦ #persistence_timeout 5 Â¦ real_server 192.168.13.250 8600 { Â¦ Â¦ Â¦ weight 1 Â¦ Â¦ Â¦ connect_port 8600 Â¦ Â¦ Â¦ connect_timeout 5 Â¦ Â¦ Â¦ nb_get_retry 1 Â¦ Â¦ Â¦ delay_before_retry 1 Â¦ }} çŠ¶æ€æ£€æµ‹è„šæœ¬ # check_backup # ä¿®æ”¹çŠ¶æ€ä»master-> backup æƒé‡ 100 -> 80 æ³¨é”€ notify_backup æ³¨é”€include echo \"--- I am BACKUP #`date`\" >> /tmp/keepalived.logsed -r -i '/state/s^MASTER^BACKUP^g;/priority/s^100^80^g;/notify_backup/s@^@#@g;/include/s@^@#@g;' /etc/keepalived/keepalived.confsystemctl restart keepalived# check_masterecho \"+++ I am MASTER #`date`\" >> /tmp/keepalived.logsed -r -i '/state/s^BACKUP^MASTER^g;/priority/s^80^100^g;/notify_backup/s@#@@g;' /etc/keepalived/keepalived.confipvsadm --set 100 15 15systemctl restart keepalived æŠ¥é”™è§£å†³æ–¹æ¡ˆkeepalivedæŠ¥é”™ä¿¡æ¯åœ¨/usr/log/messagesä¸‹é¢ ä¸»æœåŠ¡å™¨åœæ­¢åï¼Œå¤‡ç”¨æœåŠ¡æ²¡æœ‰å¯ç”¨ç›‘æ§ä¸»æœåŠ¡å™¨ä¸Šçš„æ—¥å¿—Jun 28 09:18:32 rust Keepalived_vrrp: receive an invalid ip number countassociated with VRID!Jun 28 09:18:32 rust Keepalived_vrrp: bogus VRRP packet received on eth0 !!!Jun 28 09:18:32 rust Keepalived_vrrp: VRRP_Instance(VI_1) Dropping receivedVRRP packet.HA è§£å†³æ–¹æ¡ˆï¼šæ”¹å˜é…ç½®æ–‡ä»¶/etc/keepalived/keepalived.conf ä¸­virtual_route_idçš„å€¼virtual_router_id 60 ä¸»ä»æ–¹éƒ½è¦æ”¹ï¼Œé»˜è®¤ä¸º51 lvsé»˜è®¤è¶…æ—¶æ—¶é—´è¿‡ç¨‹ï¼Œå¯¼è‡´æ¡†æ¶å·²ç»æ­å»ºæˆåŠŸï¼Œä½†æ˜¯æ•ˆæœçœ‹ä¸å‡ºæ¥900 120 300è¿™ä¸‰ä¸ªæ•°å€¼åˆ†åˆ«æ˜¯TCP TCPFINUDPçš„æ—¶é—´.ä¹Ÿå°±æ˜¯è¯´ä¸€æ¡tcpçš„è¿æ¥ç»è¿‡lvså,lvsä¼šæŠŠè¿™å°è®°å½•ä¿å­˜15åˆ†é’Ÿï¼Œå°±æ˜¯å› ä¸ºè¿™ä¸ªæ—¶é—´è¿‡é•¿ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†äººéƒ½ä¼šå‘ç°åšå¥½LVS DRä¹‹åè½®è¯¢ç°è±¡å¹¶æ²¡æœ‰å‘ç”Ÿï¼Œè€Œä¸”æˆ‘ä¹Ÿçœ‹åˆ°å¤§éƒ¨åˆ†çš„æ•™ç¨‹æ˜¯æ²¡æœ‰è¯´æ˜è¿™ä¸€ç‚¹çš„ï¼Œå·¨å‘ï¼ï¼ï¼ï¼ï¼ï¼å› ä¸ºæ˜¯å®éªŒæ€§è´¨ï¼Œæ‰€ä»¥å°†æ­¤æ•°å€¼è°ƒæ•´ä¸ºéå¸¸å°ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è°ƒæ•´åœ¨ä¸¤å°DSæœåŠ¡å™¨ä¸Šä¿®æ”¹[root@DR1 keepalived]# ipvsadm -L --timeoutTimeout (tcp tcpfin udp): 900 120 300 [root@DR1 ~]# ipvsadm --set 1 2 1 æ¦‚å¿µç¯‡Keepalivedè½¯ä»¶èµ·åˆæ˜¯ä¸“ä¸ºLVSè´Ÿè½½å‡è¡¡è½¯ä»¶è®¾è®¡çš„ï¼Œç”¨æ¥ç®¡ç†å¹¶ç›‘æ§LVSé›†ç¾¤ç³»ç»Ÿä¸­å„ä¸ªæœåŠ¡èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œåæ¥åˆåŠ å…¥äº†å¯ä»¥å®ç°é«˜å¯ç”¨ï¼ˆHAï¼‰çš„VRRPåŠŸèƒ½ã€‚äºæ˜¯keepalivedé™¤äº†èƒ½å¤Ÿç®¡ç†LVSè½¯ä»¶å¤–ï¼Œè¿˜å¯ä»¥ä½œä¸ºå…¶ä»–æœåŠ¡ï¼ˆä¾‹å¦‚ï¼šNginxã€Haproxyã€MySQLç­‰ï¼‰çš„é«˜å¯ç”¨è§£å†³æ–¹æ¡ˆè½¯ä»¶ Keepalivedè½¯ä»¶ä¸»è¦æ˜¯é€šè¿‡VRRPåè®®å®ç°é«˜å¯ç”¨åŠŸèƒ½çš„ã€‚ å®˜ç½‘https://www.keepalived.org/ ä¸»è¦åŠŸèƒ½â€“> ç®¡ç†LVSè´Ÿè½½å‡è¡¡â€“> å®ç°LVSé›†ç¾¤èŠ‚ç‚¹çš„å¥åº·æ£€æŸ¥â€“> ä½œä¸ºç³»ç»Ÿç½‘ç»œæœåŠ¡çš„é«˜å¯ç”¨æ€§ï¼ˆfailoverï¼‰ è¿è¡Œæµç¨‹åœ¨ KeepalivedæœåŠ¡æ­£å¸¸å·¥ä½œæ—¶ï¼Œä¸» MasterèŠ‚ç‚¹ä¼šä¸æ–­åœ°å‘å¤‡èŠ‚ç‚¹å‘é€ï¼ˆå¤šæ’­çš„æ–¹å¼ï¼‰å¿ƒè·³æ¶ˆæ¯ï¼Œç”¨ä»¥å‘Šè¯‰å¤‡BackupèŠ‚ç‚¹è‡ªå·±è¿˜æ´»çœ‹ï¼Œå½“ä¸» MasterèŠ‚ç‚¹å‘ç”Ÿæ•…éšœæ—¶ï¼Œå°±æ— æ³•å‘é€å¿ƒè·³æ¶ˆæ¯ï¼Œå¤‡èŠ‚ç‚¹ä¹Ÿå°±å› æ­¤æ— æ³•ç»§ç»­æ£€æµ‹åˆ°æ¥è‡ªä¸» MasterèŠ‚ç‚¹çš„å¿ƒè·³äº†ï¼Œäºæ˜¯è°ƒç”¨è‡ªèº«çš„æ¥ç®¡ç¨‹åºï¼Œæ¥ç®¡ä¸»MasterèŠ‚ç‚¹çš„ IPèµ„æºåŠæœåŠ¡ã€‚è€Œå½“ä¸» MasterèŠ‚ç‚¹æ¢å¤æ—¶ï¼Œå¤‡BackupèŠ‚ç‚¹åˆä¼šé‡Šæ”¾ä¸»èŠ‚ç‚¹æ•…éšœæ—¶è‡ªèº«æ¥ç®¡çš„IPèµ„æºåŠæœåŠ¡ï¼Œæ¢å¤åˆ°åŸæ¥çš„å¤‡ç”¨è§’è‰²ã€‚ é…ç½®æ–‡ä»¶è¯´æ˜å…¨å±€é…ç½®ï¼Œä¸€èˆ¬ä¿ç•™è·¯ç”±æ ‡è¯†ä¿¡æ¯å°±å¯ä»¥äº† global_defs { #å…¨å±€é…ç½® notification_email { #å®šä¹‰æŠ¥è­¦é‚®ä»¶åœ°å€ acassen@firewall.loc failover@firewall.loc # æ”¶ä»¶äºº sysadmin@firewall.loc } notification_email_from Alexandre.Cassen@firewall.loc #å®šä¹‰å‘é€é‚®ä»¶çš„åœ°å€ smtp_server 192.168.200.1 #é‚®ç®±æœåŠ¡å™¨ smtp_connect_timeout 30 #å®šä¹‰è¶…æ—¶æ—¶é—´ router_id LVS_DEVEL #å®šä¹‰è·¯ç”±æ ‡è¯†ä¿¡æ¯ï¼Œç›¸åŒå±€åŸŸç½‘å”¯ä¸€ } è™šæ‹Ÿipé…ç½® brrp vrrp_instance VI_1 { #å®šä¹‰å®ä¾‹ state MASTER #çŠ¶æ€å‚æ•° master/backup åªæ˜¯è¯´æ˜ interface eth0 #è™šIPåœ°å€æ”¾ç½®çš„ç½‘å¡ä½ç½® virtual_router_id 51 #vrrp_instanceçš„å”¯ä¸€æ ‡è¯† priority 100 # keepalivedæƒé‡,æ•°å€¼è¶Šå¤§æƒé‡è¶Šå¤§,MASTERåº”å¤§äºBACKUP advert_int 1 #å‘é€å¿ƒè·³é—´éš”,å¦‚æœbackup1ç§’æ”¶ä¸åˆ°å¿ƒè·³å°±æ¥ç®¡,å•ä½æ˜¯ç§’ authentication { # â†“ auth_type PASS #â†“ auth_pass 1111 #è®¤è¯ } #â†‘ virtual_ipaddress { #â†“ 192.168.200.16 #vip 192.168.200.17 192.168.200.18 } nopreempt # è®¾ç½®ä¸æŠ¢å åŠŸèƒ½ #nopreempt è¡¨ç¤ºä¸»èŠ‚ç‚¹æ•…éšœæ¢å¤åä¸å†åˆ‡å›åˆ°ä¸»èŠ‚ç‚¹ï¼Œè®©æœåŠ¡ä¸€ç›´åœ¨å¤‡ç”¨èŠ‚ç‚¹ä¸‹å·¥ä½œï¼Œç›´åˆ°å¤‡ç”¨èŠ‚ç‚¹å‡ºç°æ•…éšœæ‰ä¼šè¿›è¡Œåˆ‡æ¢ã€‚ preemtp_delay 300 # è®¾ç½®æŠ¢å å»¶æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ã€‚} lvsé…ç½® #ç›¸å½“äº ipvsadm -A -t 192.168.0.89:80 -s wrr virtual_server 192.168.0.89 80 { delay_loop 6 #æœåŠ¡å¥åº·æ£€æŸ¥å‘¨æœŸ,å•ä½æ˜¯ç§’ lb_algo wrr #è°ƒåº¦ç®—æ³• lb_kind DR #æ¨¡å¼ nat_mask 255.255.255.0 persistence_timeout 50 #å›è¯ä¿æŒæ—¶é—´,å•ä½æ˜¯ç§’ protocol TCP #TCPåè®®è½¬å‘ sorry_server # å½“æ‰€æœ‰ real server å¤±æ•ˆåï¼ŒæŒ‡å®šçš„ Web æœåŠ¡å™¨çš„è™šæ‹Ÿä¸»æœºåœ°å€ã€‚#æ·»åŠ åç«¯realserver#ç›¸å½“äº ipvsadm -a -t 192.168.0.89:80 -r 192.168.0.93:80 -w 1 real_server 192.168.0.93 80 { #realserverçš„çœŸå®IP weight 1 #æƒé‡ #å¥åº·æ£€æŸ¥ TCP_CHECK { connect_timeout 8 #è¶…æ—¶æ—¶é—´ nb_get_retry 3 #é‡è¯•æ¬¡æ•° delay_before_retry 3 #é‡è¯•é—´éš” connect_port 80 #æ£€æŸ¥realserverçš„80ç«¯å£,å¦‚æœ80ç«¯å£æ²¡ç›‘å¬,å°±ä¼šä»é›†ç¾¤ä¸­å‰”é™¤ } } real_server 192.168.0.94 80 { weight 1 TCP_CHECK { connect_timeout 8 nb_get_retry 3 delay_before_retry 3 connect_port 80 } }} ipvsadm æ¦‚å¿µç¯‡æ·»åŠ è™šæ‹ŸæœåŠ¡å™¨ è¯­æ³•:ipvsadm -A [-t|u|f] [vip_addr:port] [-s:æŒ‡å®šç®—æ³•] -A:æ·»åŠ  -t:TCPåè®® -u:UDPåè®® -f:é˜²ç«å¢™æ ‡è®° -D:åˆ é™¤è™šæ‹ŸæœåŠ¡å™¨è®°å½• -E:ä¿®æ”¹è™šæ‹ŸæœåŠ¡å™¨è®°å½• -C:æ¸…ç©ºæ‰€æœ‰è®°å½• -L:æŸ¥çœ‹æ·»åŠ åç«¯RealServer è¯­æ³•:ipvsadm -a [-t|u|f] [vip_addr:port] [-r ip_addr] [-g|i|m] [-w æŒ‡å®šæƒé‡] -a:æ·»åŠ  -t:TCPåè®® -u:UDPåè®® -f:é˜²ç«å¢™æ ‡è®° -r:æŒ‡å®šåç«¯realserverçš„IP -g:DRæ¨¡å¼ -i:TUNæ¨¡å¼ -m:NATæ¨¡å¼ -w:æŒ‡å®šæƒé‡ -d:åˆ é™¤realserverè®°å½• -e:ä¿®æ”¹realserverè®°å½• -l:æŸ¥çœ‹é€šç”¨: ipvsadm -ln:æŸ¥çœ‹è§„åˆ™ service ipvsadm save:ä¿å­˜è§„åˆ™ lvsçš„å‡ ç§è°ƒåº¦ç®—æ³• RRï¼šroundrobinè½®è¯¢,åç«¯RSå‡æ‘Šæ‰€æœ‰çš„è¯·æ±‚ WRR weighted RRåŠ æƒè½®è¯¢ï¼Œæ ¹æ®æƒå€¼æ¥åˆ†é…è¯·æ±‚çš„æ•°é‡ SHï¼šSource Hashin[root@lvs-web1 ~]# ipvsadm -lnIP Virtual Server version 1.2.1 (size=4096)Prot LocalAddress:Port Scheduler Flags-> RemoteAddress:Port Forward Weight ActiveConn InActConnTCP 10.0.5.97:8888 rr-> 10.0.5.90:8888 Route 1 0 0-> 10.0.5.91:8888 Route 1 0 0g DHï¼šDestination Hashing LCï¼šleast connections WLCï¼šWeighted LC å…·ä½“çš„è°ƒåº¦ç®—æ³• å…¶ä»–æ¦‚å¿µä»€ä¹ˆæ˜¯VRRPVRRPæ˜¯Virtual Router RedundancyProtocol(è™šæ‹Ÿè·¯ç”±å™¨å†—ä½™åè®®ï¼‰çš„ç¼©å†™ï¼ŒVRRPå‡ºç°çš„ç›®çš„å°±æ˜¯ä¸ºäº†è§£å†³é™æ€è·¯ç”±å•ç‚¹æ•…éšœé—®é¢˜çš„ï¼Œå®ƒèƒ½å¤Ÿä¿è¯å½“ä¸ªåˆ«èŠ‚ç‚¹å®•æœºæ—¶ï¼Œæ•´ä¸ªç½‘ç»œå¯ä»¥ä¸é—´æ–­åœ°è¿è¡Œã€‚VRRPé€šè¿‡ä¸€ç§ç«é€‰æœºåˆ¶æ¥å°†è·¯ç”±çš„ä»»åŠ¡äº¤ç»™æŸå°VRRPè·¯ç”±å™¨çš„ã€‚https://www.cnblogs.com/f-ck-need-u/p/8483807.html keepalivedå®˜ç½‘http://www.keepalived.org keepalivedé«˜å¯ç”¨æ¶æ„å›¾ ç½‘å€é«˜å¹¶å‘åœºæ™¯ LVS å®‰è£…åŠé«˜å¯ç”¨å®ç°https://www.cnblogs.com/clsn/p/7920637.html#auto_id_30VRRPåŸç†å’Œåˆ†æhttps://www.jianshu.com/p/4b46586e79aaHaproxy+Keepalivedé«˜å¯ç”¨ç¯å¢ƒéƒ¨ç½²æ¢³ç†ï¼ˆä¸»ä¸»å’Œä¸»ä»æ¨¡å¼ï¼‰https://blog.51cto.com/dengaosky/2129856 https://www.cnblogs.com/f-ck-need-u/p/8492298.html#3-keepalived-lvs-Keepalived+LVSçš„é«˜å¯ç”¨é›†ç¾¤ç½‘ç«™æ¶æ„https://www.cnblogs.com/along21/p/7841132.html#auto_id_6","link":"/posts/a33a1a7d/"},{"title":"ç”µå•†åå°ç®¡ç†ç³»ç»Ÿ(vue)-homeæ¨¡å—","text":"homeæ¨¡å— homeæ¨¡å— é€šè¿‡æ¥å£è·è·å–èœå•æ•°æ®é€šè¿‡axiosè¯·æ±‚æ‹¦æˆªå™¨æ·»åŠ tokenï¼Œä¿è¯æ‹¥æœ‰è·å–æ•°æ®çš„æƒé™","link":"/posts/403006fc/"},{"title":"äº¤æ¢æœºçŠ¶æ€æ£€æµ‹","text":"äº¤æ¢æœºçŠ¶æ€æ£€æµ‹è®°å½•äº¤æ¢æœºä¸Šçš„ä¸€äº›çŠ¶æ€æ£€æµ‹æŒ‡ä»¤ï¼Œä»¥åŠæµç¨‹ æŸ¥çœ‹ç«¯å£ä¸Šçš„æµé‡dis int Bri 100dis int T 1/0/1display interface XGigabitEthernet 2/0/0 XGigabitEthernet2/0/0 current state : UPLine protocol current state : UPDescription:connet to f5-2Switch Port, PVID : 1, TPID : 8100(Hex), The Maximum Frame Length is 9216IP Sending Frames' Format is PKTFMT_ETHNT_2, Hardware address is f84a-bf70-3d00Last physical up time : 2014-03-09 18:12Last physical down time : 2014-03-09 18:12Current system time: 2014-03-09 18:12Port Mode: COMMON FIBERSpeed : 10000, Loopback: NONEDuplex: FULL, Negotiation: DISABLEMdi : NORMALLast 300 seconds input rate 1602936 bits/sec, 1784 packets/secLast 300 seconds output rate 1393224 bits/sec, 1732 packets/secInput peak rate 142352400 bits/sec, Record time: 2014-03-09 18:12Output peak rate 136841800 bits/sec, Record time: 2014-03-09 18:12Input: 26101952708 packets, 3055712267640 bytes å…¶ä¸­INPUTå’ŒOUTPUTéƒ¨åˆ†å°±æ˜¯äº¤æ¢æœºçš„è¿›å‡ºå£æµé‡ æŸ¥çœ‹äº¤æ¢æœºä¸Šä¸‹è”çŠ¶æ€dis link s","link":"/posts/845aaf29/"},{"title":"ipv6éƒ¨ç½²","text":"ipv6éƒ¨ç½²éƒ¨ç½²æ¡ˆä¾‹ç”±äºipv4å¿«è¦ç”¨å®Œäº†ï¼Œå¾ˆå¤šäº¤æ¢æœºéœ€è¦æ›´æ¢ipv6çš„åœ°å€ï¼Œè¿™é‡Œåšä¸€äº›é…ç½®çš„è¿‡ç¨‹ è¥¿å®‰å…‰é€šé«˜é˜² ipv6é…ç½® è¦æ±‚è¥¿å®‰å…‰é€šé«˜é˜²ä¸šåŠ¡ipv6 240e:bf:b800:1900::/64äº’è” å¯¹ç«¯:240e:bf:b800:19ff::100/127 å…¬å¸:240e:bf:b800:19ff::101/127 # å…ˆé…ç½®äº’è”åœ°å€ï¼Œçœ‹å’Œæœºæˆ¿æ˜¯å¦äº’é€šï¼Œé»˜è®¤vlan1ä¸ºä¸šåŠ¡vlan ,å…¶ä»–vlanä¸ºäº’è”vlan[CTN-SN-XIY-S01]dis int briefBrief information on interfaces in route mode:Link: ADM - administratively down; Stby - standbyProtocol: (s) - spoofingInterface Link Protocol Primary IP DescriptionInLoop0 UP UP(s) --NULL0 UP UP(s) --Vlan1 UP UP 1.81.5.161Vlan10 DOWN DOWN --Vlan101 UP UP 192.168.100.2# é…ç½®äº’è”åœ°å€Interface vlan-interface 101ipv6 address 240e:bf:b800:19ff::101/127 # æµ‹è¯•äº’è”æ˜¯å¦äº’é€šping ipv6 240e:bf:b800:19ff::100# é…ç½®ä¸šåŠ¡åœ°å€å’Œé™æ€è·¯ç”±interface vlan-interface 1ipv6 address 240e:bf:b800:1900::1/64undo ipv6 nd ra halt# é…ç½®é™æ€è·¯ç”±ipv6 route-static :: 0 240e:bf:b800:19ff::100 å››å·æˆåç§»åŠ¨æœºæˆ¿ è¦æ±‚å››å·æˆåç§»åŠ¨æœºæˆ¿ï¼ˆè‡ªæœ‰èŠ‚ç‚¹ï¼‰IPV6èµ„æºï¼š2409:8C62:410:6::/64ï¼Œäº’è”ï¼š å¯¹ç«¯2409:8062:3000:0201:: C/127 å…¬å¸2409:8062:3000:0201:: D/127 å¯¹ç«¯2409:8062:3000:0202:: 6/127 å…¬å¸2409:8062:3000:0202:: 7/127 dis int briefBrief information on interfaces in route mode:Link: ADM - administratively down; Stby - standbyProtocol: (s) - spoofingInterface Link Protocol Primary IP DescriptionVlan1 UP UP 117.172.22.129Vlan200 UP UP 117.172.4.50Vlan201 UP UP 117.172.4.54# é…ç½®äº’è”åœ°å€interface Vlan-interface200 ip address 117.172.4.50 255.255.255.252 ipv6 address 2409:8062:3000:201::D/127interface Vlan-interface201 ip address 117.172.4.54 255.255.255.252 ipv6 address 2409:8062:3000:202::7/127# æµ‹è¯•äº’è”ping ipv6 2409:8062:3000:201::Cping ipv6 2409:8062:3000:202::6# é…ç½®ä¸šåŠ¡vlaninterface Vlan-interface1 ip address 117.172.22.129 255.255.255.224 ipv6 address 2409:8C62:410:6::1/64 undo ipv6 nd ra halt# é…ç½®é™æ€[CMN-SC-CTU4-S01]dis current-configuration | include ipv6.ro ipv6 route-static :: 0 2409:8062:3000:201::C ipv6 route-static :: 0 2409:8062:3000:202::6# æµ‹è¯•è·¯ç”±tracert ipv6 2409:8062:3000:201::Ctraceroute to 2409:8062:3000:201::C (2409:8062:3000:201::C), 30 hops at most, 60 byte packets, press CTRL_C to break 1 2409:8062:3000:201::C 2.934 ms 2.345 ms 2.336 mstracert ipv6 2409:8062:3000:202::6traceroute to 2409:8062:3000:202::6 (2409:8062:3000:202::6), 30 hops at most, 60 byte packets, press CTRL_C to break 1 2409:8062:3000::202 3.957 ms 3.125 ms 3.879 ms# æµ‹è¯•å¤–ç½‘èƒ½å¦è®¿é—® check-listipv6é…ç½®å®Œæˆä»¥åéœ€è¦ç¡®è®¤å†…å®¹ æµ‹è¯•äº’è”æ˜¯å¦æ­£ç¡®ï¼Œping ipv6 å¯¹ç«¯äº’è”ip ä¸šåŠ¡åœ°å€æ˜¯å¦é…äº† undo ipv6 nd ra halt é™æ€è·¯ç”±é…ç½®ä»¥åæ˜¯å¦æ­£ç¡®ï¼Œæœ¬åœ°æ˜¯å¦é€šï¼Œå¤–ç½‘æ˜¯å¦é€šè¿™é‡Œä»¥è¥¿å®‰é«˜é˜²ä¸ºä¾‹å­ï¼Œå¦‚æœæ˜¯å†…ç½‘æœºå™¨ï¼Œæ¯”å¦‚äº’è”ipæ˜¯feè¿™ç§ï¼Œé‚£å°±æ˜¯å†…ç½‘æœºå™¨ï¼Œæ‰¾cdné‚£è¾¹è¦æœºå™¨æµ‹mtr ipv6 240e:bf:b800:1900::1å¦‚æœæ˜¯å¤–ç½‘æœºå™¨ï¼Œæ‰¾å…¶ä»–çš„äº¤æ¢æœºæµ‹tracert ipv6 240e:bf:b800:1900::1 å¦å¤–è¿˜è¦æ³¨æ„çš„æ˜¯å¦‚æœæ©ç æ˜¯/72çš„åªèƒ½è‡ªå·±åˆ†é…ipä¸èƒ½dhcp","link":"/posts/82cf9f4/"},{"title":"é¡¹ç›®æ³¨æ„ç‚¹","text":"vueé¡¹ç›®æ³¨æ„ç‚¹ é¡¹ç›®æ³¨æ„ç‚¹export default {} scoped å…³é”®å­—ç”¨åœ¨æ ·å¼æ ‡ç­¾ä¸­ï¼Œä¸»è¦æ˜¯è¡¨ç¤ºè¯¥æ ·å¼æ˜¯åªä½¿ç”¨äºå½“å‰çš„vueç»„ä»¶","link":"/posts/6cd97811/"},{"title":"äºŒå±‚äº¤æ¢æœº","text":"äºŒå±‚äº¤æ¢æœºçŸ¥è¯† å›¾ç‰‡ç¬”è®° somethingsäºŒå±‚äº¤æ¢æœºï¼Œåªèƒ½åœ¨ç›¸åŒvlané—´é€šä¿¡ï¼Œå› æ­¤åœ¨ä¸šåŠ¡ä¸Šé…ç½®äºŒå±‚äº¤æ¢æœºçš„åŒæ—¶ï¼Œéœ€è¦çŸ¥é“å¯¹ç«¯äº¤æ¢æœºçš„vlanæ˜¯å¦‚ä½•åˆ’åˆ†çš„å¯¹äºå¤švlanä¹‹é—´çš„äº¤äº’ï¼Œéœ€è¦åœ¨ç«¯å£ä¸Šè®¾ç½®trunkçš„æ¨¡å¼ï¼Œå¦å¤–æœåŠ¡å™¨åœ¨ç«¯å£ä¸Šåªå…è®¸accessçš„æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯è¯´switch â€” ä¸Šè”switch(trunk)switch â€” ä¸‹è”server(access) å¦‚æœäº¤æ¢æœºå¯¹ç«¯è®¾ç½®äº†dynamic,åˆ™æœ¬ç«¯ä¹Ÿéœ€è¦è®¾ç½®dynamicæ¨¡å¼ dynamicä¸staticä¸¤ç§èšåˆæ¨¡å¼çš„åŒºåˆ« é¦–å…ˆéœ€è¦æ˜ç¡®é“¾è·¯èšåˆçš„æ¦‚å¿µï¼šé“¾è·¯èšåˆæ˜¯å°†ä¸¤ä¸ªæˆ–æ›´å¤šæ•°æ®ä¿¡é“ç»“åˆæˆä¸€ä¸ªå•ä¸ªçš„ä¿¡é“ï¼Œè¯¥ä¿¡é“ä»¥ä¸€ä¸ªå•ä¸ªçš„æ›´é«˜å¸¦å®½çš„é€»è¾‘é“¾è·¯å‡ºç°ã€‚é“¾è·¯èšåˆä¸€èˆ¬ç”¨æ¥è¿æ¥ä¸€ä¸ªæˆ–å¤šä¸ªå¸¦å®½éœ€æ±‚å¤§çš„è®¾å¤‡ï¼Œä¾‹å¦‚è¿æ¥éª¨å¹²ç½‘ç»œçš„æœåŠ¡å™¨æˆ–æœåŠ¡å™¨ç¾¤ã€‚ åŒºåˆ«å¦‚ä¸‹ï¼š é™æ€èšåˆæ¨¡å¼ï¼šé…ç½®èšåˆçš„ç«¯å£æ•°é‡æ˜¯å›ºå®šçš„ï¼Œèšåˆåçš„å¸¦å®½ä¹Ÿæ˜¯å›ºå®šçš„ï¼› åŠ¨æ€èšåˆæ¨¡å¼ï¼šå®é™…èšåˆçš„ç«¯å£æ•°é‡æ˜¯æ ¹æ®æµé‡ç­–ç•¥åŠ¨æ€è°ƒæ•´çš„ï¼Œèšåˆå¸¦å®½ä¹Ÿä¼šéšä¹‹å˜åŒ–ã€‚ä¾‹å¦‚åœ¨ä½è´Ÿè½½æ—¶æœ‰2ä¸ªç«¯å£å‚ä¸èšåˆï¼Œé«˜è´Ÿè½½æ—¶ä¼šæœ‰4ä¸ªç«¯å£å‚ä¸èšåˆï¼Œä»è€Œæ›´å¥½çš„æ»¡è¶³åº”ç”¨çš„è¦æ±‚ã€‚ é™æ€èšåˆï¼Œå°±æ˜¯äººå·¥è®¾å®šæŠŠå¤šæ¡ä¿¡é“åˆ†å¼€æˆ–è€…åˆå¹¶åŠ¨æ€èšåˆå°±æ˜¯ç³»ç»Ÿè‡ªåŠ¨åˆ†é…ä¿¡é“ h3cæ–‡æ¡£ look..look ç›´æ¥é€ä¼ å’Œé—´æ¥é€ä¼  ç›´æ¥é€ä¼ å°±æ˜¯æŸä¸ªæ•°æ®åŒ…åœ¨ä¸¤ä¸ªç›´è¿é“¾è·¯çš„ä¸¤ä¸ªç«¯å£é—´ä¼ è¾“ï¼Œæ•°æ®åŒ…çš„VLANæ ‡è®°æ²¡æœ‰å‘ç”Ÿä»»ä½•å˜åŒ–ã€‚å¦‚ä¸¤ä¸ªç›´è¿çš„Trunkå£ï¼Œä¸¤ä¸ªç«¯å£çš„PVID éƒ½æ˜¯vlan 1ï¼ŒVLAN 2çš„æ•°æ®åŒ…ä»Trunkå£Aå‘é€å‡ºæ¥ï¼Œè¢«å¦ä¸€ç«¯çš„Trunkå£Bæ¥æ”¶ï¼Œæ”¶å‘ä¹‹é—´ï¼ŒVLAN 2çš„æ•°æ®åŒ…æ— ä»»ä½•æ”¹å˜ã€‚ é—´æ¥é€ä¼ å°±æ˜¯æ•°æ®åŒ…åœ¨ä¸¤ä¸ªç›´è¿ç«¯å£é“¾è·¯é—´ä¼ è¾“æ—¶ï¼Œåœ¨ä¸¤ä¸ªç«¯å£æ”¶å‘æ—¶ï¼Œæ•°æ®åŒ…çš„VLANæ ‡ç­¾ä¼šå‘ç”Ÿæ”¹å˜ï¼Œä½†æ˜¯æœ€ç»ˆæ•°æ®åŒ…çš„VLANè¿˜æ˜¯æ²¡å˜ã€‚å¦‚ä¸¤ä¸ªç›´è¿çš„Trunkå£ï¼Œä¸¤ä¸ªç«¯å£çš„PVID éƒ½æ˜¯vlan 1ï¼ŒVLAN 1çš„æ•°æ®åŒ…ä»Trunkå£Aå‘é€å‡ºæ¥ï¼Œæ­¤æ—¶è¢«å‰¥é™¤VLAN 1çš„ä¿¡æ¯ï¼Œè¢«å¦ä¸€ç«¯çš„Trunkå£Bæ¥æ”¶ï¼Œæ­¤æ—¶åˆè¢«æ·»åŠ VLAN 1çš„ä¿¡æ¯ã€‚æ”¶å‘ä¹‹é—´ï¼ŒVLAN 2çš„æ•°æ®åŒ…å…ˆæ˜¯è¢«å‰¥ç¦»VLANä¿¡æ¯ï¼Œç„¶ååœ¨æ¥æ”¶ç«¯åˆè¢«æ‰“ä¸ŠåŸå…ˆçš„VLAN1ä¿¡æ¯ã€‚ä¸ç®¡æ˜¯å“ªç§æ–¹å¼é€ä¼ ï¼Œé€ä¼ çš„ç»“æœéƒ½æ˜¯æ•°æ®åŒ…çš„æœ€ç»ˆVLANä¿¡æ¯åœ¨ç»å†ç«¯å£æ”¶å‘åï¼Œéƒ½ä¸æ”¹å˜ã€‚ vlanä¸äº¤æ¢æœºç«¯å£æ¨¡å¼Accessï¼ŒHybridï¼ŒTrunkVLANï¼ˆVirtual Local Area Networkï¼‰çš„ä¸­æ–‡åä¸ºâ€è™šæ‹Ÿå±€åŸŸç½‘â€ã€‚VLANæ˜¯ä¸€ç§å°†å±€åŸŸç½‘è®¾å¤‡ä»é€»è¾‘ä¸Šåˆ’åˆ†æˆä¸€ä¸ªä¸ªç½‘æ®µï¼Œä»è€Œå®ç°è™šæ‹Ÿå·¥ä½œç»„çš„æ–°å…´æ•°æ®äº¤æ¢æŠ€æœ¯ã€‚è¿™ä¸€æ–°å…´æŠ€æœ¯ä¸»è¦åº”ç”¨äºäº¤æ¢æœºå’Œè·¯ç”±å™¨ä¸­ï¼Œä½†ä¸»æµåº”ç”¨è¿˜æ˜¯åœ¨äº¤æ¢æœºä¹‹ä¸­ã€‚ä½†åˆä¸æ˜¯æ‰€æœ‰äº¤æ¢æœºéƒ½å…·æœ‰æ­¤åŠŸèƒ½ï¼Œåªæœ‰VLANåè®®çš„ç¬¬äºŒå±‚ä»¥ä¸Šäº¤æ¢æœºæ‰å…·æœ‰æ­¤åŠŸèƒ½ã€‚802.1Qçš„æ ‡å‡†çš„å‡ºç°æ‰“ç ´äº†è™šæ‹Ÿç½‘ä¾èµ–äºå•ä¸€å‚å•†çš„åƒµå±€ï¼Œä»ä¸€ä¸ªä¾§é¢æ¨åŠ¨äº†VLANçš„è¿…é€Ÿå‘å±•ã€‚äº¤æ¢æœºç«¯å£æœ‰ä¸‰ç§å·¥ä½œæ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯Accessï¼ŒHybridï¼ŒTrunkã€‚ Accessç±»å‹çš„ç«¯å£åªèƒ½å±äº1ä¸ªVLANï¼Œä¸€èˆ¬ç”¨äºè¿æ¥è®¡ç®—æœºçš„ç«¯å£ï¼› Trunkç±»å‹çš„ç«¯å£å¯ä»¥å…è®¸å¤šä¸ªVLANé€šè¿‡ï¼Œå¯ä»¥æ¥æ”¶å’Œå‘é€å¤šä¸ªVLANçš„æŠ¥æ–‡ï¼Œä¸€èˆ¬ç”¨äºäº¤æ¢æœºä¹‹é—´è¿æ¥çš„ç«¯å£ï¼› Hybridç±»å‹çš„ç«¯å£å¯ä»¥å…è®¸å¤šä¸ªVLANé€šè¿‡ï¼Œå¯ä»¥æ¥æ”¶å’Œå‘é€å¤šä¸ªVLANçš„æŠ¥æ–‡ï¼Œå¯ä»¥ç”¨äºäº¤æ¢æœºä¹‹é—´è¿æ¥ï¼Œä¹Ÿå¯ä»¥ç”¨äºè¿æ¥ç”¨æˆ·çš„è®¡ç®—æœºã€‚Hybridç«¯å£å’ŒTrunkç«¯å£åœ¨æ¥æ”¶æ•°æ®æ—¶ï¼Œå¤„ç†æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼Œå”¯ä¸€ä¸åŒä¹‹å¤„åœ¨äºå‘é€æ•°æ®æ—¶ï¼šHybridç«¯å£å¯ä»¥å…è®¸å¤šä¸ªVLANçš„æŠ¥æ–‡å‘é€æ—¶ä¸æ‰“æ ‡ç­¾ï¼Œè€ŒTrunkç«¯å£åªå…è®¸ç¼ºçœVLANçš„æŠ¥æ–‡å‘é€æ—¶ä¸æ‰“æ ‡ç­¾ã€‚ untagå°±æ˜¯æ™®é€šçš„ethernetæŠ¥æ–‡ï¼Œæ™®é€šPCæœºçš„ç½‘å¡æ˜¯å¯ä»¥è¯†åˆ«è¿™æ ·çš„æŠ¥æ–‡è¿›è¡Œé€šè®¯ï¼›tagæŠ¥æ–‡ç»“æ„çš„å˜åŒ–æ˜¯åœ¨æºmacåœ°å€å’Œç›®çš„macåœ°å€ä¹‹åï¼ŒåŠ ä¸Šäº†4bytesçš„vlanä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯vlan tagå¤´ï¼›ä¸€èˆ¬æ¥è¯´è¿™æ ·çš„æŠ¥æ–‡æ™®é€šPCæœºçš„ç½‘å¡æ˜¯ä¸èƒ½è¯†åˆ«çš„å› æ­¤å¯¹äºPcæœºæ¥è¯´ï¼Œåªå…è®¸ä½¿ç”¨åœ¨ä¼ è¾“æ•°æ®æ—¶ï¼Œä¸å¸¦æ ‡ç­¾çš„æ¨¡å¼access Accessã€Trunkã€Hybridä¸‰ç§ç«¯å£æ¨¡å¼æ¥æ”¶å‘æ•°æ®çŠ¶æ€åœ¨ç½‘ç»œçš„åˆ†å±‚ç»“æ„å’Œå®½å¸¦çš„åˆç†åˆ†é…æ–¹é¢ï¼ŒTRUNKè¢«è§£é‡Šä¸ºâ€œç«¯å£æ±‡èšâ€ï¼Œæ˜¯å¸¦å®½æ‰©å±•å’Œé“¾è·¯å¤‡ä»½çš„ä¸€ä¸ªé‡è¦é€”å¾„ã€‚TRUNKæŠŠå¤šä¸ªç‰©ç†ç«¯å£æ†ç»‘åœ¨ä¸€èµ·å½“ä½œä¸€ä¸ªé€»è¾‘ç«¯å£ä½¿ç”¨ï¼Œå¯ä»¥æŠŠå¤šç»„ç«¯å£çš„å®½å¸¦å åŠ èµ·æ¥ä½¿ç”¨ã€‚TRUNKæŠ€æœ¯å¯ä»¥å®ç°TRUNKå†…éƒ¨å¤šæ¡é“¾è·¯äº’ä¸ºå¤‡ä»½çš„åŠŸèƒ½ï¼Œå³å½“ä¸€æ¡é“¾è·¯å‡ºç°æ•…éšœæ—¶ï¼Œä¸å½±å“å…¶ä»–é“¾è·¯çš„å·¥ä½œï¼ŒåŒæ—¶å¤šé“¾è·¯ä¹‹é—´è¿˜èƒ½å®ç°æµé‡å‡è¡¡ï¼Œå°±åƒæˆ‘ä»¬ç†Ÿæ‚‰çš„æ‰“å°æœºæ± å’ŒMODEMæ± ä¸€æ ·ã€‚ Acessç«¯å£æ”¶æŠ¥æ–‡: æ”¶åˆ°ä¸€ä¸ªæŠ¥æ–‡,åˆ¤æ–­æ˜¯å¦æœ‰VLANä¿¡æ¯ï¼šå¦‚æœæ²¡æœ‰åˆ™æ‰“ä¸Šç«¯å£çš„PVIDï¼Œå¹¶è¿›è¡Œäº¤æ¢è½¬å‘,å¦‚æœæœ‰åˆ™ç›´æ¥ä¸¢å¼ƒï¼ˆç¼ºçœï¼‰ trunkç«¯å£æ”¶æŠ¥æ–‡ï¼š æ”¶åˆ°ä¸€ä¸ªæŠ¥æ–‡ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰VLANä¿¡æ¯ï¼šå¦‚æœæ²¡æœ‰åˆ™æ‰“ä¸Šç«¯å£çš„PVIDï¼Œå¹¶è¿›è¡Œäº¤æ¢è½¬å‘ï¼Œå¦‚æœæœ‰åˆ¤æ–­è¯¥trunkç«¯å£æ˜¯å¦å…è®¸è¯¥ VLANçš„æ•°æ®è¿›å…¥ï¼šå¦‚æœå…è®¸åˆ™æŠ¥æ–‡æºå¸¦åŸæœ‰VLANæ ‡è®°è¿›è¡Œè½¬å‘ï¼Œå¦åˆ™ä¸¢å¼ƒè¯¥æŠ¥æ–‡ã€‚ hybridç«¯å£æ”¶æŠ¥æ–‡ï¼š æ”¶åˆ°ä¸€ä¸ªæŠ¥æ–‡,åˆ¤æ–­æ˜¯å¦æœ‰VLANä¿¡æ¯ï¼šå¦‚æœæ²¡æœ‰åˆ™æ‰“ä¸Šç«¯å£çš„PVIDï¼Œå¹¶è¿›è¡Œäº¤æ¢è½¬å‘ï¼Œå¦‚æœæœ‰åˆ™åˆ¤æ–­è¯¥hybridç«¯å£æ˜¯å¦å…è®¸è¯¥VLANçš„æ•°æ®è¿›å…¥ï¼šå¦‚æœå¯ä»¥åˆ™è½¬å‘ï¼Œå¦åˆ™ä¸¢å¼ƒ Acessç«¯å£å‘æŠ¥æ–‡ï¼šå°†æŠ¥æ–‡çš„VLANä¿¡æ¯å‰¥ç¦»ï¼Œç›´æ¥å‘é€å‡ºå» trunkç«¯å£å‘æŠ¥æ–‡ï¼šæ¯”è¾ƒç«¯å£çš„PVIDå’Œå°†è¦å‘é€æŠ¥æ–‡çš„VLANä¿¡æ¯ï¼Œå¦‚æœä¸¤è€…ç›¸ç­‰åˆ™å‰¥ç¦»VLANä¿¡æ¯ï¼Œå†å‘é€ï¼Œå¦åˆ™æŠ¥æ–‡å°†æºå¸¦åŸæœ‰çš„VLANæ ‡è®°è¿›è¡Œè½¬å‘ã€‚ hybridç«¯å£å‘æŠ¥æ–‡ï¼š1ã€åˆ¤æ–­è¯¥VLANåœ¨æœ¬ç«¯å£çš„å±æ€§ 2ã€å¦‚æœæ˜¯untagåˆ™å‰¥ç¦»VLANä¿¡æ¯ï¼Œå†å‘é€ï¼Œå¦‚æœæ˜¯tagåˆ™æ¯”è¾ƒç«¯å£çš„PVIDå’Œå°†è¦å‘é€æŠ¥æ–‡çš„VLANä¿¡æ¯ï¼Œå¦‚æœä¸¤è€…ç›¸ç­‰åˆ™å‰¥ç¦»VLANä¿¡æ¯ï¼Œå†å‘é€ï¼Œå¦åˆ™æŠ¥æ–‡å°†æºå¸¦åŸæœ‰çš„VLANæ ‡è®°è¿›è¡Œè½¬å‘ å®è·µç»è¿‡å®éªŒï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ä¸€äº›é…ç½®åœ¨æŸäº›æƒ…å†µä¸‹æ˜¯ç›¸åŒçš„æ¯”å¦‚ä¸Šè”çš„ä¿¡æ¯æ˜¯è¿™æ ·çš„ interface Ten-GigabitEthernet1/0/9 port link-mode bridge description CCM@UPYUN-KC-ALS-06 port link-type trunk undo port trunk permit vlan 1 port trunk permit vlan 1000 port trunk pvid vlan 1000 ä»ä¸Šé¢çš„å†…å®¹å¯ä»¥çŸ¥é“ï¼Œåªå…è®¸æ ‡ç­¾ä¸º1000çš„æ•°æ®è¿›å…¥ å¯ä»¥è¿™æ ·é…ç½® vlan 1000ip address 10.0.5.124 20ip router-static 0.0.0.0 0 10.0.0.130 ä¹Ÿå¯ä»¥è¿™æ ·é…ç½® int bridge 1000int g1/0/5port link-aggretion group 1000int g 1/0/6port link-aggretion group 1000int bridge 1000[10.0.5.125-Bridge-Aggregation1000]dis this#interface Bridge-Aggregation1000 port link-type trunk undo port trunk permit vlan 1 port trunk permit vlan 1000 port trunk pvid vlan 1000#return trunkåœ¨å¯¹ç«¯ç›¸åŒvlan-idçš„æ—¶å€™åŒæ ·ä¼šå‰¥ç¦»vlançš„idä¿¡æ¯ çº§è¿ã€å †å ã€é›†ç¾¤çº§è¿https://baike.baidu.com/item/%E7%BA%A7%E8%BF%9E ä»€ä¹ˆæ˜¯pvidPVIDè‹±æ–‡ä¸ºPort-base VLAN IDï¼Œæ˜¯è¡¨ç¤ºç½‘ç»œé€šä¿¡ä¸­åŸºäºç«¯å£çš„VLAN IDï¼Œä¸€ä¸ªç«¯å£å¯ä»¥å±äºå¤šä¸ªVLANï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªPVIDï¼Œæ”¶åˆ°ä¸€ä¸ªä¸å¸¦tagå¤´çš„æ•°æ®åŒ…æ—¶ï¼Œä¼šæ‰“ä¸ŠPVIDæ‰€è¡¨ç¤ºçš„VLANå·ï¼Œè§†åŒè¯¥VLANçš„æ•°æ®åŒ…å¤„ç†ä¸€ä¸ªç‰©ç†ç«¯å£åªèƒ½æ‹¥æœ‰ä¸€ä¸ªPVIDï¼Œå½“ä¸€ä¸ªç‰©ç†ç«¯å£æ‹¥æœ‰äº†ä¸€ä¸ªPVIDçš„æ—¶å€™ï¼Œå¿…å®šä¼šæ‹¥æœ‰å’ŒPVIDç›¸ç­‰çš„VIDï¼Œè€Œä¸”åœ¨è¿™ä¸ªVIDä¸Šï¼Œè¿™ä¸ªç‰©ç†ç«¯å£å¿…å®šæ˜¯Untagged Portã€‚PVIDçš„ä½œç”¨åªæ˜¯åœ¨äº¤æ¢æœºä»å¤–éƒ¨æ¥å—åˆ°å¯ä»¥æ¥å—Untagged æ•°æ®å¸§çš„æ—¶å€™ç»™æ•°æ®å¸§æ·»åŠ TAGæ ‡è®°ç”¨çš„ï¼Œåœ¨äº¤æ¢æœºå†…éƒ¨è½¬å‘æ•°æ®çš„æ—¶å€™PVIDä¸èµ·ä»»ä½•ä½œç”¨https://baike.baidu.com/item/PVID ç½‘å€äº¤æ¢æœºä¸‰ç§ç«¯å£æ¨¡å¼Accessã€Hybridå’ŒTrunkçš„ç†è§£http://www.word666.com/zhishi/62797.html","link":"/posts/9bb9b12b/"},{"title":"ç½‘ç»œéƒ¨ç½²éœ€æ±‚åˆ†æ","text":"ç½‘ç»œéƒ¨ç½²éœ€æ±‚åˆ†æåé¢éœ€è¦æ ¹æ®towerç»™å‡ºçš„å†…å®¹å¯¹ç½‘ç»œç¯å¢ƒï¼Œæœºå™¨ä¸Šæ¶è§„åˆ’å†…å®¹ç”±äºtowerä¸­ç»™å‡ºçš„å¤§éƒ¨åˆ†éƒ½æ˜¯çº¸ä¸Šä¿¡æ¯ï¼Œè¿™é‡Œåšå‡ ä¸ªä¾‹å­è¿›è¡Œä¸€ä¸‹æ€»ç»“ å‡¡æ˜¯æ²¡æœ‰æåˆ°2å±‚æˆ–è€…3å±‚éœ€æ±‚çš„ï¼Œéƒ½æŒ‰ç…§3å±‚éœ€æ±‚æ¥å¤„ç† *****åŸºç¡€é…ç½®åŸºç¡€é…ç½® äºŒä¸‰å±‚é€šç”¨ # ç”¨æˆ·é…ç½®local-user admin class manage service-type ssh authorization-attribute user-role level-3 authorization-attribute user-role network-admin authorization-attribute user-role network-operator#local-user root class manage service-type ssh authorization-attribute user-role level-3 authorization-attribute user-role network-admin authorization-attribute user-role network-operatoruser-interface vty 0 4authentication-mode scheme user-role network-adminprotocol inbound allquit# ä¸æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯undo copyright-info enable# å…¬é’¥å¯¼å…¥public-key peer pub public-key-code begin 30820122300D06092A864886F70D01010105000382010F003082010A0282010100D37D67EC 5A9466CD38895097E74386EBBEFA9EC59236DF5E96D7514B2903C21F09C6D47D74792B5E3D C1F99DB4D43614AE3AD61DEFFAF35CED9B94DBD85DE174598C491FA043F8C700DA686BFFCA 227E4E7417A251CD7590673B4C1A227962F65CBA6017329479484EF8FE48A8E2FED636C846 5765801A0D62C821906FF8E7188DA69D716FD392E8C0D4D0618E9020670FFA24CF083E2EF7 690EABCA43AA4341D798A72B6FFB5A0A1BEF0F4B14B6B66E5F7126582BD11A11F4220EA3FF C1A5DF36E86E76A8EF6A97949158F094CBAD09725069A090CBA36D95CB6A9531A5AB8B3ED5 8D6C63C8138320F0F1ECD7B25203A1B79FC82635B0F53475BC428B3B741F0203010001 public-key-code end peer-public-key endpublic-key peer upyun public-key-code begin 30820122300D06092A864886F70D01010105000382010F003082010A0282010100BEF4DB4E 5224F5FFE95AF67CC1753592979F6C1379E0A1FB8519C0E6E626B50F221957806B64384173 F2B370254381D583D3EC70D4211CC599CF6C1615754E985895D1E78E1E62788A9BC2E4D2EB 55A18FD20D2B692813114C650FE4FC883DB5467039264C2478332C2C967F3DAE83AFBDFAB3 D794F38DCB2E112184127A151741947DFBB00E8E66B9037131C54A27DE703B2E80A3D8D3C6 79CFC9E851D9C76610228790D7E2253D7E7735481D2EA61AA71D6DFD2EAC037203CE08943E 43DF88AC1ECCB77433358B5ABDF080616D6B6C40AEBEEEDD64D8B8718F091CAA0EA8D5A6A0 2B6106D931E45717C94DBC0F3FF6608CB609C4DA4860C8C48EE67CB304470203010001 public-key-code end peer-public-key end# ç”¨æˆ·å…¬é’¥è®¤è¯ssh user admin service-type stelnet authentication-type publickey assign publickey pubssh user root service-type stelnet authentication-type publickey assign publickey upyun# aclè¿‡æ»¤acl number 2000description Login IP Controlrule 1 permit source 192.168.0.0 0.0.255.255rule 5 permit source 115.238.93.82 0rule 10 permit source 115.231.100.64 0.0.0.63rule 15 permit source 121.52.226.192 0.0.0.63rule 20 permit source 115.238.54.160 0.0.0.15rule 25 permit source 124.160.114.192 0.0.0.15rule 30 permit source 106.186.117.158 0.0.0.255rule 35 permit source 157.119.232.0 0.0.0.31rule 40 permit source 218.205.64.19 0.0.0.31rule 45 permit source 112.17.251.0 0.0.0.31rule 50 permit source 121.52.250.193 0.0.0.31rule 55 permit source 183.131.0.65 0.0.0.31rule 60 permit source 43.230.89.160 0.0.0.31rule 65 permit source 111.1.32.0 0.0.0.127rule 70 permit source 115.231.97.0 0.0.0.31rule 1000 deny source anyquitundo ip http enable# sshè¿‡æ»¤ssh server enablessh server acl 2000# æ¥å£è¿‡æ»¤user-interface vty 0 4acl 2000 inbound# snmpç›‘æ§snmp-agentsnmp-agent local-engineid 800063A203snmp-agent community read hgE6ofdZ3bsnmp-agent sys-info version v2c v3 # æœºå™¨æ—¶é—´åŒæ­¥ntp-service unicast-server 218.189.210.4 source Vlan-interface 1ntp-service unicast-server 137.189.4.10 source Vlan-interface 1clock timezone beijing add 8# è·¯ç”±è¿½è¸ªip ttl-expires enableip unreachables enableipv6 unreachables enable ***äºŒå±‚ç¯è·¯æ£€æµ‹é…ç½®h3c 5130é…ç½® loopback-detection global enable vlan all# ç«¯å£å®šæ—¶å™¨shutdown-interval 120 # ç¯è·¯æ£€æµ‹æŠ¥æ–‡å‘é€å‘¨æœŸloopback-detection interval-time 5# æ¥å£å†…éƒ¨é…ç½®# ç¯è·¯æ£€æµ‹æ¥å£é…ç½®loopback-detection action shutdownloopback-detection enable vlan all h3c 5120é…ç½® loopback-detection multi-port-mode enableloopback-detection enable# ç«¯å£å®šæ—¶å™¨shutdown-interval 120 # ç¯è·¯æ£€æµ‹æŠ¥æ–‡å‘é€å‘¨æœŸloopback-description interval-time 5# æ¥å£å†…é…ç½®# ç¯è·¯æ£€æµ‹æ¥å£é…ç½®loopback-detection action shutdownloopback-detection enable vlan all èµ°äºŒå±‚ä¸èµ°ä¸‰å±‚çš„å…³ç³»äº¤æ¢æœºçš„äºŒä¸‰å±‚å†³å®šå–å†³äºOSIæ¨¡å‹ ï¼ŒäºŒå±‚èµ°æ•°æ®é“¾è·¯å±‚ ä¸‰å±‚åœ¨äºŒå±‚åŸºç¡€ä¸Šæ·»åŠ ç½‘ç»œå±‚å¦å¤–äº¤æ¢æœºæ˜¯å¦èµ°ä¸‰å±‚ï¼Œåº”è¯¥å–å†³äºç½‘ç»œçš„è§„åˆ’ é¦–å…ˆæ˜¯äºŒå±‚äº¤æ¢æœºèµ°äºŒå±‚ï¼Œè·¯ç”±åœ¨æ ¸å¿ƒäº¤æ¢æœºä¸Šï¼Œä¸è½¬å‘å¤šç½‘æ®µçš„æ•°æ®(Vlan)æ•°æ®èµ°æ•°æ®é“¾è·¯å±‚ä»¥ä¸Šè¯´æ˜äºŒå±‚äº¤æ¢æœºä¸èƒ½è·¨ç½‘æ®µä¼ è¾“ä¿¡æ¯ï¼Œåœ¨åˆ’åˆ†vlançš„æƒ…å†µä¸‹ï¼Œåªèƒ½èµ°åŒvlanä¸‹çš„æ•°æ® éœ€è¦æµ‹è¯• # åœ¨åŒvlanä¸‹ï¼Œä¸é€šç½‘æ®µipéœ€è¦é»˜è®¤è·¯ç”±ï¼Ÿ# åœ¨åŒvlanä¸‹ï¼ŒåŒç½‘æ®µipä¸éœ€è¦é»˜è®¤è·¯ç”±ï¼Ÿ # é™æ€è·¯ç”±çš„åŠŸèƒ½é™¤äº† è§„å®šæµé‡è½¬å‘è¿˜æœ‰ä»€ä¹ˆï¼Ÿ é™æ€è·¯ç”±æŒ‡å‘æ ¸å¿ƒäº¤æ¢æœºä¸Šçš„ç½‘å…³ å…¶æ¬¡æ˜¯ä¸‰å±‚äº¤æ¢æœºä¸‰å±‚äº¤æ¢æœºå°±æ˜¯åœ¨äºŒå±‚äº¤æ¢æœºçš„åŸºç¡€ä¸ŠåŠ äº†è·¯ç”±åŠŸèƒ½ï¼Œäº¤æ¢æœºèµ°ä¸‰å±‚ï¼Œè·¯ç”±åœ¨å½“å‰ä¸‰å±‚äº¤æ¢æœºä¸Šä¸‰å±‚äº¤æ¢æœºèƒ½è½¬å‘å¤šç½‘æ®µçš„æ•°æ®,è·¯ç”±å™¨è½¬å‘æ•°æ®æ˜¯åŸºäºIPåœ°å€è¿›è¡Œè½¬å‘çš„ï¼ï¼è€ŒäºŒå±‚äº¤æ¢æœºæ˜¯åŸºäºMACåœ°å€è½¬å‘çš„ï¼ï¼è®©åŸºäºMACåœ°å€è½¬å‘çš„äº¤æ¢æœºå®ç°åŸºäºIPåœ°å€è½¬å‘ ===> ä¸‰å±‚äº¤æ¢æœº ä¸‰å±‚äº¤æ¢æœºå¯ä»¥è½¬å‘å¤šç½‘æ®µçš„æ•°æ®ï¼Œä¸å±€é™äºåŒvlanä¸‹çš„æ•°æ®è½¬å‘ï¼Œ é™æ€è·¯ç”±æŒ‡å‘ç½‘å…³ è™½ç„¶ä¸‰å±‚äº¤æ¢æœºæœ‰è·¯ç”±åŠŸèƒ½ï¼Œä½†ä¸èƒ½å®Œå…¨å–ä»£è·¯ç”±å™¨ï¼ŒåŸºç¡€åŸç†ä¸åŒ äºŒå±‚æ¶æ„äºä¸‰å±‚æ¶æ„çš„åŒºåˆ«https://blog.51cto.com/fenggao/1582958https://www.cnblogs.com/sunada2005/articles/2666902.html ä¸¾ä¾‹æ¯”å¦‚ä½ ç°åœ¨æœ‰ä¸¤å°äº¤æ¢æœº A BA ä½œä¸ºæ ¸å¿ƒäº¤æ¢æœºB ä½œä¸ºæ ¸å¿ƒæœºä¸‹é¢çš„æœºå™¨ è¦èµ°äºŒå±‚çš„è¯ï¼Œåˆ™åŒvlanèµ°ä¸ªé™æ€å°±okäº† è¦èµ°ä¸‰å±‚çš„è¯ï¼Œä¹Ÿå°±æ˜¯è¯´Bä¸‹é¢æœ‰å¤šä¸ªç½‘æ®µçš„æœºå™¨ ä¸¤å°æœºå™¨çš„vlanæ˜¯ä¸éœ€è¦ç›¸åŒçš„ï¼Œä¸‰å±‚äº¤æ¢æœºä¼šåŠ¨æ€é…ç½® ç¦å»ºå¦é—¨è”é€šCUN-FJ-XMN-S01å¦‚å›¾ä»¥ä¸Šä¿¡æ¯ ipä¿¡æ¯ 36.248.208.224/27æœºå™¨ä¿¡æ¯ 15å°1UæœåŠ¡å™¨ 1å°5130äº¤æ¢æœº(52å£) 2ä¸ªä¸‡å…†å¤šæ¨¡ 30æ ¹ç½‘çº¿ 16æ ¹ç”µæºçº¿-->-->-->ä¹Ÿå°±æ˜¯è¯´ 15å°æœåŠ¡å™¨æ¯å°2æ ¹ç½‘çº¿ 5130äº¤æ¢æœºå‰é¢30ä¸ªç”µå£åšæ±‡èšinterface bridge-aggregation 1interface GigabitEthernet1/0/1port link-aggregation group 1interface GigabitEthernet1/0/2port link-aggregation group 1# å¯ä»¥ç”¨è„šæœ¬ç”Ÿæˆä¸¤ä¸ªä¸‡å…†å¤šæ¨¡ï¼Œäº¤æ¢æœºä¸Šè”æ¥å…¥ä¸€ä¸ªï¼Œä¸Šè”ä¸€ä¸ª ****èµ°äºŒå±‚ä¸èµ°vlan1 æŒ‡å®švlan 2250# é…ç½®vlan2250vlan 2250int vlan-interface 2250ip address 36.248.208.226 255.255.255.224# ç«¯å£æ±‡èšinterface bridge-aggregation 1interface GigabitEthernet2/0/1port link-aggregation group 1interface GigabitEthernet2/0/2port link-aggregation group 1...int range Bridge-Aggregation 1 to Bridge-Aggregation 15port access vlan 2250# é…ç½®ä¸Šè”å£interface ten1/0/49port link-type trunk # æ¥å…¥trunkæ¨¡å¼ï¼Œå¯¹åº”trunkæ¨¡å¼undo port trunk permit vlan 1port trunk permit vlan 2250# å…³é—­ç«¯å£stpç”Ÿæˆæ ‘åŠŸèƒ½int range g1/0/1 to g1/0/30 undo stp enable# äºŒå±‚ç¯è·¯æ£€æµ‹é…ç½® å››å·æˆéƒ½è”é€šCMN-SC-CTU4-S01ZA-16030782 1 2 å£ZA-16030781 3 4 å£ZA-16031259 5 6 å£ZA-16031257 7 8 å£ZA-16030285 9 10 å£ZA-15041213 11 12 å£ZA-15041819 13 14 å£ZA-15041852 15 16 å£ZA-15070367 17 18 å£ZA-19010018 19 20 å£ 6300 47 48ä¸Šè”å£ # èµ°ä¸‰å±‚10 å°äº¤æ¢æœº æ±‡èš èµ°1-20å£ èµ°47 48å£ # è¿™ä¸ªéœ€è¦é—®ï¼Œå›¾é‡Œæ²¡ç»™ *****èµ°ä¸‰å±‚# åŸºç¡€é…ç½® å¤åˆ¶ç²˜è´´# é…ç½®vlan 200 201vlan 200int vlan-interface 200ip address 117.172.4.50 255.255.255.252vlan 201 int vlan-interface 201ip address 117.172.4.54 255.255.255.252vlan 1int vlan-interface 1ip address 117.172.22.129 255.255.255.224# é…ç½®é™æ€è·¯ç”±ip route-static 0.0.0.0 0 117.172.4.49ip route-static 0.0.0.0 0 117.172.4.53# é…ç½®ä¸Šè”int ten 1/0/47port access vlan 200int ten 1/0/49port access vlan 201# äºŒå±‚ç¯è·¯æ£€æµ‹é…ç½® è‡ªåŠ¨ç”Ÿæˆæ±‡èšç«¯å£é…ç½®è„šæœ¬import osimport json# æŒ‡å®šç«¯å£ç±»å‹ æœ‰äº›åšè¿‡å †å çš„äº¤æ¢æœº MemberIDæ˜¯ä¸åŒçš„port_type = \"1\"for i in range(1,16): print(\"interface bridge-aggregation %s\"%i) print(\"interface GigabitEthernet%s/0/%s\"%(port_type,int(i*2-1))) print(\"port link-aggregation group %s\"%i) print(\"interface GigabitEthernet%s/0/%s\"%(port_type,int(i*2))) print(\"port link-aggregation group %s\"%i)## REANME.md##äº¤æ¢æœºçš„é…ç½®éœ€è¦æ‰¹é‡é…ç½®ç®¡ç†ç«¯å£##ç”¨è¿™ä¸ªè„šæœ¬ç”Ÿæˆå°±okäº† check-list åŸºç¡€é…ç½®æ˜¯å¦å®ŒæˆåŸºç¡€é…ç½®ä¸»è¦æ˜¯ä¸Šé¢æ‰“*çš„éƒ¨åˆ†ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¤åˆ¶ç²˜è´´å°±å¯ä»¥äº† äº’è”æ˜¯å¦å·²é€šping ä¸‹è‡ªå·±ï¼Œping ä¸‹å¯¹ç«¯ å¦‚æœæœºæˆ¿ä¸´æ—¶æœ‰äº‹ï¼Œå¯¼è‡´äº¤æ¢æœºæ—¶é—´å†…æ— æ³•è¿ä¸Šç½‘ç»œï¼Œå¯ä»¥å…ˆè¯•ç€pingä¸€ä¸‹loopback æ¥å£3.","link":"/posts/291d4679/"},{"title":"hexoåšå®¢ä¼˜åŒ–","text":"handsomeåšå®¢ä¼˜åŒ–ä¿®æ”¹å³ä¾§æ sidebar.php æ­¤å¤„ç›´æ¥å»é™¤äº† çƒ­é—¨æ–‡å­— ã€ æœ€æ–°è¯„è®º ã€ éšæœºæ–‡å­— è¿™ä¸‰ä¸ªæ¨¡å—ï¼ˆä»–ä»¬åœ¨ä¸€ä¸ª Tab é‡Œï¼‰ è¿™é‡Œæ˜¯æˆ‘çš„ä¸ªäººå°ç«™ï¼šçŒ«ä¹‹ä¸‰åƒå²ï¼Œç”¨ä»¥è®°å½•ç”Ÿæ´»ä¸­çš„ç‚¹ç‚¹æ»´æ»´ï¼Œæˆ‘ä¸€ç›´è®¤ä¸ºæœ‰ä¸€ä¸ªå®‰é™çš„ã€æ¸©é¦¨çš„å°çªæ˜¯ä¸€ä»¶å¾ˆå¿«ä¹çš„äº‹æƒ…ã€‚æœ€åæ¬¢è¿æ‚¨ä¸ç»æ„é—´çš„å…‰ä¸´~ ğŸ¾ éƒ¨åˆ†ä¿®æ”¹ç½‘ç«™https://szyink.com/archives/229/ å¦‚ä½•è·å–è‡ªå·±çš„å¤‡æ¡ˆå·https://icp.chinaz.com/noback.top æ”¹æˆCDNçš„å†…å®¹public static function whenSwitchHeaderImgSrc($index = 0, $howToThumb, $attach, $content, $thumbField) { $options = mget(); //$randomNum = unserialize(INDEX_IMAGE_ARRAY); // éšæœºç¼©ç•¥å›¾è·¯å¾„ // $random = \"http://image.noback.top/\" . @$randomNum[$index] . '.jpg';//å¦‚æœæœ‰æ–‡ç« ç½®é¡¶ï¼Œè¿™é‡Œå¯èƒ½ä¼šå¯¼è‡´index not undefined $random = 'http://image.noback.top/'.rand(1, 69).'.jpg'; $pattern = '/\\]*>/i'; çªç„¶åˆæƒ³äº†ä¸€ä¸ªéªšæ“ä½œ åªè¦æŠŠbing 4kå£çº¸ä¸Šçš„https://bing.lylares.com/detail/cnjX2Vj0.html åç¼€æ‹¿åˆ° å¼„ä¸€ä¸ªåˆ—è¡¨ éšæœºä¸€ä¸‹ è¿™æ ·CDNæµé‡é’±éƒ½çœäº†ï½ ç½‘ç«™æµ‹é€Ÿhttps://developers.google.com/speed/pagespeed/insights/?hl=zh-cn&url=http%3A%2F%2Fnoback.top%2F hexoåšå®¢ä¼˜åŒ–end of the stream or a document separator is expected at line 8, column 1:æŠ¥é”™å†…å®¹ æ²¡æœ‰æ·»åŠ ---title:tags:---ç­‰å¤´éƒ¨å†…å®¹","link":"/posts/83186147/"},{"title":"jwtåŸç†ä¸å®æˆ˜åº”ç”¨","text":"jwtåŸç†ä¸å®æˆ˜åº”ç”¨ åŸºäºä¼ ç»Ÿçš„tokenè®¤è¯ç”¨æˆ·ç™»é™†ï¼ŒæœåŠ¡ç«¯ç»™è¿”å›token,å¹¶å°†tokenä¿å­˜åœ¨æœåŠ¡ç«¯ï¼Œä»¥åç”¨æˆ·è®¿é—®æ—¶ï¼Œéœ€è¦æºå¸¦tokenï¼ŒæœåŠ¡ç«¯è·å–tokenåï¼Œå†å»æ•°æ®åº“ä¸­è·å–tokenè®¤è¯æ ¡éªŒ jwtå½¢å¼çš„tokenè®¤è¯ç”¨æˆ·ç™»å½•ï¼ŒæœåŠ¡ç«¯ç»™ç”¨æˆ·è¿”å›ä¸€ä¸ªtoken(æœåŠ¡ç«¯ä¸ä¿å­˜)ï¼Œä»¥åç”¨æˆ·å†æ¥è®¿é—®ï¼Œéœ€è¦æºå¸¦tokenï¼ŒæœåŠ¡ç«¯è·å–tokenåï¼Œå†åštokenè®¤è¯ ä¸ç”¨åœ¨æœåŠ¡ç«¯ä¿å­˜token jwtå®ç°è¿‡ç¨‹ ç”¨æˆ·æäº¤ç”¨æˆ·åå’Œå¯†ç ç»™æœåŠ¡å™¨ï¼Œå¦‚æœç™»å½•æˆåŠŸï¼Œä½¿ç”¨jwtåˆ›å»ºä¸€ä¸ªtokenï¼Œå¹¶ç»™ç”¨æˆ·è¿”å›ã€‚ jwt-tokenç»„æˆç”±ä¸‰æ®µå­—ç¬¦ä¸²ç»„æˆï¼Œå¹¶ä¸”ç”¨.è¿æ¥ åŠ å¯†è¿‡ç¨‹ ç¬¬ä¸€æ®µå­—ç¬¦ä¸² header å†…éƒ¨åŒ…å«ç®—æ³•/tokenç±»å‹.json è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œç„¶ååšbase64urlåŠ å¯†(base64åŠ å¯†) { \"alg\": \"HS256\", # ç®—æ³• \"typ\": \"JWT\", # ç±»å‹} ç¬¬äºŒæ®µå­—ç¬¦ä¸²payload è‡ªå®šä¹‰å€¼jsonè½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œç„¶ååšbase64urlåŠ å¯†(base64åŠ å¯†) { \"id\": \"12343242\", \"name\": \"hzj\", \"exp\": 323212423 # è¶…æ—¶æ—¶é—´} ç¬¬ä¸‰æ®µå­—ç¬¦ä¸²:æ‹¼æ¥1,2éƒ¨åˆ†å†…å®¹ï¼Œå¹¶å¯¹å…¶è¿›è¡ŒHS256åŠ å¯† + åŠ ç›(åŠ éšæœºå­—ç¬¦ä¸²)å¯¹HS256åŠ å¯†åçš„å¯†æ–‡å†åšbase64urlåŠ å¯† è¿”å›ç»™ç”¨æˆ·ï¼Œç”¨æˆ·ä¸‹æ¬¡è®¿é—®å¸¦ç€jwt-tokenæ¥è®¿é—® è§£å¯†è¿‡ç¨‹ç”¨æˆ·ç¬¬äºŒæ¬¡è®¿é—®ï¼Œå¸¦ç€jjwt-tokenæ¥è®¿é—®ï¼Œåç«¯éœ€è¦å¯¹tokenè¿›è¡ŒéªŒè¯ è·å–tokenï¼Œæ ¹æ®.å¯¹tokenè¿›è¡Œåˆ‡å‰² å¯¹ç¬¬äºŒæ®µè¿›è¡Œbase64urlè§£å¯†ï¼Œå¹¶è·å–payloadä¿¡æ¯{ \"id\": \"1234343\", \"name\": \"hzj\", \"exp\": 432423 # è¶…æ—¶æ—¶é—´} ç¬¬ä¸‰æ­¥: æŠŠç¬¬ä¸€äºŒæ®µæ‹¼æ¥ï¼Œå†æ¬¡HS256åŠ å¯†åå¯¹base64urlè§£å¯†åçš„å†…å®¹è¿›è¡Œæ¯”è¾ƒ(è®¤è¯é€šè¿‡)åœ¨ jwtå®ç°åŸç† åº•å±‚ä½¿ç”¨pyjwt drfå°è£…åº“ä½¿ç”¨çš„æ˜¯django-estframework-jwt pyjwtä½¿ç”¨# å®‰è£…pip install pyjwt ç”Ÿæˆtoken # é…ç½®import jwtimport datetimefrom django.conf import settings# ç”Ÿæˆtokendef create_token(payload,timeout=1): # éšæœºç¬¦å·ï¼Œè¿™é‡Œå†™äº†è¯¥é¡¹ç›®çš„secret_key salt = settings.SECRET_KEY # æ„é€ header headers = { 'typ': 'jwt', 'alg': 'HS256', } # æ„é€ payload payload = { 'user_id': \"ud\", 'username': \"username\", 'exp': datetime.datetime.utcnow() + datetime.timedelta(minutes=timeout) } token = jwt.encode(payload=payload, key=salt, algorithm=\"HS256\", headers=headers).decode('utf-8') return token éªŒè¯token from rest_framework.authentication import BaseAuthenticationimport thisimport jwtimport datetimefrom rest_framework.response import Responsefrom django.conf import settingsfrom rest_framework import exceptionssalt = settings.SECRET_KEYclass JwtQueryParamsAuthentication(BaseAuthentication): def authenticate(self, request): # è·å–token å¹¶åˆ¤æ–­tokençš„åˆæ³•æ€§ token = request.query_params.get(\"token\") # 1ã€‚åˆ‡å‰² # 2. è§£å¯†ç¬¬äºŒæ®µ/åˆ¤æ–­è¿‡æœŸ # 3. éªŒè¯ç¬¬ä¸‰æ®µåˆæ³•æ€§ playload = None msg = None try: payload = jwt.decode(token,salt,True) except exceptions: msg = 'tokenå·²ç»å¤±æ•ˆ' except jwt.DecodeError: msg = \"tokenè®¤è¯å¤±è´¥\" except jwt.InvalidTokenError: msg = \"éæ³•çš„token\" if not playload: pass else: return (playload,msg) viewsç¼–å†™ # viewsç¼–å†™ from api.extensions.auth import JwtQueryParamsAuthenticationclass ProOrderView(ApiView): authentication_classes = [JwtQueryParamsAuthentication,] djangorestframework-jwtä½¿ç”¨djangorestframework-jwtæœ¬è´¨æ˜¯è°ƒç”¨pyjwtå®ç°çš„ # å®‰è£…pip install djangorestframework-jwt åœ°å€jwtè®¤è¯http://yangjianhua.me/2020/01/django-drf-8/ https://shuke163.github.io/2019/02/24/Django-REST-framework-API%E8%AE%A4%E8%AF%81-%E5%8C%85%E5%90%ABJWT%E8%AE%A4%E8%AF%81/https://www.cnblogs.com/ruhai/p/11311852.htmlhttps://www.cnblogs.com/chichung/p/9967325.html","link":"/posts/e8b3a2c2/"},{"title":"macé…ç½®","text":"macé…ç½®Mac OS ä¸­å¦‚ä½•ä¼˜é›…çš„åˆ›å»ºå®šæ—¶ä»»åŠ¡mac å¯ä»¥åƒlinuxä¸€æ ·ä½¿ç”¨crontabæ¥ä½¿ç”¨å®šæ—¶ä»»åŠ¡.å¦å¤–è¿˜æœ‰ä¸€ä¸ªlaunchctlçš„å·¥å…· é…ç½®æ–‡ä»¶ xxx.plist Label cn.rayjun..plist ProgramArguments /path/to/programer StartCalendarInterval Minute 00 Hour 22 StandardOutPath /path/to/log/x.log StandardErrorPath /path/to/err/x.err åœ¨ Plist ä¸­ï¼Œæ”¯æŒä¸¤ç§å®šæ—¶ä»»åŠ¡çš„è®¾ç½®ï¼š StartIntervalï¼šå®šä¹‰ä»»åŠ¡å¤šé•¿æ—¶é—´ï¼ˆå•ä½ï¼Œç§’ï¼‰æ‰§è¡Œä¸€æ¬¡ StartCalendarIntervalï¼šè¿™ä¸ªé…ç½®ç±»ä¼¼åœ¨ crontab ä¸­çš„é…ç½®ï¼ŒæŒ‡å®šå…·ä½“çš„æ‰§è¡Œæ—¥æœŸã€æ˜ŸæœŸã€æ¯æœˆã€æ¯æ—¥çš„å„ä¸ªæ—¶é—´ç‚¹ï¼Œå…·ä½“å‚ç…§ä¸Šé¢çš„é…ç½®æ–‡ä»¶ã€‚æœˆä»½å’Œå¤©æ•°çš„é…ç½®ç±»ä¼¼ã€‚ å­˜æ”¾ç‚¹åœ¨ Mac ç³»ç»Ÿä¸­ï¼Œå¯ä»¥å°†éœ€è¦å¤„ç†çš„äº‹æƒ…éƒ½å†™åœ¨ plist æ–‡ä»¶ä¸­ï¼Œplist æ˜¯ä¸€ä¸ª xml æ ¼å¼çš„æ–‡ä»¶ã€‚plist æ–‡ä»¶æ ¹æ®ä¸åŒçš„éœ€è¦å¯ä»¥æ”¾åœ¨ä¸åŒçš„ç›®å½•åº•ä¸‹ã€‚Mac OS X ä¸­æ”¯æŒæ”¾ plist çš„ç›®å½•å¦‚ä¸‹ï¼š /Library/LaunchDaemons: ç³»ç»Ÿå¯åŠ¨åå°±ä¼šæ‰§è¡Œ /Library/LaunchAgents: å½“ç”¨æˆ·ç™»å½•ç³»ç»Ÿåæ‰ä¼šæ‰§è¡Œ ~/Library/LaunchAgents: ç”¨æˆ·è‡ªå®šä¹‰çš„ plist /System/Library/LaunchAgents: ç”± Mac OS X ä¸ºç”¨æˆ·å®šä¹‰çš„ä»»åŠ¡ /System/Library/LaunchDaemons: ç”± Mac OS X å®šä¹‰çš„å®ˆæŠ¤è¿›ç¨‹ä»»åŠ¡ å‘½ä»¤è¡Œ launchctl load xx.plist # å¯åŠ¨ç¨‹åºlaunchctl unload xx.plist # åœæ­¢ç¨‹åº è§£å†³è®¨åŒçš„.DS_Store.DS_Store (Desktop Services Store) æ˜¯ä¸€ç§ç”±è‹¹æœå…¬å¸çš„ Mac OS X æ“ä½œç³»ç»Ÿæ‰€åˆ›é€ çš„éšè—æ–‡ä»¶ï¼Œç›®çš„åœ¨äºå­˜è´®ç›®å½•çš„è‡ªå®šä¹‰å±æ€§ï¼Œä¾‹å¦‚æ–‡ä»¶ä»¬çš„å›¾æ ‡ä½ç½®æˆ–è€…æ˜¯èƒŒæ™¯è‰²çš„é€‰æ‹©ã€‚ç›¸å½“äº Windows ä¸‹çš„ desktop.ini ä¸ºä»€ä¹ˆè¦è§£å†³ï¼Ÿå¦‚æœä¸å¤„ç†ï¼Œæ¯æ¬¡æ‹·è´ç»™ä½ åŒäº‹çš„æ–‡ä»¶é‡Œéƒ½ä¼šåŒ…å«æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ–è€…ä¸Šä¼ ç½‘é¡µçš„æ—¶å€™ï¼Œåº”è¯¥æŠŠè¿™ä¸ªæ–‡ä»¶åˆ é™¤æ¯”è¾ƒå¦¥å½“ï¼Œå› ä¸ºé‡Œé¢åŒ…å«äº†ä¸€äº›ä½ ä¸ä¸€å®šå¸Œæœ›åˆ«äººçœ‹è§çš„ä¿¡æ¯ã€‚ï¼ˆå°¤å…¶æ˜¯ç½‘ç«™ï¼Œé€šè¿‡ .DS_Store å¯ä»¥çŸ¥é“è¿™ä¸ªç›®å½•é‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„æ¸…å•ï¼Œå¾ˆå¤šæ—¶å€™è¿™æ˜¯ä¸€ä¸ªä¸å¸Œæœ›å‡ºç°çš„é—®é¢˜ã€‚ï¼‰ è§£å†³ åˆ é™¤å½“å‰ç›®å½•çš„.DS_Storefind . -name '*.DS_Store' -type f -delete åˆ é™¤æ‰€æœ‰ç›®å½•çš„.DS_Storesudo find / -name \".DS_Store\" -depth -exec rm {} \\; ç¦æ­¢.DS_Storeç”Ÿæˆdefaults write com.apple.desktopservices DSDontWriteNetworkStores -bool TRUE æ¢å¤.DS_Storeç”Ÿæˆdefaults delete com.apple.desktopservices DSDontWriteNetworkStores gitä¸Šä¼ å¿½ç•¥å…¨å±€æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨gitconfigä¸­å¼•å…¥touch ~/.gitigonre_global# .gitignore_global############################################ OS generated files ############################################.DS_Store.DS_Store?*.swp._*.Spotlight-V100.TrashesIcon?ehthumbs.dbThumbs.db################################################# packages #################################################*.7z*.dmg*.gz*.iso*.jar*.rar*.tar*.zip #.gitconfig[filter \"lfs\"] required = true clean = git-lfs clean %f smudge = git-lfs smudge %f[user] name = bingozb email = 454113692@qq.com[core] excludesfile = /Users/bingo/.gitignore_global","link":"/posts/76ec0771/"},{"title":"å¸¸è§é”™è¯¯","text":"linuxé”™è¯¯yumä¸æ”¯æŒpython3[root@gogogo alpaca]# yum File \"/bin/yum\", line 30 except KeyboardInterrupt, e: ^SyntaxError: invalid syntax File \"/usr/libexec/urlgrabber-ext-down\", line 28 except OSError, e: è§£å†³åŠæ³• sed -i 's:bin/python:bin/python2.7:' /usr/bin/yumsed -i 's:bin/python:bin/python2.7:' /usr/libexec/urlgrabber-ext-down å¯ä»¥é€šå¤–ç½‘ï¼Œä½†æ˜¯æ— æ³•pingç™¾åº¦åŒ…æ‹¬æ— æ³•ä½¿ç”¨yum wget ç­‰ä¸‹è½½å·¥å…·æˆ–è€…æŠ¥é”™ cannot find a valid baseurl for repo:base/7/x86_64 çš„è§£å†³æ–¹æ³• è§£å†³åŠæ³•åŸå›  - > DNSçš„é—®é¢˜ echo nameserver 114.114.114.114 > /etc/reslov.conf linuxä¸­å¦‚ä½•æ¢å¤åˆ°åå°è¿›ç¨‹linux ä¸‹æˆ‘ä»¬å¦‚æœæƒ³ä¸€ä¸ªä»»åŠ¡æˆ–è€…ç¨‹åºè¿›è¡Œè°ƒåº¦bg å°†ä¸€ä¸ªåå°æš‚åœçš„å‘½ä»¤ï¼Œå˜æˆç»§ç»­æ‰§è¡Œfg å°†åå°çš„å‘½ä»¤è°ƒè‡³å‰å°ç»§ç»­è¿è¡Œjobs æŸ¥çœ‹å½“å‰åœ¨åå°è¿è¡Œçš„å‘½ä»¤c-z å°†å‰å°å‘½ä»¤æ”¾åˆ°åå°è¿è¡Œ å¹¶ä¸”æš‚åœnohup command & åœ¨åå°ä¸æ–­è¿è¡Œcommandå‘½ä»¤ sshé…ç½®çš„é—®é¢˜è¿™ä¸ªé—®é¢˜ä¸»è¦æ˜¯å­˜åœ¨äºäº¤æ¢æœºsshç™»é™†äº¤æ¢æœºçš„è¿‡ç¨‹sshé…ç½®è¿‡ç¨‹ä¸­ï¼Œé…ç½®äº†å¯†ç ç™»é™†ï¼Œä½†æ˜¯å‡ºç°ä¸‹é¢çš„é”™è¯¯ ssh 10.0.0.166The server's host key does not match the local cached key. Either the server administrator has changed the host key, or you connected to another server pretending to be this server. Please remove the local cached key, before logging in! ä¸»è¦é—®é¢˜æ˜¯ä¸€å¼€å§‹ç”¨sshç™»é™†äº¤æ¢æœºçš„æ—¶å€™ï¼Œé€‰æ‹©äº†ä¿å­˜key ssh 10.0.0.166Username: ttPress CTRL+C to abort.Connecting to 10.0.0.166 port 22.The server is not authenticated. Continue? [Y/N]:yDo you want to save the server public key? [Y/N]:y è¿™æ ·å¯¼è‡´çš„é—®é¢˜å°±æ˜¯åœ¨å½“å‰äº¤æ¢æœºä¸Šä¼šä¿å­˜ä¸€ä¸ªç™»é™†å¦ä¸€ä¸ªäº¤æ¢æœºçš„key #public-key peer 10.0.0.166 public-key-code begin 30819F300D06092A864886F70D010101050003818D0030818902818100DF3E1240D158E197 CE0712173C8591883F88CC925B1C0CFC63C779E9F531C3B7E409BBB2CCED954C09A339BE78 46B1497E4771EDD7E88D2E380C50F37A6EC9254E6B27EC7AFFE6DCDFC1EA230D16C4DC9BB8 B831A2F0CB578B736566052E830A582836AA9BFFE0821CE7CB43F74077D38B20437479F260 A5D0550CA7D3D0747F0203010001 public-key-code end peer-public-key end# äºæ˜¯å½“ä½ ä¸‹æ¬¡é€‰æ‹©ä½¿ç”¨ssh+å¯†ç ç™»é™†äº¤æ¢æœºçš„æ—¶å€™å°±ä¼šå‘ç°é”™è¯¯ è§£å†³åˆ é™¤å½“å‰äº¤æ¢æœºçš„key å¹¶åœ¨ä¸‹æ¬¡ç™»é™†çš„æ—¶å€™é€‰æ‹© ssh 10.0.0.166Username: ttPress CTRL+C to abort.Connecting to 10.0.0.166 port 22.The server is not authenticated. Continue? [Y/N]:yDo you want to save the server public key? [Y/N]:n","link":"/posts/c10f304f/"},{"title":"åˆæ‹äº‘","text":"åˆæ‹äº‘å·¥ä½œè®°å½•äº¤æ¢æœºå‘½åæ ¼å¼ä¸‰å¤§è¿è¥å•†ç¼©å†™ + é™„è¿‘æœºåœºä»£ç  + S01ç­‰ ç§»åŠ¨ CMNç”µä¿¡ CTNè”é€š CUN äº¤æ¢æœºipv6æ£€æµ‹å†…å®¹åŸå›  å†…ç½‘æœºå™¨æ¯”å¦‚å…¨æ˜¯ç§»åŠ¨çš„ï¼Œäº¤æ¢æœºé…çš„ç§»åŠ¨çš„ipï¼Œä¸‹é¢é…çš„ä¹Ÿæ˜¯ç§»åŠ¨çš„ipè¿™æ ·pingçš„é€šï¼Œä½†æ˜¯è”é€šçš„æœåŠ¡å™¨ip pingä¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´æ˜¯å†…ç½‘é€šï¼Œå¤–ç½‘ä¸åŒã€‚å†…ç½‘ping ç½‘å…³è‚¯å®šé€š æ£€æµ‹ï¼šç”¨ç§»åŠ¨çš„äº¤æ¢æœºä¸‹é¢çš„æœåŠ¡å™¨ï¼ˆå‡ºé—®é¢˜çš„äº¤æ¢æœºï¼‰ å»mtrå¤–ç½‘çš„ipï¼Œå»çœ‹æ˜¯å“ªé‡Œæ–­æ‰çš„è€Œä¸æ˜¯ç”¨å¤–ç½‘çš„æœºå™¨æ¥mtrå†…ç½‘çš„ipï¼Œè¿™æ ·æˆªæ­¢çš„åœ°æ–¹ä¼šçœ‹ä¸å‡ºæ¥ï¼Œå› ä¸ºä¸æ˜¯å†…ç½‘çš„æœºå™¨ ipv6é…ç½®#ä¸šåŠ¡vlaninterface Vlan-interface1ipv6 address +ä¸šåŠ¡vlan ipundo ipv6 nd ra halt#äº’è”vlaninterface Vlan-interface200ipv6 address +äº’è”æœ¬åœ°ip#é»˜è®¤è·¯ç”±ipv6 route-static :: 0 + äº’è”å¯¹ç«¯ip é…ç½®æ¡ˆä¾‹å¹¿ä¸œå¹¿å·ç§»åŠ¨æœºæˆ¿ï¼ˆè‡ªæœ‰æœºæˆ¿NMï¼‰ï¼š2409:8C54:B000:0704::/64 äº’è”åœ°å€ æœºæˆ¿ï¼šFEC0::C/127ï¼Œ æˆ‘å¸ FEC0::D/127vlan 1 ip address 2409:8C54:B000:0704::/64 undo ipv6 nd ra haltvlan 20ipv6 address FEC0::D/127router-staticipv6 route-static :: 0 FEC0::Cå±±ä¸œæµå—ç§»åŠ¨æœºæˆ¿ï¼ˆè‡ªæœ‰èŠ‚ç‚¹NMï¼‰ï¼š2409:8C3C:0004:000C::/64ï¼Œäº’è”åœ°å€ä¸ºï¼š2409:8C3C:00FF:0004::000E/127ã€ æˆ‘å¸ 2409:8C3C:00FF:0004::0010/127vlan 1ip address 2409:8C3C:0004:000C::/64undo ipv6 nd ra haltvlan 20ipv6 address 2409:8C3C:00FF:0004::0010/127route-staticipv6 route-static :: 0 2409:8C3C:00FF:0004::000Evlan 1ipv6 address 240E:E9:B804:3:400::1/72undo ipv6 nd ra haltvlan 30 ipv6 address 240E:E9:B804:3:200::A3/127ipv6 address 240E:E9:B804:3:200::B3/127router-staticipv6 route-static :: 0 240E:E9:B804:3:200::A3 æ— æ³•è”ç½‘ é¦–å…ˆpingäº¤æ¢æœºip çœ‹æ˜¯å¦é€š ä¸²å£çº¿è¿æ¥äº¤æ¢æœº pingç½‘å…³æ˜¯å¦é€šä¸é€š 10.0.0.130 æŸ¥çœ‹ç«¯å£çŠ¶æ€dis int briefèšåˆå£æ˜¯å¦èµ·æ¥ ç«¯å£æ˜¯å¦èµ·æ¥ pvidæ˜¯å¦å¯¹åº”1000(ç»Ÿä¸€æ˜¯1000 é™¤ä¸ªåˆ«å¤–å¯ä»¥åœ¨ä¸Šè”äº¤æ¢æœºä¸Šçœ‹10.0.0.130) ç¡¬ä»¶é—®é¢˜çœ‹æ¨¡å—æ˜¯å¦å‘å…‰ çœ‹è·³çº¿æ˜¯å¦å‘å…‰ æ•´ç†é¦™æ¸¯nttç‚¹ipå¯¹åº”å…³ç³» ç™»é™†netopæœåŠ¡å™¨ ç™»é™†é¦™æ¸¯nttäº¤æ¢æœº æŸ¥çœ‹vlan1 å¯¹åº”ip å…¶ä¸­157.xxx/27 [NTT-CN-HKG-S01-Vlan-interface1]display this#interface Vlan-interface1 ip address 157.119.232.1 255.255.255.224 ip address 10.81.0.254 255.255.255.0 sub ip address 103.211.192.221 255.255.255.252 sub ip address 103.251.128.1 255.255.255.224 sub ip address 157.119.232.65 255.255.255.224 sub ip address 192.168.1.1 255.255.255.0 sub ip address 192.168.128.1 255.255.255.0 sub ip address 192.168.232.1 255.255.255.224 sub ipv6 address 2405:FD80:110::1/52#return åœ¨netopæœåŠ¡å™¨ä¸Šç”¨fping -g 157.119.231.1/27 æ¥æŸ¥çœ‹å¯¹åº”ipçš„çŠ¶æ€ [root@NETOPS machines]# fping -g 157.119.232.65/27157.119.232.65 is alive157.119.232.66 is alive157.119.232.67 is alive157.119.232.68 is alive157.119.232.69 is alive157.119.232.70 is alive157.119.232.71 is alive157.119.232.72 is alive157.119.232.73 is alive157.119.232.74 is alive157.119.232.75 is alive157.119.232.85 is alive157.119.232.87 is alive157.119.232.86 is alive157.119.232.88 is alive157.119.232.89 is alive157.119.232.90 is alive157.119.232.91 is alive157.119.232.76 is unreachable157.119.232.77 is unreachable157.119.232.78 is unreachable157.119.232.79 is unreachable157.119.232.80 is unreachable157.119.232.81 is unreachable157.119.232.82 is unreachable157.119.232.83 is unreachable157.119.232.84 is unreachable157.119.232.92 is unreachable157.119.232.93 is unreachable157.119.232.94 is unreachable[root@NETOPS machines]# fping -g 157.119.232.1/27157.119.232.1 is alive157.119.232.2 is alive157.119.232.3 is alive157.119.232.4 is alive157.119.232.5 is alive157.119.232.6 is alive157.119.232.7 is alive157.119.232.8 is alive157.119.232.9 is alive157.119.232.10 is alive157.119.232.11 is alive157.119.232.12 is alive157.119.232.13 is alive157.119.232.14 is alive157.119.232.15 is alive157.119.232.16 is alive157.119.232.17 is alive157.119.232.19 is alive157.119.232.18 is alive157.119.232.20 is alive157.119.232.21 is alive157.119.232.22 is alive157.119.232.23 is alive157.119.232.24 is alive157.119.232.25 is alive157.119.232.26 is alive157.119.232.27 is alive157.119.232.28 is alive157.119.232.29 is alive157.119.232.30 is alive æŸ¥çœ‹inventoryä¸­å¯¹åº”å…³ç³» [root@NETOPS machines]# grep 157.119.232.73 /root/mingtao/inventory/machines/*/root/mingtao/inventory/machines/lists-upapp-01:157.119.232.73[root@NETOPS machines]# grep 157.119.232.30 /root/mingtao/inventory/machines/*/root/mingtao/inventory/machines/lists-cdn-v406:# NTT-CN-HKG-030 ansible_ssh_host=157.119.232.30/root/mingtao/inventory/machines/lists-openstack:# NTT-CN-HKG-030 ansible_ssh_host=157.119.232.30/root/mingtao/inventory/machines/lists-openstack:OPK-HKG-M30 ansible_ssh_host=157.119.232.30/root/mingtao/inventory/machines/lists-upops:NTT-CN-HKG-030 ansible_ssh_host=157.119.232.30[root@NETOPS machines]# grep 157.119.232.29 /root/mingtao/inventory/machines/*/root/mingtao/inventory/machines/lists-cdn-v406:# NTT-CN-HKG-029 ansible_ssh_host=157.119.232.29/root/mingtao/inventory/machines/lists-openstack:# NTT-CN-HKG-029 ansible_ssh_host=157.119.232.29/root/mingtao/inventory/machines/lists-upapp-01:157.119.232.29[root@NETOPS machines]# grep 157.119.232.20 /root/mingtao/inventory/machines/*[root@NETOPS machines]# grep 157.119.232.24 /root/mingtao/inventory/machines/*[root@NETOPS machines]# grep 157.119.232.21 /root/mingtao/inventory/machines/* è®°å½•æœºå™¨çš„å¯¹åº”åå­— nttæœºå™¨å¯¹åº”è„šæœ¬#!/usr/bin/bash# add ip (active and unknown)fping -g 157.119.232.65/27 > ntt_machinefping -g 157.119.231.1/27 >> ntt_machine# filter active to tmp.txtawk '{if($3==\"alive\"){print $1}}' > tmp.txt ntt_machine# Calculate the totalnums=`cat tmp.txt | wc -l`# reset result.txt to blankecho \"result:\" > result.txt# filter ipfor i in `seq 1 $nums`do ip=`awk \"NR==$i\" tmp.txt` link=`grep -w $ip mingtao/inventory/machines/machines/*` link=`echo $link | awk -F\":\" '{print $2}' ` link=`echo $link | awk '{if($1==\"#\"){print $2}else{print $1}}'` echo $ip ,\"active\" , $link >> result.txtdone# add unknown to tmp.txtawk '{if($3!=\"alive\"){print $1,$3}}' >> result.txt ntt_machine~ åº•å±‚è®¾å¤‡åˆ°ç½‘ç»œé…ç½®é€šè¿‡è¯¥toweræˆªå›¾æ¥è·å–ç½‘ç»œé…ç½®éœ€æ±‚15å°1UæœåŠ¡å™¨1å°5130äº¤æ¢æœº2ä¸ªä¸‡å…†å¤šæ¨¡æ¨¡å—30æ ¹ç½‘çº¿16æ ¹ç”µæºçº¿ 1ä¸ªä¸‡å…†å£ 1-30å£æ±‡èš49å£æ¥ä¸Šè” èµ°trunk","link":"/posts/899b698f/"},{"title":"Vimrcé…ç½®","text":"é…ç½®NERDtreeé…ç½®\" ---------------------æ–‡ä»¶æ ‘\" \\\"è¡¨ç¤ºæ³¨è§†\" å…³é—­NERDTreeå¿«æ·é”®map t :NERDTreeToggle\" å½“NERDTreeä¸ºå‰©ä¸‹çš„å”¯ä¸€çª—å£æ—¶è‡ªåŠ¨å…³é—­autocmd bufenter * if (winnr(\"$\") == 1 && exists(\"b:NERDTree\") && b:NERDTree.isTabTree()) | q | endif\" ä¿®æ”¹æ ‘çš„æ˜¾ç¤ºå›¾æ ‡let g:NERDTreeDirArrowExpandable = 'â–º'let g:NERDTreeDirArrowCollapsible = 'â–¼'let NERDTreeAutoCenter=1\" æ˜¾ç¤ºè¡Œå·let NERDTreeShowLineNumbers=1\" æ˜¯å¦æ˜¾ç¤ºéšè—æ–‡ä»¶let NERDTreeShowHidden=1\" è®¾ç½®å®½åº¦let NERDTreeWinSize=25\" åœ¨ç»ˆç«¯å¯åŠ¨vimæ—¶ï¼Œå…±äº«NERDTreelet g:nerdtree_tabs_open_on_console_startup=1\" å¿½ç•¥ä¸€ä¸‹æ–‡ä»¶çš„æ˜¾ç¤ºlet NERDTreeIgnore=['\\.pyc','\\~$','\\.swp']let g:NERDTreeIndicatorMapCustom = { \\ \"Modified\" : \"âœ¹\", \\ \"Staged\" : \"âœš\", \\ \"Untracked\" : \"âœ­\", \\ \"Renamed\" : \"âœ\", \\ \"Unmerged\" : \"â•\", \\ \"Deleted\" : \"âœ–\", \\ \"Dirty\" : \"âœ—\", \\ \"Clean\" : \"âœ”ï¸\", \\ 'Ignored' : 'â˜’', \\ \"Unknown\" : \"?\" \\ }\" æ‰“å¼€NERDTreeçš„å¿«æ·é”®è®¾ç½®ä¸ºF6map :NERDTreeToggle tmuxé…ç½®å®‰è£…Tumx# å…ˆå®‰è£…Homebrewï¼Œæœ‰åˆ™è·³è¿‡ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"# å®‰è£…tmuxbrew install tmux tmuxçš„é…ç½®æ–‡ä»¶åœ¨ï½/.tmux.confé€€å‡ºtmuxåç”Ÿæˆé…ç½® source .tmux.conf tmuxç®€ä»‹å¯¹äºtmuxæ¥è¯´,æœ€å¥½èƒ½äº†è§£ä¸€äº›æ¦‚å¿µ,åœ¨tmuxä¸­,ä¸€å…±åˆ†ä¸º çª—å£ï¼ˆwindows)ï¼Œä¼šè¯(session) ä»¥åŠ é¢æ¿(pane)ä¸‰å—å†…å®¹, tumx ä½¿ç”¨æŒ‡å—ï¼ˆä¼šè¯ç¯‡ï¼‰tumx # æ–°å»ºä¸€ä¸ªæ— åç§°çš„ä¼šè¯tmux new -s demo # (-s -session) æ–°å»ºä¸€ä¸ªåç§°ä¸ºdemoçš„ä¼šè¯tmux detach # æ–­å¼€å½“å‰ä¼šè¯ï¼Œä¼šè¯åœ¨åå°è¿è¡Œtmux ls # æŸ¥çœ‹å½“å‰ä¼šè¯åˆ—è¡¨tmux a # é»˜è®¤è¿›å…¥ç¬¬ä¸€ä¸ªä¼šè¯tmux a -t demo # è¿›å…¥åˆ°åç§°ä¸ºdemoçš„ä¼šè¯ (-t -tmux)tmux kill-session -t demo #å…³é—­demoä¼šè¯tmux kill-server # å…³é—­æœåŠ¡å™¨ï¼Œå³æ‰€æœ‰çš„ä¼šè¯éƒ½å°†å…³é—­tmux ls # æŸ¥çœ‹æ‰€æœ‰ä¼šè¯ tmuxä½¿ç”¨æŒ‡å—ï¼ˆçª—å£ç¯‡ï¼‰c-b d # æ–­å¼€å½“å‰çª—å£ï¼Œåå°è¿è¡Œc-b s # åœ¨å½“å‰çª—å£æ‰“æ¥å…¶ä»–æ­£åœ¨è¿è¡Œçš„tmuxc-b ? # æ˜¾ç¤ºå¿«æ·é”®å¸®åŠ©æ–‡æ¡£c-b d # æ–­å¼€å½“å‰ä¼šè¯c-b c+z # æŒ‚èµ·å½“å‰ä¼šè¯c-b r # å¼ºåˆ¶é‡è½½å½“å‰ä¼šè¯c-b s # æ˜¾ç¤ºä¼šè¯åˆ—è¡¨ç”¨äºé€‰æ‹©å¹¶åˆ‡æ¢c-b [ # è¿›å…¥å¤åˆ¶æ¨¡å¼ æŒ‰qé€€å‡ºc-b ] # ç²˜è´´å¤åˆ¶æ¨¡å¼ä¸­çš„æ–‡æœ¬c-b c # æ–°å»ºçª—å£c-b & # å…³é—­å½“å‰çª—å£ éœ€è¦è¾“å…¥y n ç¡®è®¤c-b 0~9 # åˆ‡æ¢åˆ°æŒ‡å®šçª—å£c-b p # åˆ‡æ¢åˆ°æŒ‡å®šçª—å£c-b n # åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçª—å£c-b w # æ‰“å¼€çª—å£åˆ—è¡¨ï¼Œç”¨äºåˆ‡æ¢çª—å£c-b , # é‡å‘½åå½“å‰çª—å£c-b . # ä¿®æ”¹å½“å‰çª—å£ç¼–å·c-b f # å¿«é€Ÿå®šä½åˆ°çª—å£ Tmuxä½¿ç”¨æ‰‹å†Œåœ°å€ï¼šhttp://louiszhai.github.io/2017/09/30/tmux/ è¿˜éœ€è¦åœ¨è®°å½•ä¸€ä¸‹ tmuxç¾åŒ–ç¯‡tumxé…ç½®ç¯‡é¦–å…ˆtmuxé»˜è®¤å°†ä½œä¸ºå¯åŠ¨åŠŸèƒ½çš„å‰ç¼€æŒ‰é”®ï¼Œå½“ç„¶æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¿®æ”¹è¿™ä¸ªå‰ç¼€æŒ‰é”®ï¼Œå…·ä½“é…ç½®å¯ä»¥å‚ç…§ä¸‹é¢çš„é…ç½®æ–‡ä»¶ å¸¸ç”¨æŒ‰é”®åœ¨å…·ä½“é…ç½®ä¹‹å‰æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹tmuxå¸¸ç”¨æŒ‰é”®,è¿™é‡Œæˆ‘å·²ç»æŠŠå‰ç¼€æŒ‰é”®æ›¿æ¢æˆäº†c-z # å¸¸ç”¨æŒ‰é”®c-z ï¼Ÿæ˜¾ç¤ºå¿«æ·é”®å¸®åŠ©c-z c-o è°ƒæ¢çª—å£ä½ç½®c-z space é‡‡ç”¨ä¸Šä¸‹å¸ƒå±€æˆ–å·¦å³å¸ƒå±€c-z u çºµå‘åˆ†å‰²çª—å£c-z v æ¨ªå‘åˆ†å‰²çª—å£c-z q æ˜¾ç¤ºåˆ†å‰²çª—å£çš„ç¼–å·c-z hjkl ä¸Šä¸‹å·¦å³é€‰æ‹©çª—å£c-z c åˆ›å»ºæ–°çª—å£c-z 0-9 é€‰æ‹©å‡ å·çª—å£c-z n åˆ‡æ¢ä¸‹ä¸€ä¸ªçª—å£c-z p é€‰æ‹©å‰ä¸€ä¸ªçª—å£c-z w ä»¥èœå•æ–¹å¼æ˜¾ç¤ºåŠé€‰æ‹©çª—å£c-z t æ˜¾ç¤ºæ—¶é’Ÿc-z x å…³é—­é¢æ¿c-z d é€€å‡ºå½“å‰çª—å£ï¼Œä¸¢åˆ°ç¼“å­˜ , tmux a è¿›å…¥æŒ‡å®šä¼šè¯c-z s ä»¥èœå•å½¢å¼æ˜¾ç¤ºå’Œé€‰æ‹©ä¼šè¯c-z $ ä¿®æ”¹å½“å‰ä¼šè¯åå­—tmux new -s xxx åˆ›å»ºå¹¶æŒ‡å®šsessionåå­—tmux ls åˆ—å‡ºsessiontmux a -t xxxè¿›å…¥å·²ç»åœ¨çš„sessiontmux kill-session -t session_name åˆ é™¤æŒ‡å®šsession å…·ä½“é…ç½®# Tumxé…ç½®æ–‡ä»¶# from hzj# remap prefix from 'C-b' to 'C-a'# ä¿®æ”¹å‰ç¼€æƒé™unbind C-b # å–æ¶ˆCtrl-Bset -g prefix C-z # æ·»åŠ Ctrl-zbind-key C-z send-prefix ç»‘å®šctrl+zä¸ºæ–°çš„å‰ç¼€ # split panes using | and -# ä½¿ç”¨c-u c-våˆ†å‰²é¢æ¿bind u split-window -hbind v split-window -vunbind '\"'unbind %# ä½¿ç”¨c-(hijk)é€‰æ‹©é¢æ¿bind h select-pane -Lbind l select-pane -Rbind j select-pane -Dbind k select-pane -U bind-key e setw synchronize-panes # Set the default terminal mode to 256color modeset -g default-terminal \"screen-256color\" # Set scrollback buffer to 10000set -g history-limit 10000# resize panebind -r ^k resizep -U 10 # upward (prefix Ctrl+k)bind -r ^j resizep -D 10 # downward (prefix Ctrl+j)bind -r ^h resizep -L 10 # to the left (prefix Ctrl+h)bind -r ^l resizep -R 10 # to the right (prefix Ctrl+l) # app# htop (prefix !)bind ! splitw htop # python bind / command-prompt \"splitw 'exec python3 %%'\" # reload config (prefix r)bind r source ~/.tmux.conf \\; display \"Configuration reloaded!\" #-- statusbar --#set -g status-interval 1set -g status-keys vi setw -g mode-keys visetw -g automatic-rename off #-- colorscheme --##https://github.com/daethorian/conf-tmux/blob/master/colors/zenburn.conf# mouse# æ”¯æŒé¼ æ ‡set-option -g mouse on # æ”¯æŒå¤åˆ¶ç²˜è´´è¿ç»­åˆ°å‰ªåˆ‡æ¿bind C-c run \"tmux save-buffer - | reattach-to-user-namespace pbcopy\"bind C-v run \"reattach-to-user-namespace pbpaste | tmux load-buffer - \\; paste-buffer\"bind-key -T copy-mode-vi 'y' send-keys -X copy-pipe-and-cancel 'reattach-to-user-namespace pbcopy'bind-key -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe-and-cancel \"pbcopy\"set -g status-utf8 on # çŠ¶æ€æ æ”¯æŒutf8set -g status-interval 1 # çŠ¶æ€æ åˆ·æ–°æ—¶é—´set -g status-justify left # çŠ¶æ€æ åˆ—è¡¨å·¦å¯¹é½setw -g monitor-activity on # éå½“å‰çª—å£æœ‰å†…å®¹æ›´æ–°æ—¶åœ¨çŠ¶æ€æ é€šçŸ¥set -g status-bg black # è®¾ç½®çŠ¶æ€æ èƒŒæ™¯é»‘è‰²set -g status-fg yellow # è®¾ç½®çŠ¶æ€æ å‰æ™¯é»„è‰²set -g status-style \"bg=black, fg=yellow\" # çŠ¶æ€æ å‰æ™¯èƒŒæ™¯è‰²set -g status-left \"#[bg=#FF661D] â #S \" # çŠ¶æ€æ å·¦ä¾§å†…å®¹set -g status-right 'Continuum status: #{continuum_status}' # çŠ¶æ€æ å³ä¾§å†…å®¹set -g status-left-length 300 # çŠ¶æ€æ å·¦è¾¹é•¿åº¦300set -g status-right-length 500 # çŠ¶æ€æ å·¦è¾¹é•¿åº¦500set -wg window-status-format \" #I #W \" # çŠ¶æ€æ çª—å£åç§°æ ¼å¼set -wg window-status-current-format \" #I:#W#F \" # çŠ¶æ€æ å½“å‰çª—å£åç§°æ ¼å¼(#Iï¼šåºå·ï¼Œ#wï¼šçª—å£åç§°ï¼Œ#Fï¼šé—´éš”ç¬¦)set -wg window-status-separator \"\" # çŠ¶æ€æ çª—å£åç§°ä¹‹é—´çš„é—´éš”set -wg window-status-current-style \"bg=red\" # çŠ¶æ€æ å½“å‰çª—å£åç§°çš„æ ·å¼set -wg window-status-last-style \"fg=red\" # çŠ¶æ€æ æœ€åä¸€ä¸ªçª—å£åç§°çš„æ ·å¼set -g message-style \"bg=#202529, fg=#91A8BA\" # æŒ‡å®šæ¶ˆæ¯é€šçŸ¥çš„å‰æ™¯ã€åæ™¯è‰²set -g default-terminal \"screen-256color\"","link":"/posts/b4afac26/"},{"title":"è½¯ä»¶é…ç½®","text":"è®¾å¤‡æœ¬æ–‡ä¸»è¦è®°å½•ä¸€äº›è®¾å¤‡ä¸Šçš„å˜åŠ¨ï¼ŒåŒ…æ‹¬å¿«æ·é”®çš„è®¾ç½®ç­‰ç­‰ vscodevscodeè®¾ç½®ä»£ç å—1.ç”±äºmarkdownä¸æ˜¯ä»€ä¹ˆç¼–ç¨‹è¯­æ³•ï¼Œvscodeä¸æ”¯æŒè‡ªåŠ¨æç¤ºå’Œè¡¥å…¨,æ‰€ä»¥æˆ‘ä»¬è¦ç°åœ¨ç”¨æˆ·è®¾ç½®ä¸­æ‰“å¼€markdownçš„è‡ªåŠ¨è¡¥å…¨ctrl+shift+pæ‰“å¼€è®¾ç½®â€”> setting â€”-> åœ¨å…¶ä¸­æ·»åŠ  \"[markdown]\": { \"editor.wordWrap\": \"on\", \"editor.quickSuggestions\": true,}, 2.æ·»åŠ è¡¥å…¨ä»£ç å—ctrl+shift+p â€”> è¾“å…¥markdown â€“> æ‰“å¼€markdown.json â€”> æ·»åŠ å†…å®¹ \"Print to console\": { \"prefix\": \"fcr\", \"body\": [ \"$1\" ], \"description\": \"change font-color to red sign import \" } å…¶ä¸­prefix æ˜¯æŒ‡ä½ ä»£ç å—çš„ç®€æ´å†™æ³•,åœ¨ä½ è¾“å…¥çš„æ—¶å€™ä¼šå‡ºç°ä»£ç å—çš„æç¤ºbodyæ˜¯ä¸»ä½“å†…å®¹,ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ·»åŠ çš„ä»£ç å—description æ˜¯æ³¨é‡Šï¼Œä½ å¯ä»¥æ ‡æ³¨ä¸€ä¸‹è¿™ä»£ç å—æ˜¯ç”¨æ¥å¹²å˜›çš„ vscode ç»‘å®švimè‡ªå®šä¹‰å¿«æ·é”®åœ¨vscodeä¸­è‡ªå®šä¹‰vimå¿«æ·é”®â€œvim.insertModeKeyBindingsâ€: [ { â€œbeforeâ€: [â€œjâ€, â€œjâ€], â€œafterâ€: [â€œâ€œ] }]https://github.com/VSCodeVim/Vim/#key-remapping chromeæ¸…é™¤ç‰¹å®šç½‘å€çš„ç¼“å­˜æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼Œé€‰æ‹© Networkâ€”â€”Disable cache å³å¯ã€‚éœ€è¦æ¸…é™¤æŸç½‘ç«™ç¼“å­˜æ—¶ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·å°±ä¼šè‡ªåŠ¨æ¸…é™¤è¿™ä¸ªç½‘ç«™çš„ç¼“å­˜ï¼Œè€Œä¸å¿…æ¸…é™¤æ‰€æœ‰ç½‘ç«™çš„ç¼“å­˜äº† ssssåŠ å¼ºæ¨¡å¼ Macç”µè„‘ä½¿ç”¨shadowsocksæ— æ³•è¿æ¥å…¬å¸å†…ç½‘é—®é¢˜æœ€è¿‘æ¢äº†macä½†æ˜¯å‘ç°æ— æ³•è¿æ¥macç”µè„‘ï¼Œä¸»è¦åŸå› æ˜¯åœ¨macç”µè„‘ä¸­ssæ— æ³•å¯¹æ‰€æœ‰è½¯ä»¶éƒ½æ”¯æŒç«¯å£è½¬å‘,è¿™æ—¶å€™éœ€è¦ç”¨åˆ°ä¸€ä¸ªè½¯ä»¶ proxifier,åœ¨è¿™ä¸ªä¸Šé¢åšå…¨å±€çš„ç«¯å£è½¬å‘å³å¯ çœ‹åˆ°socks5çš„ç›‘å¬ç«¯å£ä¸º 1086 æ·»åŠ ä»£ç† æ·»åŠ è§„åˆ™ macmacè¿æ¥äº¤æ¢æœºç”±äºåœ¨macä¸­æ²¡æœ‰åƒwindowsä¸­xshellè¿™æ ·ç®€å•æ–¹ä¾¿çš„ä¸²å£è¿æ¥å·¥å…·ï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½ä½¿ç”¨screenæ¥è¿æ¥äº¤æ¢æœº é¦–å…ˆç”¨ä¸²å£çº¿è¿æ¥äº¤æ¢æœºï¼Œç„¶åæŸ¥çœ‹æ¥å…¥çš„ä¸²å£è®¾å¤‡ï¼Œä»–ä»¬æ”¾åœ¨/devä¸‹é¢ ç”±äºä¸åŒçš„ä¸²å£çº¿å‘½åä¸åŒï¼Œä½†æ˜¯ä»–ä»¬åº”è¯¥éƒ½ä¼šå¸¦æœ‰usbå­—æ · ls /dev | grep -i tty.*usbscreen /dev/tty.usbxxxxx 9600 è¿™é‡Œ9600ä¸ºäº¤æ¢æœºçš„é»˜è®¤æ³¢ç‰¹ç‡ï¼Œä½†ä½ ä¹Ÿå¯ä»¥åœ¨äº¤æ¢æœºæ›´æ¢æ³¢ç‰¹ç‡çš„å†…å®¹ macä¸‹ä½¿ç”¨ftpç”±äºæ–°çš„Macç³»ç»Ÿå»è°ƒäº†è‡ªå¸¦çš„telnetå‘½ä»¤å’Œftpå‘½ä»¤ï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥æˆ‘ä»¬è¦å®‰è£…ftpå‘½ä»¤ã€‚æˆ‘çš„ç³»ç»Ÿæ˜¯10.13.6 ftpçš„å®‰è£…éœ€è¦å¾ˆå¤šçš„è½¯ä»¶ä¾èµ– brew install telnetbrew install inetutilsbrew link --overwrite inetutils ç™»é™†- # æ–¹å¼ä¸€ftp ip# æ–¹å¼äºŒftp open ip https://www.jianshu.com/p/10c4e46c77f1ftpä½¿ç”¨æ–¹æ³•https://blog.csdn.net/tianlesoftware/article/details/5818990 macä¸‹æ”¹é”®è®°å½•ä½¿ç”¨karabiner-elementä¿®æ”¹macæŒ‰é”®ä¿®æ”¹å†…å®¹ä¸º:åˆ‡æ¢è¾“å…¥æ³• ç”±ä¹‹å‰çš„caps lockæ”¹æˆ shiftä¹‹å‰çš„caps æ”¹æˆäº† control ä¸‹è½½karabiner-element åœ¨simple modifitions ä¸­ä¿®æ”¹æ˜ å°„from key caps_lockto_key left_control ä¿®æ”¹shiftå’Œcapsç”±äºkarabiner-elementä¸æ”¯æŒåœ¨çª—å£ä¸­ä¿®æ”¹ï¼Œä½†å¯ä»¥æŒ‡å®šjsonå½¢å¼çš„é…ç½®æ–‡ä»¶vi /Users/alpaca/.config/karabiner/karabiner.json \"rules\": [ { \"manipulators\": [ { \"description\": \"Change left_shift to control+space when used alone\", \"from\": { \"key_code\": \"left_shift\", \"modifiers\": { \"optional\": [ \"any\" ] } }, \"to\": [ { \"key_code\": \"left_shift\" } ], \"to_if_alone\": [ { \"key_code\": \"spacebar\", \"modifiers\": [ \"left_control\" ] } ], \"type\": \"basic\" } ] } ] mac /usr/bin/python æƒé™é—®é¢˜operation not permittedä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬åœ¨ä½¿ç”¨macç³»ç»Ÿè¿‡ç¨‹ä¸­ä¸‹è½½ä¸€äº›æ–‡ä»¶ã€æ–°å»ºä¸€äº›é¡¹ç›®ä¹‹åï¼Œè¿™äº›æ–‡ä»¶éƒ½ä¼šé»˜è®¤æ˜¯åªè¯»çŠ¶æ€ï¼Œè¿™æ—¶æˆ‘ä»¬åªéœ€è¦ç®€å•çš„ä¸€å¥æƒé™è®¾ç½®å‘½ä»¤å°±å¯ä»¥è§£å†³ sudo chmod -R 777 filename /usr/binä¸‹é¢çš„æ–‡ä»¶åœ¨macä¸­ä¼šå‡ºç°ä¸€ä¸‹çš„é”™è¯¯ operation not permitted è¿™æ˜¯å› ä¸ºmacå¯ç”¨äº†SIPï¼ˆSystem Integrity Protectionï¼‰ï¼Œå¢åŠ äº†rootlessæœºåˆ¶ï¼Œå¯¼è‡´å³ä½¿åœ¨rootæƒé™ä¸‹ä¾ç„¶æ— æ³•ä¿®æ”¹æ–‡ä»¶ï¼Œåœ¨å¿…è¦æ—¶å€™ä¸ºäº†èƒ½å¤Ÿä¿®æ”¹ä¸‹é¢çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬åªèƒ½å…³é—­è¯¥ä¿æŠ¤æœºåˆ¶ 1) é‡å¯ å¼€æœºè¿‡ç¨‹ä¸­æŒ‰ä½command+R è¿›å…¥ä¿æŠ¤æ¨¡å¼2) æ‰“å¼€ç»ˆç«¯ csrutil disable 3) å†æ¬¡é‡å¯ï¼Œå°±å¯ä»¥ä¿®æ”¹/usr/binä¸‹çš„ç›®å½•æ–‡ä»¶ 4)æ¢å¤ä¿æŠ¤æœºåˆ¶ csrutil enable","link":"/posts/cd35325c/"}],"tags":[],"categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","link":"/categories/%E7%BC%96%E7%A8%8B/"},{"name":"linux","slug":"linux","link":"/categories/linux/"},{"name":"Cè¯­è¨€","slug":"ç¼–ç¨‹/Cè¯­è¨€","link":"/categories/%E7%BC%96%E7%A8%8B/C%E8%AF%AD%E8%A8%80/"},{"name":"Python","slug":"ç¼–ç¨‹/Python","link":"/categories/%E7%BC%96%E7%A8%8B/Python/"},{"name":"docker","slug":"linux/docker","link":"/categories/linux/docker/"},{"name":"docker","slug":"docker","link":"/categories/docker/"},{"name":"ansible","slug":"linux/ansible","link":"/categories/linux/ansible/"},{"name":"django","slug":"ç¼–ç¨‹/django","link":"/categories/%E7%BC%96%E7%A8%8B/django/"},{"name":"checklist","slug":"checklist","link":"/categories/checklist/"},{"name":"mysql","slug":"ç¼–ç¨‹/mysql","link":"/categories/%E7%BC%96%E7%A8%8B/mysql/"},{"name":"git","slug":"git","link":"/categories/git/"},{"name":"vue","slug":"ç¼–ç¨‹/vue","link":"/categories/%E7%BC%96%E7%A8%8B/vue/"},{"name":"nginx","slug":"nginx","link":"/categories/nginx/"},{"name":"SwaggerUi","slug":"ç¼–ç¨‹/SwaggerUi","link":"/categories/%E7%BC%96%E7%A8%8B/SwaggerUi/"},{"name":"æ‰©å±•","slug":"æ‰©å±•","link":"/categories/%E6%89%A9%E5%B1%95/"},{"name":"å·¥å…·","slug":"å·¥å…·","link":"/categories/%E5%B7%A5%E5%85%B7/"},{"name":"vim","slug":"ç¼–ç¨‹/vim","link":"/categories/%E7%BC%96%E7%A8%8B/vim/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","link":"/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"è®°äº‹æœ¬","slug":"è®°äº‹æœ¬","link":"/categories/%E8%AE%B0%E4%BA%8B%E6%9C%AC/"},{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","link":"/categories/%E7%BD%91%E7%BB%9C/"},{"name":"extra","slug":"ç½‘ç»œ/extra","link":"/categories/%E7%BD%91%E7%BB%9C/extra/"},{"name":"Rust","slug":"ç¼–ç¨‹/Rust","link":"/categories/%E7%BC%96%E7%A8%8B/Rust/"},{"name":"linuxç½‘ç»œç®¡ç†","slug":"linux/linuxç½‘ç»œç®¡ç†","link":"/categories/linux/linux%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86/"},{"name":"è„šæœ¬","slug":"linux/è„šæœ¬","link":"/categories/linux/%E8%84%9A%E6%9C%AC/"},{"name":"å¸¸ç”¨å‘½ä»¤","slug":"linux/å¸¸ç”¨å‘½ä»¤","link":"/categories/linux/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"},{"name":"æ•…éšœé—®é¢˜","slug":"linux/æ•…éšœé—®é¢˜","link":"/categories/linux/%E6%95%85%E9%9A%9C%E9%97%AE%E9%A2%98/"},{"name":"æ–‡ä»¶ç³»ç»Ÿ","slug":"linux/æ–‡ä»¶ç³»ç»Ÿ","link":"/categories/linux/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"name":"code/more","slug":"code-more","link":"/categories/code-more/"},{"name":"è´Ÿè½½å‡è¡¡","slug":"linux/è´Ÿè½½å‡è¡¡","link":"/categories/linux/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"},{"name":"vue","slug":"code-more/vue","link":"/categories/code-more/vue/"},{"name":"äº¤æ¢æœº","slug":"ç½‘ç»œ/äº¤æ¢æœº","link":"/categories/%E7%BD%91%E7%BB%9C/%E4%BA%A4%E6%8D%A2%E6%9C%BA/"},{"name":"äº¤æ¢æœºéƒ¨ç½²","slug":"ç½‘ç»œ/äº¤æ¢æœºéƒ¨ç½²","link":"/categories/%E7%BD%91%E7%BB%9C/%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%83%A8%E7%BD%B2/"},{"name":"äºŒå±‚äº¤æ¢æœº","slug":"ç½‘ç»œ/äºŒå±‚äº¤æ¢æœº","link":"/categories/%E7%BD%91%E7%BB%9C/%E4%BA%8C%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA/"},{"name":"è®¾å¤‡","slug":"è®¾å¤‡","link":"/categories/%E8%AE%BE%E5%A4%87/"},{"name":"jwt","slug":"ç¼–ç¨‹/jwt","link":"/categories/%E7%BC%96%E7%A8%8B/jwt/"}]}